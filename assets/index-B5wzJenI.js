const __vite__fileDeps=["foo3/assets/vendor-DVCf_wKq.js","foo3/assets/react-BphjquZE.js","foo3/assets/polyfills-CvPnuOP8.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
var vd=Object.defineProperty;var xd=(s,t,e)=>t in s?vd(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var p=(s,t,e)=>xd(s,typeof t!="symbol"?t+"":t,e);import{j as r,r as m,a as wd,R as bd,b as Ne,c as Sd}from"./react-BphjquZE.js";import{C as $c,c as jd,s as Cd,i as Fr,p as Pd,a as fe,b as on,d as ne,e as B,g as Rc,h as ie,j as Xr,k as us,l as xe,m as Oc,n as Ed,o as Da,q as Id,r as Ma,t as Ad,u as Dc,v as kd,w as Td,x as Nd,A as Ld,I as $d,y as dn,B as Rd,Q as Od,z as Dd,D as T,E as F,F as Md,G as Fd,H as Bd,J as Ud,K as un,N as Mc,V as Fa,L as ae,M as ue,O as ut,P as Hd,R as gt,S as de,T as hn,U as Wd,W as We,X as Zr,Y as ea,Z as Vd,_ as Fn,$ as Fc,a0 as qd,a1 as Gd,a2 as ta,a3 as Ms,a4 as kt,a5 as zd,a6 as Bc,a7 as Ge,a8 as hs,a9 as Kd,aa as Uc,ab as Jd,ac as Hc,ad as Yd,ae as Qd,af as Xd,ag as Zd,ah as eu,ai as tu,aj as su,ak as nu,al as ru,am as au,an as ou,ao as Ba,ap as Wc,aq as iu}from"./vendor-DVCf_wKq.js";import{I as Ks}from"./inplayer-BgU9fFlx.js";import"./index-B5wzJenI.js";import"./polyfills-CvPnuOP8.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function e(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=e(a);fetch(a.href,o)}})();var LC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $C(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}const cu="modulepreload",lu=function(s){return"/"+s},Ua={},Vc=function(t,e,n){let a=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),i=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.all(e.map(c=>{if(c=lu(c),c in Ua)return;Ua[c]=!0;const l=c.endsWith(".css"),d=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=l?"stylesheet":cu,l||(h.as="script",h.crossOrigin=""),h.href=c,i&&h.setAttribute("nonce",i),document.head.appendChild(h),l)return new Promise((u,g)=>{h.addEventListener("load",u),h.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}return a.then(()=>t()).catch(o=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o})};function du(s={}){const{immediate:t=!1,onNeedRefresh:e,onOfflineReady:n,onRegistered:a,onRegisteredSW:o,onRegisterError:i}=s;let c,l;const d=async(u=!0)=>{await l};async function h(){if("serviceWorker"in navigator){if(c=await Vc(async()=>{const{Workbox:u}=await import("./vendor-DVCf_wKq.js").then(g=>g.ar);return{Workbox:u}},__vite__mapDeps([0,1,2])).then(({Workbox:u})=>new u("foo3/sw.js",{scope:"/",type:"classic"})).catch(u=>{i==null||i(u)}),!c)return;c.addEventListener("activated",u=>{(u.isUpdate||u.isExternal)&&window.location.reload()}),c.addEventListener("installed",u=>{u.isUpdate||n==null||n()}),c.register({immediate:t}).then(u=>{o?o("/sw.js",u):a==null||a(u)}).catch(u=>{i==null||i(u)})}}return l=h(),d}const H={APP_VERSION:"",APP_API_BASE_URL:"https://cdn.jwplayer.com",APP_API_ACCESS_BRIDGE_URL:"",APP_PLAYER_ID:"M4qoGvUk",APP_FOOTER_TEXT:"",APP_DEFAULT_LANGUAGE:"en",APP_PUBLIC_URL:""},uu=s=>{H.APP_VERSION=s.APP_VERSION||H.APP_VERSION,H.APP_API_BASE_URL=s.APP_API_BASE_URL||H.APP_API_BASE_URL,H.APP_API_ACCESS_BRIDGE_URL=s.APP_API_ACCESS_BRIDGE_URL||H.APP_API_ACCESS_BRIDGE_URL,H.APP_PLAYER_ID=s.APP_PLAYER_ID||H.APP_PLAYER_ID,H.APP_FOOTER_TEXT=s.APP_FOOTER_TEXT||H.APP_FOOTER_TEXT,H.APP_DEFAULT_LANGUAGE=s.APP_DEFAULT_LANGUAGE||H.APP_DEFAULT_LANGUAGE,H.APP_PUBLIC_URL=s.APP_PUBLIC_URL||H.APP_PUBLIC_URL,H.APP_DEFAULT_CONFIG_SOURCE||(H.APP_DEFAULT_CONFIG_SOURCE=s.APP_DEFAULT_CONFIG_SOURCE),H.APP_PLAYER_LICENSE_KEY||(H.APP_PLAYER_LICENSE_KEY=s.APP_PLAYER_LICENSE_KEY),H.APP_BODY_FONT=H.APP_BODY_FONT,H.APP_BODY_ALT_FONT=H.APP_BODY_ALT_FONT};var yt=(s=>(s.ContinueWatching="continue_watching",s.Favorites="favorites",s))(yt||{});const hu=["favorites","continue_watching"],Zt={JWP:"JWP",CLEENG:"CLEENG"},Me={AVOD:"AVOD",AUTHVOD:"AUTHVOD",SVOD:"SVOD"},Yt={Min:.05,Max:.95},pu=25,qc="test_I4OFGUUCEVB5TI222AS3N2Y2LY6PJM3K",Gc="live_BQDOFBYTGZB3XKF62GBYSLPUJ4YW2TPL",mu=15*6e4,nt={series:"series",episode:"episode",liveChannel:"livechannel",liveEvent:"liveevent",page:"page",hub:"hub"},fu={live:"live"},Ha={hero:"hero",featured:"featured"},Br="M4qoGvUk",sn="app-config",wn="config-file-override",ms=60*1e3*20,fs=60*1e3*20,gu=["1:1","2:1","2:3","4:3","5:3","16:9","9:13","9:16"],sa=48,_u={canUpdateEmail:!1,canSupportEmptyFullName:!1,canChangePasswordWithOldPassword:!1,canRenewSubscription:!1,canExportAccountData:!1,canDeleteAccount:!1,canUpdatePaymentMethod:!1,canShowReceipts:!1,hasSocialURLs:!1,hasNotifications:!1,watchListSizeLimit:sa},na={jwp:"jwp",viewNexa:"viewnexa"},Ft={playlist:"playlist",continue_watching:"continue_watching",favorites:"favorites",content_list:"content_list",media:"media"},te=new $c({defaultScope:"Singleton",skipBaseClassChecks:!0});function q(s,t=!0){const e=te.getAll(s)[0];if(t&&!e)throw new Error(`Service / Controller '${String(s)}' not found`);return e}function yu(s){return te.getAll(s)}function It(s,t,e=!0){if(!t)return;let n;try{return n=te.getAllNamed(s,t)[0],n}catch(a){if(a instanceof Error&&a.message.includes("No matching bindings found")){if(e)throw new Error(`Service not found '${String(s)}' with name '${t}'`);return}console.error("Error caught while initializing service",a)}}function Be(s,t){if(!s)throw new Error(t)}function or(s,t){if(!s)throw new Error(`${t} feature is not enabled`)}const Fs=Symbol("INTEGRATION_TYPE"),ra=Symbol("DETERMINE_INTEGRATION_TYPE"),pn=Symbol("GET_CUSTOMER_IP"),zc=Symbol("API_ACCESS_BRIDGE_URL"),Kc=Symbol("BROADCAST_CHANNEL");function vu(s,t=200){let e;function n(...a){e&&clearTimeout(e),e=setTimeout(()=>s(...a),t)}return n.cancel=()=>clearTimeout(e),n}function xu(s,t){let e,n;function a(...o){const i=n?Date.now()-n:t;i>=t?(s.apply(this,o),n=Date.now()):e||(e=setTimeout(()=>{n&&Date.now()-n>=t&&(s.apply(this,o),n=Date.now()),e=void 0},t-i))}return a.cancel=()=>clearTimeout(e),a}const wu=s=>s.replace(/\\u[\dA-F]{4}/gi,t=>String.fromCharCode(parseInt(t.replace(/\\u/g,""),16)));function bu(s){if(s.indexOf("#")===0&&(s=s.slice(1)),s.length===3&&(s=s[0]+s[0]+s[1]+s[1]+s[2]+s[2]),s.length===6)return{r:parseInt(s.slice(0,2),16),g:parseInt(s.slice(2,4),16),b:parseInt(s.slice(4,6),16)}}function ir(s){const t=bu(s);return t?t.r*.299+t.g*.587+t.b*.114>186?"#000000":"#FFFFFF":""}const Su=!1,aa=!1,Qt=(s,t)=>{var e;return((e=s.contentType)==null?void 0:e.toLowerCase())===t.toLowerCase()},gs=s=>{var t;return["true","1","yes","on"].includes((t=String(s))==null?void 0:t.toLowerCase())},ju=s=>{var t;return["false","0","no","off"].includes((t=String(s))==null?void 0:t.toLowerCase())};const Cu=s=>!!s;var Bt=(s=>(s.LIVE="LIVE",s.VOD="VOD",s.SCHEDULED="SCHEDULED",s))(Bt||{});const Jc=s=>!!s&&Qt(s,nt.liveEvent),Yc=s=>s.mediaStatus==="SCHEDULED"||s.mediaStatus==="LIVE",Pu=s=>{const t=s["VCH.EventState"],{scheduledStart:e,scheduledEnd:n}=s,a=new Date;if((t==="LIVE_PUBLISHED"||e&&e<a)&&n&&n>a)return"LIVE";if(!t)return"VOD";switch(t){case"PRE_LIVE":case"LIVE_UNPUBLISHED":return"SCHEDULED";case"LIVE_PUBLISHED":return"LIVE";case"INSTANT_VOD":case"VOD_PUBLIC":return"VOD"}},Eu=s=>s.mediaStatus==="LIVE"||s.mediaStatus==="VOD",Qc="/m/:id/*",oa="/p/:id/*",Xc="/n/:id/*",Iu="/s/:id/*",Au="/q/*",ku="/o/about",Wn="/u",Tu=`${Wn}/*`,nn="my-account",Ur="favorites",Hr="payments",Nu=`${Wn}/${nn}`,Lu=`${Wn}/${Ur}`,$u=`${Wn}/${Hr}`;var st=(s=>(s[s.DEBUG=0]="DEBUG",s[s.INFO=1]="INFO",s[s.WARN=2]="WARN",s[s.ERROR=3]="ERROR",s[s.FATAL=4]="FATAL",s[s.SILENT=5]="SILENT",s))(st||{});class ia{}const Ru=s=>s instanceof Error?s:new Error(String(s)),mn=s=>(t,e,{error:n,...a}={})=>{yu(ia).forEach(i=>{i.log(s,t,e,a,n?Ru(n):void 0)})},Dt=mn(st.DEBUG),Zc=mn(st.INFO),ds=mn(st.WARN),Ue=mn(st.ERROR);mn(st.FATAL);const el=s=>s?s.seriesPlayListId||s.seriesPlaylistId||s.seriesId:void 0,tl=s=>typeof el(s)<"u",Ou=s=>Qt(s,nt.series),sl=s=>tl(s)||Ou(s),nl=s=>typeof(s==null?void 0:s.episodeNumber)<"u"||Qt(s,nt.episode),Du=s=>{if(!s||!nl(s))return;const e=(s.tags?s.tags.split(","):[]).find(function(n){return/seriesid_([\w\d]+)/i.test(n)});if(e)return e.split("_")[1]},rl=s=>Qt(s,nt.liveChannel),Se=(s,t)=>{const[e,n=""]=s.split("?"),a=new URLSearchParams(n);Object.entries(t).forEach(([i,c])=>{if(c==null)return a.delete(i);const l=Array.isArray(c)?c.join(","):c;a.set(i,String(l))});const o=a.toString();return`${e}${o?`?${o}`:""}`},Vn=(s,t,e)=>{const n=s.split("/").map(a=>{if(a==="*")return t?Object.entries(t).filter(([l])=>!s.includes(l)).map(([l,d])=>d).join("/"):a;if(!a.startsWith(":")||!t)return a;const o=a.endsWith("?"),i=a.replace(":","").replace("?",""),c=t[i];return c||(o||ds("urlFormatting","Missing param in path creation",{path:s,paramName:i}),"")}).join("/");return e?Se(n,e):n},qn=(s,t="-")=>s.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/,"").replace(/-+$/,"").replace(/-/g,t),Te=({id:s,title:t,playlistId:e,play:n=!1,episodeId:a})=>Vn(Qc,{id:s,title:t?qn(t):void 0},{r:e,play:n?"1":null,e:a}),Mu=(s,t)=>Vn(oa,{id:s,title:t?qn(t):void 0}),Fu=(s,t)=>Vn(Xc,{id:s,title:t?qn(t):void 0}),al=({type:s,contentId:t,label:e})=>{switch(s){case Ft.content_list:return Fu(t,e);case Ft.media:return Te({id:t,title:e});case Ft.playlist:return Mu(t,e);default:return""}},Ns=(s,t,e=!1)=>Vn(oa,{id:s},{channel:t,play:e?"1":null}),cs=({seriesId:s,episodeId:t,play:e,playlistId:n})=>Se(`/s/${s}`,{r:n,e:t,play:e?"1":null}),ol=(s,t,e)=>{const n=Du(s),a=el(s);return cs({seriesId:a||n||"",play:t,playlistId:e,episodeId:n&&s.mediaid})};class il extends Error{constructor(e="",n){super(e);p(this,"code");p(this,"message");this.name="ApiError",this.message=e,this.code=n}}const tt=async s=>{const t=await s.json();if(!s.ok){const e=`Request '${s.url}' failed with ${s.status}`,n=t&&typeof t=="object"&&"message"in t&&typeof t.message=="string"?t.message:void 0;throw new il(n||e,s.status||500)}return t},Gn=(s,t,e,n)=>{const a=ju(n==null?void 0:n.requiresSubscription)||gs(n==null?void 0:n.free),o=n==null?void 0:n.mediaOffers;return!(a||s===Me.AVOD&&!o||s===Me.AUTHVOD&&t&&!o||s===Me.SVOD&&e&&!(o!=null&&o.some(i=>i.premier)))},Bu=(s,t)=>t?t.replace(/\s/g,"").split(",").reduce((e,n)=>n.indexOf(`${s}:`)===0||n.indexOf(`!${s}:`)===0?[...e,{offerId:n.slice(n.indexOf(":")+1),premier:n[0]==="!"}]:e,[]):null,_s=(s,t)=>{const e=Cd(t);return jd(e)},z=_s("ConfigStore",()=>({loaded:!1,config:{id:"",siteName:"",description:"",player:"",siteId:"",assets:{},content:[],menu:[],integrations:{cleeng:{useSandbox:!0},jwp:{clientId:null,assetId:null,useSandbox:!0}},styling:{}},settings:{additionalAllowedConfigSources:[],playerId:Br},supportedLanguages:[],accessModel:Me.AVOD,integrationType:null}));var Wa,Va;const qa=20;let Ee=(Wa=fe(),Wa(Va=class{constructor(){p(this,"generateAlternateImageURL",({mediaId:t,label:e,playlistLabel:n})=>{const a=`/v2/media/${t}/images/${n||e}.webp`;return Se(`${H.APP_API_BASE_URL}${a}`,{poster_fallback:1,fallback:n?e:null})});p(this,"parseDate",(t,e)=>{const n=t[e];if(n&&!Fr(new Date(n))){Ue("ApiService",`Invalid "${e}" date provided for the "${t.title}" media item`,{error:new Error("Invalid date")});return}return n?Pd(n):void 0});p(this,"getTranslatedFields",(t,e)=>{if(!e)return t;const n=H.APP_DEFAULT_LANGUAGE,a={...t};if(e!==n)for(const[o,i]of Object.entries(a))t[`${o}-${e}`]&&(a[o]=t[`${o}-${e}`]);return a});p(this,"transformContentList",(t,e)=>{const{list:n,...a}=t,o={...a,playlist:[]};return o.playlist=n.map(i=>{const{custom_params:c,media_id:l,description:d,tags:h,...u}=i,g={feedid:t.id,mediaid:l,tags:h.join(","),description:d||"",sources:[],images:[],image:"",link:"",pubdate:0,...u,...c};return this.transformMediaItem({item:g,playlist:o,language:e})}),o});p(this,"transformPlaylist",(t,e,n)=>(t.playlist=t.playlist.map(a=>this.transformMediaItem({item:a,playlist:t,language:n})),e&&(t.playlist=t.playlist.filter(a=>a.mediaid!==e)),t));p(this,"transformMediaItem",({item:t,playlist:e,language:n})=>{const a=z.getState().config,o=Object.keys(a==null?void 0:a.integrations)[0],i=e==null?void 0:e.imageLabel,c=t.mediaid,l=this.getTranslatedFields(t,n),d={...t,...l,cardImage:this.generateAlternateImageURL({mediaId:c,label:"card",playlistLabel:i}),channelLogoImage:this.generateAlternateImageURL({mediaId:c,label:"channel_logo",playlistLabel:i}),backgroundImage:this.generateAlternateImageURL({mediaId:c,label:"background"}),mediaOffers:t.productIds?Bu(o,t.productIds):void 0,scheduledStart:this.parseDate(t,"VCH.ScheduledStart"),scheduledEnd:this.parseDate(t,"VCH.ScheduledEnd")};return d.mediaStatus=Pu(d),d});p(this,"transformEpisodes",(t,e,n)=>{const{episodes:a,page:o,page_limit:i,total:c}=t;return{episodes:a.filter(l=>l.media_item).map(l=>{var d;return{...this.transformMediaItem({item:l.media_item,language:e}),seasonNumber:(n==null?void 0:n.toString())||((d=l.season_number)==null?void 0:d.toString())||"",episodeNumber:String(l.episode_number)}}),pagination:{page:o,page_limit:i,total:c}}});p(this,"getMediaByWatchlist",async({playlistId:t,mediaIds:e,token:n,language:a})=>{if(!(e!=null&&e.length))return[];const o=`/apps/watchlists/${t}`,i=Se(`${H.APP_API_BASE_URL}${o}`,{token:n,media_ids:e}),c=await fetch(i),l=await tt(c);if(!l)throw new Error(`The data was not found using the watchlist ${t}`);return(l.playlist||[]).map(d=>this.transformMediaItem({item:d,language:a}))});p(this,"getMediaById",async({id:t,token:e,drmPolicyId:n,language:a})=>{const o=n?`/v2/media/${t}/drm/${n}`:`/v2/media/${t}`,i=Se(`${H.APP_API_BASE_URL}${o}`,{token:e}),c=await fetch(i),d=(await tt(c)).playlist[0];if(!d)throw new Error("MediaItem not found");return this.transformMediaItem({item:d,language:a})});p(this,"getMediaByIdWithPassport",async({id:t,siteId:e,planId:n,passport:a,language:o})=>{const i=`/v2/sites/${e}/media/${t}/playback.json`,c=Se(`${H.APP_API_BASE_URL}${i}`,{passport:a,plan_id:n}),l=await fetch(c),h=(await tt(l)).playlist[0];if(!h)throw new Error("MediaItem not found");return this.transformMediaItem({item:h,language:o})});p(this,"getSeries",async(t,e={})=>{if(!t)throw new Error("Series ID is required");const n=`/apps/series/${t}`,a=Se(`${H.APP_API_BASE_URL}${n}`,e),o=await fetch(a);return await tt(o)});p(this,"getSeriesByMediaIds",async t=>{const n=`${H.APP_API_BASE_URL}/apps/series?media_ids=${t.join(",")}`,a=await fetch(n);return await tt(a)});p(this,"getEpisodes",async({seriesId:t,pageOffset:e,pageLimit:n=qa,afterId:a,language:o})=>{if(!t)throw new Error("Series ID is required");const i=`/apps/series/${t}/episodes`,c=Se(`${H.APP_API_BASE_URL}${i}`,{page_offset:e,page_limit:n,after_id:a}),l=await fetch(c),d=await tt(l);return this.transformEpisodes(d,o)});p(this,"getSeasonWithEpisodes",async({seriesId:t,seasonNumber:e,pageOffset:n,pageLimit:a=qa,language:o})=>{if(!t)throw new Error("Series ID is required");const i=`/apps/series/${t}/seasons/${e}/episodes`,c=Se(`${H.APP_API_BASE_URL}${i}`,{page_offset:n,page_limit:a}),l=await fetch(c),d=await tt(l);return this.transformEpisodes(d,o,e)});p(this,"getAdSchedule",async t=>{if(!t)throw new Error("Ad Schedule ID is required");const e=H.APP_API_BASE_URL+`/v2/advertising/schedules/${t}.json`,n=await fetch(e,{credentials:"omit"});return await tt(n)});p(this,"getPlaylistById",async(t,e={},n=H.APP_DEFAULT_LANGUAGE)=>{if(!t)return;const a=`/v2/playlists/${t}`,o=Se(`${H.APP_API_BASE_URL}${a}`,e),i=await fetch(o),c=await tt(i);return this.transformPlaylist(c,e.related_media_id,n)});p(this,"getContentList",async({id:t,siteId:e,language:n})=>{if(!t||!e)throw new Error("List ID and Site ID are required");const a=`/v2/sites/${e}/content_lists/${t}`,o=Se(`${H.APP_API_BASE_URL}${a}`,{}),i=await fetch(o),c=await tt(i);return this.transformContentList(c,n)});p(this,"getContentSearch",async({siteId:t,params:e})=>{const n=`/v2/sites/${t}/app_content/media/search`,a=Se(`${H.APP_API_BASE_URL}${n}`,{search_query:e.searchTerm}),o=await fetch(a),i=await tt(o);return this.transformPlaylist(i)})}})||Va);class _e{}class vt{constructor(t){p(this,"features");this.features=t}}var Ga,za,Ka,Ja,Ya,Qa,ot;const Uu=on(ne().shape({mediaid:B(),progress:Rc()}));let Wr=(Ga=fe(),za=function(s,t){return ie(Fs)(s,void 0,0)},Ka=function(s,t){return ie(Ee)(s,void 0,1)},Ja=function(s,t){return ie(_e)(s,void 0,2)},Ya=Reflect.metadata("design:type",Function),Qa=Reflect.metadata("design:paramtypes",[String,typeof Ee>"u"?Object:Ee,typeof _e>"u"?Object:_e]),Ga(ot=za(ot=Ka(ot=Ja(ot=Ya(ot=Qa(ot=class{constructor(t,e,n){p(this,"PERSIST_KEY_WATCH_HISTORY","history");p(this,"apiService");p(this,"storageService");p(this,"accountService");p(this,"getWatchHistoryItems",async(t,e,n)=>{const a=await this.apiService.getMediaByWatchlist({playlistId:t,mediaIds:e,language:n});return Object.fromEntries((a||[]).map(i=>[i.mediaid,i]))});p(this,"getWatchHistorySeriesItems",async(t,e,n)=>{const a=await this.apiService.getSeriesByMediaIds(e),o=Object.keys(a||{}).map(d=>{var h,u;return(u=(h=a==null?void 0:a[d])==null?void 0:h[0])==null?void 0:u.series_id}).filter(Boolean),i=[...new Set(o)],c=await this.apiService.getMediaByWatchlist({playlistId:t,mediaIds:i,language:n});return Object.keys(a||{}).reduce((d,h)=>{var g,y;const u=(y=(g=a==null?void 0:a[h])==null?void 0:g[0])==null?void 0:y.series_id;return u&&(d[h]=c==null?void 0:c.find(f=>f.mediaid===u)),d},{})});p(this,"getWatchHistory",async(t,e,n)=>{const a=t?await this.getWatchHistoryFromAccount(t):await this.getWatchHistoryFromStorage(),o=a.map(({mediaid:i})=>i);if(!o.length)return[];try{const i=await this.getWatchHistoryItems(e,o,n),c=await this.getWatchHistorySeriesItems(e,o,n);return a.map(l=>{const d=c==null?void 0:c[l.mediaid],h=i[l.mediaid];if(h)return this.createWatchHistoryItem(d||h,l.mediaid,d==null?void 0:d.mediaid,l.progress)}).filter(l=>!!l)}catch(i){Ue("WatchHistoryService","Failed to get watch history items",{error:i})}return[]});p(this,"serializeWatchHistory",t=>t.map(({mediaid:e,progress:n})=>({mediaid:e,progress:n})));p(this,"persistWatchHistory",async(t,e)=>{var n;e?await((n=this.accountService)==null?void 0:n.updateWatchHistory({history:this.serializeWatchHistory(t),user:e})):await this.storageService.setItem(this.PERSIST_KEY_WATCH_HISTORY,JSON.stringify(this.serializeWatchHistory(t)))});p(this,"createWatchHistoryItem",(t,e,n,a)=>({mediaid:e,seriesId:n,title:t.title,tags:t.tags,duration:t.duration,progress:a,playlistItem:t}));p(this,"getMaxWatchHistoryCount",()=>{var t,e;return((e=(t=this.accountService)==null?void 0:t.features)==null?void 0:e.watchListSizeLimit)||sa});p(this,"saveItem",async(t,e,n,a)=>{if(!n)return;const o=this.createWatchHistoryItem(e||t,t.mediaid,e==null?void 0:e.mediaid,n),i=a.filter(({mediaid:c,seriesId:l})=>c!==o.mediaid&&(!l||l!==o.seriesId));return i.unshift(o),i.splice(this.getMaxWatchHistoryCount()),i});this.apiService=e,this.storageService=n,this.accountService=It(vt,t)}validateWatchHistory(t){return t&&Uu.validateSync(t)?t:[]}async getWatchHistoryFromAccount(t){const e=await this.accountService.getWatchHistory({user:t});return this.validateWatchHistory(e)}async getWatchHistoryFromStorage(){const t=await this.storageService.getItem(this.PERSIST_KEY_WATCH_HISTORY,!0);return this.validateWatchHistory(t)}})||ot)||ot)||ot)||ot)||ot)||ot);var Xa,Za;let cl=(Xa=fe(),Xa(Za=class{constructor(){p(this,"getToken",async(t,e={},n)=>await(await fetch(t,{method:"POST",headers:{Authorization:n?`Bearer ${n}`:""},body:JSON.stringify(e)})).json());p(this,"getMediaToken",async(t,e,n,a,o)=>{const i=await this.getToken(`${t}/media/${e}/sign${o?`/drm/${o}`:""}`,a,n);if(!i.entitled)throw new Error("Unauthorized");return i.token})}})||Za);var eo,to,so,no,Ut;const cr="inplayer_token",Hu="inplayer_iot",Wu={json:"application/json",form:"application/x-www-form-urlencoded"};var Mr;let Re=(eo=fe(),to=function(s,t){return ie(_e)(s,void 0,0)},so=Reflect.metadata("design:type",Function),no=Reflect.metadata("design:paramtypes",[typeof _e>"u"?Object:_e]),eo(Ut=to(Ut=so(Ut=no(Ut=(Mr=class{constructor(t){p(this,"storageService");p(this,"useSandboxEnv",!0);p(this,"setup",t=>{this.useSandboxEnv=t});p(this,"getBaseUrl",()=>this.useSandboxEnv?"https://staging-sims.jwplayer.com":"https://sims.jwplayer.com");p(this,"setToken",(t,e="",n)=>this.storageService.setItem(cr,JSON.stringify({token:t,refreshToken:e,expires:n}),!1));p(this,"getToken",async()=>{const t=await this.storageService.getItem(cr,!0,!1);return t||{token:"",refreshToken:"",expires:0}});p(this,"removeToken",async()=>{await Promise.all([this.storageService.removeItem(cr),this.storageService.removeItem(Hu)])});p(this,"isAuthenticated",async()=>{const t=await this.getToken();return!!t.token&&t.expires>Date.now()/1e3});p(this,"performRequest",async(t="/",e="GET",n,{contentType:a="form",responseType:o="json",withAuthentication:i=!1,keepalive:c,includeFullResponse:l=!1}={},d)=>{var x;const h={"Content-Type":Wu[a]};if(i){const w=await this.getToken();w.token&&(h.Authorization=`Bearer ${w.token}`)}const u=new URLSearchParams;n&&Object.entries(n).forEach(([w,_])=>{(_||_===0)&&(typeof _=="object"?Object.entries(_).forEach(([b,v])=>{u.append(`${w}[${b}]`,v.toString())}):u.append(w,_.toString()))});const g=`${t.startsWith("http")?t:`${this.getBaseUrl()}${t}`}${d?`?${new URLSearchParams(d).toString()}`:""}`,y=await fetch(g,{headers:h,keepalive:c,method:e,body:n&&u.toString()}),f=await((x=y[o])==null?void 0:x.call(y));if(!y.ok)throw{response:{data:f}};return l?{...y,data:f}:f});p(this,"get",(t,e,n)=>this.performRequest(t,"GET",void 0,e,n));p(this,"patch",(t,e,n)=>this.performRequest(t,"PATCH",e,n));p(this,"put",(t,e,n)=>this.performRequest(t,"PUT",e,n));p(this,"post",(t,e,n)=>this.performRequest(t,"POST",e,n));p(this,"remove",(t,e,n)=>this.performRequest(t,"DELETE",n,e));this.storageService=t}},p(Mr,"isCommonError",t=>{var e,n,a,o;return typeof t=="object"&&t!==null&&"response"in t&&typeof((n=(e=t.response)==null?void 0:e.data)==null?void 0:n.code)=="number"&&typeof((o=(a=t.response)==null?void 0:a.data)==null?void 0:o.message)=="string"}),Mr))||Ut)||Ut)||Ut)||Ut);var ro,ao,oo,io,Ht;let ca=(ro=fe(),ao=function(s,t){return ie(Re)(s,void 0,0)},oo=Reflect.metadata("design:type",Function),io=Reflect.metadata("design:paramtypes",[typeof Re>"u"?Object:Re]),ro(Ht=ao(Ht=oo(Ht=io(Ht=class{constructor(t){p(this,"apiService");p(this,"getJWPMediaToken",async(t="",e)=>{try{return(await this.apiService.get("/v2/items/jw-media/token",{withAuthentication:!0},{app_config_id:t,media_id:e})).token}catch{throw new Error("Unauthorized")}});p(this,"getEntitledPlans",async({siteId:t})=>{try{return await this.apiService.get(`/v3/sites/${t}/entitlements`,{withAuthentication:await this.apiService.isAuthenticated()})}catch{throw new Error("Failed to fetch entitled plans")}});this.apiService=t}})||Ht)||Ht)||Ht)||Ht);var co,lo,uo,ho,po,mo,it;const Vu=on(ne().shape({mediaid:B()}));let Vr=(co=fe(),lo=function(s,t){return ie(Fs)(s,void 0,0)},uo=function(s,t){return ie(Ee)(s,void 0,1)},ho=function(s,t){return ie(_e)(s,void 0,2)},po=Reflect.metadata("design:type",Function),mo=Reflect.metadata("design:paramtypes",[String,typeof Ee>"u"?Object:Ee,typeof _e>"u"?Object:_e]),co(it=lo(it=uo(it=ho(it=po(it=mo(it=class{constructor(t,e,n){p(this,"PERSIST_KEY_FAVORITES","favorites");p(this,"apiService");p(this,"storageService");p(this,"accountService");p(this,"getFavorites",async(t,e,n)=>{const o=(t?await this.getFavoritesFromAccount(t):await this.getFavoritesFromStorage()).map(({mediaid:i})=>i);if(!o)return[];try{return(await this.apiService.getMediaByWatchlist({playlistId:e,mediaIds:o,language:n})||[]).map(c=>this.createFavorite(c))}catch(i){Ue("FavoriteService","Failed to get favorites",{error:i})}return[]});p(this,"serializeFavorites",t=>t.map(({mediaid:e})=>({mediaid:e})));p(this,"persistFavorites",async(t,e)=>{var n;if(e)return(n=this.accountService)==null?void 0:n.updateFavorites({favorites:this.serializeFavorites(t),user:e});await this.storageService.setItem(this.PERSIST_KEY_FAVORITES,JSON.stringify(this.serializeFavorites(t)))});p(this,"getMaxFavoritesCount",()=>{var t,e;return((e=(t=this.accountService)==null?void 0:t.features)==null?void 0:e.watchListSizeLimit)||sa});p(this,"createFavorite",t=>({mediaid:t.mediaid,title:t.title,tags:t.tags,duration:t.duration,playlistItem:t}));this.apiService=e,this.storageService=n,this.accountService=It(vt,t,!1)}validateFavorites(t){return t&&Vu.validateSync(t)?t:[]}async getFavoritesFromAccount(t){var n;const e=await((n=this.accountService)==null?void 0:n.getFavorites({user:t}));return this.validateFavorites(e)}async getFavoritesFromStorage(){const t=await this.storageService.getItem(this.PERSIST_KEY_FAVORITES,!0);return this.validateFavorites(t)}})||it)||it)||it)||it)||it)||it);const qu=ne({contentId:B().notRequired(),title:B().notRequired(),featured:Xr().notRequired(),backgroundColor:B().nullable().notRequired(),type:us().oneOf(["playlist","continue_watching","favorites","content_list"]),custom:ne().notRequired()}).defined(),Gu=ne().shape({label:B().defined(),contentId:B().defined(),filterTags:B().notRequired(),type:us().oneOf(["playlist","content_list","media"]).notRequired(),custom:ne().notRequired()}),zu=ne({recommendationsPlaylist:B().nullable(),searchPlaylist:B().nullable(),continueWatchingList:B().nullable(),favoritesList:B().nullable()}),Ku=ne({id:B().nullable(),monthlyOffer:B().nullable(),yearlyOffer:B().nullable(),useSandbox:Xr().default(!0)}),Ju=ne({clientId:B().nullable(),assetId:Rc().nullable(),useSandbox:Xr().default(!0)}),Yu=ne({backgroundColor:B().nullable(),highlightColor:B().nullable(),headerBackground:B().nullable(),footerText:B().nullable()}),Qu=ne({id:B().notRequired(),siteName:B().notRequired(),description:B().defined(),analyticsToken:B().nullable(),adSchedule:B().nullable(),adDeliveryMethod:us().oneOf(["csai","ssai"]).notRequired(),adConfig:B().nullable(),siteId:B().defined(),assets:ne({banner:B().notRequired().nullable()}).notRequired(),content:on().of(qu),menu:on().of(Gu),styling:Yu.notRequired(),features:zu.notRequired(),integrations:ne({cleeng:Ku.notRequired(),jwp:Ju.notRequired()}).notRequired(),adScheduleUrls:ne({json:B().notRequired().nullable(),xml:B().notRequired().nullable()}).notRequired(),custom:ne().notRequired(),contentSigningService:ne().shape({host:B().required(),drmPolicyId:B().notRequired()}),contentProtection:ne().shape({accessModel:B().oneOf(["free","freeauth","authvod","svod"]).notRequired(),drm:ne({defaultPolicyId:B()}).notRequired()}).notRequired()}).defined();class $s extends Error{constructor(e,n){super(e);p(this,"payload");this.name="AppError",this.payload=n}}var fo,go;let Rs=(fo=fe(),fo(go=class{constructor(){p(this,"CONFIG_HOST",H.APP_API_BASE_URL);p(this,"DEFAULT_CONFIG",{id:"",siteName:"",description:"",siteId:"",assets:{banner:"/images/logo.png"},content:[],menu:[],integrations:{},styling:{footerText:""},features:{}});p(this,"enrichConfig",t=>{const{content:e,siteName:n}=t,a=e.map(o=>Object.assign({featured:!1},o));return{...t,siteName:n||xe.t("common:default_site_name"),content:a}});p(this,"getDefaultConfig",()=>this.DEFAULT_CONFIG);p(this,"validateConfig",t=>Qu.validate(t,{strict:!0}));p(this,"formatSourceLocation",t=>{if(t)return t.match(/^[a-z,\d]{8}$/)?`${this.CONFIG_HOST}/apps/configs/${t}.json`:t});p(this,"loadConfig",async t=>{const e=Oc(),n={title:e.t("error:config_invalid"),description:e.t("error:check_your_config"),helpLink:"https://github.com/jwplayer/ott-web-app/blob/develop/docs/configuration.md"};if(!t)throw new $s("No config location found",n);const a=await fetch(t,{headers:{Accept:"application/json"},method:"GET"}).catch(()=>{throw new $s("Failed to load the config",n)});if(!a.ok)throw new $s("Failed to load the config",n);const o=await a.json();if(!o)throw new Error("No config found");return this.enrichConfig(o)})}})||go);var _o,yo,vo,xo,Wt;let Rn=(_o=fe(),yo=function(s,t){return ie(_e)(s,void 0,0)},vo=Reflect.metadata("design:type",Function),xo=Reflect.metadata("design:paramtypes",[typeof _e>"u"?Object:_e]),_o(Wt=yo(Wt=vo(Wt=xo(Wt=class{constructor(t){p(this,"storageService");p(this,"isValidConfigSource",(t,e)=>e!=null&&e.UNSAFE_allowAnyConfigSource?!!t:(e==null?void 0:e.defaultConfigSource)===t||(e==null?void 0:e.additionalAllowedConfigSources)&&(e==null?void 0:e.additionalAllowedConfigSources.indexOf(t))>=0);p(this,"initialize",async()=>{var a;const t=await fetch("/foo3/webapp.txt").then(o=>o.text()).then(o=>Ed.parse(o)).catch(o=>(Dt("SettingsService","Failed to fetch or parse the ini settings",{error:o}),{})),e=Oc(),n={title:e.t("error:settings_invalid"),description:e.t("error:check_your_settings"),helpLink:"https://github.com/jwplayer/ott-web-app/blob/develop/docs/initialization-file.md"};if(!t)throw new $s("Unable to load .webapp.ini",n);if(t.defaultConfigSource||(t.defaultConfigSource=H.APP_DEFAULT_CONFIG_SOURCE),t.playerId||(t.playerId=H.APP_PLAYER_ID||Br),t.playerLicenseKey||(t.playerLicenseKey=H.APP_PLAYER_LICENSE_KEY),t.apiAccessBridgeUrl||(t.apiAccessBridgeUrl=H.APP_API_ACCESS_BRIDGE_URL),t.playerId===Br&&!t.playerLicenseKey&&ds("SettingsService","Using Global OTT Player without setting player key. Some features, such as analytics, may not work correctly."),!t.defaultConfigSource&&(!t.additionalAllowedConfigSources||((a=t.additionalAllowedConfigSources)==null?void 0:a.length)===0)&&!t.UNSAFE_allowAnyConfigSource)throw new $s("No usable config sources",n);return t});this.storageService=t}async getConfigSource(t,e){var i;if(!t)return"";const a=new URLSearchParams(e.split("?")[1]).get(sn);if(!t.UNSAFE_allowAnyConfigSource&&(((i=t.additionalAllowedConfigSources)==null?void 0:i.length)||0)<=0)return t.defaultConfigSource;if(a!==null){if(!a)return await this.storageService.removeItem(wn),t.defaultConfigSource;if(this.isValidConfigSource(a,t))return await this.storageService.setItem(wn,a),a;ds("SettingsService",`Invalid app-config query param: ${a}`)}const o=await this.storageService.getItem(wn,!1);if(o&&typeof o=="string"){if(this.isValidConfigSource(o,t))return o;ds("SettingsService","Invalid stored config: "+o),await this.storageService.removeItem(wn)}return t.defaultConfigSource}})||Wt)||Wt)||Wt)||Wt);const U=_s("AccountStore",(s,t)=>({loading:!1,user:null,subscription:null,transactions:null,entitledPlan:null,activePayment:null,customerConsents:null,publisherConsents:null,publisherConsentsLoading:!1,pendingOffer:null,setLoading:e=>s({loading:e}),getAccountInfo:()=>{const e=t().user,n=t().customerConsents;if(!(e!=null&&e.id))throw new Error("user not logged in");return{customerId:e==null?void 0:e.id,customer:e,customerConsents:n}}})),_t=_s("WatchHistoryStore",(s,t)=>({watchHistory:[],playlistItemsLoaded:!1,continueWatchingPlaylistId:yt.ContinueWatching,getItem:e=>t().watchHistory.find(({mediaid:n,progress:a})=>n===e.mediaid&&a>Yt.Min&&a<Yt.Max),getPlaylist:()=>({feedid:t().continueWatchingPlaylistId||yt.ContinueWatching,title:"Continue watching",playlist:t().watchHistory.filter(({playlistItem:e,progress:n})=>!!e&&n>Yt.Min&&n<Yt.Max).map(({playlistItem:e})=>e)}),getDictionaryWithEpisodes:()=>t().watchHistory.reduce((e,n)=>{const a=n.mediaid;return e[a]=n.progress,e},{}),getDictionaryWithSeries:()=>t().watchHistory.reduce((e,n)=>{const a=n.seriesId||n.mediaid;return e[a]=n.progress,e},{})}));var wo,bo,So,js;let Os=(wo=fe(),bo=Reflect.metadata("design:type",Function),So=Reflect.metadata("design:paramtypes",[typeof Wr>"u"?Object:Wr]),wo(js=bo(js=So(js=class{constructor(t){p(this,"watchHistoryService");p(this,"initialize",async t=>{await this.restoreWatchHistory(t)});p(this,"restoreWatchHistory",async t=>{var o;const{user:e}=U.getState(),n=(o=z.getState().config.features)==null?void 0:o.continueWatchingList;if(!n)return;const a=await this.watchHistoryService.getWatchHistory(e,n,t);_t.setState({watchHistory:a.filter(i=>!!(i!=null&&i.mediaid)),playlistItemsLoaded:!0,continueWatchingPlaylistId:n})});p(this,"persistWatchHistory",async()=>{const{watchHistory:t}=_t.getState(),{user:e}=U.getState();await this.watchHistoryService.persistWatchHistory(t,e)});p(this,"saveItem",async(t,e,n)=>{const{watchHistory:a}=_t.getState();if(!n)return;const o=await this.watchHistoryService.saveItem(t,e,n,a);o&&(_t.setState({watchHistory:o}),await this.persistWatchHistory())});this.watchHistoryService=t}})||js)||js)||js);class Bs{}class Us{}const be=_s("CheckoutStore",s=>({requestedMediaOffers:[],mediaOffers:[],subscriptionOffers:[],switchSubscriptionOffers:[],selectedOffer:null,defaultOfferId:null,order:null,paymentMethods:null,setRequestedMediaOffers:t=>s({requestedMediaOffers:t}),setOrder:t=>s({order:t}),setPaymentMethods:t=>s({paymentMethods:t})}));class Ze extends Error{constructor(e){super(Object.values(e).flat().join(";"));p(this,"errors");this.errors=e}}const Xu=s=>{const t=s==null?void 0:s.period;return t==="month"?"upgrade":t==="year"?"downgrade":"upgrade"},qr=s=>{var t,e;return((e=(t=s==null?void 0:s.find(n=>n.methodName==="card"))==null?void 0:t.id)==null?void 0:e.toString())||""};var jo,Co,Po,Eo,Io,xt;let Tt=(jo=fe(),Co=function(s,t){return ie(Fs)(s,void 0,0)},Po=function(s,t){return ie(pn)(s,void 0,1)},Eo=Reflect.metadata("design:type",Function),Io=Reflect.metadata("design:paramtypes",[typeof IntegrationType>"u"?Object:IntegrationType,typeof GetCustomerIP>"u"?Object:GetCustomerIP]),jo(xt=Co(xt=Po(xt=Eo(xt=Io(xt=class{constructor(t,e){p(this,"accountService");p(this,"checkoutService");p(this,"subscriptionService");p(this,"getCustomerIP");p(this,"initialiseOffers",async()=>{const t=be.getState().requestedMediaOffers,e=t?await this.getOffers({offerIds:t.map(({offerId:n})=>n)}):[];if(be.setState({mediaOffers:e}),!be.getState().subscriptionOffers.length&&this.accountService.svodOfferIds){const n=await this.getOffers({offerIds:this.accountService.svodOfferIds});be.setState({subscriptionOffers:n})}if(!be.getState().switchSubscriptionOffers.length){const n=await this.getSubscriptionSwitches(),a=n?await this.getOffers({offerIds:n}):[];be.setState({switchSubscriptionOffers:a})}});p(this,"getSubscriptionOfferIds",()=>this.accountService.svodOfferIds);p(this,"chooseOffer",async t=>{be.setState({selectedOffer:t})});p(this,"initialiseOrder",async t=>{var l,d;const{getAccountInfo:e}=U.getState(),{customer:n}=e(),a=await this.getPaymentMethods(),o=parseInt(qr(a)),i={offer:t,customerId:n.id,country:(n==null?void 0:n.country)||"",paymentMethodId:o},c=await this.checkoutService.createOrder(i);if(((l=c==null?void 0:c.errors)==null?void 0:l.length)>0)throw be.getState().setOrder(null),new Error(c==null?void 0:c.errors[0]);be.getState().setOrder((d=c.responseData)==null?void 0:d.order)});p(this,"updateOrder",async(t,e,n)=>{var a;try{const o=await this.checkoutService.updateOrder({order:t,paymentMethodId:e,couponCode:n});o.responseData.order&&be.getState().setOrder((a=o.responseData)==null?void 0:a.order)}catch(o){if(o instanceof Error)if(o.message==="Order not found")be.getState().setOrder(null);else{if(o.message==="Invalid coupon code")throw new Ze({couponCode:[xe.t("account:checkout.coupon_not_valid")]});if(o.message==="Invalid coupon code for this offer")throw new Ze({couponCode:[xe.t("account:checkout.coupon_not_valid_for_offer")]})}throw new Ze({form:[xe.t("error:unknown_error")]})}});p(this,"getPaymentMethods",async()=>{var n,a;const{paymentMethods:t}=be.getState();if(t)return t;const e=await this.checkoutService.getPaymentMethods();if(e.errors.length>0)throw new Error(e.errors[0]);return be.getState().setPaymentMethods((n=e.responseData)==null?void 0:n.paymentMethods),(a=e.responseData)==null?void 0:a.paymentMethods});p(this,"paymentWithoutDetails",async({captchaValue:t}={})=>{const{order:e}=be.getState();if(!e)throw new Error("No order created");const n=await this.checkoutService.paymentWithoutDetails({orderId:e.id,captchaValue:t});if(n.errors.length>0)throw new Error(n.errors[0]);if(n.responseData.rejectedReason)throw new Error(n.responseData.rejectedReason);return n.responseData});p(this,"directPostCardPayment",async({cardPaymentPayload:t,referrer:e,returnUrl:n})=>{const{order:a}=be.getState();if(!a)throw new Error("No order created");return await this.checkoutService.directPostCardPayment(t,a,e,n)});p(this,"createAdyenPaymentSession",async(t,e=!0)=>{const{order:n}=be.getState(),a=n==null?void 0:n.id;if(e&&!a)throw new Error("There is no order to pay for");Be(this.checkoutService.createAdyenPaymentSession,"createAdyenPaymentSession is not available in checkout service");const o=await this.checkoutService.createAdyenPaymentSession({orderId:a,returnUrl:t});if(o.errors.length>0)throw new Error(o.errors[0]);return o.responseData});p(this,"initialAdyenPayment",async(t,e,n)=>{const{order:a}=be.getState();if(!a)throw new Error("No order created");Be(this.checkoutService.initialAdyenPayment,"initialAdyenPayment is not available in checkout service");const o=await this.checkoutService.initialAdyenPayment({orderId:a.id,returnUrl:e,paymentMethod:t,customerIP:await this.getCustomerIP(),captchaValue:n});if(o.errors.length>0)throw new Error(o.errors[0]);return o.responseData});p(this,"finalizeAdyenPayment",async(t,e,n)=>{if(!e)throw new Error("No order created");Be(this.checkoutService.finalizeAdyenPayment,"finalizeAdyenPayment is not available in checkout service");const a=await this.checkoutService.finalizeAdyenPayment({orderId:e,details:t,paymentData:n});if(a.errors.length>0)throw new Error(a.errors[0]);return a.responseData});p(this,"paypalPayment",async({successUrl:t,waitingUrl:e,cancelUrl:n,errorUrl:a,couponCode:o="",captchaValue:i})=>{const{order:c}=be.getState();if(!c)throw new Error("No order created");const l=await this.checkoutService.paymentWithPayPal({order:c,successUrl:t,waitingUrl:e,cancelUrl:n,errorUrl:a,couponCode:o,captchaValue:i});if(l.errors.length>0)throw new Error(l.errors[0]);return{redirectUrl:l.responseData.redirectUrl}});p(this,"getSubscriptionSwitches",async()=>{const{getAccountInfo:t}=U.getState(),{customerId:e}=t(),{subscription:n}=U.getState();if(!n||!this.checkoutService.getSubscriptionSwitches)return null;Be(this.checkoutService.getOffer,"getOffer is not available in checkout service");const a=await this.checkoutService.getSubscriptionSwitches({customerId:e,offerId:n.offerId});return a.responseData.available.length?a.responseData.available.map(({toOfferId:o})=>o):null});p(this,"switchSubscription",async()=>{const t=be.getState().selectedOffer,e=U.getState().subscription,{getAccountInfo:n}=U.getState(),{customerId:a}=n();if(!t||!e)throw new Error("No offer selected");Be(this.checkoutService.switchSubscription,"switchSubscription is not available in checkout service");const o=Xu(e),i={toOfferId:t.offerId,customerId:a,offerId:e.offerId,switchDirection:o};await this.checkoutService.switchSubscription(i)});p(this,"changeSubscription",async({accessFeeId:t,subscriptionId:e})=>{Be(this.subscriptionService.changeSubscription,"changeSubscription is not available in subscription service");const{responseData:n}=await this.subscriptionService.changeSubscription({accessFeeId:t,subscriptionId:e});return n});p(this,"updatePayPalPaymentMethod",async(t,e,n,a,o,i)=>{Be(this.checkoutService.updatePaymentMethodWithPayPal,"updatePaymentMethodWithPayPal is not available in checkout service"),Be(this.checkoutService.deletePaymentMethod,"deletePaymentMethod is not available in checkout service");const c=await this.checkoutService.updatePaymentMethodWithPayPal({paymentMethodId:o,successUrl:t,waitingUrl:e,cancelUrl:n,errorUrl:a});if(c.errors.length>0)throw new Error(c.errors[0]);return i&&await this.checkoutService.deletePaymentMethod({paymentDetailsId:i}),c.responseData});p(this,"addAdyenPaymentDetails",async(t,e,n)=>{Be(this.checkoutService.addAdyenPaymentDetails,"addAdyenPaymentDetails is not available in checkout service");const a=await this.checkoutService.addAdyenPaymentDetails({paymentMethodId:e,returnUrl:n,paymentMethod:t,customerIP:await this.getCustomerIP()});if(a.errors.length>0)throw new Error(a.errors[0]);return a.responseData});p(this,"finalizeAdyenPaymentDetails",async(t,e,n)=>{Be(this.checkoutService.finalizeAdyenPaymentDetails,"finalizeAdyenPaymentDetails is not available in checkout service");const a=await this.checkoutService.finalizeAdyenPaymentDetails({paymentMethodId:e,details:t,paymentData:n});if(a.errors.length>0)throw new Error(a.errors[0]);return a.responseData});p(this,"getOffers",t=>this.checkoutService.getOffers(t));p(this,"getEntitlements",t=>this.checkoutService.getEntitlements(t));this.getCustomerIP=e,this.accountService=It(vt,t),this.checkoutService=It(Bs,t),this.subscriptionService=It(Us,t)}})||xt)||xt)||xt)||xt)||xt);const ft=_s("FavoritesState",(s,t)=>({favorites:[],warning:null,favoritesPlaylistId:yt.Favorites,setWarning:e=>s({warning:e}),clearWarning:()=>s({warning:null}),hasItem:e=>t().favorites.some(n=>n.mediaid===e.mediaid),getPlaylist:()=>({feedid:t().favoritesPlaylistId||yt.Favorites,title:"Favorites",playlist:t().favorites.map(({playlistItem:e})=>e)})}));var Ao,ko,To,Cs;let ps=(Ao=fe(),ko=Reflect.metadata("design:type",Function),To=Reflect.metadata("design:paramtypes",[typeof Vr>"u"?Object:Vr]),Ao(Cs=ko(Cs=To(Cs=class{constructor(t){p(this,"favoritesService");p(this,"initialize",async t=>{await this.restoreFavorites(t)});p(this,"restoreFavorites",async t=>{var o;const{user:e}=U.getState(),n=(o=z.getState().config.features)==null?void 0:o.favoritesList;if(!n)return;const a=await this.favoritesService.getFavorites(e,n,t);ft.setState({favorites:a,favoritesPlaylistId:n})});p(this,"persistFavorites",async()=>{const{favorites:t}=ft.getState(),{user:e}=U.getState();await this.favoritesService.persistFavorites(t,e)});p(this,"saveItem",async t=>{const{favorites:e}=ft.getState();if(!e.some(({mediaid:n})=>n===t.mediaid)){const n=[this.favoritesService.createFavorite(t)].concat(e);ft.setState({favorites:n}),await this.persistFavorites()}});p(this,"removeItem",async t=>{const{favorites:e}=ft.getState(),n=e.filter(({mediaid:a})=>a!==t.mediaid);ft.setState({favorites:n}),await this.persistFavorites()});p(this,"toggleFavorite",async t=>{const{favorites:e,hasItem:n,setWarning:a}=ft.getState();if(!t)return;if(n(t)){await this.removeItem(t);return}if(e.length>this.favoritesService.getMaxFavoritesCount()){a(xe.t("video:favorites_warning",{maxCount:this.favoritesService.getMaxFavoritesCount()}));return}await this.saveItem(t)});p(this,"clear",async()=>{ft.setState({favorites:[]}),await this.persistFavorites()});this.favoritesService=t}})||Cs)||Cs)||Cs);var No,Lo,$o,Ro,Vt;let On=(No=fe(),Lo=function(s,t){return ie(zc)(s,void 0,0)},$o=Reflect.metadata("design:type",Function),Ro=Reflect.metadata("design:paramtypes",[String]),No(Vt=Lo(Vt=$o(Vt=Ro(Vt=class{constructor(t){p(this,"apiAccessBridgeUrl");p(this,"generateAccessTokens",async(t,e)=>{const n=`${this.apiAccessBridgeUrl}/v2/sites/${t}/access/generate`,a=await fetch(n,{method:"PUT",headers:{Authorization:e?`Bearer ${e}`:""}});return a.ok?await a.json():(Ue("AccessService","Failed to generateAccessTokens",{status:a.status,error:a.json()}),null)});p(this,"refreshAccessTokens",async(t,e)=>{const n=`${this.apiAccessBridgeUrl}/v2/sites/${t}/access/refresh`,a=await fetch(n,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e})});return a.ok?await a.json():(Ue("AccessService","Failed to refreshAccessTokens",{status:a.status,error:a.json()}),null)});this.apiAccessBridgeUrl=t}})||Vt)||Vt)||Vt)||Vt);const Dn=_s("AccessStore",()=>({passport:null}));var Oo,Do,Mo,Fo,Bo,Uo,Ho,Ye;const lr="access_tokens";let cn=(Oo=fe(),Do=function(s,t){return ie(Fs)(s,void 0,0)},Mo=function(s,t){return ie(Ee)(s,void 0,1)},Fo=function(s,t){return ie(_e)(s,void 0,2)},Bo=function(s,t){return ie(On)(s,void 0,3)},Uo=Reflect.metadata("design:type",Function),Ho=Reflect.metadata("design:paramtypes",[typeof IntegrationType>"u"?Object:IntegrationType,typeof Ee>"u"?Object:Ee,typeof _e>"u"?Object:_e,typeof On>"u"?Object:On]),Oo(Ye=Do(Ye=Mo(Ye=Fo(Ye=Bo(Ye=Uo(Ye=Ho(Ye=class{constructor(t,e,n,a){p(this,"apiService");p(this,"accessService");p(this,"accountService");p(this,"storageService");p(this,"siteId","");p(this,"initialize",async()=>{const{config:t,accessModel:e}=z.getState();this.siteId=t.siteId,e!=="AVOD"&&this.generateOrRefreshAccessTokens()});p(this,"getMediaById",async t=>{const{entitledPlan:e}=U.getState();if(!(!this.siteId||!e))try{const n=await this.generateOrRefreshAccessTokens();if(!(n!=null&&n.passport))throw new Error("Failed to get / generate access tokens and retrieve media.");return await this.apiService.getMediaByIdWithPassport({id:t,siteId:this.siteId,planId:e.id,passport:n.passport})}catch(n){if(n instanceof il&&n.code===403){const a=await this.refreshAccessTokens();if(a!=null&&a.passport)return await this.apiService.getMediaByIdWithPassport({id:t,siteId:this.siteId,planId:e.id,passport:a.passport});throw new Error("Failed to refresh access tokens and retrieve media.")}throw n}});p(this,"generateOrRefreshAccessTokens",async()=>{const t=await this.getAccessTokens(),e=t&&Date.now()>t.expires;return t||await this.generateAccessTokens(),e?await this.refreshAccessTokens():t});p(this,"generateAccessTokens",async()=>{if(!this.siteId)return null;const t=await this.accountService.getAuthData(),e=await this.accessService.generateAccessTokens(this.siteId,t==null?void 0:t.jwt);return e?(await this.setAccessTokens(e),e):null});p(this,"refreshAccessTokens",async()=>{const t=await this.getAccessTokens();if(!t)return null;const e=await this.accessService.refreshAccessTokens(this.siteId,t.refresh_token);return e?(await this.setAccessTokens(e),e):null});p(this,"setAccessTokens",async t=>{Dn.setState({passport:t.passport});const e=new Date(Date.now()+3600*1e3).getTime();return await this.storageService.setItem(lr,JSON.stringify({...t,expires:e}),!0)});p(this,"getAccessTokens",async()=>{const t=await this.storageService.getItem(lr,!0,!0);return t&&Dn.setState({passport:t.passport}),t});p(this,"removeAccessTokens",async()=>(Dn.setState({passport:null}),await this.storageService.removeItem(lr)));this.apiService=e,this.accessService=a,this.storageService=n,this.accountService=It(vt,t)}})||Ye)||Ye)||Ye)||Ye)||Ye)||Ye)||Ye);var Wo,Vo,qo,Go,qt;let ye=(Wo=fe(),Vo=function(s,t){return ie(Fs)(s,void 0,0)},qo=Reflect.metadata("design:type",Function),Go=Reflect.metadata("design:paramtypes",[typeof IntegrationType>"u"?Object:IntegrationType,typeof cn>"u"?Object:cn,typeof ps>"u"?Object:ps,typeof Os>"u"?Object:Os]),Wo(qt=Vo(qt=qo(qt=Go(qt=class{constructor(t,e,n,a){p(this,"checkoutService");p(this,"accountService");p(this,"subscriptionService");p(this,"entitlementService");p(this,"accessController");p(this,"favoritesController");p(this,"watchHistoryController");p(this,"features");p(this,"refreshEntitlements");p(this,"loadUserData",async()=>{try{await this.accountService.getAuthData()&&await this.getAccount()}catch(t){Ue("AccountController","Failed to get user",{error:t}),t instanceof Error&&t.message.includes("Invalid JWT token")&&await this.logout()}});p(this,"initialize",async(t,e)=>{this.refreshEntitlements=e,U.setState({loading:!0});const n=z.getState().config;await this.accountService.initialize(n,t,this.logout),z.setState({accessModel:this.accountService.accessModel}),await this.loadUserData(),await this.getEntitledPlans(),U.setState({loading:!1})});p(this,"updateUser",async t=>{U.setState({loading:!0});const{user:e}=U.getState(),{canUpdateEmail:n,canSupportEmptyFullName:a}=this.getFeatures();if(Object.prototype.hasOwnProperty.call(t,"email")&&!n)throw new Error("Email update not supported");if(!e)throw new Error("User not logged in");const o=this.validateInputLength(t);if(o.length)return{errors:o,responseData:{}};let i=t;a||(i={...t,email:e.email});const c=await this.accountService.updateCustomer({...i,id:e.id.toString()});if(!c)throw new Error("Unknown error");return U.setState({user:c}),{errors:[],responseData:c}});p(this,"getAccount",async()=>{const{config:t}=z.getState();try{const e=await this.accountService.getUser({config:t});e&&await this.afterLogin(e.user,e.customerConsents),U.setState({loading:!1})}catch{U.setState({user:null,subscription:null,transactions:null,activePayment:null,customerConsents:null,publisherConsents:null,loading:!1})}});p(this,"login",async(t,e,n)=>{var a;U.setState({loading:!0});try{const o=await this.accountService.login({email:t,password:e,referrer:n});if(o){await((a=this.accessController)==null?void 0:a.generateAccessTokens()),await this.afterLogin(o.user,o.customerConsents);return}}catch(o){if(o instanceof Error&&o.message.toLowerCase().includes("invalid param email"))throw new Ze({email:[xe.t("account:login.wrong_email")]})}finally{U.setState({loading:!1})}throw new Ze({form:[xe.t("account:login.wrong_combination")]})});p(this,"logout",async()=>{var t,e,n;await((t=this.accountService)==null?void 0:t.logout()),await((e=this.accessController)==null?void 0:e.removeAccessTokens()),await this.clearLoginState(),await((n=this.refreshEntitlements)==null?void 0:n.call(this))});p(this,"register",async(t,e,n,a,o)=>{try{const i=await this.accountService.register({email:t,password:e,consents:a,referrer:n,captchaValue:o});if(i){const{user:c,customerConsents:l}=i;await this.afterLogin(c,l,!0);return}}catch(i){if(i instanceof Error){const c=i.message.toLowerCase();if(c.includes("customer already exists")||c.includes("account already exists"))throw new Ze({form:[xe.t("account:registration.user_exists")]});if(c.includes("please enter a valid e-mail address"))throw new Ze({email:[xe.t("account:registration.field_is_not_valid_email")]});if(c.includes("invalid param password"))throw new Ze({password:[xe.t("account:registration.invalid_password")]})}}throw new Ze({form:[xe.t("account:registration.failed_to_create")]})});p(this,"updateConsents",async t=>{var a;const{getAccountInfo:e}=U.getState(),{customer:n}=e();U.setState({loading:!0});try{const o=await((a=this.accountService)==null?void 0:a.updateCustomerConsents({customer:n,consents:t}));return o?(U.setState({customerConsents:o}),{responseData:o,errors:[]}):{responseData:[],errors:[]}}finally{U.setState({loading:!1})}});p(this,"getCustomerConsents",async()=>{const{getAccountInfo:t}=U.getState(),{customer:e}=t(),n=await this.accountService.getCustomerConsents({customer:e});return n&&U.setState({customerConsents:n}),n});p(this,"getPublisherConsents",async()=>{const{config:t}=z.getState();U.setState({publisherConsentsLoading:!0});const e=await this.accountService.getPublisherConsents(t);U.setState({publisherConsents:e,publisherConsentsLoading:!1})});p(this,"getCaptureStatus",async()=>{const{getAccountInfo:t}=U.getState(),{customer:e}=t();return this.accountService.getCaptureStatus({customer:e})});p(this,"updateCaptureAnswers",async t=>{const{getAccountInfo:e}=U.getState(),{customer:n,customerConsents:a}=e(),o=await this.accountService.updateCaptureAnswers({customer:n,...t});return U.setState({user:o,customerConsents:a}),o});p(this,"resetPassword",async(t,e)=>{await this.accountService.resetPassword({customerEmail:t,resetUrl:e})});p(this,"changePasswordWithOldPassword",async(t,e,n)=>{await this.accountService.changePasswordWithOldPassword({oldPassword:t,newPassword:e,newPasswordConfirmation:n})});p(this,"changePasswordWithToken",async(t,e,n,a)=>{await this.accountService.changePasswordWithResetToken({customerEmail:t,newPassword:e,resetPasswordToken:n,newPasswordConfirmation:a})});p(this,"updateSubscription",async t=>{var i;const{getAccountInfo:e}=U.getState(),{customerId:n}=e(),{subscription:a}=U.getState();if(!a)throw new Error("user has no active subscription");const o=await((i=this.subscriptionService)==null?void 0:i.updateSubscription({customerId:n,offerId:a.offerId,status:t,unsubscribeUrl:a.unsubscribeUrl}));if(o.errors.length>0)throw new Error(o.errors[0]);return await this.reloadSubscriptions({retry:10}),o==null?void 0:o.responseData});p(this,"updateCardDetails",async({cardName:t,cardNumber:e,cvc:n,expMonth:a,expYear:o,currency:i})=>{const{getAccountInfo:c}=U.getState(),{customerId:l}=c();Be(this.subscriptionService.updateCardDetails,"updateCardDetails is not available in subscription service");const d=await this.subscriptionService.updateCardDetails({cardName:t,cardNumber:e,cvc:n,expMonth:a,expYear:o,currency:i}),h=await this.subscriptionService.getActivePayment({customerId:l})||null;return U.setState({loading:!1,activePayment:h}),d});p(this,"checkEntitlements",async t=>{if(!t)return!1;const{responseData:e}=await this.checkoutService.getEntitlements({offerId:t});return!!(e!=null&&e.accessGranted)});p(this,"getEntitledPlans",async()=>{var i;const{config:t,settings:e}=z.getState(),n=t.siteId;if(!!!(e!=null&&e.apiAccessBridgeUrl))return null;const o=await this.entitlementService.getEntitledPlans({siteId:n});if((i=o==null?void 0:o.plans)!=null&&i.length){const c=o.plans.find(l=>l.metadata.access_model==="svod")||o.plans[0];return U.setState({entitledPlan:c}),c}return null});p(this,"reloadSubscriptions",async({delay:t,retry:e}={delay:0,retry:0})=>{var h,u;U.setState({loading:!0});const{getAccountInfo:n}=U.getState(),{customerId:a}=n(),{accessModel:o}=z.getState();if(t&&t>0)return new Promise(g=>{setTimeout(()=>{this.reloadSubscriptions({retry:e}).finally(g)},t)});if(o!=="SVOD")return await((h=this.refreshEntitlements)==null?void 0:h.call(this)),U.setState({loading:!1});const[i,c,l]=await Promise.all([this.subscriptionService.getActiveSubscription({customerId:a}),this.subscriptionService.getAllTransactions({customerId:a}),this.subscriptionService.getActivePayment({customerId:a})]);let d=null;if(!i&&e&&e>0)return await this.reloadSubscriptions({delay:1500,retry:e-1});try{if(i!=null&&i.pendingSwitchId){Be(this.checkoutService.getOffer,"getOffer is not available in checkout service"),Be(this.checkoutService.getSubscriptionSwitch,"getSubscriptionSwitch is not available in checkout service");const g=await this.checkoutService.getSubscriptionSwitch({switchId:i.pendingSwitchId});d=(await this.checkoutService.getOffer({offerId:g.responseData.toOfferId})).responseData}}catch(g){Ue("AccountController","Failed to fetch the pending offer",{error:g})}await((u=this.refreshEntitlements)==null?void 0:u.call(this)),U.setState({subscription:i,loading:!1,pendingOffer:d,transactions:c,activePayment:l})});p(this,"exportAccountData",async()=>{var e;const{canExportAccountData:t}=this.getFeatures();return Be(this.accountService.exportAccountData,"exportAccountData is not available in account service"),or(t,"Export account"),(e=this.accountService)==null?void 0:e.exportAccountData(void 0)});p(this,"getSocialLoginUrls",t=>{const{hasSocialURLs:e}=this.getFeatures();return Be(this.accountService.getSocialUrls,"getSocialUrls is not available in account service"),or(e,"Social logins"),this.accountService.getSocialUrls({redirectUrl:t})});p(this,"deleteAccountData",async t=>{const{canDeleteAccount:e}=this.getFeatures();Be(this.accountService.deleteAccount,"deleteAccount is not available in account service"),or(e,"Delete account");try{await this.accountService.deleteAccount({password:t})}catch(n){throw(n instanceof Error?n.message.toLowerCase():"").includes("invalid credentials")?new Ze({form:[xe.t("user:account.delete_account.invalid_credentials")]}):new Ze({form:[xe.t("user:account.delete_account.error")]})}});p(this,"getReceipt",async t=>{Be(this.subscriptionService.fetchReceipt,"fetchReceipt is not available in subscription service");const{responseData:e}=await this.subscriptionService.fetchReceipt({transactionId:t});return e});p(this,"getAuthData",async()=>this.accountService.getAuthData());p(this,"subscribeToNotifications",async({uuid:t,onMessage:e})=>this.accountService.subscribeToNotifications({uuid:t,onMessage:e}));p(this,"validateInputLength",t=>{var n,a;const e=[];return Number((n=t==null?void 0:t.firstName)==null?void 0:n.length)>50&&e.push(xe.t("account:validation.first_name")),Number((a=t==null?void 0:t.lastName)==null?void 0:a.length)>50&&e.push(xe.t("account:validation.last_name")),e});p(this,"clearLoginState",async()=>{U.setState({user:null,subscription:null,transactions:null,activePayment:null,customerConsents:null,publisherConsents:null,loading:!1}),await this.favoritesController.restoreFavorites(),await this.watchHistoryController.restoreWatchHistory()});this.checkoutService=It(Bs,t),this.accountService=It(vt,t),this.subscriptionService=It(Us,t),this.entitlementService=q(ca),this.accessController=e,this.favoritesController=n,this.watchHistoryController=a,this.features=t?this.accountService.features:_u}getSandbox(){return this.accountService.sandbox}getFeatures(){return this.features}async afterLogin(t,e,n=!1){U.setState({user:t,customerConsents:e}),await Promise.allSettled([this.reloadSubscriptions(),this.getPublisherConsents(),n?this.favoritesController.persistFavorites():this.favoritesController.restoreFavorites(),n?this.watchHistoryController.persistWatchHistory():this.watchHistoryController.restoreWatchHistory()]),U.setState({loading:!1})}})||qt)||qt)||qt)||qt);var zo,Ko,Jo,Yo,Qo,Xo,ct;let zn=(zo=fe(),Ko=function(s,t){return ie(Rs)(s,void 0,0)},Jo=function(s,t){return ie(Rn)(s,void 0,1)},Yo=function(s,t){return ie(_e)(s,void 0,2)},Qo=Reflect.metadata("design:type",Function),Xo=Reflect.metadata("design:paramtypes",[typeof Rs>"u"?Object:Rs,typeof Rn>"u"?Object:Rn,typeof _e>"u"?Object:_e]),zo(ct=Ko(ct=Jo(ct=Yo(ct=Qo(ct=Xo(ct=class{constructor(t,e,n){p(this,"configService");p(this,"settingsService");p(this,"storageService");p(this,"loadAndValidateConfig",async t=>{const e=this.configService.formatSourceLocation(t),n=this.configService.getDefaultConfig();e||z.setState({config:n});let a=await this.configService.loadConfig(e);return a.id=t,a.assets=a.assets||{},a.assets.banner||(a.assets.banner=n.assets.banner),z.setState(o=>Da({},o,{config:{assets:{banner:a.assets.banner}}})),a=await this.configService.validateConfig(a),a=Da({},n,a),a});p(this,"initializeApp",async(t,e,n)=>{var l,d;Dt("AppController","Initializing app",{url:t});const a=await this.settingsService.initialize(),o=await this.settingsService.getConfigSource(a,t),i=await this.loadAndValidateConfig(o),c=this.calculateIntegrationType(i);return z.setState({config:i,loaded:!0,integrationType:c}),this.storageService.initialize("jwapp"),z.setState({settings:a}),c&&await q(ye).initialize(t,n),a!=null&&a.apiAccessBridgeUrl&&await q(cn).initialize(),(l=i.features)!=null&&l.continueWatchingList&&i.content.some(h=>h.type===yt.ContinueWatching)&&await q(Os).initialize(e),(d=i.features)!=null&&d.favoritesList&&i.content.some(h=>h.type===yt.Favorites)&&await q(ps).initialize(e),{config:i,settings:a,configSource:o}});p(this,"calculateIntegrationType",t=>{const n=te.getAll(ra).reduce((a,o)=>{const i=o(t);return i?[...a,i]:a},[]);if(n.length>1)throw new Error(`Failed to initialize app, more than 1 integrations are enabled: ${n.join(", ")}`);return n[0]||null});p(this,"getIntegrationType",()=>{const t=z.getState();if(!t.loaded)throw new Error("A call to `AppController#getIntegrationType()` was made before loading the config");return t.integrationType});p(this,"getApiAccessBridgeUrl",()=>{var e;const t=z.getState();if(!t.loaded)throw new Error("A call to `AppController#getApiAccessBridgeUrl()` was made before loading the config");return((e=t.settings)==null?void 0:e.apiAccessBridgeUrl)||void 0});this.configService=t,this.settingsService=e,this.storageService=n}})||ct)||ct)||ct)||ct)||ct)||ct);class fn{}var Zo,ei;const Zu=s=>s.status==="fulfilled"?!0:(Ue("EpgController","An error occurred resolving a promise: ",{error:s.reason}),!1);let ll=(Zo=fe(),Zo(ei=class{constructor(){p(this,"parseSchedule",async(t,e)=>{const n=!!e.scheduleDemo||!1,a=this.getEpgService(e);if(!Array.isArray(t))return[];const i=(await Promise.allSettled(t.map(c=>a==null?void 0:a.transformProgram(c).catch(l=>{Dt("EpgController","Failed to transform a program",{error:l,program:c})})))).filter(Zu).map(c=>c.value).filter(c=>!!c);return n?this.generateDemoPrograms(i):i});p(this,"getSchedule",async t=>{const e=this.getEpgService(t),n=await(e==null?void 0:e.fetchSchedule(t)),a=await this.parseSchedule(n,t),o=t.catchupHours&&parseInt(t.catchupHours);return{id:t.mediaid,title:t.title,description:t.description,catchupHours:o||8,channelLogoImage:t.channelLogoImage,backgroundImage:t.backgroundImage,programs:a}});p(this,"getEpgService",t=>{var a;const e=((a=t==null?void 0:t.scheduleType)==null?void 0:a.toLocaleLowerCase())||na.jwp,n=It(fn,e,!1);return n||ds("EpgController",`No epg service was added for the ${e} schedule type`),n});p(this,"getSchedules",async t=>Promise.all(t.map(e=>this.getSchedule(e))))}generateDemoPrograms(t){var i;const e=new Date,n=new Date((i=t[0])==null?void 0:i.startTime),a=new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate())),o=Id(e,a);return t.map((c,l)=>({...c,id:`${c.id}_${l}`,startTime:Ma(new Date(c.startTime),o).toJSON(),endTime:Ma(new Date(c.endTime),o).toJSON()}))}})||ei);var ti,si;const eh=ne().shape({"episode-num":ne().shape({"#text":B().required()}),title:ne().shape({"#text":B().required()}),desc:ne().shape({"#text":B()}),icon:ne().shape({src:B()}),start:B().required(),stop:B().required()}),ni=s=>Ad(s,"yyyyMdHms xxxx",new Date).toISOString();let th=(ti=fe(),ti(si=class extends fn{constructor(){super(...arguments);p(this,"transformProgram",async e=>{var a,o,i;const n=await eh.validate(e);return{id:n["episode-num"]["#text"],title:n.title["#text"],startTime:ni(n.start),endTime:ni(n.stop),description:(a=n==null?void 0:n.desc)==null?void 0:a["#text"],cardImage:(o=n==null?void 0:n.icon)==null?void 0:o.src,backgroundImage:(i=n==null?void 0:n.icon)==null?void 0:i.src}});p(this,"fetchSchedule",async e=>{var i;const{XMLParser:n}=await Vc(async()=>{const{XMLParser:c}=await import("./vendor-DVCf_wKq.js").then(l=>l.f);return{XMLParser:c}},__vite__mapDeps([0,1,2])),a=e.scheduleUrl;if(!a){ds("ViewNexaEpgService","Tried requesting a schedule for an item with missing `scheduleUrl`",{item:e});return}const o={ignoreAttributes:!1,attributeNamePrefix:""};try{const c=await fetch(a).then(h=>h.text()),d=new n(o).parse(c);return((i=d==null?void 0:d.tv)==null?void 0:i.programme)||[]}catch(c){c instanceof Error&&Ue("ViewNexaEpgService",`Fetch failed for View Nexa EPG schedule: '${a}'`,{error:c})}})}})||si);var ri,ai;const sh="API-KEY",nh=ne().shape({id:B().required(),title:B().required(),startTime:B().required().test(s=>s?Fr(new Date(s)):!1),endTime:B().required().test(s=>s?Fr(new Date(s)):!1),chapterPointCustomProperties:on().of(ne().shape({key:B().required(),value:B().test("required-but-empty","value is required",s=>typeof s=="string")}))});let rh=(ri=fe(),ri(ai=class extends fn{constructor(){super(...arguments);p(this,"transformProgram",async e=>{var o,i,c,l;const n=await nh.validate(e),a=((i=(o=n.chapterPointCustomProperties)==null?void 0:o.find(d=>d.key==="image"))==null?void 0:i.value)||void 0;return{id:n.id,title:n.title,startTime:n.startTime,endTime:n.endTime,cardImage:a,backgroundImage:a,description:((l=(c=n.chapterPointCustomProperties)==null?void 0:c.find(d=>d.key==="description"))==null?void 0:l.value)||void 0}});p(this,"fetchSchedule",async e=>{if(!e.scheduleUrl){ds("JWEpgService","Tried requesting a schedule for an item with missing `scheduleUrl`",{item:e});return}const n=new Headers;e.scheduleToken&&n.set(sh,e.scheduleToken);try{const a=await fetch(e.scheduleUrl,{headers:n});return await tt(a)}catch(a){a instanceof Error&&Ue("JWEpgService",`Fetch failed for EPG schedule: '${e.scheduleUrl}'`,{error:a})}})}})||ai);const ah=s=>s.container.get(zn).getApiAccessBridgeUrl();class oh{constructor(){p(this,"queue",[])}getLength(){return this.queue.length}async enqueue(){return new Promise((t,e)=>{this.queue.push({resolve:t,reject:e})})}async resolve(t){const e=this.queue.map(({resolve:n})=>n(t));this.queue=[],await Promise.allSettled(e)}async reject(t){const e=this.queue.map(({reject:n})=>n(t));this.queue=[],await Promise.allSettled(e)}}var oi,ii,ci,li,di,ui,hi,Qe;const dr="auth",ih=ne().shape({accessToken:B().required(),refreshToken:B().required()}),ch=s=>ih.isValidSync(s),pi=s=>{try{const t=Dc(s);if(typeof t.exp=="number")return t.exp*1e3}catch{}return-1};let At=(oi=fe(),ii=function(s,t){return ie(_e)(s,void 0,0)},ci=function(s,t){return ie(pn)(s,void 0,1)},li=function(s,t){return ie(Kc)(s,void 0,2)},di=function(s,t){return kd()(s,void 0,2)},ui=Reflect.metadata("design:type",Function),hi=Reflect.metadata("design:paramtypes",[typeof _e>"u"?Object:_e,typeof GetCustomerIP>"u"?Object:GetCustomerIP,typeof BroadcastChannel>"u"?Object:BroadcastChannel]),oi(Qe=ii(Qe=ci(Qe=li(Qe=di(Qe=ui(Qe=hi(Qe=class{constructor(t,e,n){p(this,"storageService");p(this,"getCustomerIP");p(this,"channel");p(this,"queue",new oh);p(this,"isRefreshing",!1);p(this,"expiration",-1);p(this,"sandbox",!1);p(this,"tokens",null);p(this,"logoutCallback");p(this,"getNewTokens",async({refreshToken:t})=>{var e;try{const{responseData:n}=await this.post("/auths/refresh_token",JSON.stringify({refreshToken:t}));return{accessToken:n.jwt,refreshToken:n.refreshToken}}catch(n){throw n instanceof Error&&(Dt("CleengService","Failed to refresh accessToken",{error:n}),(n.message.includes("Refresh token is expired or does not exist")||n.message.includes("Missing or invalid parameter"))&&(this.logoutCallback||Dt("CleengService","logoutCallback is not set"),await((e=this.logoutCallback)==null?void 0:e.call(this)))),n}});p(this,"handleBroadcastMessage",async t=>{this.isRefreshing=t.action==="refreshing",t.tokens&&await this.setTokens(t.tokens),t.action==="resolved"?await this.queue.resolve():t.action==="rejected"&&await this.queue.reject()});p(this,"sendBroadcastMessage",(t,e)=>{if(!this.channel)return;const n={action:t,tokens:e};this.channel.postMessage(n)});p(this,"getBaseUrl",()=>this.sandbox?"https://mediastore-sandbox.cleeng.com":"https://mediastore.cleeng.com");p(this,"performRequest",async(t="/",e="GET",n,a={})=>{try{const o=a.authenticate?await this.getAccessTokenOrThrow():void 0;return await(await fetch(`${this.getBaseUrl()}${t}`,{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:o?`Bearer ${o}`:""},keepalive:a.keepalive,method:e,body:n})).json()}catch(o){return{errors:Array.of(o instanceof Error?o.message:String(o))}}});p(this,"initialize",async(t,e)=>{this.sandbox=t,this.logoutCallback=e,await this.restoreTokensFromStorage(),await this.maybeRefreshAccessToken()});p(this,"setTokens",async t=>{this.tokens=t,this.expiration=pi(t.accessToken),await this.persistInStorage(this.tokens)});p(this,"clearTokens",async()=>{this.tokens=null,await this.persistInStorage(null)});p(this,"restoreTokensFromStorage",async()=>{const t=await this.storageService.getItem(dr,!1);let e;if(typeof t!="string")return;try{if(e=JSON.parse(t),!ch(e))return}catch{return}const n=pi(e.accessToken);n>this.expiration&&(this.tokens=e,this.expiration=n)});p(this,"accessTokenIsExpired",()=>this.tokens?this.expiration>-1&&Date.now()-this.expiration>0:!1);p(this,"hasTokens",()=>!!this.tokens);p(this,"refreshTokens",async t=>{this.sendBroadcastMessage("refreshing"),this.isRefreshing=!0;try{const e=await this.getNewTokens(t);if(e){await this.setTokens(e),this.isRefreshing=!1,this.sendBroadcastMessage("resolved",e),await this.queue.resolve();return}}catch(e){Dt("CleengService","Failed to refresh tokens",{error:e})}await this.clearTokens(),this.isRefreshing=!1,this.sendBroadcastMessage("rejected"),await this.queue.reject()});p(this,"maybeRefreshAccessToken",async()=>{try{if(this.isRefreshing)return Dt("CleengService","Token is already refreshing, waiting in queue..."),await this.queue.enqueue();if(!this.accessTokenIsExpired()||!this.tokens)return;await this.refreshTokens(this.tokens)}catch(t){Ue("CleengService","Error caught while refreshing the access token",{error:t})}});p(this,"getAccessToken",async()=>{var t;return await this.maybeRefreshAccessToken(),await this.restoreTokensFromStorage(),(t=this.tokens)==null?void 0:t.accessToken});p(this,"getAccessTokenOrThrow",async()=>{const t=await this.getAccessToken();if(!t)throw new Error("Access token is missing");return t});p(this,"getLocales",async()=>{const t=await this.getCustomerIP();return this.get(`/locales${t?"?customerIP="+t:""}`)});p(this,"get",(t,e)=>this.performRequest(t,"GET",void 0,e));p(this,"patch",(t,e,n)=>this.performRequest(t,"PATCH",e,n));p(this,"put",(t,e,n)=>this.performRequest(t,"PUT",e,n));p(this,"post",(t,e,n)=>this.performRequest(t,"POST",e,n));p(this,"remove",(t,e)=>this.performRequest(t,"DELETE",void 0,e));var a;this.storageService=t,this.getCustomerIP=e,this.channel=n,(a=this.channel)==null||a.addEventListener("message",this.handleBroadcastMessage)}async persistInStorage(t){t?await this.storageService.setItem(dr,JSON.stringify(t)):await this.storageService.removeItem(dr)}})||Qe)||Qe)||Qe)||Qe)||Qe)||Qe)||Qe);const mi=s=>({id:s.id,email:s.email,country:s.country,firstName:s.firstName,lastName:s.lastName,fullName:`${s.firstName} ${s.lastName}`,metadata:s.externalData||{}}),lh=s=>({type:"checkbox",name:s.name,label:s.label,defaultValue:"",required:s.required,placeholder:s.placeholder,options:{},enabledByDefault:!1,version:s.version});var fi,gi,_i,yi,vi,wt;let dh=(fi=fe(),gi=function(s,t){return ie(At)(s,void 0,0)},_i=function(s,t){return ie(pn)(s,void 0,1)},yi=Reflect.metadata("design:type",Function),vi=Reflect.metadata("design:paramtypes",[typeof At>"u"?Object:At,typeof GetCustomerIP>"u"?Object:GetCustomerIP]),fi(wt=gi(wt=_i(wt=yi(wt=vi(wt=class extends vt{constructor(e,n){super({canUpdateEmail:!0,canSupportEmptyFullName:!0,canChangePasswordWithOldPassword:!1,canRenewSubscription:!0,canExportAccountData:!1,canDeleteAccount:!1,canUpdatePaymentMethod:!0,canShowReceipts:!1,hasSocialURLs:!1,hasNotifications:!1,watchListSizeLimit:48});p(this,"cleengService");p(this,"getCustomerIP");p(this,"publisherId","");p(this,"externalData",{});p(this,"accessModel",Me.AUTHVOD);p(this,"svodOfferIds",[]);p(this,"sandbox",!1);p(this,"handleErrors",e=>{if(e.length>0)throw new Error(e[0])});p(this,"getCustomerIdFromAuthData",e=>Dc(e.jwt).customerId);p(this,"getCustomer",async({customerId:e})=>{const{responseData:n,errors:a}=await this.cleengService.get(`/customers/${e}`,{authenticate:!0});return this.handleErrors(a),this.externalData=n.externalData||{},mi(n)});p(this,"getLocales",async()=>this.cleengService.getLocales());p(this,"initialize",async(e,n,a)=>{var i;const o=(i=e==null?void 0:e.integrations)==null?void 0:i.cleeng;if(!(o!=null&&o.id))throw new Error("Failed to initialize Cleeng integration. The publisherId is missing.");this.publisherId=o.id,this.accessModel=o.monthlyOffer||o.yearlyOffer?Me.SVOD:Me.AUTHVOD,this.svodOfferIds=[o==null?void 0:o.monthlyOffer,o==null?void 0:o.yearlyOffer].filter(Boolean).map(String),this.sandbox=!!o.useSandbox,await this.cleengService.initialize(this.sandbox,a)});p(this,"getAuthData",async()=>this.cleengService.tokens?{jwt:this.cleengService.tokens.accessToken,refreshToken:this.cleengService.tokens.refreshToken}:null);p(this,"getCustomerConsents",async e=>{var o;const{customer:n}=e,a=await this.cleengService.get(`/customers/${n==null?void 0:n.id}/consents`,{authenticate:!0});return this.handleErrors(a.errors),((o=a==null?void 0:a.responseData)==null?void 0:o.consents)||[]});p(this,"updateCustomerConsents",async e=>{const{customer:n}=e,a={id:n.id,consents:e.consents},o=await this.cleengService.put(`/customers/${n==null?void 0:n.id}/consents`,JSON.stringify(a),{authenticate:!0});return this.handleErrors(o.errors),await this.getCustomerConsents(e)});p(this,"login",async({email:e,password:n})=>{const a={email:e,password:n,publisherId:this.publisherId,customerIP:await this.getCustomerIP()},{responseData:o,errors:i}=await this.cleengService.post("/auths",JSON.stringify(a));this.handleErrors(i),await this.cleengService.setTokens({accessToken:o.jwt,refreshToken:o.refreshToken});const{user:c,customerConsents:l}=await this.getUser();return{user:c,auth:o,customerConsents:l}});p(this,"register",async({email:e,password:n,consents:a,captchaValue:o})=>{const i=await this.getLocales();this.handleErrors(i.errors);const c={email:e,password:n,locale:i.responseData.locale,country:i.responseData.country,currency:i.responseData.currency,publisherId:this.publisherId,customerIP:await this.getCustomerIP(),captchaValue:o},{responseData:l,errors:d}=await this.cleengService.post("/customers",JSON.stringify(c));this.handleErrors(d),await this.cleengService.setTokens({accessToken:l.jwt,refreshToken:l.refreshToken});const{user:h}=await this.getUser(),u=await this.updateCustomerConsents({consents:a,customer:h}).catch(()=>[]);return{user:h,auth:l,customerConsents:u}});p(this,"logout",async()=>{await this.cleengService.clearTokens()});p(this,"getUser",async()=>{const e=await this.getAuthData();if(!e)throw new Error("Not logged in");const n=this.getCustomerIdFromAuthData(e),a=await this.getCustomer({customerId:n}),o=await this.getCustomerConsents({customer:a});return{user:a,customerConsents:o}});p(this,"getPublisherConsents",async()=>{var n;const e=await this.cleengService.get(`/publishers/${this.publisherId}/consents`);return this.handleErrors(e.errors),(((n=e.responseData)==null?void 0:n.consents)||[]).map(lh)});p(this,"getCaptureStatus",async({customer:e})=>{const n=await this.cleengService.get(`/customers/${e==null?void 0:e.id}/capture/status`,{authenticate:!0});return this.handleErrors(n.errors),n.responseData});p(this,"updateCaptureAnswers",async({customer:e,...n})=>{const a={customerId:e.id,...n},o=await this.cleengService.put(`/customers/${e.id}/capture`,JSON.stringify(a),{authenticate:!0});return this.handleErrors(o.errors),this.getCustomer({customerId:e.id})});p(this,"resetPassword",async e=>{const n=await this.cleengService.put("/customers/passwords",JSON.stringify({...e,publisherId:this.publisherId}));this.handleErrors(n.errors)});p(this,"changePasswordWithResetToken",async e=>{const n=await this.cleengService.patch("/customers/passwords",JSON.stringify({...e,publisherId:this.publisherId}));this.handleErrors(n.errors)});p(this,"changePasswordWithOldPassword",async()=>{});p(this,"updateCustomer",async e=>{const{id:n,metadata:a,fullName:o,...i}=e,c={id:n,...i},{responseData:l,errors:d}=await this.cleengService.patch(`/customers/${n}`,JSON.stringify(c),{authenticate:!0,keepalive:!0});return this.handleErrors(d),this.externalData=l.externalData||{},mi(l)});p(this,"updateWatchHistory",async({user:e,history:n})=>{const a={id:e.id,externalData:{...this.externalData,history:n}},{errors:o,responseData:i}=await this.cleengService.patch(`/customers/${e.id}`,JSON.stringify(a),{authenticate:!0,keepalive:!0});this.handleErrors(o),this.externalData=i.externalData||{}});p(this,"updateFavorites",async({user:e,favorites:n})=>{const a={id:e.id,externalData:{...this.externalData,favorites:n}},{errors:o,responseData:i}=await this.cleengService.patch(`/customers/${e.id}`,JSON.stringify(a),{authenticate:!0,keepalive:!0});this.handleErrors(o),this.externalData=i.externalData||{}});p(this,"getWatchHistory",async()=>this.externalData.history||[]);p(this,"getFavorites",async()=>this.externalData.favorites||[]);p(this,"subscribeToNotifications",async()=>!1);p(this,"getSocialUrls");p(this,"exportAccountData");p(this,"deleteAccount");this.cleengService=e,this.getCustomerIP=n}})||wt)||wt)||wt)||wt)||wt);var xi,wi,bi,Si,ji,bt;let uh=(xi=fe(),wi=function(s,t){return ie(At)(s,void 0,0)},bi=function(s,t){return ie(pn)(s,void 0,1)},Si=Reflect.metadata("design:type",Function),ji=Reflect.metadata("design:paramtypes",[typeof At>"u"?Object:At,typeof GetCustomerIP>"u"?Object:GetCustomerIP]),xi(bt=wi(bt=bi(bt=Si(bt=ji(bt=class extends Bs{constructor(e,n){super();p(this,"cleengService");p(this,"getCustomerIP");p(this,"getOffers",async e=>await Promise.all(e.offerIds.map(async n=>{const a=await this.getOffer({offerId:String(n)});if(a.errors.length>0)throw new Error(a.errors[0]);return a.responseData})));p(this,"getOffer",async e=>{const n=await this.getCustomerIP();return this.cleengService.get(`/offers/${e.offerId}${n?"?customerIP="+n:""}`)});p(this,"createOrder",async e=>{var i;const n=await this.cleengService.getLocales();if(n.errors.length>0)throw new Error(n.errors[0]);const a=n.responseData.ipAddress,o={offerId:e.offer.offerId,customerId:e.customerId,country:e.country,currency:((i=n==null?void 0:n.responseData)==null?void 0:i.currency)||"EUR",customerIP:a,paymentMethodId:e.paymentMethodId};return this.cleengService.post("/orders",JSON.stringify(o),{authenticate:!0})});p(this,"getOrder",async({orderId:e})=>this.cleengService.get(`/orders/${e}`,{authenticate:!0}));p(this,"updateOrder",async({order:e,...n})=>{const a=await this.cleengService.patch(`/orders/${e.id}`,JSON.stringify(n),{authenticate:!0});if(a.errors.length){if(a.errors[0].includes(`Order with ${e.id} not found`))throw new Error("Order not found");if(a.errors[0].includes(`Coupon ${n.couponCode} not found`))throw new Error("Invalid coupon code");if(a.errors[0].includes(`Coupon ${n.couponCode} cannot be applied on this offer`))throw new Error("Invalid coupon code for this offer")}return a});p(this,"getPaymentMethods",async()=>this.cleengService.get("/payment-methods",{authenticate:!0}));p(this,"paymentWithoutDetails",async e=>this.cleengService.post("/payments",JSON.stringify(e),{authenticate:!0}));p(this,"paymentWithPayPal",async e=>{const{order:n,successUrl:a,cancelUrl:o,errorUrl:i,captchaValue:c}=e,l={orderId:n.id,successUrl:a,cancelUrl:o,errorUrl:i,captchaValue:c};return this.cleengService.post("/connectors/paypal/v1/tokens",JSON.stringify(l),{authenticate:!0})});p(this,"getSubscriptionSwitches",async e=>this.cleengService.get(`/customers/${e.customerId}/subscription_switches/${e.offerId}/availability`,{authenticate:!0}));p(this,"getSubscriptionSwitch",async e=>this.cleengService.get(`/subscription_switches/${e.switchId}`,{authenticate:!0}));p(this,"switchSubscription",async e=>this.cleengService.post(`/customers/${e.customerId}/subscription_switches/${e.offerId}`,JSON.stringify({toOfferId:e.toOfferId,switchDirection:e.switchDirection}),{authenticate:!0}));p(this,"getEntitlements",async e=>this.cleengService.get(`/entitlements/${e.offerId}`,{authenticate:!0}));p(this,"createAdyenPaymentSession",async e=>await this.cleengService.post("/connectors/adyen/sessions",JSON.stringify(e),{authenticate:!0}));p(this,"initialAdyenPayment",async e=>this.cleengService.post("/connectors/adyen/initial-payment",JSON.stringify({...e,attemptAuthentication:this.cleengService.sandbox?"always":void 0}),{authenticate:!0}));p(this,"finalizeAdyenPayment",async e=>this.cleengService.post("/connectors/adyen/initial-payment/finalize",JSON.stringify(e),{authenticate:!0}));p(this,"updatePaymentMethodWithPayPal",async e=>this.cleengService.post("/connectors/paypal/v1/payment_details/tokens",JSON.stringify(e),{authenticate:!0}));p(this,"deletePaymentMethod",async e=>this.cleengService.remove(`/payment_details/${e.paymentDetailsId}`,{authenticate:!0}));p(this,"addAdyenPaymentDetails",async e=>this.cleengService.post("/connectors/adyen/payment-details",JSON.stringify({...e,attemptAuthentication:this.cleengService.sandbox?"always":void 0}),{authenticate:!0}));p(this,"finalizeAdyenPaymentDetails",async e=>this.cleengService.post("/connectors/adyen/payment-details/finalize",JSON.stringify(e),{authenticate:!0}));p(this,"directPostCardPayment",async()=>!1);this.cleengService=e,this.getCustomerIP=n}})||bt)||bt)||bt)||bt)||bt);var Ci,Pi,Ei,Ii,Gt;let hh=(Ci=fe(),Pi=function(s,t){return ie(At)(s,void 0,0)},Ei=Reflect.metadata("design:type",Function),Ii=Reflect.metadata("design:paramtypes",[typeof At>"u"?Object:At]),Ci(Gt=Pi(Gt=Ei(Gt=Ii(Gt=class extends Us{constructor(e){super();p(this,"cleengService");p(this,"getActiveSubscription",async({customerId:e})=>{const n=await this.getSubscriptions({customerId:e});return n.errors.length>0?null:n.responseData.items.find(a=>a.status==="active"||a.status==="cancelled")||null});p(this,"getAllTransactions",async({customerId:e})=>{const n=await this.getTransactions({customerId:e});return n.errors.length>0?null:n.responseData.items});p(this,"getActivePayment",async({customerId:e})=>{const n=await this.getPaymentDetails({customerId:e});return n.errors.length>0?null:n.responseData.paymentDetails.find(a=>a.active)||null});p(this,"getSubscriptions",async e=>this.cleengService.get(`/customers/${e.customerId}/subscriptions`,{authenticate:!0}));p(this,"updateSubscription",async e=>this.cleengService.patch(`/customers/${e.customerId}/subscriptions`,JSON.stringify(e),{authenticate:!0}));p(this,"getPaymentDetails",async e=>this.cleengService.get(`/customers/${e.customerId}/payment_details`,{authenticate:!0}));p(this,"getTransactions",async({customerId:e,limit:n,offset:a})=>this.cleengService.get(Se(`/customers/${e}/transactions`,{limit:n,offset:a}),{authenticate:!0}));p(this,"fetchReceipt",async({transactionId:e})=>this.cleengService.get(`/receipt/${e}`,{authenticate:!0}));p(this,"updateCardDetails");p(this,"changeSubscription");this.cleengService=e}})||Gt)||Gt)||Gt)||Gt);const ph=(s,t)=>{var a;const e=s.menu.find(o=>o.contentId===t);return((a=e==null?void 0:e.filterTags)==null?void 0:a.split(",").filter(Boolean))||[]},mh=(s,t)=>t===""?s:{...s,playlist:s.playlist.filter(({tags:e})=>e?e.split(",").includes(t):!1)},dl=(s=15)=>({title:"",playlist:new Array(s).fill({}).map((t,e)=>({description:"",duration:0,feedid:"",image:"",images:[],cardImage:"",backgroundImage:"",channelLogoImage:"",link:"",genre:"",mediaid:`placeholder_${e}`,pubdate:0,rating:"",sources:[],tags:"",title:"",tracks:[]}))}),fh=(s=[],t=[])=>!s||!t?{}:s==null?void 0:s.reduce((n,a)=>{const o=t==null?void 0:t.find(i=>i.name===a.name);if(o){const i=a.isCustomRegisterField?o.value??"":o.state==="accepted";n[a.name]=i}return n},{}),gh=(s=[],t=[])=>{if(!s||!t)return{};const e={};return s==null||s.forEach(n=>{t!=null&&t.find(a=>a.name===n.name&&a.state==="accepted")&&(e[n.name]=!0)}),e},_h=s=>{const t={};return s&&(s==null||s.forEach(e=>{t[e.name]=e.type==="checkbox"?e.enabledByDefault===!0:e.defaultValue??""})),t},Mn=(s,t)=>{const e=[];return!s||!t||s.forEach(n=>{e.push({name:n.name,version:n.version,state:t[n.name]?"accepted":"declined",value:t[n.name]??""})}),e},yh=(s,t)=>{const e=[],n=[];return!s||!t?{customerConsents:e,consentsErrors:n}:(s.forEach(a=>{a.required&&!t[a.name]&&n.push(a.name),e.push({name:a.name,version:a.version,state:t[a.name]?"accepted":"declined",value:t[a.name]??""})}),{customerConsents:e,consentsErrors:n})},vh=s=>s.value!=="",xh=({name:s,value:t=""},e,n)=>{const a=s==="us_state"?n.find(({name:i,value:c})=>i==="country"&&c==="us")?t==="n/a"?"":t:"n/a":(t===!0||t===!1)&&s!=="terms"?t?"on":"off":t;return[s,a]},Gr=s=>Object.fromEntries(s.filter(vh).map(xh)),Ai=s=>Array.isArray(s)||typeof s=="object"&&s!==null?JSON.parse(JSON.stringify(s)):s,ul=s=>{if(typeof s=="string"&&gu.includes(s))return s},hl=s=>{if(!s)return 0;const t=s.split(":");return t.length===2?Math.floor(parseInt(t[1])/parseInt(t[0])):0};var ki,Ti,Ni,Li,$i,St;const wh="https://inplayer.com/legal/terms";let bh=(ki=fe(),Ti=function(s,t){return ie(_e)(s,void 0,0)},Ni=function(s,t){return ie(Re)(s,void 0,1)},Li=Reflect.metadata("design:type",Function),$i=Reflect.metadata("design:paramtypes",[typeof _e>"u"?Object:_e,typeof Re>"u"?Object:Re]),ki(St=Ti(St=Ni(St=Li(St=$i(St=class extends vt{constructor(e,n){super({canUpdateEmail:!1,canSupportEmptyFullName:!1,canChangePasswordWithOldPassword:!0,canRenewSubscription:!1,canExportAccountData:!0,canUpdatePaymentMethod:!1,canShowReceipts:!0,canDeleteAccount:!0,hasNotifications:!0,hasSocialURLs:!0,watchListSizeLimit:48});p(this,"storageService");p(this,"apiService");p(this,"clientId","");p(this,"accessModel",Me.AUTHVOD);p(this,"assetId",null);p(this,"svodOfferIds",[]);p(this,"sandbox",!1);p(this,"parseJson",(e,n={})=>{try{return JSON.parse(e)}catch{return n}});p(this,"formatFavorite",e=>({mediaid:e.media_id}));p(this,"formatHistoryItem",e=>({mediaid:e.media_id,progress:e.progress}));p(this,"formatAccount",e=>{const{id:n,uuid:a,email:o,full_name:i,metadata:c,created_at:l}=e,d=new Date(l*1e3).toLocaleString(),h=c==null?void 0:c.first_name,u=c==null?void 0:c.surname;return{id:n.toString(),uuid:a,email:o,fullName:i,firstName:h,lastName:u,metadata:c,regDate:d,country:"",lastUserIp:""}});p(this,"initialize",async(e,n,a)=>{var u;const o=(u=e.integrations)==null?void 0:u.jwp;if(!(o!=null&&o.clientId))throw new Error("Failed to initialize JWP integration. The clientId is missing.");this.sandbox=!!o.useSandbox;const i=this.sandbox?"development":"production";Ks.setConfig(i),this.apiService.setup(this.sandbox),o.clientId&&(this.clientId=o.clientId),o.assetId&&(this.accessModel=Me.SVOD,this.assetId=o.assetId,this.svodOfferIds=o.assetId?[String(o.assetId)]:[]);const c=new URLSearchParams(n.split("#")[1]),l=c.get("token"),d=c.get("refresh_token"),h=c.get("expires");!l||!d||!h||this.apiService.setToken(l,d,parseInt(h))});p(this,"getAuthData",async()=>{if(await this.apiService.isAuthenticated()){const e=await this.apiService.getToken();return{jwt:e.token,refreshToken:e.refreshToken}}return null});p(this,"getPublisherConsents",async()=>{try{const e=await this.apiService.get(`/accounts/register-fields/${this.clientId}`),n=e==null?void 0:e.collection.find(({name:o})=>o==="terms"),a=e==null?void 0:e.collection.filter(o=>!["email_confirmation","first_name","surname"].includes(o.name)&&![n].includes(o)).map(o=>({type:o.type,isCustomRegisterField:!0,name:o.name,label:o.label,placeholder:o.placeholder,required:o.required,options:o.options,defaultValue:"",version:"1",...o.type==="checkbox"?{enabledByDefault:o.default_value==="true"}:{defaultValue:o.default_value}}));return n?[this.getTermsConsent(n),...a]:a}catch{throw new Error("Failed to fetch publisher consents.")}});p(this,"getCustomerConsents",async e=>{var n;try{if(!(e!=null&&e.customer))return{consents:[]};const{customer:a}=e;return this.parseJson((n=a.metadata)==null?void 0:n.consents,[])}catch{throw new Error("Unable to fetch Customer consents.")}});p(this,"updateCustomerConsents",async e=>{var n;try{const{customer:a,consents:o}=e,i=this.formatUpdateAccount(a),c={...i,metadata:{...i.metadata,...Gr(o),consents:JSON.stringify(o)}},l=await this.apiService.put("/accounts",c,{withAuthentication:!0});return this.parseJson((n=l==null?void 0:l.metadata)==null?void 0:n.consents,[])}catch{throw new Error("Unable to update Customer consents")}});p(this,"updateCaptureAnswers",async({customer:e,...n})=>this.updateCustomer({...e,...n}));p(this,"changePasswordWithOldPassword",async e=>{const{oldPassword:n,newPassword:a,newPasswordConfirmation:o}=e;try{await this.apiService.post("/accounts/change-password",{old_password:n,password:a,password_confirmation:o},{withAuthentication:!0})}catch(i){throw Re.isCommonError(i)?new Error(i.response.data.message):new Error("Failed to change password")}});p(this,"resetPassword",async({customerEmail:e})=>{try{await this.apiService.post("/accounts/forgot-password",{email:e,merchant_uuid:this.clientId,branding_id:0})}catch{throw new Error("Failed to reset password.")}});p(this,"login",async({email:e,password:n,referrer:a})=>{var o;try{const i=await this.apiService.post("/v2/accounts/authenticate",{client_id:this.clientId||"",grant_type:"password",referrer:a,username:e,password:n});this.apiService.setToken(i.access_token,"",i.expires);const c=this.formatAccount(i.account);return{auth:this.formatAuth(i),user:c,customerConsents:this.parseJson((o=c==null?void 0:c.metadata)==null?void 0:o.consents,[])}}catch{throw new Error("Failed to authenticate user.")}});p(this,"register",async({email:e,password:n,referrer:a,consents:o})=>{var i;try{const c=await this.apiService.post("/accounts",{full_name:e,username:e,password:n,password_confirmation:n,client_id:this.clientId||"",type:"consumer",referrer:a,grant_type:"password",metadata:{first_name:" ",surname:" ",...Gr(o),consents:JSON.stringify(o)}});this.apiService.setToken(c.access_token,"",c.expires);const l=this.formatAccount(c.account);return{auth:this.formatAuth(c),user:l,customerConsents:this.parseJson((i=l==null?void 0:l.metadata)==null?void 0:i.consents,[])}}catch(c){throw Re.isCommonError(c)?new Error(c.response.data.message):new Error("Failed to create account.")}});p(this,"logout",async()=>{try{Ks.Notifications.isSubscribed()&&Ks.Notifications.unsubscribe(),await this.apiService.isAuthenticated()&&(await this.apiService.get("/accounts/logout",{withAuthentication:!0}),await this.apiService.removeToken())}catch{throw new Error("Failed to sign out.")}});p(this,"getUser",async()=>{var e;try{const n=await this.apiService.get("/accounts",{withAuthentication:!0}),a=this.formatAccount(n);return{user:a,customerConsents:this.parseJson((e=a==null?void 0:a.metadata)==null?void 0:e.consents,[])}}catch{throw new Error("Failed to fetch user data.")}});p(this,"updateCustomer",async e=>{try{const n=await this.apiService.put("/accounts",this.formatUpdateAccount(e),{withAuthentication:!0});return this.formatAccount(n)}catch{throw new Error("Failed to update user data.")}});p(this,"formatUpdateAccount",e=>{var l,d;const n=((l=e.firstName)==null?void 0:l.trim())||"",a=((d=e.lastName)==null?void 0:d.trim())||"",o=`${n} ${a}`.trim()||e.email,i={...e.metadata,first_name:n,surname:a};return{full_name:o,metadata:i}});p(this,"getCaptureStatus",async({customer:{firstName:e,lastName:n}})=>{const a=(e==null?void 0:e.trim())||"",o=(n==null?void 0:n.trim())||"";return{isCaptureEnabled:!0,shouldCaptureBeDisplayed:!a||!o,settings:[{answer:{firstName:a||null,lastName:o||null},enabled:!0,key:"firstNameLastName",required:!0}]}});p(this,"changePasswordWithResetToken",async e=>{const{resetPasswordToken:n="",newPassword:a,newPasswordConfirmation:o=""}=e;try{await this.apiService.put(`/accounts/forgot-password/${n}`,{password:a,password_confirmation:o,branding_id:0})}catch(i){throw Re.isCommonError(i)?new Error(i.response.data.message):new Error("Failed to change password.")}});p(this,"getTermsConsent",({label:e})=>{const n=`<a href="${e||wh}" target="_blank">${xe.t("account:registration.terms_and_conditions")}</a>`;return{type:"checkbox",isCustomRegisterField:!0,required:!0,name:"terms",defaultValue:"",label:e?xe.t("account:registration.terms_consent",{termsLink:n}):xe.t("account:registration.terms_consent_jwplayer",{termsLink:n}),enabledByDefault:!1,placeholder:"",options:{},version:"1"}});p(this,"updateWatchHistory",async({history:e})=>{const n=await this.getWatchHistory(),a=n.map(o=>o.mediaid)||[];await Promise.allSettled(e.map(({mediaid:o,progress:i})=>{if(!a.includes(o)||n.some(c=>c.mediaid==o&&c.progress!=i))return this.apiService.patch("/v2/accounts/media/watch-history",{media_id:o,progress:i},{withAuthentication:!0})}))});p(this,"updateFavorites",async({favorites:e})=>{const a=(await this.getFavorites()).map(i=>i.mediaid)||[],o=e.map(i=>i.mediaid);await Promise.allSettled(o.map(i=>a.includes(i)?Promise.resolve():this.apiService.post("/v2/accounts/media/favorites",{media_id:i},{withAuthentication:!0}))),await Promise.allSettled(a.map(i=>o.includes(i)?Promise.resolve():this.apiService.remove(`/v2/accounts/media/favorites/${i}`,{withAuthentication:!0})))});p(this,"getFavorites",async()=>{var n;const e=await this.apiService.get("/v2/accounts/media/favorites",{withAuthentication:!0});return((n=e==null?void 0:e.collection)==null?void 0:n.map(this.formatFavorite))||[]});p(this,"getWatchHistory",async()=>{var n;const e=await this.apiService.get("/v2/accounts/media/watch-history",{withAuthentication:!0},{filter:"currently_watching"});return((n=e==null?void 0:e.collection)==null?void 0:n.map(this.formatHistoryItem))||[]});p(this,"subscribeToNotifications",async({uuid:e,onMessage:n})=>{try{return Ks.Notifications.isSubscribed()||Ks.subscribe(e,{onMessage:n,onOpen:()=>!0}),!0}catch{return!1}});p(this,"exportAccountData",async()=>{try{return await this.apiService.post("/accounts/export",{password:void 0,branding_id:0},{withAuthentication:!0})}catch{throw new Error("Failed to export account data")}});p(this,"deleteAccount",async({password:e})=>{try{return await this.apiService.remove("/accounts/erase",{withAuthentication:!0},{password:e,branding_id:0})}catch(n){throw Re.isCommonError(n)?new Error(n.response.data.message||"Failed to delete account"):new Error("Failed to delete account")}});p(this,"getSocialUrls",async({redirectUrl:e})=>{const n=this.storageService.base64Encode(JSON.stringify({client_id:this.clientId||"",redirect:e})),a=await this.apiService.get("/accounts/social",{includeFullResponse:!0},{state:n});if(a.status!==200)throw new Error("Failed to fetch social urls");return a.data.social_urls});this.storageService=e,this.apiService=n}formatAuth(e){const{access_token:n}=e;return{jwt:n,refreshToken:""}}})||St)||St)||St)||St)||St);const la=(s,{minutesAbbreviation:t})=>s?`${Math.ceil(s/60)} ${t}`:"",pl=(s,{hoursAbbreviation:t,minutesAbbreviation:e})=>{if(!s)return"";const n=Math.floor(s/3600),a=Math.round((s-n*3600)/60),o=n?`${n}${t}`:"",i=a?`${a}${e}`:"";return[o,i].filter(Boolean).join(" ")},dt=(s,t,e)=>new Intl.NumberFormat(e||"en-US",{style:"currency",currency:t}).format(s),Kn=(s,t)=>!s&&!t?"":s&&s!=="0"?`S${s}:E${t}`:`E${t}`,Sh=(s,t,e)=>t?e?`${Bn(t,s," • ")} - ${ml(e,s)}`:Bn(t,s," • "):"",Et=(s,t)=>new Intl.DateTimeFormat(t,{day:"numeric",month:"long",year:"numeric"}).format(s),ml=(s,t)=>new Intl.DateTimeFormat(t,{hour:"numeric",minute:"numeric"}).format(s),Bn=(s,t,e=" ")=>`${Et(s,t)}${e}${ml(s,t)}`,jh=s=>dt(s.customerPriceInclTax,s.customerCurrency,s.customerCountry),da=s=>{var t;return((t=s.offerId)==null?void 0:t[0])==="S"};var Ri,Oi,Di,Mi,zt;let Ch=(Ri=fe(),Oi=function(s,t){return ie(Re)(s,void 0,0)},Di=Reflect.metadata("design:type",Function),Mi=Reflect.metadata("design:paramtypes",[typeof Re>"u"?Object:Re]),Ri(zt=Oi(zt=Di(zt=Mi(zt=class extends Bs{constructor(e){super();p(this,"cardPaymentProvider","stripe");p(this,"apiService");p(this,"formatPaymentMethod",(e,n)=>({id:e.id,methodName:e.method_name.toLocaleLowerCase(),provider:n,logoUrl:""}));p(this,"formatEntitlements",(e=0,n=!1)=>({errors:[],responseData:{accessGranted:n,expiresAt:e}}));p(this,"formatOffer",e=>({id:e.id,offerId:this.formatOfferId(e),offerCurrency:e.currency,customerPriceInclTax:e.amount,customerCurrency:e.currency,offerTitle:e.description,active:!0,period:e.access_type.period==="month"&&e.access_type.quantity===12?"year":e.access_type.period,freePeriods:e.trial_period?1:0,planSwitchEnabled:e.item.plan_switch_enabled??!1}));p(this,"formatOrder",e=>({id:e.offer.id,customerId:e.customerId,offerId:e.offer.offerId,totalPrice:e.offer.customerPriceInclTax,priceBreakdown:{offerPrice:e.offer.customerPriceInclTax,discountAmount:e.offer.customerPriceInclTax,discountedPrice:e.offer.customerPriceInclTax,paymentMethodFee:0,taxValue:0},taxRate:0,currency:e.offer.offerCurrency||"EUR",requiredPaymentDetails:!0}));p(this,"createOrder",async e=>({errors:[],responseData:{message:"",order:this.formatOrder(e),success:!0}}));p(this,"getOffers",async e=>(await Promise.all(e.offerIds.map(async a=>{try{const o=await this.apiService.get(`/v2/items/${this.parseOfferId(a)}/access-fees`);return o==null?void 0:o.map(i=>this.formatOffer(i))}catch{throw new Error("Failed to get offers")}}))).flat());p(this,"getPaymentMethods",async()=>{try{const e=await this.apiService.get("/payments/methods",{withAuthentication:!0}),n=[];return e.forEach(a=>{["card","paypal"].includes(a.method_name.toLowerCase())&&n.push(this.formatPaymentMethod(a,this.cardPaymentProvider))}),{errors:[],responseData:{message:"",paymentMethods:n,status:1}}}catch{throw new Error("Failed to get payment methods")}});p(this,"paymentWithPayPal",async e=>{try{const n=await this.apiService.post("/external-payments",{origin:e.waitingUrl,access_fee:e.order.id,payment_method:2,voucher_code:e.couponCode},{withAuthentication:!0});return n!=null&&n.id?{errors:["Already have an active access"],responseData:{redirectUrl:e.errorUrl}}:{errors:[],responseData:{redirectUrl:n.endpoint}}}catch{throw new Error("Failed to generate PayPal payment url")}});p(this,"iFrameCardPayment",async()=>({errors:[],responseData:{}}));p(this,"paymentWithoutDetails",async()=>({errors:[],responseData:{}}));p(this,"updateOrder",async({order:e,couponCode:n})=>{try{const a=await this.apiService.post("/vouchers/discount",{voucher_code:`${n}`,access_fee_id:e.id},{withAuthentication:!0}),o=e.totalPrice-a.amount,i={...e,totalPrice:a.amount,priceBreakdown:{...e.priceBreakdown,discountAmount:o,discountedPrice:o},discount:{applied:!0,type:"coupon",periods:a.discount_duration}};return{errors:[],responseData:{message:"successfully updated",order:i,success:!0}}}catch(a){throw Re.isCommonError(a)&&a.response.data.message==="Voucher not found"?new Error("Invalid coupon code"):new Error("An unknown error occurred")}});p(this,"getEntitlements",async({offerId:e})=>{try{const n=await this.apiService.get(`/items/${this.parseOfferId(e)}/access`,{withAuthentication:!0});return this.formatEntitlements(n.expires_at,!0)}catch{return this.formatEntitlements()}});p(this,"directPostCardPayment",async(e,n,a,o)=>{const i={number:e.cardNumber.replace(/\s/g,""),card_name:e.cardholderName,exp_month:e.cardExpMonth||"",exp_year:e.cardExpYear||"",cvv:e.cardCVC,access_fee:n.id,payment_method:1,voucher_code:e.couponCode,referrer:a,return_url:o};try{return da(n)?await this.apiService.post("/subscriptions",i,{withAuthentication:!0}):await this.apiService.post("/payments",i,{withAuthentication:!0}),!0}catch{throw new Error("Failed to make payment")}});p(this,"getSubscriptionSwitches");p(this,"getOrder");p(this,"switchSubscription");p(this,"getSubscriptionSwitch");p(this,"createAdyenPaymentSession");p(this,"initialAdyenPayment");p(this,"finalizeAdyenPayment");p(this,"updatePaymentMethodWithPayPal");p(this,"deletePaymentMethod");p(this,"addAdyenPaymentDetails");p(this,"finalizeAdyenPaymentDetails");p(this,"getOffer");this.apiService=e}formatOfferId(e){return["ppv","ppv_custom"].includes(e.access_type.name)?`C${e.item_id}_${e.id}`:`S${e.item_id}_${e.id}`}parseOfferId(e){return typeof e=="string"?e.startsWith("C")||e.startsWith("S")?parseInt(e.slice(1).split("_")[0]):parseInt(e):e}})||zt)||zt)||zt)||zt);var Fi,Bi,Ui,Hi,Wi,jt;let Ph=(Fi=fe(),Bi=function(s,t){return Td("JWP")(s,void 0,0)},Ui=function(s,t){return ie(Re)(s,void 0,1)},Hi=Reflect.metadata("design:type",Function),Wi=Reflect.metadata("design:paramtypes",[typeof vt>"u"?Object:vt,typeof Re>"u"?Object:Re]),Fi(jt=Bi(jt=Ui(jt=Hi(jt=Wi(jt=class extends Us{constructor(e,n){super();p(this,"accountService");p(this,"apiService");p(this,"formatCardDetails",e=>{const{number:n,exp_month:a,exp_year:o,card_name:i,card_type:c,account_id:l,currency:d}=e,h=`0${a}`.slice(-2);return{id:0,paymentMethodId:0,paymentGateway:"card",paymentMethod:"card",customerId:l.toString(),paymentMethodSpecificParams:{holderName:i,variant:c,lastCardFourDigits:String(n),cardExpirationDate:`${h}/${o}`},active:!0,currency:d}});p(this,"formatTransaction",e=>{var a,o,i;const n=((a=e==null?void 0:e.charged_amount)==null?void 0:a.toString())||"0";return{transactionId:e.transaction_token||xe.t("user:payment.access_granted"),transactionDate:e.created_at,trxToken:e.trx_token,offerId:((o=e.item_id)==null?void 0:o.toString())||xe.t("user:payment.no_transaction"),offerType:e.item_type||"",offerTitle:(e==null?void 0:e.item_title)||"",offerPeriod:"",transactionPriceExclTax:n,transactionCurrency:e.currency_iso||"EUR",discountedOfferPrice:n,offerCurrency:e.currency_iso||"EUR",offerPriceExclTax:n,applicableTax:"0",transactionPriceInclTax:n,customerId:(i=e.consumer_id)==null?void 0:i.toString(),customerEmail:"",customerLocale:"",customerCountry:"en",customerIpCountry:"",customerCurrency:"",paymentMethod:e.payment_method_name||xe.t("user:payment.access_granted")}});p(this,"formatActiveSubscription",(e,n)=>{var o,i;let a="";switch(e.action_type){case"free-trial":a="active_trial";break;case"recurrent":a="active";break;case"canceled":a="cancelled";break;case"incomplete_expired":a="expired";break;default:a="terminated"}return{subscriptionId:e.subscription_id,offerId:(o=e.item_id)==null?void 0:o.toString(),accessFeeId:`S${e.access_fee_id}`,status:a,expiresAt:n,nextPaymentAt:e.next_rebill_date,nextPaymentPrice:e.subscription_price,nextPaymentCurrency:e.currency,paymentGateway:"stripe",paymentMethod:e.payment_method_name,offerTitle:e.item_title,period:(i=e.access_type)==null?void 0:i.period,totalPrice:e.charged_amount,unsubscribeUrl:e.unsubscribe_url,pendingSwitchId:null}});p(this,"formatGrantedSubscription",e=>({subscriptionId:"",offerId:e.item.id.toString(),status:"active",expiresAt:e.expires_at,nextPaymentAt:e.expires_at,nextPaymentPrice:0,nextPaymentCurrency:"EUR",paymentGateway:"none",paymentMethod:xe.t("user:payment.access_granted"),offerTitle:e.item.title,period:"granted",totalPrice:0,unsubscribeUrl:"",pendingSwitchId:null}));p(this,"getActiveSubscription",async()=>{const e=this.accountService.assetId;if(e===null)throw new Error("Couldn't fetch active subscription, there is no assetId configured");try{const n=await this.apiService.get(`/items/${e}/access`,{withAuthentication:!0});if(n){const o=(await this.apiService.get("/subscriptions",{withAuthentication:!0,contentType:"json"},{limit:15,page:0})).collection.find(i=>i.item_id===e);return o?this.formatActiveSubscription(o,n==null?void 0:n.expires_at):this.formatGrantedSubscription(n)}return null}catch(n){if(Re.isCommonError(n)&&n.response.data.code===402)return null;throw new Error("Unable to fetch customer subscriptions.")}});p(this,"getAllTransactions",async()=>{var e;try{const n=await this.apiService.get("/v2/accounting/payment-history",{withAuthentication:!0,contentType:"json"});return(e=n==null?void 0:n.collection)==null?void 0:e.map(a=>this.formatTransaction(a))}catch{throw new Error("Failed to get transactions")}});p(this,"getActivePayment",async()=>{var e;try{const n=await this.apiService.get("/v2/payments/cards/default",{withAuthentication:!0,contentType:"json"}),a=[];for(const o in n==null?void 0:n.cards)a.push(this.formatCardDetails({...(e=n.cards)==null?void 0:e[o],currency:o}));return a.find(o=>o.active)||null}catch{return null}});p(this,"getSubscriptions",async()=>({errors:[],responseData:{items:[]}}));p(this,"updateSubscription",async({offerId:e,unsubscribeUrl:n})=>{if(!n)throw new Error("Missing unsubscribe url");try{return await this.apiService.get(n,{withAuthentication:!0,contentType:"json"}),{errors:[],responseData:{offerId:e,status:"cancelled",expiresAt:0}}}catch{throw new Error("Failed to update subscription")}});p(this,"changeSubscription",async({accessFeeId:e,subscriptionId:n})=>{try{const a=await this.apiService.post("/v2/subscriptions/stripe:switch",{inplayer_token:n,access_fee_id:e},{withAuthentication:!0});return{errors:[],responseData:{message:a.message}}}catch{throw new Error("Failed to change subscription")}});p(this,"updateCardDetails",async({cardName:e,cardNumber:n,cvc:a,expMonth:o,expYear:i,currency:c})=>{try{const l=await this.apiService.put("/v2/payments/cards/default",{number:n,card_name:e,cvv:a,exp_month:o,exp_year:i,currency_iso:c},{withAuthentication:!0});return{errors:[],responseData:l}}catch{throw new Error("Failed to update card details")}});p(this,"fetchReceipt",async({transactionId:e})=>{try{const n=await this.apiService.get(`/v2/accounting/transactions/${e}/receipt`,{withAuthentication:!0,contentType:"json",responseType:"blob"});return{errors:[],responseData:n}}catch{throw new Error("Failed to get billing receipt")}});p(this,"getPaymentDetails");p(this,"getTransactions");this.accountService=e,this.apiService=n}})||jt)||jt)||jt)||jt)||jt);const Eh=s=>s.container.get(zn).getIntegrationType(),Ih=s=>{var t,e;return(e=(t=s.integrations)==null?void 0:t.cleeng)!=null&&e.id?Zt.CLEENG:null},Ah=s=>{var t,e;return(e=(t=s.integrations)==null?void 0:t.jwp)!=null&&e.clientId?Zt.JWP:null},kh=(s,t)=>{const e=Nd({uri:s});return new Ld({link:e,cache:new $d({addTypename:!1})})},Th=dn`
    query KeywordSearch($keyword: String!) {
  movies(filter: {title: {includesInsensitive: $keyword}}) {
    nodes {
      id
      originalTitle
      studio
      released
      cast
      productionCountries
      tags
      title
      description
      synopsis
      genres {
        nodes {
          movieGenre {
            id
            title
          }
        }
      }
      images {
        nodes {
          id
          type
          width
          height
          path
          altText
        }
      }
      licenses {
        nodes {
          countries
          startTime
          endTime
        }
      }
      videos {
        nodes {
          id
          type
          title
          dashManifest
          hlsManifest
          audioLanguages
          subtitleLanguages
          outputFormat
          lengthInSeconds
          captionLanguages
          isProtected
          cuePoints {
            nodes {
              id
              cuePointTypeKey
              timeInSeconds
              value
            }
          }
          videoStreams {
            nodes {
              label
              format
              frameRate
              languageCode
              bitrateInKbps
              displayAspectRatio
              pixelAspectRatio
              samplingRate
              fileTemplate
              bitrateInKbps
              id
              iv
              keyId
              type
              fileTemplate
              codecs
              height
              width
              displayAspectRatio
            }
          }
        }
      }
    }
  }
  episodes(filter: {title: {includesInsensitive: $keyword}}) {
    nodes {
      id
      index
      originalTitle
      studio
      released
      cast
      productionCountries
      tags
      title
      description
      synopsis
      genres {
        nodes {
          tvshowGenre {
            id
            title
          }
        }
      }
      images {
        nodes {
          id
          type
          width
          height
          path
          altText
        }
      }
      licenses {
        nodes {
          countries
          startTime
          endTime
        }
      }
      videos {
        nodes {
          id
          type
          title
          dashManifest
          hlsManifest
          audioLanguages
          subtitleLanguages
          outputFormat
          lengthInSeconds
          captionLanguages
          isProtected
          cuePoints {
            nodes {
              id
              cuePointTypeKey
              timeInSeconds
              value
            }
          }
          videoStreams {
            nodes {
              label
              format
              frameRate
              languageCode
              bitrateInKbps
              displayAspectRatio
              pixelAspectRatio
              samplingRate
              fileTemplate
              bitrateInKbps
              id
              iv
              keyId
              type
              fileTemplate
              codecs
              height
              width
              displayAspectRatio
            }
          }
        }
      }
    }
  }
  tvshows(filter: {title: {includesInsensitive: $keyword}}) {
    nodes {
      id
      originalTitle
      studio
      released
      cast
      productionCountries
      tags
      title
      description
      synopsis
      genres {
        nodes {
          tvshowGenre {
            id
            title
          }
        }
      }
      images {
        nodes {
          id
          type
          width
          height
          path
          altText
        }
      }
      licenses {
        nodes {
          countries
          startTime
          endTime
        }
      }
      videos {
        nodes {
          id
          type
          title
          dashManifest
          hlsManifest
          audioLanguages
          subtitleLanguages
          outputFormat
          lengthInSeconds
          captionLanguages
          isProtected
          cuePoints {
            nodes {
              id
              cuePointTypeKey
              timeInSeconds
              value
            }
          }
          videoStreams {
            nodes {
              label
              format
              frameRate
              languageCode
              bitrateInKbps
              displayAspectRatio
              pixelAspectRatio
              samplingRate
              fileTemplate
              bitrateInKbps
              id
              iv
              keyId
              type
              fileTemplate
              codecs
              height
              width
              displayAspectRatio
            }
          }
        }
      }
    }
  }
}
    `;dn`
    query GetAllChannels {
  channels {
    nodes {
      id
      title
      description
      dashStreamUrl
      hlsStreamUrl
      keyId
      playlists {
        nodes {
          id
          startDateTime
          endDateTime
          programs(orderBy: SORT_INDEX_ASC) {
            nodes {
              id
              sortIndex
              title
              movie {
                title
              }
              episode {
                title
              }
              id
            }
          }
        }
      }
    }
  }
}
    `;const bn=dn`
    query GetItem($id: String!) {
  movie(id: $id) {
    id
    originalTitle
    studio
    released
    cast
    productionCountries
    tags
    title
    description
    synopsis
    genres {
      nodes {
        movieGenre {
          id
          title
        }
      }
    }
    images {
      nodes {
        id
        type
        width
        height
        path
        altText
      }
    }
    licenses {
      nodes {
        countries
        startTime
        endTime
      }
    }
    videos {
      nodes {
        id
        type
        title
        dashManifest
        hlsManifest
        audioLanguages
        subtitleLanguages
        outputFormat
        lengthInSeconds
        captionLanguages
        isProtected
        cuePoints {
          nodes {
            id
            cuePointTypeKey
            timeInSeconds
            value
          }
        }
        videoStreams {
          nodes {
            label
            format
            frameRate
            languageCode
            bitrateInKbps
            displayAspectRatio
            pixelAspectRatio
            samplingRate
            fileTemplate
            bitrateInKbps
            id
            iv
            keyId
            type
            fileTemplate
            codecs
            height
            width
            displayAspectRatio
          }
        }
      }
    }
  }
  tvshow(id: $id) {
    id
    originalTitle
    studio
    released
    cast
    productionCountries
    tags
    title
    description
    synopsis
    genres {
      nodes {
        tvshowGenre {
          id
          title
        }
      }
    }
    images {
      nodes {
        id
        type
        width
        height
        path
        altText
      }
    }
    licenses {
      nodes {
        countries
        startTime
        endTime
      }
    }
    videos {
      nodes {
        id
        type
        title
        dashManifest
        hlsManifest
        audioLanguages
        subtitleLanguages
        outputFormat
        lengthInSeconds
        captionLanguages
        isProtected
        cuePoints {
          nodes {
            id
            cuePointTypeKey
            timeInSeconds
            value
          }
        }
        videoStreams {
          nodes {
            label
            format
            frameRate
            languageCode
            bitrateInKbps
            displayAspectRatio
            pixelAspectRatio
            samplingRate
            fileTemplate
            bitrateInKbps
            id
            iv
            keyId
            type
            fileTemplate
            codecs
            height
            width
            displayAspectRatio
          }
        }
      }
    }
    seasons {
      nodes {
        id
        index
        synopsis
        episodes {
          nodes {
            id
            index
            originalTitle
            studio
            released
            cast
            productionCountries
            tags
            title
            description
            synopsis
            season {
              tvshowId
            }
            genres {
              nodes {
                tvshowGenre {
                  id
                  title
                }
              }
            }
            images {
              nodes {
                id
                type
                width
                height
                path
                altText
              }
            }
            licenses {
              nodes {
                countries
                startTime
                endTime
              }
            }
            videos {
              nodes {
                id
                type
                title
                dashManifest
                hlsManifest
                audioLanguages
                subtitleLanguages
                outputFormat
                lengthInSeconds
                captionLanguages
                isProtected
                cuePoints {
                  nodes {
                    id
                    cuePointTypeKey
                    timeInSeconds
                    value
                  }
                }
                videoStreams {
                  nodes {
                    label
                    format
                    frameRate
                    languageCode
                    bitrateInKbps
                    displayAspectRatio
                    pixelAspectRatio
                    samplingRate
                    fileTemplate
                    bitrateInKbps
                    id
                    iv
                    keyId
                    type
                    fileTemplate
                    codecs
                    height
                    width
                    displayAspectRatio
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  season(id: $id) {
    id
    index
    studio
    released
    cast
    productionCountries
    tags
    description
    synopsis
    genres {
      nodes {
        tvshowGenre {
          id
          title
        }
      }
    }
    images {
      nodes {
        id
        type
        width
        height
        path
        altText
      }
    }
    licenses {
      nodes {
        countries
        startTime
        endTime
      }
    }
    videos {
      nodes {
        id
        type
        title
        dashManifest
        hlsManifest
        audioLanguages
        subtitleLanguages
        outputFormat
        lengthInSeconds
        captionLanguages
        isProtected
        cuePoints {
          nodes {
            id
            cuePointTypeKey
            timeInSeconds
            value
          }
        }
        videoStreams {
          nodes {
            label
            format
            frameRate
            languageCode
            bitrateInKbps
            displayAspectRatio
            pixelAspectRatio
            samplingRate
            fileTemplate
            bitrateInKbps
            id
            iv
            keyId
            type
            fileTemplate
            codecs
            height
            width
            displayAspectRatio
          }
        }
      }
    }
  }
  episode(id: $id) {
    id
    index
    originalTitle
    studio
    released
    cast
    productionCountries
    tags
    title
    description
    synopsis
    season {
      id
      index
      tvshowId
    }
    genres {
      nodes {
        tvshowGenre {
          id
          title
        }
      }
    }
    images {
      nodes {
        id
        type
        width
        height
        path
        altText
      }
    }
    licenses {
      nodes {
        countries
        startTime
        endTime
      }
    }
    videos {
      nodes {
        id
        type
        title
        dashManifest
        hlsManifest
        audioLanguages
        subtitleLanguages
        outputFormat
        lengthInSeconds
        captionLanguages
        isProtected
        cuePoints {
          nodes {
            id
            cuePointTypeKey
            timeInSeconds
            value
          }
        }
        videoStreams {
          nodes {
            label
            format
            frameRate
            languageCode
            bitrateInKbps
            displayAspectRatio
            pixelAspectRatio
            samplingRate
            fileTemplate
            bitrateInKbps
            id
            iv
            keyId
            type
            fileTemplate
            codecs
            height
            width
            displayAspectRatio
          }
        }
      }
    }
  }
  channel(id: $id) {
    id
    title
    hlsStreamUrl
    description
    dashStreamUrl
    images {
      nodes {
        id
        path
        type
      }
    }
  }
}
    `,Nh=dn`
    query GetCollection($id: String!) {
  collection(id: $id) {
    id
    title
    synopsis
    description
    items {
      nodes {
        id
        relationType
        episodeId
        episode {
          id
          index
          synopsis
          genres {
            nodes {
              tvshowGenre {
                title
              }
            }
          }
          cast
          released
          tags
          images {
            nodes {
              id
              type
              path
            }
          }
          videos {
            nodes {
              id
              dashManifest
              hlsManifest
              cuePoints {
                nodes {
                  id
                  cuePointTypeKey
                  timeInSeconds
                  value
                }
              }
            }
          }
        }
        seasonId
        season {
          id
          index
          studio
          released
          cast
          productionCountries
          tags
          description
          synopsis
          genres {
            nodes {
              tvshowGenre {
                id
                title
              }
            }
          }
          images {
            nodes {
              id
              type
              width
              height
              path
              altText
            }
          }
          licenses {
            nodes {
              countries
              startTime
              endTime
            }
          }
          videos {
            nodes {
              id
              type
              title
              dashManifest
              hlsManifest
              audioLanguages
              subtitleLanguages
              outputFormat
              lengthInSeconds
              captionLanguages
              isProtected
              cuePoints {
                nodes {
                  id
                  cuePointTypeKey
                  timeInSeconds
                  value
                }
              }
              videoStreams {
                nodes {
                  label
                  format
                  frameRate
                  languageCode
                  bitrateInKbps
                  displayAspectRatio
                  pixelAspectRatio
                  samplingRate
                  fileTemplate
                  bitrateInKbps
                  id
                  iv
                  keyId
                  type
                  fileTemplate
                  codecs
                  height
                  width
                  displayAspectRatio
                }
              }
            }
          }
        }
        tvshowId
        tvshow {
          id
          originalTitle
          studio
          released
          cast
          productionCountries
          tags
          title
          description
          synopsis
          genres {
            nodes {
              tvshowGenre {
                id
                title
              }
            }
          }
          images {
            nodes {
              id
              type
              width
              height
              path
              altText
            }
          }
          licenses {
            nodes {
              countries
              startTime
              endTime
            }
          }
          videos {
            nodes {
              id
              type
              title
              dashManifest
              hlsManifest
              audioLanguages
              subtitleLanguages
              outputFormat
              lengthInSeconds
              captionLanguages
              isProtected
              cuePoints {
                nodes {
                  id
                  cuePointTypeKey
                  timeInSeconds
                  value
                }
              }
              videoStreams {
                nodes {
                  label
                  format
                  frameRate
                  languageCode
                  bitrateInKbps
                  displayAspectRatio
                  pixelAspectRatio
                  samplingRate
                  fileTemplate
                  bitrateInKbps
                  id
                  iv
                  keyId
                  type
                  fileTemplate
                  codecs
                  height
                  width
                  displayAspectRatio
                }
              }
            }
          }
          seasons {
            nodes {
              id
              index
              synopsis
              episodes {
                nodes {
                  id
                  index
                  title
                  synopsis
                }
              }
            }
          }
        }
        movieId
        movie {
          id
          originalTitle
          studio
          released
          cast
          productionCountries
          tags
          title
          description
          synopsis
          genres {
            nodes {
              movieGenre {
                id
                title
              }
            }
          }
          images {
            nodes {
              id
              type
              width
              height
              path
              altText
            }
          }
          licenses {
            nodes {
              countries
              startTime
              endTime
            }
          }
          videos {
            nodes {
              id
              type
              title
              dashManifest
              hlsManifest
              audioLanguages
              subtitleLanguages
              outputFormat
              lengthInSeconds
              captionLanguages
              isProtected
              cuePoints {
                nodes {
                  id
                  cuePointTypeKey
                  timeInSeconds
                  value
                }
              }
              videoStreams {
                nodes {
                  label
                  format
                  frameRate
                  languageCode
                  bitrateInKbps
                  displayAspectRatio
                  pixelAspectRatio
                  samplingRate
                  fileTemplate
                  bitrateInKbps
                  id
                  iv
                  keyId
                  type
                  fileTemplate
                  codecs
                  height
                  width
                  displayAspectRatio
                }
              }
            }
          }
        }
      }
    }
  }
}
    `,Lh=dn`
    query GetItems($ids: [String!]) {
  movies(filter: {id: {in: $ids}}) {
    nodes {
      id
      originalTitle
      studio
      released
      cast
      productionCountries
      tags
      title
      description
      synopsis
      genres {
        nodes {
          movieGenre {
            id
            title
          }
        }
      }
      images {
        nodes {
          id
          type
          width
          height
          path
          altText
        }
      }
      licenses {
        nodes {
          countries
          startTime
          endTime
        }
      }
      videos {
        nodes {
          id
          type
          title
          dashManifest
          hlsManifest
          audioLanguages
          subtitleLanguages
          outputFormat
          lengthInSeconds
          captionLanguages
          isProtected
          cuePoints {
            nodes {
              id
              cuePointTypeKey
              timeInSeconds
              value
            }
          }
          videoStreams {
            nodes {
              label
              format
              frameRate
              languageCode
              bitrateInKbps
              displayAspectRatio
              pixelAspectRatio
              samplingRate
              fileTemplate
              bitrateInKbps
              id
              iv
              keyId
              type
              fileTemplate
              codecs
              height
              width
              displayAspectRatio
            }
          }
        }
      }
    }
  }
  tvshows(filter: {id: {in: $ids}}) {
    nodes {
      id
      originalTitle
      studio
      released
      cast
      productionCountries
      tags
      title
      description
      synopsis
      genres {
        nodes {
          tvshowGenre {
            id
            title
          }
        }
      }
      images {
        nodes {
          id
          type
          width
          height
          path
          altText
        }
      }
      licenses {
        nodes {
          countries
          startTime
          endTime
        }
      }
      videos {
        nodes {
          id
          type
          title
          dashManifest
          hlsManifest
          audioLanguages
          subtitleLanguages
          outputFormat
          lengthInSeconds
          captionLanguages
          isProtected
          cuePoints {
            nodes {
              id
              cuePointTypeKey
              timeInSeconds
              value
            }
          }
          videoStreams {
            nodes {
              label
              format
              frameRate
              languageCode
              bitrateInKbps
              displayAspectRatio
              pixelAspectRatio
              samplingRate
              fileTemplate
              bitrateInKbps
              id
              iv
              keyId
              type
              fileTemplate
              codecs
              height
              width
              displayAspectRatio
            }
          }
        }
      }
      seasons {
        nodes {
          id
          index
          synopsis
          episodes {
            nodes {
              id
              index
              originalTitle
              studio
              released
              cast
              productionCountries
              tags
              title
              description
              synopsis
              season {
                tvshowId
              }
              genres {
                nodes {
                  tvshowGenre {
                    id
                    title
                  }
                }
              }
              images {
                nodes {
                  id
                  type
                  width
                  height
                  path
                  altText
                }
              }
              licenses {
                nodes {
                  countries
                  startTime
                  endTime
                }
              }
              videos {
                nodes {
                  id
                  type
                  title
                  dashManifest
                  hlsManifest
                  audioLanguages
                  subtitleLanguages
                  outputFormat
                  lengthInSeconds
                  captionLanguages
                  isProtected
                  cuePoints {
                    nodes {
                      id
                      cuePointTypeKey
                      timeInSeconds
                      value
                    }
                  }
                  videoStreams {
                    nodes {
                      label
                      format
                      frameRate
                      languageCode
                      bitrateInKbps
                      displayAspectRatio
                      pixelAspectRatio
                      samplingRate
                      fileTemplate
                      bitrateInKbps
                      id
                      iv
                      keyId
                      type
                      fileTemplate
                      codecs
                      height
                      width
                      displayAspectRatio
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  seasons(filter: {id: {in: $ids}}) {
    nodes {
      id
      index
      studio
      released
      cast
      productionCountries
      tags
      description
      synopsis
      genres {
        nodes {
          tvshowGenre {
            id
            title
          }
        }
      }
      images {
        nodes {
          id
          type
          width
          height
          path
          altText
        }
      }
      licenses {
        nodes {
          countries
          startTime
          endTime
        }
      }
      videos {
        nodes {
          id
          type
          title
          dashManifest
          hlsManifest
          audioLanguages
          subtitleLanguages
          outputFormat
          lengthInSeconds
          captionLanguages
          isProtected
          cuePoints {
            nodes {
              id
              cuePointTypeKey
              timeInSeconds
              value
            }
          }
          videoStreams {
            nodes {
              label
              format
              frameRate
              languageCode
              bitrateInKbps
              displayAspectRatio
              pixelAspectRatio
              samplingRate
              fileTemplate
              bitrateInKbps
              id
              iv
              keyId
              type
              fileTemplate
              codecs
              height
              width
              displayAspectRatio
            }
          }
        }
      }
    }
  }
  episodes(filter: {id: {in: $ids}}) {
    nodes {
      id
      index
      originalTitle
      studio
      released
      cast
      productionCountries
      tags
      title
      description
      synopsis
      season {
        id
        index
        tvshowId
      }
      genres {
        nodes {
          tvshowGenre {
            id
            title
          }
        }
      }
      images {
        nodes {
          id
          type
          width
          height
          path
          altText
        }
      }
      licenses {
        nodes {
          countries
          startTime
          endTime
        }
      }
      videos {
        nodes {
          id
          type
          title
          dashManifest
          hlsManifest
          audioLanguages
          subtitleLanguages
          outputFormat
          lengthInSeconds
          captionLanguages
          isProtected
          cuePoints {
            nodes {
              id
              cuePointTypeKey
              timeInSeconds
              value
            }
          }
          videoStreams {
            nodes {
              label
              format
              frameRate
              languageCode
              bitrateInKbps
              displayAspectRatio
              pixelAspectRatio
              samplingRate
              fileTemplate
              bitrateInKbps
              id
              iv
              keyId
              type
              fileTemplate
              codecs
              height
              width
              displayAspectRatio
            }
          }
        }
      }
    }
  }
  channels(filter: {id: {in: $ids}}) {
    nodes {
      id
      title
      hlsStreamUrl
      description
      dashStreamUrl
      images {
        nodes {
          id
          path
          type
        }
      }
    }
  }
}
    `;var Vi,qi;const Gi=20,$h="https://mosaic-ott-catalog.axprod.net/graphql",Rh="https://image.service.eu.axinom.net",ns=kh($h),Oh=()=>{throw new Error("Not Implemented")};let Dh=(Vi=fe(),Vi(qi=class extends Ee{constructor(){super(...arguments);p(this,"transformToPlaylistItem",(e,n,a)=>{var d,h,u,g,y,f,x,w;const o=((h=(d=e==null?void 0:e.images)==null?void 0:d.nodes)==null?void 0:h.filter(_=>_.path).map(_=>({src:Rh+_.path,type:_.type,width:_.width})))??[],i="videos"in e&&Array.isArray((u=e==null?void 0:e.videos)==null?void 0:u.nodes)?e.videos.nodes.filter(_=>(_.hlsManifest||_.dashManifest)&&(a?_.type==="TRAILER":_.type==="MAIN")).map(_=>({file:_.hlsManifest??_.dashManifest,type:_.hlsManifest?"application/vnd.apple.mpegurl":"application/dash+xml",lengthInSeconds:_.lengthInSeconds})):[],c="videos"in e&&Array.isArray((g=e==null?void 0:e.videos)==null?void 0:g.nodes)?e.videos.nodes.find(_=>(_.hlsManifest||_.dashManifest)&&_.type==="TRAILER")??!1:!1,l=[""];return l.pop(),n=="movie"?e.genres.nodes.forEach(_=>{var b;l.push(((b=_.movieGenre)==null?void 0:b.title)??"?")}):n=="series"&&e.genres.nodes.forEach(_=>{var b;l.push(((b=_.tvshowGenre)==null?void 0:b.title)??"?")}),{description:(e==null?void 0:e.description)??"",duration:i.length>0?((y=i[0])==null?void 0:y.lengthInSeconds)??0:0,feedid:"na",genre:l.join(",  "),image:"",link:"",mediaid:e==null?void 0:e.id,pubdate:0,tags:l.join(","),title:"index"in e&&n==="season"?((f=e.index)==null?void 0:f.toString())??"":"title"in e?e.title??"":"",contentType:n,cardImage:((x=o.find(_=>_.type==="COVER"))==null?void 0:x.src)||"/404.png",backgroundImage:((w=o.find(_=>_.type==="TEASER"))==null?void 0:w.src)||"/404.png",images:o,sources:i,...n==="movie"&&c&&{trailerId:"TRAILER_"+(e==null?void 0:e.id)},cast:e==null?void 0:e.cast,genres:l.filter(_=>_!="Action")}});p(this,"tranformEpisodeToPlayListItem",e=>this.transformToPlaylistItem(e,"episode"));p(this,"tranformMovieToPlayListItem",(e,n)=>this.transformToPlaylistItem(e,"movie",n));p(this,"tranformSeasonToPlayListItem",e=>this.transformToPlaylistItem(e,"season"));p(this,"tranformTvShowToPlayListItem",e=>this.transformToPlaylistItem(e,"series"));p(this,"transformAxinomMediaItem",(e,n)=>e.movie?this.tranformMovieToPlayListItem(e.movie,n):e.episode?this.tranformEpisodeToPlayListItem(e.episode):e.tvshow?this.tranformTvShowToPlayListItem(e.tvshow):e.season?this.tranformSeasonToPlayListItem(e.season):{title:"not found"});p(this,"getMediaByWatchlist",async({playlistId:e,mediaIds:n,token:a,language:o})=>n!=null&&n.length?Oh():[]);p(this,"getMediaById",async({id:e,token:n,drmPolicyId:a,language:o})=>{const i=await ns.query({context:{headers:o?{"mosaic-locale":o}:void 0},query:bn,variables:{id:e.replace("TRAILER_","")},fetchPolicy:"no-cache"});if(i.errors)throw new Error("MediaItem not found");return this.transformAxinomMediaItem(i.data,e.startsWith("TRAILER_"))});p(this,"getMediaByIdWithPassport",async({id:e,siteId:n,planId:a,passport:o,language:i})=>await this.getMediaById({id:e,token:void 0,drmPolicyId:void 0,language:i??void 0}));p(this,"getSeries",async(e,n={})=>{var d,h,u;if(!e)throw new Error("Series ID is required");const a=await ns.query({query:bn,variables:{id:e},fetchPolicy:"no-cache"}),o=(d=a==null?void 0:a.data)==null?void 0:d.tvshow;if(!o)return;const i=((u=(h=o.seasons)==null?void 0:h.nodes)==null?void 0:u.filter(g=>!n.season||g.index===n.season).map(g=>{var f,x,w,_;const y=((x=(f=g.episodes)==null?void 0:f.nodes)==null?void 0:x.reduce((b,v)=>{var j,S;const C=(S=(j=v.videos)==null?void 0:j.nodes)==null?void 0:S.find(E=>E.type==="MAIN");return b+((C==null?void 0:C.lengthInSeconds)??0)},0))??0;return{season_id:g.id,season_number:g.index??1,season_title:`Season ${g.index??1}`,season_description:g.synopsis??"",episode_count:((_=(w=g.episodes)==null?void 0:w.nodes)==null?void 0:_.length)??0,total_duration:y}}))??[],c=i.reduce((g,y)=>g+(y.episode_count??0),0),l=i.reduce((g,y)=>g+(y.total_duration??0),0);return{series_id:o.id,episode_count:c,season_count:i.length,total_duration:l,seasons:i}});p(this,"getSeriesByMediaIds",async e=>{var i;const n=await ns.query({query:Lh,variables:{ids:e},fetchPolicy:"no-cache"}),a=(c,l,d,h,u)=>{c[l]=[{series_id:d,episode_number:u,season_number:h}]},o={};return(i=n.data.episodes)==null||i.nodes.forEach(c=>{var l,d;a(o,c.id,((l=c.season)==null?void 0:l.tvshowId)??"",((d=c==null?void 0:c.season)==null?void 0:d.index)??0,(c==null?void 0:c.index)??0)}),o});p(this,"getEpisodes",async({seriesId:e,pageOffset:n,pageLimit:a=Gi,afterId:o,language:i})=>{var _;if(!e)throw new Error("Series ID is required");const c=await ns.query({context:{headers:i?{"mosaic-locale":i}:void 0},query:bn,variables:{id:e},fetchPolicy:"no-cache"});if(c.errors)throw new Error("MediaItem not found");const l=(_=c.data)==null?void 0:_.tvshow,d=[];l==null||l.seasons.nodes.forEach(b=>{b.episodes.nodes.forEach(v=>{var C,j;if(v!=null){const S={...this.tranformEpisodeToPlayListItem(v),seasonNumber:((C=b==null?void 0:b.index)==null?void 0:C.toString())??"",episodeNumber:((j=v==null?void 0:v.index)==null?void 0:j.toString())??""};d.push(S)}})});const h=d.length??1,u=Math.max(1,Math.ceil(h/a)),y=(Math.min(n??1,u)-1)*a,f=Math.min(y+a,h),x=d.slice(y,f),w={page:(n??0)+1,page_limit:a,total:h};return{episodes:x,pagination:w}});p(this,"getSeasonWithEpisodes",async({seriesId:e,seasonNumber:n,pageOffset:a,pageLimit:o=Gi,language:i})=>{var h;if(!e)throw new Error("Series ID is required");const c=await ns.query({context:{headers:i?{"mosaic-locale":i}:void 0},query:bn,variables:{id:e},fetchPolicy:"no-cache"});if(c.errors)throw new Error("MediaItem not found");const l=[];(h=c.data.tvshow)==null||h.seasons.nodes.forEach(u=>{u.index==n&&u.episodes.nodes.forEach(g=>{var y,f;if(l.length<o&&g!=null){const x={...this.tranformEpisodeToPlayListItem(g),seasonNumber:((y=u==null?void 0:u.index)==null?void 0:y.toString())??"",episodeNumber:((f=g==null?void 0:g.index)==null?void 0:f.toString())??""};l.push(x)}})});const d={page:(a??0)+1,page_limit:o,total:l.length??1};return{episodes:l,pagination:d}});p(this,"getAdSchedule",async e=>{if(!e)throw new Error("Ad Schedule ID is required");const n=H.APP_API_BASE_URL+`/v2/advertising/schedules/${e}.json`,a=await fetch(n,{credentials:"omit"});return await tt(a)});p(this,"doKeyWordSearch",async(e={},n=H.APP_DEFAULT_LANGUAGE)=>{var i,c,l;const a=await ns.query({context:{headers:n?{"mosaic-locale":n}:void 0},query:Th,variables:{keyword:e.search??""},fetchPolicy:"no-cache"}),o={playlist:[],title:"Search result"};return o.playlist=[],(i=a.data.movies)==null||i.nodes.forEach(d=>{o.playlist.push(this.tranformMovieToPlayListItem(d))}),(c=a.data.episodes)==null||c.nodes.forEach(d=>{o.playlist.push(this.tranformEpisodeToPlayListItem(d))}),(l=a.data.tvshows)==null||l.nodes.forEach(d=>{o.playlist.push(this.tranformTvShowToPlayListItem(d))}),o});p(this,"getPlaylistById",async(e,n={},a=H.APP_DEFAULT_LANGUAGE)=>{var d,h;if(!e)return;if(e=="KEYWORD-SEARCH")return await this.doKeyWordSearch(n,a);let o;n.related_media_id&&(o=await this.getMediaById({id:n==null?void 0:n.related_media_id,token:void 0,drmPolicyId:void 0,language:a}));const i=await ns.query({context:{headers:a?{"mosaic-locale":a}:void 0},query:Nh,variables:{id:e},fetchPolicy:"no-cache"});if(i.errors)throw new Error("MediaItem not found");const c=(d=i.data)==null?void 0:d.collection,l={description:(c==null?void 0:c.description)??"",feedid:c==null?void 0:c.id,title:n.related_media_id||!(c!=null&&c.title)?"More like this":c==null?void 0:c.title,playlist:[],cardImageAspectRatio:"2:3"};return l.playlist=[],(h=c==null?void 0:c.items)==null||h.nodes.forEach(u=>{switch(u.relationType){case"MOVIE":if(u.movie!=null){const g=this.tranformMovieToPlayListItem(u.movie);(!o||this.arePlayListItemsRelated(o,g))&&l.playlist.push(g)}break;case"EPISODE":u.episode!=null&&l.playlist.push(this.tranformEpisodeToPlayListItem(u.episode));break;case"TVSHOW":u.tvshow!=null&&l.playlist.push(this.tranformTvShowToPlayListItem(u.tvshow));break}}),l});p(this,"arePlayListItemsRelated",(e,n)=>Array.isArray(e.genres)&&Array.isArray(n.genres)&&e.mediaid!=n.mediaid&&e.genres.some(a=>n.genres.includes(a)));p(this,"getContentList",async({id:e,siteId:n,language:a})=>{if(!e||!n)throw new Error("List ID and Site ID are required");return await this.getPlaylistById(e,void 0,a)});p(this,"getContentSearch",async({siteId:e,params:n})=>await this.doKeyWordSearch({search:n.searchTerm}))}})||qi);const Mh=null,Fh="csai",Bh=null,Uh="xx",Hh={banner:"https://axweb.blob.core.windows.net/assets/img/axinom_email_blasts/ax_logo.png"},Wh=[{contentId:"collection-8",featured:!0,filterTags:"",title:"",type:"playlist"},{type:"favorites",title:"My Favorites"},{type:"continue_watching"},{contentId:"collection-9",featured:!1,filterTags:"Animation",title:"Animation",type:"playlist"},{contentId:"collection-4",enableText:!1,featured:!1,filterTags:"",title:"Top Rated",type:"playlist"}],Vh={accessModel:"free",drm:{defaultPolicyId:""}},qh={enableSharing:"true"},Gh="Axinom Mosaic Web App demo",zh={continueWatchingList:"collection-continueWatchingList",enableCasting:!0,enableSharing:!0,favoritesList:"FAVOURITES",recommendationsPlaylist:"collection-10",searchPlaylist:"KEYWORD-SEARCH"},Kh={},Jh=[{contentId:"collection-10",filterTags:"Action,Adventure,Animation,Biography,Comedy,Crime,Drama,Documentary,Fantasy,Horror,Mystery,Romance,Sci-Fi,Thriller,War",label:"All Movies",type:"playlist"},{contentId:"collection-11",custom:{},filterTags:"Action,Adventure,Animation,Biography,Comedy,Crime,Drama,Documentary,Fantasy,Horror,Mystery,Romance,Sci-Fi,Thriller,War",label:"All Series",type:"playlist"}],Yh="ou7L8htR",Qh="4D7KGvZg",Xh="Axinom Mosaic Web App",Zh={backgroundColor:null,dynamicBlur:!0,footerText:"© Axinom Mosaic | [portal.axinom.com](https://portal.axinom.com/)",headerBackground:null,highlightColor:"#cccccc",posterFading:!0,shelfTitles:!0},ep="2",tp={adConfig:Mh,adDeliveryMethod:Fh,adSchedule:Bh,analyticsToken:Uh,assets:Hh,content:Wh,contentProtection:Vh,custom:qh,description:Gh,features:zh,integrations:Kh,menu:Jh,player:Yh,siteId:Qh,siteName:Xh,styling:Zh,version:ep};var zi,Ki;let sp=(zi=fe(),zi(Ki=class extends Rs{constructor(){super(...arguments);p(this,"enrichConfig",e=>{const{content:n,siteName:a}=e,o=n.map(i=>Object.assign({featured:!1},i));return{...e,siteName:a||xe.t("common:default_site_name"),content:o}});p(this,"loadConfig",async e=>this.enrichConfig(tp))}})||Ki);te.bind(Rs).toSelf();te.bind(Wr).toSelf();te.bind(Vr).toSelf();te.bind(cl).toSelf();te.bind(Ee).toSelf();te.bind(Rn).toSelf();te.bind(On).toSelf();te.bind(zn).toSelf();te.bind(Os).toSelf();te.bind(ps).toSelf();te.bind(ll).toSelf();te.bind(ye).toSelf();te.bind(Tt).toSelf();te.bind(cn).toSelf();te.bind(fn).to(rh).whenTargetNamed(na.jwp);te.bind(fn).to(th).whenTargetNamed(na.viewNexa);te.bind(Fs).toDynamicValue(Eh);te.bind(zc).toDynamicValue(ah);te.bind(ra).toConstantValue(Ih);te.bind(At).toSelf();te.bind(vt).to(dh).whenTargetNamed(Zt.CLEENG);te.bind(Bs).to(uh).whenTargetNamed(Zt.CLEENG);te.bind(Us).to(hh).whenTargetNamed(Zt.CLEENG);te.bind(ra).toConstantValue(Ah);te.bind(Re).toSelf();te.bind(ca).toSelf();te.bind(vt).to(bh).whenTargetNamed(Zt.JWP);te.bind(Bs).to(Ch).whenTargetNamed(Zt.JWP);te.bind(Us).to(Ph).whenTargetNamed(Zt.JWP);te.rebind(Ee).to(Dh);te.rebind(Rs).to(sp);class np extends ia{constructor(t){super(),this.logLevel=t}log(t,e,n,a,o){if(!(t<this.logLevel)){switch(t){case st.ERROR:case st.FATAL:console.error(`${st[t]} [${e}] ${n}`);break;case st.WARN:console.warn(`${st[t]} [${e}] ${n}`);break;default:console.log(`${st[t]} [${e}] ${n}`)}o&&console.error(o),a&&Object.keys(a).length>0&&console.log(a)}}}var Ji,Yi;let rp=(Ji=fe(),Ji(Yi=class extends _e{constructor(){super(...arguments);p(this,"prefix","jwapp")}initialize(e){this.prefix=e}getStorageKey(e){return`${this.prefix}.${e}`}async getItem(e,n,a=!0){try{const o=window.localStorage.getItem(a?this.getStorageKey(e):e);return o&&n?JSON.parse(o):o}catch(o){Ue("LocalStorageService","Failed to parse localStorage entry",{error:o})}}async setItem(e,n,a=!0){try{window.localStorage.setItem(a?this.getStorageKey(e):e,n)}catch(o){Ue("LocalStorageService","Failed to store localStorage entry",{error:o})}}async removeItem(e){try{window.localStorage.removeItem(this.getStorageKey(e))}catch(n){Ue("LocalStorageService","Failed to remove localStorage entry",{error:n})}}base64Encode(e){return window.btoa(e)}base64Decode(e){return window.atob(e)}})||Yi);te.bind(_e).to(rp);te.bind(Kc).toConstantValue(new Rd("jwp-refresh-token-channel"));te.bind(pn).toConstantValue(async()=>void 0);te.bind(ia).toDynamicValue(()=>new np(st.ERROR));const fl=new Od({defaultOptions:{queries:{staleTime:60*60*1e3,refetchOnWindowFocus:!1,retryOnMount:!1}}});function ap({children:s}){return r.jsx(Dd,{client:fl,children:s})}const op="_errorPage_rlhdo_1",ip="_box_rlhdo_17",cp="_title_rlhdo_22",lp="_message_rlhdo_29",dp="_main_rlhdo_33",up="_logo_rlhdo_45",hp="_links_rlhdo_49",pp="_stack_rlhdo_53",mp="_image_rlhdo_58",Ps={errorPage:op,box:ip,title:cp,message:lp,main:dp,logo:up,links:hp,stack:pp,image:mp},rt=({title:s,message:t,learnMoreLabel:e,...n})=>{const{t:a}=T("error");return r.jsx(gl,{title:s||a("generic_error_heading"),message:t||a("generic_error_description"),learnMoreLabel:e||a("learn_more"),...n})},gl=({title:s,children:t,message:e,learnMoreLabel:n,error:a,helpLink:o})=>{const i=z(l=>{var d,h;return(h=(d=l.config)==null?void 0:d.assets)==null?void 0:h.banner});return r.jsx("div",{className:Ps.errorPage,children:r.jsxs("div",{className:Ps.box,children:[r.jsx("img",{className:Ps.image,src:i||"/images/logo.png",alt:""}),r.jsx("h1",{className:Ps.title,"aria-live":"polite",children:s||"An error occurred"}),r.jsxs("div",{className:Ps.main,children:[r.jsx("p",{className:Ps.message,children:e||"Try refreshing this page or come back later."}),t,aa]})]})})},fp="_buffer_rrxgr_1",gp="_small_rrxgr_20",_p="_large_rrxgr_30",ur={buffer:fp,small:gp,large:_p},ys=({size:s="medium",className:t=""})=>r.jsxs("div",{className:F(ur.buffer,t,{[ur.small]:s==="small",[ur.large]:s==="large"}),children:[r.jsx("div",{}),r.jsx("div",{}),r.jsx("div",{}),r.jsx("div",{})]}),yp="_loadingOverlay_96qzh_1",vp="_fixed_96qzh_7",xp="_transparent_96qzh_17",wp="_inline_96qzh_21",Sn={loadingOverlay:yp,fixed:vp,transparent:xp,inline:wp},je=({transparentBackground:s=!1,inline:t=!1})=>{const e=F(Sn.loadingOverlay,{[Sn.transparent]:s,[Sn.fixed]:!t,[Sn.inline]:t});return r.jsx("div",{className:e,children:r.jsx(ys,{size:"medium"})})},bp="_formFeedback_1hyv5_1",Sp="_info_1hyv5_11",jp="_error_1hyv5_16",Cp="_warning_1hyv5_21",Pp="_success_1hyv5_26",Js={formFeedback:bp,info:Sp,error:jp,warning:Cp,success:Pp},Ep={info:"polite",success:"assertive",warning:"polite",error:"assertive"},Oe=({children:s,variant:t="error",visible:e=!0})=>{const n=F(Js.formFeedback,{[Js.error]:t==="error",[Js.warning]:t==="warning",[Js.success]:t==="success",[Js.info]:t==="info",hidden:!e}),a=Ep[t];return r.jsx("div",{"aria-live":a,className:n,children:s})},_l=m.createContext(void 0),Ke=()=>{const s=m.useContext(_l);if(!s)throw new Error("Announcer context is not defined");return s.announce},Ip=({children:s})=>{const[t,e]=m.useState(null),n=m.useCallback((a,o,i=Md(10))=>{e({message:a,variant:o}),setTimeout(()=>{e(null)},i)},[]);return r.jsxs(_l.Provider,{value:{announce:n},children:[t&&wd.createPortal(r.jsx(Oe,{variant:t.variant,visible:!1,children:t.message}),document.body),s]})};function l0(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}const Ap=(s,t)=>t.reduce((e,n)=>{const a=s.find(({code:o})=>o===n);if(a)return[...e,a];throw new Error(`Missing defined language for code: ${n}`)},[]),kp=["account","common","country","demo","epg","error","menu","search","us_state","user","video"],Tp=[{code:"en",displayName:"English"},{code:"es",displayName:"Español"}],Np=async()=>{const s="en,es".split(",")||[],t="en",e=Ap(Tp,s);if(z.setState({supportedLanguages:e}),!e.some(({code:n})=>n===t))throw new Error(`The default language is not enabled: ${t}`);await xe.use(Fd).use(Bd).use(Ud).init({supportedLngs:e.map(({code:n})=>n),fallbackLng:t,returnEmptyString:!1,ns:kp,defaultNS:"common",fallbackNS:"common",interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator"],caches:["localStorage"],lookupLocalStorage:"jwapp.language"},react:{useSuspense:!1}})},yl=(s,t={})=>Se(`${s.pathname}${s.search||""}`,t),J=(s,t,e)=>Se(`${s.pathname}${s.search||""}`,{u:t,...e}),Mt=(s,t)=>Se(window.location.href,{u:s,...t}),he=s=>{const t=m.useRef(()=>{throw new Error("Callback called in render")});return m.useLayoutEffect(()=>{t.current=s},[s]),m.useCallback((...e)=>{if(typeof t.current=="function")return t.current(...e)},[])};function He(s){const[t]=un();return t.get(s)}const Lp=(s,t=1,e)=>{const n=m.useRef(),[a,o]=m.useState(s);return m.useEffect(()=>{if(window.clearTimeout(n.current),a===0){e&&e();return}return n.current=window.setTimeout(()=>{o(i=>i-t)},t*1e3),()=>{window.clearTimeout(n.current)}},[e,a,t]),a},Qi=new $c({defaultScope:"Singleton",skipBaseClassChecks:!0}),vs=(s,t)=>e=>{if(Qi.isBound(s)){const a=Qi.get(s);return r.jsx(a,{...e})}return r.jsx(t,{...e})},$p="_button_15pe7_1",Rp="_disabled_15pe7_21",Op="_small_15pe7_33",Dp="_large_15pe7_36",Mp="_primary_15pe7_46",Fp="_outlined_15pe7_53",Bp="_active_15pe7_56",Up="_text_15pe7_62",Hp="_danger_15pe7_77",Wp="_fullWidth_15pe7_87",Vp="_startIcon_15pe7_101",qp="_hidden_15pe7_119",Gp="_centerAbsolute_15pe7_123",mt={button:$p,disabled:Rp,small:Op,large:Dp,default:"_default_15pe7_39",primary:Mp,outlined:Fp,active:Bp,text:Up,danger:Hp,delete:"_delete_15pe7_82",fullWidth:Wp,startIcon:Vp,hidden:qp,centerAbsolute:Gp},zp=Symbol("BUTTON"),Kp=({label:s,children:t,color:e="default",startIcon:n,fullWidth:a=!1,active:o=!1,variant:i="outlined",size:c="medium",disabled:l,busy:d,type:h="button",to:u,onClick:g,className:y,activeClassname:f="",...x})=>{const w=b=>F(mt.button,y,mt[e],mt[i],{[mt.active]:b,[f]:b,[mt.fullWidth]:a,[mt.large]:c==="large",[mt.small]:c==="small",[mt.disabled]:l}),_=r.jsxs(r.Fragment,{children:[n&&r.jsx("div",{className:mt.startIcon,children:n}),r.jsx("span",{className:F({[mt.hidden]:d})||void 0,children:s}),t,d&&r.jsx(ys,{className:mt.centerAbsolute,size:"small"})]});return u?r.jsx(Mc,{className:({isActive:b})=>w(b),to:u,...x,end:!0,children:_}):r.jsx("button",{className:w(o),onClick:l?void 0:g,type:h,"aria-disabled":l,...x,children:_})},M=vs(zp,Kp),Jp="_welcome_v7d1f_1",Yp={welcome:Jp},Qp=({onCloseButtonClick:s,onCountdownCompleted:t,siteName:e})=>{const{t:n}=T("account"),a=Lp(10,1,t);return r.jsxs("div",{className:Yp.welcome,children:[r.jsx("h2",{children:n("checkout.welcome_title",{siteName:e})}),r.jsx("p",{children:n("checkout.welcome_description",{siteName:e})}),r.jsx(M,{variant:"contained",color:"primary",label:n("checkout.start_watching",{countdown:a}),onClick:s,size:"large",fullWidth:!0})]})},Xp="_title_82pz9_1",Zp="_message_82pz9_6",Xi={title:Xp,message:Zp},Zi=({type:s,message:t,onCloseButtonClick:e})=>{const{t:n}=T("account");return r.jsxs("div",{children:[r.jsx("h2",{className:Xi.title,children:n(s==="cancelled"?"checkout.payment_cancelled":"checkout.payment_error")}),r.jsx("p",{className:Xi.message,children:s==="cancelled"?n("checkout.payment_cancelled_message"):t}),r.jsx("div",{children:r.jsx(M,{label:n("checkout.close"),onClick:e,color:"primary",variant:"contained",size:"large",fullWidth:!0})})]})},em=s=>s==null?void 0:s.scrollTop,ua=({className:s,createStyle:t,open:e=!0,duration:n=250,delay:a=0,onOpenAnimationEnd:o,onCloseAnimationEnd:i,keepMounted:c=!1,children:l})=>{const d=m.useRef(null),[h,u]=m.useState("closed"),[g,y]=m.useState(!1),f=m.useRef(),x=m.useRef(),w=he(()=>{y(!0),em(d.current),f.current=window.setTimeout(()=>u("opening"),a),x.current=window.setTimeout(()=>{u("open"),o&&o()},n+a)}),_=he(()=>{g&&(f.current=window.setTimeout(()=>u("closing"),a),x.current=window.setTimeout(()=>{u("closed"),i&&i()},n+a))});return m.useEffect(()=>(e?w():_(),()=>{clearTimeout(f.current),clearTimeout(x.current)}),[e,w,_]),!e&&h==="closed"&&!c?null:r.jsx("div",{style:t(h),className:s,ref:d,children:l})},tm=({open:s=!0,duration:t=250,delay:e=0,onOpenAnimationEnd:n,onCloseAnimationEnd:a,children:o,className:i})=>{const l=`transform ${t/1e3}s ease-out`,d=h=>({transition:l,transform:h==="opening"||h==="open"?"scale(1)":"scale(0.7)"});return r.jsx(ua,{createStyle:h=>d(h),open:s,duration:t,delay:e,onOpenAnimationEnd:n,onCloseAnimationEnd:a,className:i,children:o})},sm=!!(typeof window<"u"&&window.document&&window.document.createElement);let jn;function nm(s){if((!jn&&jn!==0||s)&&sm){const t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),jn=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return jn}const rm=s=>new Promise(t=>{const e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=s,e.onload=()=>t(),e.onerror=n=>{throw console.info("Error loading external script",n),new Error("Error loading external script")},document.body.appendChild(e)}),am=()=>{document.body.style.marginRight=`${nm(!0)}px`,document.body.style.overflowY="hidden"},ec=()=>{Array.from(document.querySelectorAll("dialog")).filter(e=>e.open).length||(document.body.style.removeProperty("margin-right"),document.body.style.removeProperty("overflow-y"))};let Ys;const om=()=>{const s=m.useCallback(()=>{if(!Ys||document.activeElement!==document.body)return;Array.from(document.querySelectorAll("dialog")).filter(o=>o.open).length===0&&(Ys.focus(),Ys=void 0)},[]);m.useEffect(()=>()=>{ec(),s()},[s]);const t=m.useCallback(()=>{Ys||(Ys=document.activeElement),am()},[]),e=m.useCallback(()=>{s(),ec()},[s]);return{handleOpen:t,handleClose:e}},im="_centered_evruy_15",cm="_close_evruy_21",Cn={centered:im,close:cm,"fade-out":"_fade-out_evruy_1","fade-in":"_fade-in_evruy_1"},Jn=({open:s,onClose:t,children:e,className:n,centered:a,role:o,AnimationComponent:i=tm,animationContainerClassName:c,...l})=>{const d=m.useRef(),h=m.useRef({downTarget:null,upTarget:null}),{handleOpen:u,handleClose:g}=om(),y=he(()=>{var C;const v=()=>{var j,S;(j=d.current)==null||j.classList.remove(Cn.close),(S=d.current)==null||S.removeEventListener("animationend",v)};(C=d.current)!=null&&C.open&&(d.current.addEventListener("animationend",v),d.current.classList.add(Cn.close))}),f=he(()=>{var v,C;u(),(v=d.current)==null||v.showModal(),(C=d.current)==null||C.classList.remove(Cn.close)}),x=v=>{v.key==="Escape"&&d.current.contains(v.target)&&(v.preventDefault(),t==null||t())},w=v=>{d.current.contains(v.target)&&(t==null||t(),g())},_=()=>{var v;(v=d.current)==null||v.close()};m.useEffect(()=>{s?f():y()},[f,y,s]);const b=v=>{const{current:{downTarget:C,upTarget:j}}=h;C===j&&v.target===d.current&&(t==null||t(),g())};return bd.createPortal(r.jsx("dialog",{className:F(n,{[Cn.centered]:a}),onKeyDown:x,onClose:w,onClick:b,onMouseDown:v=>{h.current.downTarget=v.target},onMouseUp:v=>{h.current.upTarget=v.target},ref:d,role:o,...l,children:r.jsx(i,{open:s,duration:300,className:c,onCloseAnimationEnd:_,children:e})}),document.querySelector("body"))},ha=({open:s=!0,duration:t=250,delay:e=0,onOpenAnimationEnd:n,onCloseAnimationEnd:a,children:o,direction:i="top",style:c={}})=>{const l=t/1e3,d=`transform ${l}s ease, opacity ${l}s ease`,h={left:"translate(-15px, 0)",top:"translate(0, -15px)",right:"translate(15px, 0)",bottom:"translate(0, 15px)"},u=g=>({transition:d,transform:g==="opening"||g==="open"?"translate(0, 0)":h[i],opacity:g==="opening"||g==="open"?1:0,zIndex:15,...c});return r.jsx(ua,{createStyle:g=>u(g),open:s,duration:t,delay:e,onOpenAnimationEnd:n,onCloseAnimationEnd:a,children:o})},Yn=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),m.createElement("path",{d:"M0 0h24v24H0z",fill:"none"})),lm="_iconButton_12yfl_1",dm={iconButton:lm},ze=({children:s,onClick:t,className:e,...n})=>r.jsx("button",{className:F(dm.iconButton,e),type:"button",onClick:t,...n,children:s}),um="_icon_1me4h_1",hm={icon:um},K=({icon:s,className:t})=>r.jsx(s,{className:F(hm.icon,t),"aria-hidden":"true"}),pm="_modalCloseButton_1qofm_1",mm="_hidden_1qofm_15",tc={modalCloseButton:pm,hidden:mm},vl=({onClick:s,visible:t=!0})=>{const{t:e}=T("common");return r.jsx(ze,{onClick:s,"aria-label":e("close_modal"),className:F(tc.modalCloseButton,{[tc.hidden]:!t}),children:r.jsx(K,{icon:Yn})})},fm="_dialog_1ha9n_1",gm="_small_1ha9n_16",_m="_large_1ha9n_20",sc={dialog:fm,small:gm,large:_m},pa=({open:s,onClose:t,children:e,size:n="small",role:a,...o})=>r.jsx(Jn,{open:s,onClose:t,AnimationComponent:ha,role:a,centered:!0,children:r.jsxs("div",{className:F(sc.dialog,sc[n]),"data-testid":void 0,...o,children:[e,r.jsx(vl,{onClick:t})]})});function Nt({initialValues:s,validationSchema:t,validateOnBlur:e=!1,onSubmit:n,onSubmitSuccess:a,onSubmitError:o}){const{t:i}=T("error"),[c,l]=m.useState(Object.fromEntries(Object.keys(s).map(P=>[P,!1]))),[d,h]=m.useState(s),[u,g]=m.useState(!1),[y,f]=m.useState({}),[x,w]=m.useState(!1),_=m.useCallback(()=>{h(s),f({}),w(!1),g(!1),l(Object.fromEntries(Object.keys(s).map(P=>[P,!1])))},[s]),b=(P,I)=>{if(t)try{t.validateSyncAt(P,I),f(k=>({...k,[P]:null}))}catch(k){if(k instanceof Fa){const $=k.errors[0];f(L=>({...L,[P]:$})),w(!0)}}},v=m.useCallback((P,I)=>{h(k=>({...k,[P]:I}))},[]),C=P=>{const I=P.target.name,k=P.target instanceof HTMLInputElement&&P.target.type==="checkbox"?P.target.checked:P.target.value,$={...d,[I]:k};h($),l(L=>({...L,[I]:k})),y[I]&&b(I,$)},j=P=>{!e||!c[P.target.name]||b(P.target.name,d)},S=P=>{try{return P.validateSync(d,{abortEarly:!1}),!0}catch(I){if(I instanceof Fa){const k={};for(let $=0;$<I.inner.length;$++){const L=I.inner[$].path,D=I.inner[$].errors[0];L&&D&&!k[L]&&(k[L]=D)}I.inner.every($=>$.type==="required")?k.form=i("validation_form_error.required"):k.form=i("validation_form_error.other"),f(k)}}return!1};return{values:d,errors:y,validationSchemaError:x,handleChange:C,handleBlur:j,handleSubmit:async P=>{if(P.preventDefault(),!(!n||u)){if(f({}),w(!1),t&&!S(t)){w(!0);return}g(!0);try{await n(d,{setValue:v,setErrors:f,setSubmitting:g,setValidationSchemaError:w,validate:S}),a==null||a(d)}catch(I){const k={};I instanceof Ze?Object.entries(I.errors).forEach(([$,L])=>{$&&L&&!k[$]&&(k[$]=L.join(","))}):I instanceof Error?k.form=I.message:k.form=i("unknown_error"),f(k),o==null||o({error:I,resetValue:$=>v($,"")})}g(!1)}},submitting:u,setValue:v,setErrors:f,setSubmitting:g,setValidationSchemaError:w,reset:_}}const ma=(s=!1)=>{const[t,e]=m.useState(s);return[t,a=>e(o=>typeof a<"u"?a:!o)]},fa=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"})),ga=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M11.83,9L15,12.16C15,12.11 15,12.05 15,12A3,3 0 0,0 12,9C11.94,9 11.89,9 11.83,9M7.53,9.8L9.08,11.35C9.03,11.56 9,11.77 9,12A3,3 0 0,0 12,15C12.22,15 12.44,14.97 12.65,14.92L14.2,16.47C13.53,16.8 12.79,17 12,17A5,5 0 0,1 7,12C7,11.21 7.2,10.47 7.53,9.8M2,4.27L4.28,6.55L4.73,7C3.08,8.3 1.78,10 1,12C2.73,16.39 7,19.5 12,19.5C13.55,19.5 15.03,19.2 16.38,18.66L16.81,19.08L19.73,22L21,20.73L3.27,3M12,7A5,5 0 0,1 17,12C17,12.64 16.87,13.26 16.64,13.82L19.57,16.75C21.07,15.5 22.27,13.86 23,12C21.27,7.61 17,4.5 12,4.5C10.6,4.5 9.26,4.75 8,5.2L10.17,7.35C10.74,7.13 11.35,7 12,7Z"})),nc=(s,t)=>{const e=Math.random()*1e4;return[s,Math.round(e),t].filter(Boolean).join("_").replace(/[\s.]+/g,"_").toLowerCase()},pt=(s,t,e)=>{const[n,a]=m.useState(e||nc(s,t));return m.useEffect(()=>{a(e||nc(s,t))},[e,s,t]),n},ym="_helperText_1u6a3_1",vm="_error_1u6a3_6",rc={helperText:ym,error:vm},xm=({children:s,className:t,error:e,id:n})=>{const a=pt("helper_text",void 0,n);return s?r.jsx("div",{id:a,className:F(rc.helperText,{[rc.error]:e},t),children:s}):null},wm="_formField_130lt_1",bm="_label_130lt_6",ac={formField:wm,label:bm},gn=({className:s,renderInput:t,required:e,label:n,error:a,helperText:o,testId:i,editing:c=!0,name:l})=>{const d=F(ac.formField,s),h=pt("text-field",l),u=pt("helper_text",l);return r.jsxs("div",{className:d,"data-testid":i,children:[!!n&&r.jsxs("label",{htmlFor:h,className:ac.label,children:[n,e&&c?r.jsx("span",{"aria-hidden":"true",children:"*"}):null]}),t({helperTextId:u,id:h}),c&&r.jsx(xm,{id:u,error:a,children:o})]})},Sm="_container_bm5y7_1",jm="_error_bm5y7_10",Cm="_disabled_bm5y7_13",Pm="_leftControl_bm5y7_16",Em="_input_bm5y7_16",Im="_rightControl_bm5y7_19",Am="_control_bm5y7_31",Kt={container:Sm,error:jm,disabled:Cm,leftControl:Pm,input:Em,rightControl:Im,control:Am},km=(s,t)=>!!t,Tm=({required:s,className:t,disabled:e,editing:n=!0,value:a,id:o,name:i,multiline:c,error:l,helperTextId:d,type:h,textAreaRef:u,inputRef:g,leftControl:y,rightControl:f,...x})=>{const w=h||"text",_=F(Kt.container,{[Kt.error]:l,[Kt.disabled]:e,[Kt.leftControl]:!!y,[Kt.rightControl]:!!f},t),b={"aria-required":!!s,"aria-invalid":!!(s&&l&&a!==""),"aria-describedby":d},v={id:o,name:i,value:a,disabled:e,rows:c?3:void 0,className:Kt.input,readOnly:!n,required:s,...b,...x},C=km(v,c)?r.jsx("textarea",{...v,ref:u}):r.jsx("input",{...v,type:w,ref:g});return n?r.jsxs("div",{className:_,children:[y?r.jsx("div",{className:Kt.control,children:y}):null,C,f?r.jsx("div",{className:Kt.control,children:f}):null]}):C},Nm="_textField_cksfq_1",Lm={textField:Nm},me=({className:s,helperText:t,label:e,error:n,required:a,editing:o=!0,testId:i,name:c,...l})=>r.jsx(gn,{className:F(Lm.textField,s),error:n,helperText:t,label:e,required:a,editing:o,testId:i,name:c,renderInput:d=>r.jsx(Tm,{editing:o,error:n,name:c,required:a,...d,...l})}),$m="_passwordStrength_1od1i_1",Rm="_passwordStrengthFill_1od1i_9",Om="_label_1od1i_13",Dm="_passwordStrengthBar_1od1i_38",Pn={passwordStrength:$m,passwordStrengthFill:Rm,label:Om,passwordStrengthBar:Dm},Mm=/^(?=.*[a-z])(?=.*[0-9]).{8,}$/,Fm=({password:s})=>{const{t}=T("account"),n=(o=>{let i=0;return o.match(Mm)&&(o.match(/[A-Z]+/)&&(i+=1),o.match(/(\d.*\d)/)&&(i+=1),o.match(/[!,@#$%^&*?_~]/)&&(i+=1),o.match(/([!,@#$%^&*?_~].*[!,@#$%^&*?_~])/)&&(i+=1)),i})(s),a=[t("registration.password_strength.invalid"),t("registration.password_strength.weak"),t("registration.password_strength.fair"),t("registration.password_strength.strong"),t("registration.password_strength.very_strong")];return n?r.jsxs("div",{className:Pn.passwordStrength,"data-strength":n,children:[r.jsx("div",{className:Pn.passwordStrengthBar,children:r.jsx("div",{className:Pn.passwordStrengthFill})}),r.jsx("span",{className:"hidden",children:t("registration.password_strength_prefix")})," ",r.jsx("span",{className:Pn.label,children:a[n]})]}):null},an=({value:s,showToggleView:t=!0,helperText:e,showHelperText:n=!0,...a})=>{const{t:o}=T("account"),[i,c]=ma();return r.jsx(me,{...a,helperText:e??(n?r.jsxs(Ne.Fragment,{children:[r.jsx(Fm,{password:s||""}),o("reset.password_helper_text")]}):null),type:i?"text":"password",rightControl:t?r.jsx(ze,{"aria-label":o("reset.view_password"),onClick:()=>c(),"aria-pressed":i,children:r.jsx(K,{icon:i?fa:ga})}):null,required:!0})},Bm="_heading_1ungm_1",Um="_paragraph_1ungm_7",Hm="_disclaimer_1ungm_11",Wm="_buttons_1ungm_25",Vm="_stacked_1ungm_34",qm="_warningBox_1ungm_40",Jt={heading:Bm,paragraph:Um,disclaimer:Hm,buttons:Wm,stacked:Vm,warningBox:qm},Gm=()=>{const s=q(ye),{t}=T("user"),e=Ke(),n=He("u"),[a,o]=m.useState(""),i=ae(),c=ue(),{handleSubmit:l,handleChange:d,values:h,errors:u,setErrors:g,reset:y}=Nt({initialValues:{password:""},validationSchema:ne().shape({password:B().required(t("login.field_required"))}),onSubmit:w=>{o(w.password),i(J(c,"delete-account-confirmation"),{replace:!0})}}),f=ut(s.deleteAccountData,{onSuccess:async()=>{i("/"),await s.logout(),e(t("account.delete_account.success"),"success")},onError:w=>{w instanceof Ze&&(g(w.errors),i(J(c,"delete-account"),{replace:!0})),o("")}});m.useEffect(()=>{n==="delete-account-confirmation"&&!a&&i(J(c,"delete-account"),{replace:!0})},[c,n,i,a,f,y]);const x=m.useCallback(()=>{i(J(c,null),{replace:!0})},[c,i]);return a?r.jsxs("div",{children:[r.jsx("h2",{className:Jt.heading,children:t("account.delete_account.title")}),r.jsxs("div",{className:Jt.disclaimer,children:[r.jsx("p",{children:t("account.delete_account.modal.text_data_erasure")}),r.jsx("p",{children:t("account.delete_account.modal.text_revoked_access")}),r.jsx("div",{className:Jt.warningBox,children:r.jsx("p",{children:t("account.delete_account.modal.warning")})}),r.jsxs("p",{children:[t("account.delete_account.modal.text_cant_be_undone")," ",r.jsx("br",{}),t("account.delete_account.modal.text_contacts")]})]}),r.jsxs("div",{className:Jt.buttons,children:[r.jsx(M,{disabled:f.isLoading,variant:"text",label:t("account.cancel"),onClick:x}),r.jsx(M,{disabled:f.isLoading,variant:"delete",label:t("account.delete_account.title"),onClick:()=>{f.mutate(a)}})]})]}):r.jsxs("form",{onSubmit:l,children:[r.jsx("h2",{className:Jt.heading,children:t("account.delete_account.title")}),r.jsx("p",{className:Jt.paragraph,children:t("account.delete_account.modal.description")}),u.form&&r.jsx(Oe,{variant:"error",children:u.form}),r.jsx(an,{value:h.password,onChange:d,label:t("account.password"),placeholder:t("account.delete_account.modal.placeholder"),error:!!u.password||!!u.form,helperText:u.password,name:"password",showHelperText:!1}),r.jsxs("div",{className:F(Jt.buttons,Jt.stacked),children:[r.jsx(M,{type:"submit",color:"primary",label:t("account.continue"),fullWidth:!0}),r.jsx(M,{type:"button",onClick:x,variant:"text",label:t("account.cancel"),fullWidth:!0})]})]})},zm="_container_lkpac_1",Km="_title_lkpac_7",oc={container:zm,title:Km},Jm=()=>{const s=q(ye),t=q(Tt),{t:e}=T("account"),n=Ke(),a=ae(),o=ue(),{accessModel:i}=z(({accessModel:f})=>({accessModel:f})),[c]=un(),l=c.get("redirectResult"),d=c.get("orderId"),[h,u]=m.useState(),g=m.useMemo(()=>J(o,i===Me.SVOD?"welcome":null),[i,o]),y=he(async f=>{const x=d?parseInt(d,10):void 0;try{await t.finalizeAdyenPayment({redirectResult:decodeURI(f)},x),await s.reloadSubscriptions({retry:10}),n(e("checkout.payment_success"),"success"),a(g)}catch(w){w instanceof Error&&u(w.message)}});return m.useEffect(()=>{l&&y(l)},[y,l]),r.jsx("div",{className:oc.container,children:h?r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:oc.title,children:h}),r.jsx(M,{label:e("checkout.go_back_to_checkout"),variant:"contained",color:"primary",size:"large",onClick:()=>a(J(o,"checkout")),fullWidth:!0})]}):r.jsx("div",{children:r.jsx(ys,{})})})},Ym=()=>{const s=q(ye),t=q(Tt),e=m.useRef(),[n,a]=m.useState(null),{t:o}=T("user"),i=t.getSubscriptionOfferIds(),c=m.useCallback(({interval:l=3e3,iterations:d=5,offerId:h=i==null?void 0:i[0],callback:u})=>{if(!h){u==null||u({hasAccess:!1,offerId:""});return}e.current=window.setInterval(async()=>{await s.checkEntitlements(h)?(window.clearInterval(e.current),await s.reloadSubscriptions(),u==null||u({hasAccess:!0,offerId:h||""})):--d===0&&(window.clearInterval(e.current),a(o("payment.longer_than_usual")),u==null||u({hasAccess:!1,offerId:h||""}))},l)},[i,o,s]);return m.useEffect(()=>()=>{window.clearInterval(e.current)},[]),{intervalCheckAccess:c,errorMessage:n}},Qm="_center_153q1_1",Xm={center:Qm},Zm=()=>{const{t:s}=T("account"),t=He("offerId")||void 0,e=ue(),n=ae(),a=Ke(),{intervalCheckAccess:o,errorMessage:i}=Ym();return m.useEffect(()=>{o({interval:3e3,iterations:5,offerId:t,callback:({hasAccess:c,offerId:l})=>{c&&(a(s("checkout.payment_success"),"success"),l.startsWith("C")||l.startsWith("P")?n(J(e,null)):n(J(e,"welcome")))}})},[]),r.jsx("div",{className:Xm.center,children:i?r.jsx("h2",{children:i}):r.jsxs(r.Fragment,{children:[r.jsx(ys,{}),r.jsx("h2",{children:s("checkout.waiting_for_payment")})]})})},ef="_title_1edbn_1",tf="_message_1edbn_8",ic={title:ef,message:tf},hr=({type:s,onCloseButtonClick:t})=>{const{t:e}=T("account"),n=Ke(),a=e(`checkout.upgrade_${s}`),o=e(`checkout.upgrade_${s}_message`);return m.useEffect(()=>{const i={error:"error",success:"succes",pending:"info"}[s];n(o,i)},[n,o,s]),r.jsxs("div",{children:[r.jsx("h2",{className:ic.title,children:a}),r.jsx("p",{className:ic.message,children:o}),r.jsx("div",{children:r.jsx(M,{label:e("checkout.close"),onClick:t,color:"primary",variant:"contained",size:"large",fullWidth:!0})})]})},sf="_formFeedback_173nk_1",nf="_formContainer_173nk_5",rf="_passwordButtonsContainer_173nk_13",af="_buttonsContainer_173nk_21",of="_heading_173nk_30",cf="_paragraph_173nk_40",lf="_button_173nk_21",rs={formFeedback:sf,formContainer:nf,passwordButtonsContainer:rf,buttonsContainer:af,heading:of,paragraph:cf,button:lf},df=()=>{const s=q(ye),{t}=T("user"),e=U(d=>{var h;return(h=d.user)==null?void 0:h.email}),[n,a]=m.useState(),o=ae(),i=ue(),c=m.useCallback(()=>{o(J(i,null),{replace:!0})},[i,o]),l=async()=>{try{e&&(await s.resetPassword(e,""),o(J(i,"add-password")))}catch{a(t("account.add_password_error"))}};return r.jsxs("div",{className:rs.formContainer,children:[n&&r.jsx("div",{className:rs.formFeedback,children:r.jsx(Oe,{variant:"error",children:n})}),r.jsx("h2",{className:rs.heading,children:t("account.delete_account_password_warning.title")}),r.jsx("p",{className:rs.paragraph,children:t("account.delete_account_password_warning.text")}),r.jsxs("div",{className:rs.passwordButtonsContainer,children:[r.jsx(M,{type:"submit",onClick:l,className:rs.button,color:"primary",fullWidth:!0,label:t("account.proceed_to_adding_a_password")}),r.jsx(M,{type:"button",onClick:c,className:rs.button,variant:"text",fullWidth:!0,label:t("account.cancel")})]})]})},xl=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{fill:"currentColor",d:"M20,8H4V6H20M20,18H4V12H20M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z"})),_a=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M7.37083 12.6026c-.70164 0-1.28549-.0571-1.72496-.1142l-1.34375 6.9595H.179688L3.83225.516163C5.08988.201006 7.07827 0 8.97801 0c1.75279 0 3.79949.286619 5.23309 1.28917 1.3172.88839 2.1354 2.23464 2.1354 4.0958 0 2.4344-1.1386 4.26703-2.6901 5.44083-1.6084 1.2333-3.8881 1.7768-6.28557 1.7768zm1.72496-9.30834c-.78902 0-1.34375.05832-1.69457.14393L6.28924 9.13832c.43821.08561.90681.14269 1.60845.14269 2.54311 0 4.20851-1.60433 4.20851-3.52257 0-1.8624-1.3741-2.46418-3.01041-2.46418zm7.22271.21844c.523.18487 1.0195.4169 1.4552.72213 1.3158.88715 2.1353 2.23339 2.1365 4.09456 0 2.43441-1.1398 4.26701-2.69 5.44201-1.6084 1.2321-3.8869 1.7756-6.2856 1.7756-.7016 0-1.28676-.0571-1.72497-.1154l-1.34501 6.9595H3.74219l.31915-1.6577h1.30702l1.34502-6.9582c.4382.057 1.02206.1141 1.72496.1141 2.39746 0 4.67586-.5447 6.28556-1.7755 1.549-1.1738 2.6888-3.00769 2.6888-5.44209 0-1.29909-.4053-2.34258-1.0942-3.15901z"})),uf="_title_1tanv_1",hf="_success_1tanv_8",pf="_paymentMethodsInputs_1tanv_12",mf="_paymentMethod_1tanv_12",ff="_paymentMethodLabel_1tanv_22",gf="_radio_1tanv_30",$t={title:uf,success:hf,paymentMethodsInputs:pf,paymentMethod:mf,paymentMethodLabel:ff,radio:gf},_f=({paymentMethodId:s,paymentMethods:t,onCloseButtonClick:e,onPaymentMethodChange:n,renderPaymentMethod:a,submitting:o,updateSuccess:i})=>{const{t:c}=T("account"),l=Ke(),d=t==null?void 0:t.find(u=>u.methodName==="card"),h=t==null?void 0:t.find(u=>u.methodName==="paypal");return m.useEffect(()=>{i&&l(c("checkout.payment_success"),"success")},[i,l,c]),r.jsxs(r.Fragment,{children:[r.jsx("h1",{className:$t.title,children:c("payment.update_payment_details")}),i?r.jsxs(r.Fragment,{children:[r.jsx("p",{className:$t.success,children:c("payment.update_payment_success")}),r.jsx(M,{label:c("payment.back_to_profile"),onClick:e,color:"primary",fullWidth:!0})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:$t.paymentMethodsInputs,children:[d?r.jsxs("div",{className:$t.paymentMethod,children:[r.jsx("input",{className:$t.radio,type:"radio",name:"paymentMethod",value:d.id,id:"card",checked:s===d.id,onChange:n}),r.jsxs("label",{className:$t.paymentMethodLabel,htmlFor:"card",children:[r.jsx(K,{icon:xl}),c("payment.credit_card")]})]}):null,h?r.jsxs("div",{className:$t.paymentMethod,children:[r.jsx("input",{className:$t.radio,type:"radio",name:"paymentMethod",value:h.id,id:"paypal",checked:s===h.id,onChange:n}),r.jsxs("label",{className:$t.paymentMethodLabel,htmlFor:"paypal",children:[r.jsx(K,{icon:_a})," ",c("payment.paypal")]})]}):null]}),r.jsx("div",{children:a?a():null}),o&&r.jsx(je,{transparentBackground:!0,inline:!0})]})]})},yf="_payPal_17v1t_1",vf={payPal:yf},wl=({onSubmit:s,error:t})=>{const{t:e}=T("account");return r.jsxs("div",{className:vf.payPal,children:[t?r.jsx(Oe,{variant:"error",children:t}):null,r.jsx("p",{children:e("checkout.paypal_instructions")}),r.jsx(M,{label:e("checkout.continue"),variant:"contained",color:"primary",size:"large",onClick:s,fullWidth:!0})]})},xf="_adyen_1wab6_1",wf="_container_1wab6_5",cc={adyen:xf,container:wf},bl=({configuration:s,error:t,type:e})=>{const{t:n}=T("account"),a=m.useRef(null),o=m.useRef();return m.useEffect(()=>!a.current||!s.session?void 0:((async()=>{var l;const c=await Hd(s);a.current&&(o.current=c.create(e),(l=o.current)==null||l.mount(a.current))})(),()=>{var c;(c=o.current)==null||c.unmount()}),[s,e]),r.jsxs("div",{className:cc.adyen,children:[t?r.jsx(Oe,{variant:"error",children:t}):null,r.jsx("div",{className:cc.container,ref:a}),r.jsx(M,{label:n("checkout.continue"),variant:"contained",color:"primary",size:"large",onClick:()=>{o.current&&o.current.submit()},fullWidth:!0})]})};function bf({setProcessing:s,type:t,setPaymentError:e,error:n,paymentMethodId:a}){const o=q(ye),i=q(Tt),c=o.getSandbox(),{t:l}=T("account"),d=Ke(),h=ae(),u=ue(),[g,y]=m.useState(),f=He("redirectResult"),x=!!f,w=J(u,"payment-method-success"),_=he(async C=>{try{s(!0),await i.finalizeAdyenPaymentDetails({redirectResult:decodeURI(C)},a),await o.reloadSubscriptions({retry:10}),s(!1),d(l("checkout.payment_success"),"success"),h(w)}catch(j){s(!1),j instanceof Error&&(e(j.message),h(J(u,"payment-method"),{replace:!0}))}});m.useEffect(()=>{f&&_(f)},[_,f]),m.useEffect(()=>{if(x)return;(async()=>{s(!0);try{const j=await i.createAdyenPaymentSession(window.origin,!1);y(j)}catch(j){j instanceof Error&&e(j.message)}s(!1)})()},[s,e,x,h,u,i]);const b=m.useCallback(async(C,j)=>{if(C.isValid){try{s(!0),e(void 0);const S=Mt("payment-method",{paymentMethodId:`${a}`}),E=await i.addAdyenPaymentDetails(C.data.paymentMethod,a,S);"action"in E&&j(E.action),await o.reloadSubscriptions({retry:5}),h(w,{replace:!0})}catch(S){S instanceof Error&&e(S.message)}s(!1)}},[h,a,w,e,s,o,i]),v=m.useMemo(()=>({session:g,showPayButton:!1,environment:c?"test":"live",clientKey:c?qc:Gc,paymentMethodsConfiguration:{card:{hasHolderName:!0,holderNameRequired:!0}},onAdditionalDetails:async C=>{try{s(!0),await i.finalizeAdyenPayment(C.data.details,a),h(w,{replace:!0})}catch(j){j instanceof Error&&(e(j.message),s(!1))}},onSubmit:(C,j)=>b(C,j.handleAction),onError:C=>e(C.message)}),[g,c,s,a,h,w,e,b,i]);return r.jsx(bl,{configuration:v,type:t,error:n})}const Sf=({onCloseButtonClick:s})=>{const t=q(Tt),e=He("u")==="payment-method-success",n=He("paymentMethodId"),a=n?parseInt(n):void 0,o=U(_=>_.activePayment),i=o==null?void 0:o.id,[c,l]=m.useState(void 0),[d,h]=m.useState(a),u=be(_=>_.paymentMethods),[g,y]=m.useState(!1);m.useEffect(()=>{t.getPaymentMethods()},[t]);const f=_=>{const b=parseInt(_.target.value);h(b),l(void 0)},x=async()=>{y(!0);try{l(void 0);const _=Mt("payment-method-success"),b=Mt("waiting-for-payment"),v=Mt("payment-cancelled"),C=Mt("payment-error"),j=await t.updatePayPalPaymentMethod(_,b,v,C,d,i);j&&(window.location.href=j.redirectUrl)}catch(_){_ instanceof Error&&l(_.message)}y(!1)},w=()=>{const _=u==null?void 0:u.find(b=>b.id===d);return(_==null?void 0:_.methodName)==="card"?r.jsx(bf,{paymentMethodId:_.id,setPaymentError:l,setProcessing:y,error:c,type:"card"}):(_==null?void 0:_.methodName)==="paypal"?r.jsx(wl,{onSubmit:x,error:c||null}):null};return u?r.jsx(_f,{onCloseButtonClick:s,paymentMethods:u,paymentMethodId:d,onPaymentMethodChange:f,renderPaymentMethod:w,updateSuccess:e,submitting:g}):r.jsx("div",{style:{height:300},children:r.jsx(je,{inline:!0})})},jf="_title_11svw_1",Cf="_cancelButton_11svw_7",lc={title:jf,cancelButton:Cf},Pf=({renderPaymentMethod:s,submitting:t,onCancel:e})=>{const{t:n}=T(["common","user"]);return r.jsxs("div",{children:[r.jsx("div",{className:lc.title,children:r.jsx("h1",{children:n("user:payment.add_card_details")})}),r.jsx("div",{children:s?s():null}),r.jsx(M,{onClick:e,className:lc.cancelButton,fullWidth:!0,label:n("common:confirmation_dialog.close")}),t&&r.jsx(je,{transparentBackground:!0,inline:!0})]})},Sl=({value:s,onChange:t,error:e,...n})=>{const{t:a}=T("user"),o=i=>{const c=i.target.value.replace(/\D+/g,"");t&&(i.target.value=c.slice(0,4),t(i))};return r.jsx(me,{label:a("payment.security_code"),"aria-label":a("payment.security_code"),...n,error:!!e,helperText:e||null,name:"cardCVC",className:"directPostSecurityCode",type:"text",value:s,onChange:o,pattern:"\\d*",placeholder:"###",autoComplete:"cc-csc",required:!0})},jl=({value:s,onChange:t,error:e,...n})=>{const{t:a}=T("account"),o=i=>{let c=i.target.value.replace(/\D+/g,"");c.length===1?Number(c)>1&&(c="0"+c):c.length===2&&Number(c)>12&&(c="12"),c.length>=3?i.target.value=`${c.slice(0,2)}/${c.slice(2,4)}`:i.target.value=c,t&&t(i)};return r.jsx(me,{label:a("payment.credit_card_expiry_date"),...n,name:"cardExpiry",className:"directPostExpiryDate",value:s,error:!!e,helperText:e||null,onChange:o,type:"text",pattern:"\\d*",placeholder:"MM/YY",autoComplete:"cc-exp",required:!0})},Ef="_cardTypeWrapper_lfmk2_1",If={cardTypeWrapper:Ef},En={visa:"/images/payments/visa.svg",mastercard:"/images/payments/mastercard.svg",maestro:"/images/payments/maestro.svg",amex:"/images/payments/amex.svg",discover:"/images/payments/discover.svg",diners:"/images/payments/diners.svg",dinersclub:"/images/payments/diners.svg",unionpay:"/images/payments/unionpay.svg",hiper:"/images/payments/hiper.svg"},Cl=({value:s,error:t,onChange:e,onBlur:n,...a})=>{const{t:o}=T("account"),[i,c]=m.useState(null),l=d=>{var y,f;const h=gt.fns.cardType((y=d.target)==null?void 0:y.value),u=(f=d.target)==null?void 0:f.value.replace(/\D+/g,"");let g;switch(c(En!=null&&En[h]?r.jsx("div",{className:If.cardTypeWrapper,children:r.jsx("img",{src:En[h],alt:h,height:"25"})}):null),h){case"amex":g=`${u.slice(0,4)} ${u.slice(4,10)} ${u.slice(10,15)}`;break;case"dinersclub":g=`${u.slice(0,4)} ${u.slice(4,10)} ${u.slice(10,14)}`;break;default:g=`${u.slice(0,4)} ${u.slice(4,8)} ${u.slice(8,12)} ${u.slice(12,16)}`;break}e&&(d.target.value=g.trim(),e(d))};return r.jsx(me,{value:s,name:"cardNumber",label:o("payment.credit_card_number"),className:"directPostCreditCardNumber",onChange:l,onBlur:n,error:!!t,helperText:t||null,pattern:"\\d*",...a,type:"text",placeholder:"1234 5678 9012 3456",rightControl:i,autoComplete:"cc-number",required:!0})},Af="_paymentForm_g66uf_1",kf="_columns_g66uf_6",dc={paymentForm:Af,columns:kf},Tf=({onCancel:s,setUpdatingCardDetails:t})=>{var d,h,u,g,y,f,x,w;const e=q(ye),n=Ke(),{t:a}=T("account"),{mutate:o,isLoading:i}=ut(e.updateCardDetails),{activePayment:c}=U(({activePayment:_})=>({activePayment:_}),de),l=Nt({initialValues:{cardholderName:"",cardNumber:"",cardExpiry:"",cardCVC:"",cardExpMonth:"",cardExpYear:""},validationSchema:ne().shape({cardholderName:B().required(),cardNumber:B().required().test("card number validation",a("checkout.invalid_card_number"),_=>gt.fns.validateCardNumber(_)),cardExpiry:B().required().test("card expiry validation",a("checkout.invalid_card_expiry"),_=>gt.fns.validateCardExpiry(_)),cardCVC:B().required().test("cvc validation",a("checkout.invalid_cvc_number"),_=>{var v;const b=gt.fns.cardType((v=l==null?void 0:l.values)==null?void 0:v.cardNumber);return gt.fns.validateCardCVC(_,b)}),cardExpMonth:B().required(),cardExpYear:B().required()}),validateOnBlur:!0,onSubmit:async()=>{t(!0),o({cardName:l.values.cardholderName,cardNumber:l.values.cardNumber.replace(/\s+/g,""),cvc:parseInt(l.values.cardCVC),expMonth:parseInt(l.values.cardExpMonth),expYear:parseInt(l.values.cardExpYear),currency:(c==null?void 0:c.currency)||""},{onSettled:()=>s(),onSuccess:()=>{n(a("checkout.card_details_updated"),"success")}})}});return m.useEffect(()=>{if(l.values.cardExpiry){const _=gt.fns.cardExpiryVal(l.values.cardExpiry);_.month&&l.setValue("cardExpMonth",_.month.toString()),_.year&&l.setValue("cardExpYear",_.year.toString())}},[l.values.cardExpiry]),r.jsxs("div",{className:dc.paymentForm,children:[r.jsx("div",{children:r.jsx(me,{label:a("checkout.card_holder_name"),name:"cardholderName",value:(d=l==null?void 0:l.values)==null?void 0:d.cardholderName,onChange:l==null?void 0:l.handleChange,onBlur:l==null?void 0:l.handleBlur,placeholder:a("checkout.credit_card_name"),autoComplete:"cc-name",required:!0})}),r.jsx("div",{children:r.jsx(Cl,{value:(u=(h=l==null?void 0:l.values)==null?void 0:h.cardNumber)==null?void 0:u.toString(),error:(g=l==null?void 0:l.errors)==null?void 0:g.cardNumber,onBlur:l==null?void 0:l.handleBlur,onChange:l==null?void 0:l.handleChange})}),r.jsxs("div",{className:dc.columns,children:[r.jsx("div",{children:r.jsx(jl,{value:(y=l==null?void 0:l.values)==null?void 0:y.cardExpiry,onBlur:l==null?void 0:l.handleBlur,onChange:l==null?void 0:l.handleChange,error:(f=l==null?void 0:l.errors)==null?void 0:f.cardExpiry})}),r.jsx("div",{children:r.jsx(Sl,{value:(x=l==null?void 0:l.values)==null?void 0:x.cardCVC,onBlur:l==null?void 0:l.handleBlur,onChange:l==null?void 0:l.handleChange,error:(w=l==null?void 0:l.errors)==null?void 0:w.cardCVC})})]}),r.jsx("div",{children:r.jsx(M,{disabled:i,label:a("checkout.save"),variant:"contained",onClick:l.handleSubmit,type:"submit",color:"primary",size:"large",fullWidth:!0})})]})},Nf=()=>{const s=ue(),t=ae(),[e,n]=m.useState(!1),a=()=>{t(J(s,null),{replace:!1})},o=()=>r.jsx(Tf,{onCancel:a,setUpdatingCardDetails:n});return r.jsx(Pf,{onCancel:a,renderPaymentMethod:o,submitting:e})},Lf="_title_n9dff_1",$f="_text_n9dff_7",Rf="_button_n9dff_12",Of="_link_n9dff_16",Df="_textField_n9dff_17",Mf="_paragraph_n9dff_21",Ff="_resendLink_n9dff_31",Qs={title:Lf,text:$f,button:Rf,link:Of,textField:Df,paragraph:Mf,resendLink:Ff},Bf=({onSubmit:s,onChange:t,onBlur:e,showOldPasswordField:n,showResetTokenField:a,value:o,errors:i,submitting:c,validationError:l,email:d,onResendEmailClick:h})=>{const{t:u}=T(["account","user"]);return r.jsxs("form",{onSubmit:s,"data-testid":void 0,noValidate:!0,children:[i.form&&r.jsx(Oe,{variant:"error",visible:!l,children:i.form}),r.jsx("h2",{className:Qs.title,children:u(n&&a?"user:account.add_password":"reset.password_reset")}),n&&a&&r.jsxs("p",{className:Qs.paragraph,children:[u("user:account.add_password_modal_text",{email:d}),r.jsx("a",{className:Qs.resendLink,onClick:h,children:u("user:account.resend_mail")})]}),n&&!a&&r.jsx(an,{value:o.oldPassword,onChange:t,onBlur:e,label:u("reset.old_password"),placeholder:u("reset.old_password"),error:!!i.oldPassword,name:"oldPassword",showToggleView:!1,showHelperText:!1,autoComplete:"current-password",required:!0}),a&&r.jsx(me,{className:Qs.textField,value:o.resetPasswordToken||"",onChange:t,onBlur:e,label:u("reset.reset_password_token"),placeholder:u("reset.reset_password_token"),name:"resetPasswordToken",type:"text",autoComplete:"",required:!0}),r.jsx(an,{value:o.password,onChange:t,onBlur:e,label:u("reset.new_password"),placeholder:u("reset.password"),error:!!i.password,name:"password",autoComplete:"new-password",required:!0}),r.jsx(an,{value:o.passwordConfirmation,onChange:t,onBlur:e,label:u("reset.repeat_new_password"),placeholder:u("reset.repeat_new_password"),error:!!i.passwordConfirmation,name:"passwordConfirmation",autoComplete:"new-password",showHelperText:!1,required:!0}),r.jsx(M,{type:"submit",className:Qs.button,fullWidth:!0,color:"primary",disabled:c,label:u("reset.confirm")}),c&&r.jsx(je,{transparentBackground:!0,inline:!0})]})},uc=({type:s})=>{const t=q(ye),{t:e}=T("account"),n=Ke(),a=ue(),o=ae(),i=He("resetPasswordToken"),c=He("email"),l=U(y=>{var f;return(f=y.user)==null?void 0:f.email}),d=U.getState().user,h=async(y,{setErrors:f,setSubmitting:x})=>{const{oldPassword:w,password:_,passwordConfirmation:b,resetPasswordToken:v}=y;if(_!==b)return f({form:e("reset.passwords_do_not_match")}),x(!1);let C=i;v&&(C=v);try{if(d&&!C)await t.changePasswordWithOldPassword(w||"",_,b);else{if(!C)return f({form:e("reset.invalid_link")}),x(!1);await t.changePasswordWithToken(c||"",_,C,b)}n(e("reset.password_reset_success"),"success"),await t.logout(),o(J(a,"login"))}catch(j){j instanceof Error&&(j.message.includes("invalid param password")?f({password:e("reset.invalid_password")}):j.message.includes("resetPasswordToken is not valid")?f({form:e("reset.invalid_reset_link")}):j.message.includes("score does not match standards")?f({form:e("reset.password_strength")}):j.message.includes("old password does not match")?f({form:e("reset.old_password_does_not_match")}):j.message.includes("password could not be set")&&f({form:e("reset.invalid_token")}))}x(!1)},u=Nt({initialValues:{password:"",passwordConfirmation:""},validationSchema:ne().shape({email:B(),oldPassword:B(),password:B().matches(/^(?=.*[a-z])(?=.*[0-9]).{8,}$/,e("registration.invalid_password")).required(e("login.field_required",{field:e("login.password")})),passwordConfirmation:B().required(),resetPasswordToken:B()}),validateOnBlur:!0,onSubmit:h}),g=async()=>{try{l&&await t.resetPassword(l,"")}catch{u.setErrors({form:e("user:account.resend_mail_error")})}};return r.jsx(Bf,{value:u.values,submitting:u.submitting,onChange:u.handleChange,onBlur:u.handleBlur,errors:u.errors,onSubmit:u.handleSubmit,validationError:u.validationSchemaError,showOldPasswordField:!!(d&&!i),showResetTokenField:s==="add"||!d&&!i,email:c||l,onResendEmailClick:g})},Uf="_title_9xp06_1",Hf="_infoBox_9xp06_7",Wf="_price_9xp06_23",Vf="_confirmButton_9xp06_32",Xs={title:Uf,infoBox:Hf,price:Wf,confirmButton:Vf},qf=({subscription:s,customer:t,error:e,submitting:n,onConfirm:a,onClose:o})=>{const{t:i,i18n:c}=T("account");return r.jsxs("div",{children:[e?r.jsx(Oe,{variant:"error",children:e}):null,r.jsx("h2",{className:Xs.title,children:i("renew_subscription.renew_your_subscription")}),r.jsx("p",{className:Xs.paragraph,children:i("renew_subscription.explanation")}),r.jsxs("div",{className:Xs.infoBox,children:[r.jsxs("p",{children:[r.jsx("strong",{children:s.offerTitle})," ",r.jsx("br",{}),i("renew_subscription.next_billing_date_on",{date:Et(new Date(s.expiresAt*1e3),c.language)})]}),r.jsxs("p",{className:Xs.price,children:[r.jsx("strong",{children:dt(s.nextPaymentPrice,s.nextPaymentCurrency,t.country)}),r.jsxs("small",{children:["/",i(`periods.${s.period}`)]})]})]}),r.jsx(M,{className:Xs.confirmButton,color:"primary",variant:"contained",label:i("renew_subscription.renew_subscription"),onClick:a,fullWidth:!0,disabled:n,type:"submit"}),r.jsx(M,{label:i("renew_subscription.no_thanks"),onClick:o,fullWidth:!0})]})},Gf="_title_1o843_1",hc={title:Gf},zf=({onClose:s,customer:t,subscription:e})=>{const{t:n,i18n:a}=T("account"),o=Et(new Date(e.expiresAt*1e3),a.language),i=dt(e.nextPaymentPrice,e.nextPaymentCurrency,t.country);return r.jsxs("div",{children:[r.jsx("h2",{className:hc.title,children:n("subscription_renewed.title")}),r.jsx("p",{className:hc.paragraph,children:n("subscription_renewed.message",{date:o,price:i})}),r.jsx(M,{label:n("subscription_renewed.back_to_profile"),onClick:s,fullWidth:!0})]})},Kf=()=>{const s=q(ye),t=ae(),e=ue(),{t:n}=T("account"),a=Ke(),{subscription:o,user:i}=U(({subscription:x,user:w})=>({subscription:x,user:w}),de),[c,l]=m.useState(!1),[d,h]=m.useState(!1),[u,g]=m.useState(null),y=async()=>{h(!0),g(null);try{await s.updateSubscription("active"),a(n("renew_subscription.success"),"success"),l(!0)}catch{g(n("renew_subscription.unknown_error_occurred"))}h(!1)},f=()=>{t(J(e,null),{replace:!0})};return!o||!i?null:r.jsxs(Ne.Fragment,{children:[c?r.jsx(zf,{onClose:f,subscription:o,customer:i}):r.jsx(qf,{subscription:o,customer:i,error:u,onConfirm:y,onClose:f,submitting:d}),d?r.jsx(je,{inline:!0}):null]})},Jf="_title_feuiy_1",Yf="_confirmButton_feuiy_7",pr={title:Jf,confirmButton:Yf},Qf=({onConfirm:s,onCancel:t,error:e,submitting:n})=>{const{t:a}=T("account");return r.jsxs("div",{children:[e?r.jsx(Oe,{variant:"error",children:e}):null,r.jsx("h2",{className:pr.title,children:a("cancel_subscription.title")}),r.jsx("p",{className:pr.paragraph,children:a("cancel_subscription.explanation")}),r.jsx(M,{className:pr.confirmButton,label:a("cancel_subscription.unsubscribe"),color:"primary",variant:"contained",onClick:s,fullWidth:!0,disabled:n,type:"submit"}),r.jsx(M,{label:a("cancel_subscription.no_thanks"),variant:"outlined",onClick:t,fullWidth:!0})]})},Xf="_title_od1i3_1",mr={title:Xf},Zf=({expiresDate:s,onClose:t})=>{const{t:e}=T("account");return r.jsxs("div",{className:mr.SubscriptionCancelled,children:[r.jsx("h2",{className:mr.title,children:e("subscription_cancelled.title")}),r.jsx("p",{className:mr.paragraph,children:e("subscription_cancelled.message",{date:s})}),r.jsx(M,{label:e("subscription_cancelled.return_to_profile"),variant:"outlined",onClick:t,fullWidth:!0})]})},eg=()=>{const s=q(ye),{t,i18n:e}=T("account"),n=Ke(),a=ae(),o=ue(),i=U(w=>w.subscription),[c,l]=m.useState(!1),[d,h]=m.useState(!1),[u,g]=m.useState(null),y=i!=null&&i.expiresAt?Et(new Date(i.expiresAt*1e3),e.language):"",f=async()=>{h(!0),g(null);try{await s.updateSubscription("cancelled"),y&&n(t("subscription_cancelled.message",{date:y}),"success"),l(!0)}catch{g(t("cancel_subscription.unknown_error_occurred"))}h(!1)},x=()=>{a(J(o,null),{replace:!0})};return i?r.jsxs(Ne.Fragment,{children:[c?r.jsx(Zf,{expiresDate:y,onClose:x}):r.jsx(Qf,{onConfirm:f,onCancel:x,submitting:d,error:u}),d?r.jsx(je,{transparentBackground:!0,inline:!0}):null]}):null},tg="_title_173ks_1",sg="_text_173ks_7",ng="_button_173ks_12",fr={title:tg,text:sg,button:ng},rg=({onCancel:s,onReset:t,submitting:e})=>{const{t:n}=T("account");return r.jsxs("div",{children:[r.jsx("h1",{className:fr.title,children:n("reset.reset_password")}),r.jsx("p",{className:fr.text,children:n("reset.text")}),r.jsx(M,{onClick:t,className:fr.button,fullWidth:!0,color:"primary",label:n("reset.yes"),type:"submit",disabled:e}),r.jsx(M,{onClick:s,fullWidth:!0,label:n("reset.no")})]})},ag="_title_17xro_1",og="_text_17xro_7",ig="_button_17xro_12",gr={title:ag,text:og,button:ig},cg=({onSubmit:s,onChange:t,value:e,errors:n,submitting:a,onBlur:o})=>{const{t:i}=T("account");return r.jsxs("form",{onSubmit:s,"data-testid":void 0,noValidate:!0,children:[r.jsx("h2",{className:gr.title,children:i("reset.forgot_password")}),n.form?r.jsx(Oe,{variant:"error",children:n.form}):null,r.jsx("p",{className:gr.text,children:i("reset.forgot_text")}),r.jsx(me,{value:e.email,onChange:t,onBlur:o,label:i("reset.email"),placeholder:i("reset.email"),error:!!n.email||!!n.form,helperText:n.email,name:"email",type:"email",autoComplete:"email",required:!0}),r.jsx(M,{type:"submit",className:gr.button,fullWidth:!0,color:"primary",disabled:a,label:i("reset.email_me")})]})},lg="_title_v7vet_1",dg="_text_v7vet_7",ug="_button_v7vet_12",hg="_notSure_v7vet_16",pg="_link_v7vet_20",Es={title:lg,text:dg,button:ug,notSure:hg,link:pg},mg=({email:s,onBackToLogin:t,loggedIn:e})=>{const{t:n}=T("account"),a=ue();return r.jsxs("div",{className:Es.forgotPasswordForm,children:[r.jsx("h2",{className:Es.title,children:n("reset.link_sent")}),r.jsx("p",{className:Es.text,children:n("reset.link_sent_text",{email:s})}),r.jsx(M,{onClick:t,className:Es.button,fullWidth:!0,color:"primary",label:n("reset.back_login")}),!e&&r.jsxs(Ne.Fragment,{children:[r.jsx("span",{className:Es.notSure,children:n("reset.not_sure")}),r.jsx(hn,{className:Es.link,to:J(a,"forgot-password"),children:n("reset.try_again")})]})]})},_r=({type:s})=>{const t=q(ye),{t:e}=T("account"),n=ae(),a=ue(),[o,i]=m.useState(!1),{canChangePasswordWithOldPassword:c}=t.getFeatures(),{customer:l}=U(({user:f})=>({customer:f}),de),d=()=>{n(J(a,null))},h=async()=>{n({pathname:"/",search:"u=login"},{replace:!0}),l&&await t.logout()},u=async()=>{const f=`${H.APP_PUBLIC_URL}/?u=edit-password`;try{if(!(l!=null&&l.email)){Dt("ResetPassword","invalid param email");return}i(!0),await t.resetPassword(l.email,f),i(!1),n(J(a,"send-confirmation"))}catch(x){Ue("ResetPassword","Failed to reset password",{error:x})}},g=async(f,{setErrors:x,setSubmitting:w})=>{const _=`${H.APP_PUBLIC_URL}/?u=edit-password`;try{await t.resetPassword(f.email,_),n(J(a,c?"edit-password":"send-confirmation"))}catch(b){b instanceof Error&&(b.message.toLowerCase().includes("invalid param email")?x({email:e("reset.wrong_email")}):x({form:b.message}))}w(!1)},y=Nt({initialValues:{email:""},validationSchema:ne().shape({email:B().email(e("login.field_is_not_valid_email")).required(e("login.field_required",{field:e("login.email")}))}),validateOnBlur:!0,onSubmit:g});return r.jsxs(Ne.Fragment,{children:[s==="reset"&&r.jsx(rg,{submitting:o,onCancel:d,onReset:u}),s==="forgot"&&r.jsx(cg,{value:y.values,submitting:y.submitting,onChange:y.handleChange,errors:y.errors,onSubmit:y.handleSubmit,onBlur:y.handleBlur}),s==="confirmation"&&r.jsx(mg,{loggedIn:!!l,email:(l==null?void 0:l.email)||y.values.email,onBackToLogin:h}),(y.submitting||o)&&r.jsx(je,{transparentBackground:!0,inline:!0})]})},fg=({onUpdateOrderSuccess:s,onSubmitPaymentWithoutDetailsSuccess:t,onSubmitPaypalPaymentSuccess:e,onSubmitStripePaymentSuccess:n})=>{const a=q(ye),o=q(Tt),{order:i,selectedOffer:c,paymentMethods:l,setOrder:d}=be(({order:_,selectedOffer:b,paymentMethods:v,setOrder:C})=>({order:_,selectedOffer:b,paymentMethods:v,setOrder:C})),h=c&&da(c)?"svod":"tvod",u=ut({mutationKey:["initialiseOrder"],mutationFn:async({offer:_})=>!!_&&o.initialiseOrder(_)}),g=ut({mutationKey:["updateOrder"],mutationFn:async({paymentMethodId:_,couponCode:b})=>{if(!(!i||!_))return await o.updateOrder(i,_,b)},onSuccess:s}),y=ut({mutationKey:["submitPaymentWithoutDetails"],mutationFn:o.paymentWithoutDetails,onSuccess:async()=>{await a.reloadSubscriptions({retry:10}),t()}}),f=ut({mutationKey:["submitPaymentPaypal"],mutationFn:o.paypalPayment,onSuccess:e}),x=ut({mutationKey:["submitPaymentStripe"],mutationFn:o.directPostCardPayment,onSuccess:n});m.useEffect(()=>{c&&!i&&!u.isLoading&&!u.isError&&u.mutate({offer:c})},[c,i,u]),m.useEffect(()=>()=>d(null),[d]);const w=u.isLoading||g.isLoading||y.isLoading||f.isLoading||x.isLoading;return{selectedOffer:c,offerType:h,paymentMethods:l,order:i,isSubmitting:w,updateOrder:g,submitPaymentWithoutDetails:y,submitPaymentPaypal:f,submitPaymentStripe:x}},Pl=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"})),gg="_dialogBackButton_1pa6f_1",_g={dialogBackButton:gg},El=({onClick:s})=>{const{t}=T();return r.jsx(ze,{onClick:s,className:_g.dialogBackButton,"aria-label":t("common:back"),children:r.jsx(K,{icon:Pl})})},yg="_captcha_q1ooa_1",vg={captcha:yg},Il=m.forwardRef(({siteKey:s},t)=>r.jsx("div",{className:vg.captcha,children:r.jsx(Wd,{ref:t,sitekey:s,size:"invisible",badge:"inline",theme:"dark"})})),xg="_backButton_1xlk4_1",wg="_title_1xlk4_7",bg="_order_1xlk4_13",Sg="_orderTitle_1xlk4_22",jg="_orderTitleMargin_1xlk4_28",Cg="_orderBillingDate_1xlk4_32",Pg="_orderInfo_1xlk4_37",Eg="_orderPrice_1xlk4_41",Ig="_couponForm_1xlk4_54",Ag="_redeemCoupon_1xlk4_59",kg="_couponInput_1xlk4_66",Tg="_orderTotals_1xlk4_84",Ng="_couponCell_1xlk4_96",Lg="_divider_1xlk4_113",$g="_paymentMethods_1xlk4_118",Rg="_paymentMethod_1xlk4_118",Og="_paymentMethodLabel_1xlk4_127",Dg="_radio_1xlk4_135",Mg="_noPaymentNeeded_1xlk4_170",ke={backButton:xg,title:wg,order:bg,orderTitle:Sg,orderTitleMargin:jg,orderBillingDate:Cg,orderInfo:Pg,orderPrice:Eg,couponForm:Ig,redeemCoupon:Ag,couponInput:kg,orderTotals:Tg,couponCell:Ng,divider:Lg,paymentMethods:$g,paymentMethod:Rg,paymentMethodLabel:Og,radio:Dg,noPaymentNeeded:Mg},Fg=({paymentMethodId:s,paymentMethods:t,order:e,offer:n,offerType:a,onBackButtonClick:o,onPaymentMethodChange:i,error:c,couponFormOpen:l,couponInputValue:d,couponFormError:h,couponFormApplied:u,couponFormSubmitting:g,onCouponInputChange:y,onCloseCouponFormClick:f,onCouponFormSubmit:x,onRedeemCouponButtonClick:w,children:_,submitting:b,captchaSiteKey:v,recaptchaRef:C})=>{var $,L,D,O,A,W,X;const{t:j}=T("account"),S=()=>n?j(`periods.${n.period}`):"",E=ee=>{if(ee.freeDays)return j("checkout.days_trial",{count:ee.freeDays});if(ee.freePeriods){const Q=j(`periods.${ee.period}`,{count:ee.freePeriods});return j("checkout.periods_trial",{count:ee.freePeriods,period:Q})}return null},P=t==null?void 0:t.find(ee=>ee.methodName==="card"),I=t==null?void 0:t.find(ee=>ee.methodName==="paypal"),k=a==="svod"?n.period==="month"?j("checkout.monthly"):j("checkout.yearly"):n.offerTitle;return r.jsxs("div",{children:[c?r.jsx(Oe,{variant:"error",children:c}):null,r.jsx("h1",{className:ke.title,children:j("checkout.payment_method")}),r.jsxs("div",{className:ke.order,children:[r.jsxs("div",{className:ke.orderInfo,children:[r.jsx("p",{className:F(ke.orderTitle,{[ke.orderTitleMargin]:a==="svod"}),children:k}),(($=e.discount)==null?void 0:$.type)==="trial"?r.jsx("p",{className:ke.orderBillingDate,children:E(n)}):null]}),r.jsxs("div",{className:ke.orderPrice,children:[r.jsx("span",{children:dt(n.customerPriceInclTax,e.currency,n.customerCountry)}),a==="svod"&&r.jsxs("small",{children:["/",S()]})]})]}),r.jsx("div",{className:ke.couponForm,children:l?r.jsxs("form",{onSubmit:x,noValidate:!0,children:[r.jsxs("div",{className:ke.redeemCoupon,children:[r.jsx(ze,{"aria-label":"Close coupon form",onClick:f,children:r.jsx(K,{icon:Yn})}),r.jsx("input",{className:ke.couponInput,name:"couponCode",type:"text",placeholder:"Coupon code",value:d,onChange:y}),r.jsx(M,{variant:"outlined",label:"Apply",type:"submit",disabled:g})]}),h?r.jsx(Oe,{variant:"error",children:h}):null,u?r.jsx(Oe,{variant:"success",children:j("checkout.coupon_applied")}):null]}):r.jsx(M,{variant:"outlined",label:j("checkout.redeem_coupon"),onClick:w})}),r.jsx("div",{children:r.jsxs("table",{className:ke.orderTotals,children:[r.jsxs("tbody",{children:[(L=e.discount)!=null&&L.applied&&((D=e.discount)==null?void 0:D.type)==="coupon"?r.jsxs("tr",{children:[r.jsxs("td",{className:ke.couponCell,children:[j("checkout.coupon_discount"),r.jsx("br",{}),!!n.period&&a==="svod"&&r.jsx("small",{children:j("checkout.discount_period",{count:(O=e.discount)==null?void 0:O.periods,period:j(`periods.${n.period}`,{count:(A=e.discount)==null?void 0:A.periods})})})]}),r.jsx("td",{children:dt(-e.priceBreakdown.discountAmount*(1+e.taxRate),e.currency,n.customerCountry)})]}):null,(W=e.discount)!=null&&W.applied&&((X=e.discount)==null?void 0:X.type)==="trial"?r.jsxs("tr",{children:[r.jsx("td",{className:ke.couponCell,children:j("checkout.free_trial_discount")}),r.jsx("td",{children:dt(-n.customerPriceInclTax,e.currency,n.customerCountry)})]}):null,e.priceBreakdown.paymentMethodFee>0&&r.jsxs("tr",{children:[r.jsx("td",{children:j("checkout.payment_method_fee")}),r.jsx("td",{children:dt(e.priceBreakdown.paymentMethodFee,e.currency,n.customerCountry)})]})]}),r.jsxs("tfoot",{children:[r.jsxs("tr",{children:[r.jsx("td",{children:j("checkout.total_price")}),r.jsx("td",{children:dt(e.totalPrice,e.currency,n.customerCountry)})]}),e.priceBreakdown.taxValue>0&&r.jsxs("tr",{children:[r.jsx("td",{children:j("checkout.applicable_tax",{taxRate:Math.round(e.taxRate*100)})}),r.jsx("td",{children:dt(e.priceBreakdown.taxValue,e.currency,n.customerCountry)})]})]})]})}),!!v&&r.jsx(Il,{siteKey:v,ref:C}),r.jsx("hr",{className:ke.divider}),e.requiredPaymentDetails?r.jsxs("div",{className:ke.paymentMethods,children:[P?r.jsxs("div",{className:ke.paymentMethod,children:[r.jsx("input",{className:ke.radio,type:"radio",name:"paymentMethodId",value:P.id,id:"card",checked:s===P.id.toString(),onChange:i}),r.jsxs("label",{className:ke.paymentMethodLabel,htmlFor:"card",children:[r.jsx(K,{icon:xl})," ",j("checkout.credit_card")]})]}):null,I?r.jsxs("div",{className:ke.paymentMethod,children:[r.jsx("input",{className:ke.radio,type:"radio",name:"paymentMethodId",value:I.id,id:"paypal",checked:s===I.id.toString(),onChange:i}),r.jsxs("label",{className:ke.paymentMethodLabel,htmlFor:"paypal",children:[r.jsx(K,{icon:_a})," ",j("checkout.paypal")]})]}):null]}):null,_?r.jsx("div",{children:_}):null,b&&r.jsx(je,{transparentBackground:!0,inline:!0}),r.jsx(El,{onClick:o})]})},Bg="_noPaymentRequired_170kq_1",Ug={noPaymentRequired:Bg},Hg=({onSubmit:s,error:t})=>{const{t:e}=T("account");return r.jsxs("div",{className:Ug.noPaymentRequired,children:[t?r.jsx(Oe,{variant:"error",children:t}):null,r.jsx("p",{children:e("checkout.no_payment_needed")}),r.jsx(M,{label:e("checkout.continue"),variant:"contained",color:"primary",size:"large",onClick:s,fullWidth:!0})]})},Wg="_paymentForm_1nfvx_1",Vg="_columns_1nfvx_6",qg="_formError_1nfvx_13",yr={paymentForm:Wg,columns:Vg,formError:qg},Gg=({onPaymentFormSubmit:s})=>{const{t}=T("account"),{values:e,errors:n,setValue:a,handleChange:o,handleBlur:i,handleSubmit:c}=Nt({initialValues:{cardholderName:"",cardNumber:"",cardExpiry:"",cardCVC:"",cardExpMonth:"",cardExpYear:""},validationSchema:ne().required().shape({cardholderName:B().required(),cardNumber:B().required().test("card number validation",t("checkout.invalid_card_number"),l=>gt.fns.validateCardNumber(l)),cardExpiry:B().required().test("card expiry validation",t("checkout.invalid_card_expiry"),l=>gt.fns.validateCardExpiry(l)),cardCVC:B().required().test("cvc validation",t("checkout.invalid_cvc_number"),(l,d)=>{const h=gt.fns.cardType(d.parent.cardNumber);return gt.fns.validateCardCVC(l,h)}),cardExpMonth:B().required(),cardExpYear:B().required()}),validateOnBlur:!0,onSubmit:s});return m.useEffect(()=>{if(e.cardExpiry){const l=gt.fns.cardExpiryVal(e.cardExpiry);l.month&&a("cardExpMonth",l.month.toString()),l.year&&a("cardExpYear",l.year.toString())}},[e.cardExpiry]),r.jsx("div",{className:yr.paymentForm,children:r.jsxs("form",{onSubmit:c,"data-testid":void 0,noValidate:!0,children:[n.form?r.jsx("div",{className:yr.formError,children:r.jsx(Oe,{variant:"error",children:n.form})}):null,r.jsx("div",{children:r.jsx(me,{label:t("checkout.card_holder_name"),name:"cardholderName",value:e.cardholderName,onChange:o,onBlur:i,placeholder:t("checkout.credit_card_name"),autoComplete:"cc-name",required:!0})}),r.jsx("div",{children:r.jsx(Cl,{value:e.cardNumber.toString(),error:n.cardNumber,onBlur:i,onChange:o})}),r.jsxs("div",{className:yr.columns,children:[r.jsx("div",{children:r.jsx(jl,{value:e.cardExpiry,onBlur:i,onChange:o,error:n.cardExpiry})}),r.jsx("div",{children:r.jsx(Sl,{value:e.cardCVC,onBlur:i,onChange:o,error:n.cardCVC})})]}),r.jsx("div",{children:r.jsx(M,{label:t("checkout.continue"),variant:"contained",color:"primary",type:"submit",size:"large",fullWidth:!0})})]})})};function zg({setUpdatingOrder:s,type:t,paymentSuccessUrl:e,orderId:n,getCaptchaValue:a}){const o=q(ye),i=q(Tt),{t:c}=T(["account","error"]),l=Ke(),[d,h]=m.useState(),[u,g]=m.useState(),y=o.getSandbox(),f=ae();m.useEffect(()=>{(async()=>{s(!0);try{const b=await i.createAdyenPaymentSession(window.origin);g(b)}catch(b){b instanceof Error&&h(b.message)}s(!1)})()},[s,i]);const x=m.useCallback(async(_,b)=>{if(_.isValid){try{if(s(!0),h(void 0),n===void 0){h(c("error:adyen_order_unknown"));return}const v=await a(),C=Se(window.location.href,{u:"finalize-payment",orderId:n}),j=await i.initialAdyenPayment(_.data.paymentMethod,C,v);"action"in j&&b(j.action),await o.reloadSubscriptions({retry:10}),l(c("account:checkout.payment_success"),"success"),f(e,{replace:!0})}catch(v){v instanceof Error&&h(v.message)}s(!1)}},[s,n,i,o,l,c,f,e,a]),w=m.useMemo(()=>({session:u,showPayButton:!1,environment:y?"test":"live",clientKey:y?qc:Gc,paymentMethodsConfiguration:{card:{hasHolderName:!0,holderNameRequired:!0}},onAdditionalDetails:async _=>{try{s(!0);const b=_.data.details;await i.finalizeAdyenPayment(n,b),l(c("account:checkout.payment_success"),"success"),f(e,{replace:!0})}catch(b){b instanceof Error&&(h(b.message),s(!1))}},onSubmit:(_,b)=>x(_,b.handleAction),onError:_=>h(_.message)}),[u,y,s,i,n,l,c,f,e,x]);return r.jsx(bl,{configuration:w,type:t,error:d})}const Al=()=>{const s=m.useRef(null),t=z(({config:n})=>{var a,o;return(a=n.custom)!=null&&a.captchaSiteKey?(o=n.custom)==null?void 0:o.captchaSiteKey:void 0}),e=he(async()=>{var n;return t&&await((n=s.current)==null?void 0:n.executeAsync())||void 0});return{recaptchaRef:s,captchaSiteKey:t,getCaptchaValue:e}},Kg=()=>{var ce,ve;const s=ue(),t=ae(),[e,n]=m.useState(!1),[a,o]=m.useState(!1),[i,c]=m.useState(!1),{t:l}=T("account"),d=Ke(),h=J(s,"choose-offer"),u=J(s,"welcome"),g=J(s,null),{recaptchaRef:y,captchaSiteKey:f,getCaptchaValue:x}=Al(),w=()=>t(h),{selectedOffer:_,offerType:b,paymentMethods:v,order:C,isSubmitting:j,updateOrder:S,submitPaymentWithoutDetails:E,submitPaymentPaypal:P,submitPaymentStripe:I}=fg({onUpdateOrderSuccess:()=>!!k&&c(!0),onSubmitPaymentWithoutDetailsSuccess:()=>(d(l("checkout.payment_success"),"success"),t(b==="svod"?u:g,{replace:!0})),onSubmitPaypalPaymentSuccess:({redirectUrl:V})=>{window.location.href=V},onSubmitStripePaymentSuccess:()=>t(J(s,"waiting-for-payment"),{replace:!0})}),{values:{couponCode:k,paymentMethodId:$},setValue:L,submitting:D,errors:O,handleChange:A,handleSubmit:W}=Nt({initialValues:{couponCode:"",paymentMethodId:qr(v)},onSubmit:({couponCode:V,paymentMethodId:oe})=>(c(!1),S.mutateAsync({couponCode:V,paymentMethodId:parseInt(oe)})),onSubmitSuccess:({couponCode:V})=>c(!!V),onSubmitError:({error:V})=>{var oe;V instanceof Ze&&((oe=V.errors.order)!=null&&oe.includes(`Order with id ${C==null?void 0:C.id} not found`))&&t(J(s,"choose-offer"),{replace:!0})}}),X=V=>{A(V),S.mutateAsync({couponCode:k,paymentMethodId:parseInt(V.target.value)})};if(m.useEffect(()=>{if(!_)return t(h,{replace:!0})},[t,h,_]),m.useEffect(()=>{v!=null&&v.length&&L("paymentMethodId",qr(v))},[v,L]),m.useEffect(()=>()=>c(!1),[]),!_||!C||!v||!b)return r.jsx("div",{style:{height:300},children:r.jsx(je,{inline:!0})});const ee=Mt("payment-cancelled"),Q=Mt("waiting-for-payment",{offerId:_==null?void 0:_.offerId}),N=Mt("payment-error"),R=b==="svod"?Q:Se(window.location.href,{u:""}),Y=window.location.href,G=v==null?void 0:v.find(V=>V.id===parseInt($)),re=!(C!=null&&C.requiredPaymentDetails),$e=(G==null?void 0:G.methodName)==="card"&&(G==null?void 0:G.provider)==="stripe",pe=(G==null?void 0:G.methodName)==="card"&&(G==null?void 0:G.paymentGateway)==="adyen",Ce=(G==null?void 0:G.methodName)==="paypal";return r.jsxs(Fg,{order:C,offer:_,offerType:b,error:O.form,onBackButtonClick:w,paymentMethods:v,paymentMethodId:$,onPaymentMethodChange:X,onCouponFormSubmit:W,onCouponInputChange:A,onRedeemCouponButtonClick:()=>o(!0),onCloseCouponFormClick:()=>o(!1),couponInputValue:k,couponFormOpen:a,couponFormApplied:i,couponFormSubmitting:D,couponFormError:O.couponCode,submitting:j||e,captchaSiteKey:f,recaptchaRef:y,children:[re&&r.jsx(Hg,{onSubmit:async()=>{const V=await x();return E.mutateAsync({captchaValue:V})},error:((ce=E.error)==null?void 0:ce.message)||null}),$e&&r.jsx(Gg,{onPaymentFormSubmit:async V=>await I.mutateAsync({cardPaymentPayload:V,referrer:Y,returnUrl:Q})}),pe&&r.jsx(r.Fragment,{children:r.jsx(zg,{paymentSuccessUrl:b==="svod"?u:g,setUpdatingOrder:n,orderId:C.id,type:"card",getCaptchaValue:x})}),Ce&&r.jsx(wl,{onSubmit:async()=>{const V=await x();P.mutate({successUrl:R,waitingUrl:Q,cancelUrl:ee,errorUrl:N,couponCode:k,captchaValue:V})},error:((ve=P.error)==null?void 0:ve.message)||null})]})},ya=()=>{const s=q(Tt),t=q(ye),{mediaOffers:e,subscriptionOffers:n,switchSubscriptionOffers:a,requestedMediaOffers:o}=be(({mediaOffers:f,subscriptionOffers:x,switchSubscriptionOffers:w,requestedMediaOffers:_})=>({mediaOffers:f,subscriptionOffers:x,switchSubscriptionOffers:w,requestedMediaOffers:_}),de),{isLoading:i}=We({queryKey:["initialiseOffers",o],queryFn:s.initialiseOffers}),c=ut({mutationKey:["chooseOffer"],mutationFn:s.chooseOffer}),l=ut({mutationKey:["switchSubscription"],mutationFn:s.switchSubscription,onSuccess:()=>t.reloadSubscriptions({delay:3e3,retry:10})}),d=e.length>0,h=n.length>0,u=o.some(f=>f.premier),g=(n.length>0||a.length>0)&&d&&!u,y=u||!h?"tvod":"svod";return{isLoading:i||c.isLoading,mediaOffers:e,subscriptionOffers:n,switchSubscriptionOffers:a,chooseOffer:c,switchSubscription:l,hasMultipleOfferTypes:g,defaultOfferType:y}},vr=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M10 17L5 12L6.41 10.59L10 14.17L17.59 6.58L19 8L10 17Z"})),Jg="_title_1h3nw_1",Yg="_subtitle_1h3nw_7",Qg="_offerGroupSwitch_1h3nw_13",Xg="_label_1h3nw_19",Zg="_offers_1h3nw_24",e_="_offer_1h3nw_13",t_="_radio_1h3nw_41",s_="_offerGroupLabel_1h3nw_68",n_="_offerTitle_1h3nw_80",r_="_offerDivider_1h3nw_86",a_="_offerBenefits_1h3nw_93",o_="_fill_1h3nw_114",i_="_offerPrice_1h3nw_118",De={title:Jg,subtitle:Yg,offerGroupSwitch:Qg,label:Xg,offers:Zg,offer:e_,radio:t_,offerGroupLabel:s_,offerTitle:n_,offerDivider:r_,offerBenefits:a_,fill:o_,offerPrice:i_},c_=({offer:s,selected:t,onChange:e})=>{const{t:n}=T("account"),a=c=>{if(c.freeDays)return n("choose_offer.benefits.first_days_free",{count:c.freeDays});if(c.freePeriods){const l=n(`periods.${c.period}`,{count:c.freePeriods});return n("choose_offer.benefits.first_periods_free",{count:c.freePeriods,period:l})}return null},o=(c,l)=>r.jsxs("li",{children:[r.jsx(K,{icon:l}),c,r.jsx("span",{className:"hidden",children:"."})]}),i=({title:c,periodString:l,secondBenefit:d})=>r.jsxs("div",{className:De.offer,"aria-labelledby":`title-${s.offerId}`,children:[r.jsx("input",{className:De.radio,onChange:e,type:"radio",name:"selectedOfferId",value:s.offerId,id:s.offerId,checked:t,"data-testid":(s.offerId,void 0)}),r.jsx("div",{className:De.label,children:r.jsxs("label",{htmlFor:s.offerId,children:[r.jsx("h2",{className:De.offerTitle,id:`title-${s.offerId}`,children:c}),r.jsx("span",{className:"hidden",children:"."}),r.jsx("hr",{className:De.offerDivider,"aria-hidden":!0}),r.jsxs("ul",{className:De.offerBenefits,children:[s.freeDays||s.freePeriods?o(a(s)||"",vr):null,!!d&&o(d,vr),o(n("choose_offer.benefits.watch_on_all_devices"),vr)]}),r.jsx("div",{className:De.fill}),r.jsxs("div",{className:De.offerPrice,children:[jh(s)," ",!!l&&r.jsxs("small",{children:["/",l]})]})]})})]});if(da(s)){const c=s.period==="month";return i({title:n(c?"choose_offer.monthly":"choose_offer.yearly"),secondBenefit:n("choose_offer.benefits.cancel_anytime"),periodString:n(c?"periods.month":"periods.year")})}return i({title:s.offerTitle,secondBenefit:s.durationPeriod&&s.durationAmount?n("choose_offer.tvod_access",{period:s.durationPeriod,count:s.durationAmount}):void 0})},l_=({values:s,errors:t,submitting:e,offers:n,showOfferTypeSwitch:a,onChange:o,onSubmit:i,onBackButtonClickHandler:c})=>{const l=z(g=>g.config.siteName),{t:d}=T("account"),{selectedOfferType:h,selectedOfferId:u}=s;return r.jsxs("form",{onSubmit:i,"data-testid":void 0,noValidate:!0,children:[c?r.jsx(El,{onClick:c}):null,r.jsx("h1",{className:De.title,children:d("choose_offer.title")}),r.jsx("p",{className:De.subtitle,children:d("choose_offer.watch_this_on_platform",{siteName:l})}),t.form?r.jsx(Oe,{variant:"error",children:t.form}):null,a&&r.jsxs("div",{className:De.offerGroupSwitch,children:[r.jsx("input",{className:De.radio,onChange:o,type:"radio",name:"selectedOfferType",id:"svod",value:"svod",checked:h==="svod"}),r.jsx("label",{className:F(De.label,De.offerGroupLabel),htmlFor:"svod",children:d("choose_offer.subscription")}),r.jsx("input",{className:De.radio,onChange:o,type:"radio",name:"selectedOfferType",id:"tvod",value:"tvod",checked:h==="tvod"}),r.jsx("label",{className:F(De.label,De.offerGroupLabel),htmlFor:"tvod",children:d("choose_offer.one_time_only")})]}),r.jsx("div",{className:De.offers,children:n.length?n.map(g=>r.jsx(c_,{offer:g,selected:u===g.offerId,onChange:o},g.offerId)):r.jsx("p",{children:d("choose_offer.no_pricing_available")})}),e&&r.jsx(je,{transparentBackground:!0,inline:!0}),r.jsx(M,{label:d("choose_offer.continue"),disabled:e||!n.length,variant:"contained",color:"primary",type:"submit",fullWidth:!0})]})},pc=()=>{const s=ae(),t=ue(),{t:e}=T("account"),n=He("u")==="upgrade-subscription",a=U(({pendingOffer:P})=>({isPendingOffer:!!P})),{isLoading:o,mediaOffers:i,subscriptionOffers:c,switchSubscriptionOffers:l,defaultOfferType:d,hasMultipleOfferTypes:h,chooseOffer:u,switchSubscription:g}=ya(),y=J(t,"checkout"),f=J(t,"upgrade-subscription-pending"),x=J(t,"upgrade-subscription-success"),w=J(t,"upgrade-subscription-error"),{values:_,errors:b,submitting:v,setValue:C,handleSubmit:j,handleChange:S}=Nt({initialValues:{selectedOfferType:d,selectedOfferId:void 0},validationSchema:ne().shape({selectedOfferId:us().required(e("choose_offer.field_required")),selectedOfferType:us().required(e("choose_offer.field_required"))}),onSubmit:async({selectedOfferType:P,selectedOfferId:I})=>{if(!P||!I)return;const k=E.find($=>$.offerId===I);if(k&&(await u.mutateAsync(k),n))return await g.mutateAsync()},onSubmitSuccess:async()=>{if(n&&a)return s(f);if(n)return s(x);s(y)},onSubmitError:()=>s(w)}),E=_.selectedOfferType==="tvod"?i:n?l:c;return m.useEffect(()=>{var I;if(o||!E.length)return;const P=(I=E[E.length-1])==null?void 0:I.offerId;C("selectedOfferId",P)},[E,_.selectedOfferType,C,o]),m.useEffect(()=>{o||!d||C("selectedOfferType",d)},[o,d,C]),o?r.jsx("div",{style:{height:300},children:r.jsx(je,{inline:!0})}):r.jsx(l_,{onSubmit:j,onChange:S,values:_,errors:b,submitting:v,offers:E,showOfferTypeSwitch:h})},d_="_container_19jg4_1",u_="_error_19jg4_25",h_="_medium_19jg4_28",p_="_select_19jg4_31",m_="_disabled_19jg4_38",f_="_option_19jg4_69",Is={container:d_,error:u_,medium:h_,select:p_,disabled:m_,option:f_},kl=({required:s,className:t,disabled:e,defaultLabel:n,options:a,optionsStyle:o,editing:i=!0,value:c,onChange:l,id:d,name:h,error:u,helperTextId:g,type:y,...f})=>{const x=v=>{if(!i)return v.preventDefault();l==null||l(v)},w=F(Is.container,{[Is.error]:u,[Is.disabled]:e},t),_={"aria-required":!!s,"aria-invalid":!!(s&&u&&c!==""),"aria-describedby":g},b={id:d,name:h,value:c,disabled:e,className:Is.select,readOnly:!i,required:s,..._,...f};return r.jsx("div",{className:F({[w]:i}),children:r.jsxs("select",{...b,onChange:x,children:[n&&r.jsx("option",{className:F(Is.option,o),value:"",disabled:s,children:n}),a&&a.map(v=>r.jsx("option",{className:F(Is.option,o),value:typeof v=="string"?v:v.value,children:typeof v=="string"?v:v.label},typeof v=="string"?v:v.value))]})})},Tl=({name:s,className:t,label:e,error:n,helperText:a,editing:o=!0,required:i=!1,size:c="medium",testId:l,lang:d,...h})=>r.jsx(gn,{className:t,error:n,helperText:a,label:e,required:i,editing:o,testId:l,name:s,size:c,lang:d,renderInput:u=>r.jsx(kl,{name:s,required:i,editing:o,error:n,size:c,...u,...h})}),g_="_checkbox_13vmv_1",__="_error_13vmv_17",y_="_row_13vmv_68",xr={checkbox:g_,error:__,row:y_},Qn=({className:s,label:t,checkboxLabel:e,name:n,onChange:a,editing:o=!0,value:i,helperText:c,error:l,required:d,lang:h,size:u,...g})=>{const y=F(xr.checkbox,{[xr.error]:l},s),f=x=>{if(!o)return x.preventDefault();a==null||a(x)};return r.jsx(gn,{className:y,name:n,label:t,editing:o,required:d,error:l,helperText:c,renderInput:({id:x,helperTextId:w})=>r.jsxs("div",{className:xr.row,children:[r.jsx("input",{name:n,type:"checkbox",id:x,value:i,"aria-required":d,"aria-describedby":w,...g,onChange:f,readOnly:!o}),r.jsxs("label",{htmlFor:x,lang:h,children:[d?r.jsx("span",{role:"presentation","aria-hidden":"true",children:"*"}):"",e]})]})})},v_="_radio_p1qnp_1",x_="_error_p1qnp_6",mc={radio:v_,error:x_},Nl=({name:s,onChange:t,label:e,value:n,editing:a=!0,size:o,values:i,helperText:c,error:l,required:d,disabled:h,lang:u,...g})=>{const y=f=>{if(!a)return f.preventDefault();t==null||t(f)};return r.jsx(gn,{name:s,label:e,error:l,helperText:c,required:d,renderInput:({id:f,helperTextId:x})=>r.jsx("div",{id:f,children:i.map(({value:w,label:_},b)=>r.jsxs("div",{className:F(mc.radio,{[mc.error]:l}),lang:u,children:[r.jsx("input",{value:w,name:s,type:"radio",id:f+b,onChange:y,checked:n===w,required:d,disabled:h,"aria-describedby":x,...g}),r.jsx("label",{htmlFor:f+b,children:_})]},b))})})},w_="_container_n2mrr_1",b_="_error_n2mrr_10",S_="_disabled_n2mrr_13",j_="_leftControl_n2mrr_16",C_="_input_n2mrr_16",P_="_rightControl_n2mrr_19",E_="_control_n2mrr_31",I_="_dateField_n2mrr_62",A_="_hiddenInput_n2mrr_102",as={container:w_,error:b_,disabled:S_,leftControl:j_,input:C_,rightControl:P_,control:E_,dateField:I_,hiddenInput:A_},k_=s=>{if(!s)return null;const t=new Date(s);return isNaN(t.getTime())?null:t},Ll=s=>s>0&&s<10?`0${s}`:s.toString(),$l=(s,t,e)=>Math.min(e,Math.max(t,s)),wr=(s,t,e)=>{const n=$l(parseInt(s),t,e);return isNaN(n)?"":s.length>0&&n<10?Ll(n):n.toString()},br=(s,t,e)=>{const n=$l(parseInt(s),t,e);return isNaN(n)?"":s.length>1&&n<10?Ll(n):n.toString()},Rl=({className:s,label:t,error:e,helperText:n,value:a,onChange:o,format:i="YYYY-MM-DD",name:c,editing:l,lang:d,required:h,onFocus:u,testId:g})=>{const y=k_(a),[f,x]=m.useState({date:(y==null?void 0:y.getDate().toString())||"",month:y?(y.getMonth()+1).toString():"",year:(y==null?void 0:y.getFullYear().toString())||""}),w=pt("text-field",c),_=pt("helper_text",c),b=m.useRef(null),v=F(as.dateField,{[as.error]:e},s),C=I=>{I.currentTarget.select(),u==null||u(I)},j=I=>{var k;if(I.key==="Backspace"&&f[I.currentTarget.name]==="")return(k=I.currentTarget.previousElementSibling)==null||k.focus(),I.preventDefault();if(!/^[0-9]$/.test(I.key)&&I.key!=="Tab"&&I.key!=="Backspace")return I.preventDefault()},S=I=>{const{name:k,value:$}=I.target;x(L=>{const D=k==="date"?wr($,1,31):L.date,O=k==="month"?wr($,1,12):L.month,A=k==="year"?wr($,1900,2100):L.year;return{date:D,month:O,year:A}})},E=(I,k,$)=>{var A,W;const L=(A=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value"))==null?void 0:A.set,D=I&&k&&$?i.replace("YYYY",$).replace("MM",k).replace("DD",I):"";L==null||L.call(b.current,D);const O=new Event("input",{bubbles:!0});(W=b.current)==null||W.dispatchEvent(O)},P=I=>{var W;const{name:k,value:$}=I.target,L=(W=I.currentTarget)==null?void 0:W.nextElementSibling,D=k==="date"?br($,0,31):f.date,O=k==="month"?br($,0,12):f.month,A=k==="year"?br($,0,2100).slice(0,4):f.year;x({date:D,month:O,year:A}),E(D,O,A),(L&&k==="month"&&O.length===2||k==="date"&&D.length===2)&&setTimeout(()=>L.focus(),1)};return r.jsx(gn,{className:v,name:c,helperText:n,error:e,label:t,editing:l,lang:d,required:h,testId:g,renderInput:()=>r.jsxs("div",{className:as.container,children:[r.jsx("input",{ref:b,id:`${w}-hidden`,className:as.hiddenInput,name:c,onChange:o,"aria-invalid":e,"aria-describedby":_}),r.jsx("input",{className:as.input,name:"date",placeholder:"dd",value:f.date,onFocus:C,onBlur:S,onChange:P,onKeyDown:j,maxLength:2,type:"number",id:`${w}-date`,autoComplete:"bday-day"})," / ",r.jsx("input",{className:as.input,name:"month",placeholder:"mm",value:f.month,onFocus:C,onBlur:S,onChange:P,onKeyDown:j,maxLength:2,type:"number",id:`${w}-month`,autoComplete:"bday-month"})," / ",r.jsx("input",{className:as.input,name:"year",placeholder:"yyyy",value:f.year,onFocus:C,onBlur:S,onChange:P,onKeyDown:j,maxLength:4,type:"number",id:`${w}-year`,autoComplete:"bday-year"})]})})},T_="_title_a6ei2_1",fc={title:T_,continue:"_continue_a6ei2_7"},N_=({initialValues:s,onSubmit:t,fields:e,questions:n,onQuestionChange:a,questionValues:o,questionErrors:i})=>{var w,_,b,v,C;const{t:c}=T("account"),{setValue:l,handleSubmit:d,handleChange:h,values:u,errors:g,validationSchemaError:y,submitting:f}=Nt({initialValues:s,onSubmit:t}),x=({value:j,key:S,question:E,required:P,enabled:I})=>{if(!I)return null;const k=j==null?void 0:j.split(";").map(L=>{const[D,O=D]=L.split(":");return{value:D,label:O}}),$={name:S,onChange:a,error:!!i[S],helperText:i[S],required:P,key:S};return k.length===1&&k[0].value===""?r.jsx(me,{value:o[S],label:E,...$}):k.length===1?r.jsx(Qn,{checked:!!o[S],value:k[0].value,label:E,checkboxLabel:k[0].label,...$}):k.length===2?r.jsx(Nl,{values:k,value:o[S],label:E,...$}):k.length>2?r.jsx(Tl,{options:k,value:o[S],label:E,defaultLabel:c("personal_details.select_answer"),...$}):null};return r.jsxs("form",{onSubmit:d,"data-testid":void 0,noValidate:!0,children:[r.jsx("h2",{className:fc.title,children:c("personal_details.title")}),g.form?r.jsx(Oe,{variant:"error",visible:!y,children:g.form}):null,(w=e.firstNameLastName)!=null&&w.enabled?r.jsxs(Ne.Fragment,{children:[r.jsx(me,{value:u.firstName,onChange:h,label:c("personal_details.fist_name"),placeholder:c("personal_details.fist_name"),error:!!g.firstName,helperText:g.firstName,required:e.firstNameLastName.required,name:"firstName",autoComplete:"given-name"}),r.jsx(me,{value:u.lastName,onChange:h,label:c("personal_details.last_name"),placeholder:c("personal_details.last_name"),error:!!g.lastName,helperText:g.lastName,required:e.firstNameLastName.required,name:"lastName",autoComplete:"family-name"})]}):null,(_=e.companyName)!=null&&_.enabled?r.jsx(me,{value:u.companyName,onChange:h,label:c("personal_details.company_name"),placeholder:c("personal_details.company_name"),error:!!g.companyName,helperText:g.companyName,required:e.companyName.required,name:"companyName",autoComplete:"organization"}):null,(b=e.address)!=null&&b.enabled?r.jsxs(Ne.Fragment,{children:[r.jsx(me,{value:u.address,onChange:h,label:c("personal_details.address"),placeholder:c("personal_details.address"),error:!!g.address,helperText:g.address,required:e.address.required,name:"address",autoComplete:"address-line1"}),r.jsx(me,{value:u.address2,onChange:h,label:c("personal_details.address2"),placeholder:c("personal_details.address2"),error:!!g.address2,helperText:g.address2,name:"address2",autoComplete:"address-line2"}),r.jsx(me,{value:u.city,onChange:h,label:c("personal_details.city"),placeholder:c("personal_details.city"),error:!!g.city,helperText:g.city,required:e.address.required,name:"city",autoComplete:"address-level2"}),r.jsx(me,{value:u.state,onChange:h,label:c("personal_details.state"),placeholder:c("personal_details.state"),error:!!g.state,helperText:g.state,required:e.address.required,name:"state",autoComplete:"address-level1"}),r.jsx(me,{value:u.postCode,onChange:h,label:c("personal_details.post_code"),placeholder:c("personal_details.post_code"),error:!!g.postCode,helperText:g.postCode,required:e.address.required,name:"postCode",autoComplete:"postal-code"})]}):null,(v=e.phoneNumber)!=null&&v.enabled?r.jsx(me,{value:u.phoneNumber,onChange:h,label:c("personal_details.phone_number"),placeholder:c("personal_details.phone_number"),error:!!g.phoneNumber,helperText:g.phoneNumber,required:e.phoneNumber.required,name:"phoneNumber"}):null,(C=e.birthDate)!=null&&C.enabled?r.jsx(Rl,{value:u.birthDate,onChange:j=>l("birthDate",j.currentTarget.value),label:c("personal_details.birth_date"),error:!!g.birthDate,helperText:g.birthDate,required:e.birthDate.required,name:"birthDate"}):null,n.map(j=>x(j)),r.jsx(M,{className:fc.continue,type:"submit",label:c("personal_details.continue"),variant:"contained",color:"primary",size:"large",disabled:f,fullWidth:!0}),f&&r.jsx(je,{transparentBackground:!0,inline:!0})]})},Rt=(s,t)=>s?B().required(t):us().notRequired(),L_=()=>{const s=q(ye),t=ae(),e=ue(),{t:n}=T("account"),a=z(v=>v.accessModel),{data:o,isLoading:i}=We("captureStatus",s.getCaptureStatus),{mediaOffers:c}=ya(),l=c.length>0,[d,h]=m.useState({}),[u,g]=m.useState({}),y=m.useMemo(()=>Object.fromEntries((o==null?void 0:o.settings.map(v=>[v.key,v]))||[]),[o]),f=m.useMemo(()=>(o==null?void 0:o.settings.filter(v=>!!v.question))||[],[o]),x=m.useCallback(()=>{const v=a===Me.SVOD||a===Me.AUTHVOD&&l;t(J(e,v?"choose-offer":"welcome"),{replace:!0})},[t,e,a,l]);m.useEffect(()=>{o&&((!o.isCaptureEnabled||!o.shouldCaptureBeDisplayed)&&x(),f&&h(Object.fromEntries(f.map(v=>[v.key,""]))))},[o,x,f]);const w=m.useMemo(()=>{const[v,C]=(()=>{var j,S;if((j=y.firstNameLastName)!=null&&j.enabled){const E=(S=y.firstNameLastName)==null?void 0:S.answer;return[(E==null?void 0:E.firstName)||"",(E==null?void 0:E.lastName)||""]}return["",""]})();return{firstName:v,lastName:C,birthDate:"",companyName:"",phoneNumber:"",address:"",address2:"",city:"",state:"",postCode:"",country:""}},[y]),_=v=>{const C=v.target.type==="checkbox"&&!v.target.checked?"":v.target.value;h(j=>({...j,[v.target.name]:C}))},b=async(v,{setErrors:C,setSubmitting:j,setValidationSchemaError:S,validate:E})=>{var $,L,D,O,A,W,X,ee,Q,N;const P=n("personal_details.this_field_is_required"),I=ne().shape({firstName:Rt(!!(($=y.firstNameLastName)!=null&&$.required),P),lastName:Rt(!!((L=y.firstNameLastName)!=null&&L.required),P),address1:Rt(!!((D=y.address)!=null&&D.required),P),address2:Rt(!!((O=y.address)!=null&&O.required),P),postCode:Rt(!!((A=y.address)!=null&&A.required),P),state:Rt(!!((W=y.address)!=null&&W.required),P),city:Rt(!!((X=y.address)!=null&&X.required),P),companyName:Rt(!!((ee=y.companyName)!=null&&ee.required),P),birthDate:(Q=y.birthDate)!=null&&Q.required?B().required(P).matches(/\d{4}-\d{2}-\d{2}/,n("personal_details.birth_date_not_valid")):us().notRequired(),phoneNumber:Rt(!!((N=y.phoneNumber)!=null&&N.required),P)}),k={};if(f.forEach(R=>{R.enabled&&R.required&&!d[R.key]&&(k[R.key]=n("personal_details.this_field_is_required"))}),g(k),!E(I)||Object.keys(k).length){j(!1),S(!0);return}try{const R=G=>Object.fromEntries(Object.keys(G).filter(re=>G[re]!=="").map(re=>[re,G[re]])),Y=f.map(G=>({question:G.question,questionId:G.key,value:d[G.key]}));await s.updateCaptureAnswers(R({...v,customAnswers:Y})),x()}catch(R){R instanceof Error&&C({form:R.message})}j(!1)};return i?r.jsx("div",{style:{height:400},children:r.jsx(je,{inline:!0})}):r.jsx(N_,{initialValues:w,fields:y,questions:f,onQuestionChange:_,questionValues:d,questionErrors:u,onSubmit:b})};function Ol(s){const t=q(ye),{data:e,error:n}=We(["socialUrls",s],()=>t.getSocialLoginUrls(s),{enabled:t.getFeatures().hasSocialURLs,retry:!1}),a=m.useMemo(()=>e?e.reduce((o,i)=>({...o,...i}),{}):null,[e]);return n||!a?null:a}const Dl=({type:s,value:t="",label:e,options:n,editing:a,lang:o,...i})=>{const{t:c,i18n:l}=T(),d=m.useMemo(()=>s&&["country","us_state"].includes(s)?Object.keys(l.getResourceBundle(l.language,s)).map(u=>({value:u,label:c(`${s}:${u}`)})):n?Object.entries(n).map(([h,u])=>({value:h,label:u})):[],[s,n,l,c]);switch(s){case"input":return r.jsx(me,{...i,value:String(t),label:e,testId:void 0});case"radio":return r.jsx(Nl,{...i,label:e,values:d,value:String(t),"data-testid":void 0,lang:o});case"select":case"country":case"us_state":return r.jsx(Tl,{...i,options:d,value:String(t),label:e,defaultLabel:i.placeholder,testId:void 0,lang:o});case"datepicker":return r.jsx(Rl,{...i,value:String(t),label:e,testId:void 0});default:return r.jsx(Qn,{...i,checkboxLabel:e,checked:gs(t),"data-testid":void 0,lang:o})}},$_="_link_1nyb9_1",R_={link:$_},ln=({to:s,href:t,children:e,className:n,onClick:a,target:o,...i})=>{const c=F(R_.link,n);return s?r.jsx(hn,{to:s,className:c,onClick:a,...i,children:e}):r.jsx("a",{href:t,className:c,onClick:a,target:o,rel:o==="_blank"?"noreferrer":void 0,...i,children:e})},O_="_title_io7pr_1",D_="_bottom_io7pr_11",M_="_alreadyAccount_io7pr_16",F_="_login_io7pr_20",B_="_customFields_io7pr_27",In={title:O_,continue:"_continue_io7pr_7",bottom:D_,alreadyAccount:M_,login:F_,customFields:B_},U_=({onSubmit:s,onChange:t,onBlur:e,values:n,errors:a,submitting:o,validationError:i,loading:c,publisherConsents:l,consentValues:d,onConsentChange:h,consentErrors:u,captchaSiteKey:g,recaptchaRef:y})=>{const{t:f,i18n:x}=T("account"),w=ue(),_=m.useRef(null),b=x.language!==H.APP_DEFAULT_LANGUAGE?H.APP_DEFAULT_LANGUAGE:void 0,v=C=>{const j=Zr.sanitize(C),S=/<a(.|\n)*?>/.test(j),E=/<\/a(.|\n)*?>/.test(j);return S&&E?r.jsx("span",{dangerouslySetInnerHTML:{__html:C}}):C};return m.useEffect(()=>{var C;a.form&&((C=_.current)==null||C.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}))},[a.form]),r.jsxs("form",{onSubmit:s,"data-testid":void 0,noValidate:!0,children:[r.jsx("div",{ref:_,children:a.form?r.jsx(Oe,{variant:"error",visible:!i,children:a.form}):null}),r.jsx("h2",{className:In.title,children:f("registration.sign_up")}),r.jsx(me,{value:n.email,onChange:t,onBlur:e,label:f("registration.email"),placeholder:f("registration.email"),error:!!a.email,helperText:a.email,name:"email",type:"email",autoComplete:"email",required:!0}),r.jsx(an,{value:n.password,onChange:t,onBlur:e,label:f("registration.password"),placeholder:f("registration.password"),error:!!a.password,name:"password",autoComplete:"new-password",required:!0}),l&&r.jsx("div",{className:In.customFields,"data-testid":"custom-reg-fields",children:l.map(C=>{const j=u.find(S=>S===C.name);return r.jsx(Dl,{type:C.type,name:C.name,options:C.options,label:v(C.label),placeholder:C.placeholder,value:d[C.name]||"",required:C.required,error:!!j,helperText:j?f("registration.field_required"):void 0,onChange:h,lang:b},C.name)})}),!!g&&r.jsx(Il,{siteKey:g,ref:y}),r.jsx(M,{className:In.continue,type:"submit",label:f("registration.continue"),variant:"contained",color:"primary",size:"large",disabled:o,fullWidth:!0}),r.jsxs("p",{className:In.bottom,children:[f("registration.already_account")," ",r.jsx(ln,{to:J(w,"login"),children:f("login.sign_in")})]}),(c||o)&&r.jsx(je,{transparentBackground:!0,inline:!0})]})},H_=()=>{const s=q(ye),t=ae(),e=ue(),{t:n}=T("account"),a=Ke(),[o,i]=m.useState({}),[c,l]=m.useState([]),{publisherConsents:d,publisherConsentsLoading:h,loading:u}=U(({publisherConsents:P,publisherConsentsLoading:I,loading:k})=>({publisherConsents:P,publisherConsentsLoading:I,loading:k})),{recaptchaRef:g,captchaSiteKey:y,getCaptchaValue:f}=Al(),x=({currentTarget:P})=>{if(!P)return;const{name:I,type:k}=P,$=k==="checkbox"?P.checked:P.value;i(L=>({...L,[I]:$})),l(L=>L.filter(D=>D!==I))};m.useEffect(()=>{if(!d){s.getPublisherConsents();return}i(_h(d))},[s,d]);const w=Ol(Mt("personal-details")),{handleSubmit:_,handleChange:b,handleBlur:v,values:C,errors:j,validationSchemaError:S,submitting:E}=Nt({initialValues:{email:"",password:""},validationSchema:ne().shape({email:B().email(n("registration.field_is_not_valid_email")).required(n("registration.field_required",{field:n("registration.email")})),password:B().matches(/^(?=.*[a-z])(?=.*[0-9]).{8,}$/,n("registration.invalid_password",{field:n("registration.password")})).required(n("registration.field_required",{field:n("registration.password")})),captchaValue:B().notRequired()}),validateOnBlur:!0,onSubmit:async({email:P,password:I})=>{const{consentsErrors:k}=yh(d||[],o);if(k.length)throw l(k),new Error(n("registration.consents_error"));const $=await f();await s.register(P,I,window.location.href,Mn(d,o),$)},onSubmitSuccess:()=>{a(n("registration.success"),"success"),t(J(e,"personal-details"))}});return r.jsx(U_,{onSubmit:_,onChange:b,onConsentChange:x,onBlur:v,values:C,errors:j,consentErrors:c,validationError:S,submitting:E,consentValues:o,publisherConsents:d,loading:u||h,socialLoginURLs:w,captchaSiteKey:y,recaptchaRef:g})},W_="_title_8jji7_1",V_="_link_8jji7_7",q_="_bottom_8jji7_11",G_="_top_8jji7_16",Sr={title:W_,link:V_,bottom:q_,top:G_},z_=({onSubmit:s,onChange:t,values:e,errors:n,validationError:a,submitting:o,siteName:i})=>{const[c,l]=ma(),{t:d}=T("account"),h=ue();return r.jsxs("form",{onSubmit:s,"data-testid":void 0,noValidate:!0,children:[n.form?r.jsx(Oe,{variant:"error",visible:!a,children:n.form}):null,r.jsx("h2",{className:Sr.title,children:d("login.sign_in")}),r.jsx(me,{value:e.email,onChange:t,label:d("login.email"),placeholder:d("login.email"),error:!!n.email,helperText:n.email,name:"email",type:"email",required:!0,testId:"login-email-input",autoComplete:"email"}),r.jsx(me,{value:e.password,onChange:t,label:d("login.password"),placeholder:d("login.password"),error:!!n.password,helperText:n.password,name:"password",type:c?"text":"password",rightControl:r.jsx(ze,{"aria-label":d("login.view_password"),onClick:()=>l(),"aria-pressed":c,children:r.jsx(K,{icon:c?fa:ga})}),required:!0,testId:"login-password-input",autoComplete:"current-password"}),o&&r.jsx(je,{transparentBackground:!0,inline:!0}),r.jsx(ln,{className:Sr.link,to:J(h,"forgot-password"),children:d("login.forgot_password")}),r.jsx(M,{type:"submit",label:d("login.sign_in"),variant:"contained",color:"primary",size:"large",disabled:o,fullWidth:!0}),r.jsxs("p",{className:Sr.bottom,children:[d("login.not_registered",{siteName:i})," ",r.jsx(ln,{to:J(h,"create-account"),children:d("login.sign_up")})]})]})},K_=()=>{const s=q(ye),{siteName:t}=z(y=>y.config),e=ae(),n=ue(),{t:a}=T("account"),o=Ke(),i=Ol(window.location.href.split("?")[0]),{values:c,errors:l,submitting:d,validationSchemaError:h,handleSubmit:u,handleChange:g}=Nt({initialValues:{email:"",password:""},validationSchema:ne().shape({email:B().email(a("login.field_is_not_valid_email")).required(a("login.field_required",{field:a("login.email")})),password:B().required(a("login.field_required",{field:a("login.password")}))}),onSubmit:({email:y,password:f})=>s.login(y,f,window.location.href),onSubmitSuccess:()=>{o(a("login.sign_in_success"),"success"),e(J(n,null))},onSubmitError:({resetValue:y})=>y("password")});return r.jsx(z_,{values:c,validationError:h,errors:l,submitting:d,siteName:t,socialLoginURLs:i,onSubmit:u,onChange:g})},J_="_banner_ygdsu_1",Y_={banner:J_},Q_=["login","create-account","forgot-password","reset-password","send-confirmation","edit-password"],X_=()=>{const s=ae(),t=ue(),e=He("u"),n=m.useRef(e),a=He("message"),{loading:o,user:i}=U(({loading:_,user:b})=>({loading:_,user:b}),de),c=z(_=>_.config),{assets:{banner:l},siteName:d}=c,h=e&&Q_.includes(e),u=he(()=>{s(J(t,"login"))}),g=m.useMemo(()=>(e&&(n.current=e),n.current),[e]);m.useEffect(()=>{e&&!o&&!i&&!h&&u()},[e,o,h,i,u]);const y=he(()=>{s(yl(t,{u:null,message:null}))}),f=()=>{if(!i&&o&&!h)return r.jsx("div",{style:{height:300},children:r.jsx(je,{inline:!0})});switch(g){case"login":return r.jsx(K_,{});case"create-account":return r.jsx(H_,{});case"personal-details":return r.jsx(L_,{});case"choose-offer":return r.jsx(pc,{});case"edit-card":return r.jsx(Nf,{});case"upgrade-subscription":return r.jsx(pc,{});case"upgrade-subscription-error":return r.jsx(hr,{type:"error",onCloseButtonClick:y});case"upgrade-subscription-success":return r.jsx(hr,{type:"success",onCloseButtonClick:y});case"upgrade-subscription-pending":return r.jsx(hr,{type:"pending",onCloseButtonClick:y});case"checkout":return r.jsx(Kg,{});case"payment-error":return r.jsx(Zi,{type:"error",message:a,onCloseButtonClick:y});case"payment-cancelled":return r.jsx(Zi,{type:"cancelled",message:a,onCloseButtonClick:y});case"welcome":return r.jsx(Qp,{onCloseButtonClick:y,onCountdownCompleted:y,siteName:d});case"reset-password":return r.jsx(_r,{type:"reset"});case"forgot-password":return r.jsx(_r,{type:"forgot"});case"add-password":return r.jsx(uc,{type:"add"});case"delete-account":case"delete-account-confirmation":return r.jsx(Gm,{});case"warning-account-deletion":return r.jsx(df,{});case"send-confirmation":return r.jsx(_r,{type:"confirmation"});case"edit-password":return r.jsx(uc,{});case"unsubscribe":return r.jsx(eg,{});case"renew-subscription":return r.jsx(Kf,{});case"payment-method":case"payment-method-success":return r.jsx(Sf,{onCloseButtonClick:y});case"waiting-for-payment":return r.jsx(Zm,{});case"finalize-payment":return r.jsx(Jm,{})}},x=!["delete-account","delete-account-confirmation","edit-card","warning-account-deletion"].includes(g??""),w=["delete-account-confirmation"].includes(g??"")?"large":"small";return r.jsxs(pa,{size:w,open:!!e,onClose:y,children:[x&&l&&r.jsx("div",{className:Y_.banner,children:r.jsx("img",{src:l,alt:""})}),f()]})},Z_={jwpAuth:{id:"9qqwmnbx",label:"JWP AUTHVOD"},jwpSvod:{id:"a2kbjdv0",label:"JWP SVOD"},jwpAuthNoWatchlist:{id:"oqrsyxin",label:"JWP Authvod (No WL)"},basicNoAuth:{id:"gnnuzabk",label:"Demo App (No Auth)"},noStyling:{id:"kujzeu1b",label:"No Styling (No Auth)"},inlinePlayer:{id:"ata6ucb8",label:"Inline Player"},cleengAuthvod:{id:"nvqkufhy",label:"Cleeng Authvod"},cleengAuthvodNoWatchlist:{id:"7weyqrua",label:"Cleeng Authvod (No WL)"},svod:{id:"ozylzc5m",label:"Cleeng SVOD"}},ey=Z_;[...Object.values(ey).map(({id:s,label:t})=>({value:s,label:`${s.length>8?"ext-json":s} - ${t}`}))];const ty=q(zn),sy=(s,t)=>{const e=ea(),{i18n:n}=T(),a=()=>e.invalidateQueries({queryKey:["entitlements"]}),{data:o,isLoading:i,error:c,isSuccess:l,refetch:d}=We("config-init",()=>ty.initializeApp(s,n.language,a),{refetchInterval:!1,retry:1,onSettled:h=>{Dt("Bootstrap","Initialized application",{...h}),t(h==null?void 0:h.config)},cacheTime:ms,staleTime:fs});return{data:o,isLoading:i,error:c,isSuccess:l,refetch:d}},ny=s=>{const t=document.querySelector(":root"),{highlightColor:e,backgroundColor:n,headerBackground:a}=s.styling||{},o=H.APP_BODY_FONT,i=H.APP_BODY_ALT_FONT;if(t){if(t.style.setProperty("--highlight-color",e||"#fff"),t.style.setProperty("--highlight-contrast-color",e?ir(e):"#000"),a&&(t.style.setProperty("--header-background",a),t.style.setProperty("--header-contrast-color",ir(a))),n){const c=ir(n);t.style.setProperty("--body-background-color",n),t.style.setProperty("--body-color",c),c==="#000000"&&(t.style.setProperty("--body-text-shadow","none"),t.style.setProperty("--hero-shelf-background-color","#1f1f1f"),t.style.setProperty("--epg-background-color","#262626"))}o&&t.style.setProperty("--body-font-family",o),i&&t.style.setProperty("--body-alt-font-family",i)}},ry="_title_gkrmh_1",ay="_body_gkrmh_8",oy="_confirmButton_gkrmh_12",jr={title:ry,body:ay,confirmButton:oy},iy=({open:s,title:t,body:e,onConfirm:n,onClose:a,busy:o})=>{const{t:i}=T("common");return r.jsxs(pa,{open:s,onClose:a,role:"alertdialog",children:[r.jsx("h2",{className:jr.title,children:t}),r.jsx("p",{className:jr.body,children:e}),r.jsx(M,{className:jr.confirmButton,label:i("confirmation_dialog.confirm"),variant:"contained",color:o?"default":"primary",onClick:n,fullWidth:!0,disabled:o,busy:o}),r.jsx(M,{label:i("confirmation_dialog.close"),variant:"outlined",onClick:a,fullWidth:!0,disabled:o})]})},cy=()=>{const s=Vd();return r.jsx(rt,{error:s})},ly="_markdown_hxhg7_1",dy="_inline_hxhg7_62",gc={markdown:ly,inline:dy},va=new Fn.Renderer;va.link=(s,t,e)=>{const n=/^(https?|www\.|\/\/)/.test(s||""),a=n?'target="_blank"':void 0,o=n?'rel="noopener"':void 0,i=t?`title="${t}"`:void 0,c=[a,o,i].filter(Boolean);return`<a href="${s}" ${c.join(" ")}>${e}</a>`};const xa=new Fn.Renderer({gfm:!1});xa.image=()=>"";xa.link=va.link;const Hs=({markdownString:s,className:t,tag:e="div",inline:n=!1})=>{const a=m.useMemo(()=>{const o=n?Fn.parseInline(s,{renderer:xa}):Fn.parse(s,{renderer:va});return Zr.sanitize(o,{ADD_ATTR:["target"]})},[n,s]);return Ne.createElement(e,{dangerouslySetInnerHTML:{__html:a},className:F(gc.markdown,n&&gc.inline,t)})},uy="_about_c4gxs_1",hy={about:uy},py=()=>r.jsx(Hs,{className:hy.about,markdownString:`# About JW OTT Webapp
  
JW OTT Webapp is an open-source, dynamically generated video website built around JW Player and JW Platform services. It enables you to easily publish your JW Player-hosted video content with no coding and minimal configuration.

To see an example of JW OTT Webapp in action, see [https://app-preview.jwplayer.com/](https://app-preview.jwplayer.com/).

## Supported Features

- Works with any JW Player edition, from Free to Enterprise (note that usage will count against your monthly JW streaming limits). Only cloud-hosted JW Players are supported.
- It looks great on any device. The responsive UI automatically optimizes itself for desktop, tablet, and mobile screens.
- Populates your site's media content using JSON feeds. If you are using JW Platform, this happens auto-magically based on playlists that you specify. Using feeds from other sources will require you to hack the source code.
- Video titles, descriptions and hero images are populated from JW Platform JSON feed metadata.
- Playback of HLS video content from the JW Platform CDN. You can add external URLs (for example, URLS from your own server or CDN) to your playlists in the Content section of your JW Player account dashboard, but they must be HLS streams (\`.m3u8\` files).
- Support for live video streams (must be registered as external .m3u8 URLs in your JW Dashboard).
- Customize the user interface with your own branding. The default app is configured for JW Player branding and content, but you can easily change this to use your own assets by modifying the \`config.json\` file. Advanced customization is possible (for example, editing the CSS files), but you will need to modify the source code and build from source.
- Site-wide video search and related video recommendations powered by [JW Recommendations](https://docs.jwplayer.com/platform/docs/vdh-learn-about-recommendations).
- Basic playback analytics is reported to your JW Dashboard.
- Ad integrations (VAST, VPAID, GoogleIMA, etc.). These features require a JW Player Ads Edition license. For more information, see the [JW Player pricing page](https://www.jwplayer.com/pricing/).
- A "Favorites" feature for users to save videos for watching later. A separate list for "Continue Watching" is also kept so users can resume watching videos from where they left off. The lists are per-browser at this time (i.e., lists do not sync across user's browsers or devices). The "Continue Watching" list can be disabled in your JW OTT Webapp's \`config.json\` file.
- A grid view for a particular playlist of videos, with the ability to deep-link to the playlist through a static URL.
- Social sharing options using the device native sharing dialog.

## Unsupported Features

- Security-related features (encrypted HLS, DRM, signed URLs)
- Self-hosted JW Players`}),my=dl(30),Ml=({type:s,contentId:t,siteId:e,enabled:n,usePlaceholderData:a,params:o={},queryClient:i,language:c})=>{const l=q(Ee);return{enabled:!!t&&n,queryKey:["playlist",s,t,o,c],queryFn:async()=>{var d;if(s===Ft.playlist){const h=await l.getPlaylistById(t,o,c);return(d=h==null?void 0:h.playlist)==null||d.forEach(u=>{i.setQueryData(["media",u.mediaid],u)}),h}else if(s===Ft.content_list)return await l.getContentList({siteId:e,id:t,language:c})},placeholderData:t&&a?my:void 0,refetchInterval:d=>d&&(gs(d.refetch)||d.playlist.some(Yc))?1e3*30:!1,retry:!1}};function _n(s,t={},e=!0,n=!0,a=Ft.playlist){const{i18n:o}=T(),i=o.language,c=ea(),l=z(h=>h.config.siteId),d=Ml({type:a,contentId:s,siteId:l,params:t,queryClient:c,enabled:e,usePlaceholderData:n,language:i});return We(d)}const fy=s=>!hu.some(t=>t===s),gy=(s,t=void 0)=>{const e=pu.toString(),n=ea(),a=z(h=>h.config.siteId),o=ft(h=>h.getPlaylist()),i=_t(h=>h.getPlaylist()),{i18n:c}=T(),l=Fc(s.map(({contentId:h,type:u},g)=>fy(u)?Ml({enabled:!t||t>g,type:u,siteId:a,contentId:h,queryClient:n,usePlaceholderData:!0,params:{page_limit:e},language:c.language}):{enabled:!1}));return s.map(({type:h},u)=>{if(h===yt.Favorites)return{data:o,isLoading:!1,isSuccess:!0};if(h===yt.ContinueWatching)return{data:i,isLoading:!1,isSuccess:!0};const{data:g,isSuccess:y,error:f,isPlaceholderData:x}=l[u];return{data:g,isSuccess:y,error:f,isPlaceholderData:x}})},Xn=s=>{const{i18n:t}=T();return`${s}-${t.language}`},wa=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})),yn=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})),An=(s,t)=>{typeof s.addEventListener>"u"?s.addListener(t):s.addEventListener("change",t)},kn=(s,t)=>{typeof s.removeEventListener>"u"?s.removeListener(t):s.removeEventListener("change",t)},zr=matchMedia("screen and (max-width: 479px)"),Kr=matchMedia("screen and (min-width: 480px) and (max-width: 767px)"),Jr=matchMedia("screen and (min-width: 768px) and (max-width: 1023px)"),Yr=matchMedia("screen and (min-width: 1024px) and (max-width: 1199px)");var Z=(s=>(s[s.xs=0]="xs",s[s.sm=1]="sm",s[s.md=2]="md",s[s.lg=3]="lg",s[s.xl=4]="xl",s))(Z||{});const _c=()=>zr.matches?0:Kr.matches?1:Jr.matches?2:Yr.matches?3:4,Ie=()=>{const[s,t]=m.useState(()=>_c());return m.useEffect(()=>{const e=()=>t(_c());return An(zr,e),An(Kr,e),An(Jr,e),An(Yr,e),()=>{kn(zr,e),kn(Kr,e),kn(Jr,e),kn(Yr,e)}},[]),s},ba=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{fill:"currentColor",d:"M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z"})),Sa=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),m.createElement("path",{d:"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"})),_y="_image_f8aiq_1",yy={image:_y},vy=(s,t)=>Se(s,{width:t}),Cr=new Map,xy=async(s,t)=>{const e=vy(s,t);let n=e;if(Cr.has(e))return Cr.get(e);try{const a=await fetch(e);a.redirected&&(n=a.url.replace("-1920",`-${t}`)),Cr.set(e,n)}catch(a){Zc("Image","Failed to fetch image",{error:a,url:n})}return n},wy=m.forwardRef(({className:s,image:t,onLoad:e,alt:n="",width:a=640},o)=>{const[i,c]=m.useState(null);return m.useEffect(()=>{if(!t)return;(async()=>{const d=await xy(t,a);c(d),e==null||e()})()},[t,a,e]),i?r.jsx("img",{ref:o,className:`${s} ${yy.image}`,src:i,alt:n}):null}),Ws=Ne.memo(wy),by="_card_w4d6e_1",Sy="_featured_w4d6e_18",jy="_title_w4d6e_18",Cy="_tag_w4d6e_33",Py="_meta_w4d6e_42",Ey="_disabled_w4d6e_50",Iy="_poster_w4d6e_55",Ay="_current_w4d6e_65",ky="_posterImage_w4d6e_74",Ty="_currentLabel_w4d6e_82",Ny="_aspect11_w4d6e_98",Ly="_aspect21_w4d6e_102",$y="_aspect23_w4d6e_106",Ry="_aspect43_w4d6e_110",Oy="_aspect53_w4d6e_114",Dy="_aspect169_w4d6e_118",My="_aspect916_w4d6e_122",Fy="_aspect913_w4d6e_126",By="_titleContainer_w4d6e_130",Uy="_loading_w4d6e_152",Hy="_scheduledStart_w4d6e_167",Wy="_tags_w4d6e_189",Vy="_lock_w4d6e_211",qy="_live_w4d6e_220",Gy="_scheduled_w4d6e_167",zy="_progressContainer_w4d6e_230",Ky="_progressBar_w4d6e_240",ge={card:by,featured:Sy,title:jy,tag:Cy,meta:Py,disabled:Ey,poster:Iy,current:Ay,posterImage:ky,currentLabel:Ty,aspect11:Ny,aspect21:Ly,aspect23:$y,aspect43:Ry,aspect53:Oy,aspect169:Dy,aspect916:My,aspect913:Fy,titleContainer:By,loading:Uy,scheduledStart:Hy,tags:Wy,lock:Vy,live:qy,scheduled:Gy,progressContainer:zy,progressBar:Ky},Jy=Symbol("CARD");function Yy({onHover:s,progress:t,item:e,posterAspect:n="16:9",featured:a=!1,disabled:o=!1,loading:i=!1,isCurrent:c=!1,isLocked:l=!0,currentLabel:d,headingLevel:h=3,url:u,tabIndex:g=0}){const{title:y,duration:f,episodeNumber:x,seasonNumber:w,cardImage:_,mediaStatus:b,scheduledStart:v}=e,{t:C,i18n:{language:j}}=T(["common","video"]),S=F(ge.card,{[ge.featured]:a,[ge.disabled]:o}),E=n?ge[`aspect${n.replace(":","")}`]:void 0,P=F(ge.poster,E,{[ge.current]:c}),I=sl(e),k=b===Bt.LIVE||rl(e),$=b===Bt.SCHEDULED,L=()=>{if(i||!y)return null;if(I)return r.jsx("div",{className:ge.tag,children:C("video:series")});if(x)return r.jsx("div",{className:ge.tag,children:Kn(w,x)});if(f)return r.jsx("div",{className:ge.tag,children:la(f,{minutesAbbreviation:C("common:abbreviation.minutes")})});if(k)return r.jsx("div",{className:F(ge.tag,ge.live),children:C("live")});if($)return r.jsxs("div",{className:ge.tag,children:[r.jsx(K,{icon:Sa,className:ge.scheduled}),C("scheduled")]})},D=Ne.createElement(`h${h}`,{className:F(ge.title,{[ge.loading]:i})},i?"":y);return r.jsxs(hn,{role:"button",to:u,className:S,onClick:o?O=>O.preventDefault():void 0,onMouseEnter:s,tabIndex:o?-1:g,"data-testid":void 0,children:[!a&&r.jsxs("div",{className:ge.titleContainer,children:[D,!!v&&Jc(e)&&r.jsx("div",{className:F(ge.scheduledStart,{[ge.loading]:i}),children:Bn(v,j)})]}),r.jsxs("div",{className:P,children:[r.jsx(Ws,{className:ge.posterImage,image:_,width:a?640:320,alt:""}),!i&&r.jsxs("div",{className:ge.meta,children:[a&&D,r.jsxs("div",{className:ge.tags,children:[l&&r.jsx("div",{className:F(ge.tag,ge.lock),"aria-label":C("card_lock"),role:"img",children:r.jsx(K,{icon:ba})}),L()]})]}),c&&r.jsx("div",{className:ge.currentLabel,children:d}),t?r.jsx("div",{className:ge.progressContainer,children:r.jsx("div",{className:ge.progressBar,style:{width:`${Math.round(t*100)}%`}})}):null]})]})}const Fl=m.memo(vs(Jy,Yy)),Qy="_shelf_11rpw_1",Xy="_chevron_11rpw_5",Zy="_loadingTitle_11rpw_9",ev="_title_11rpw_17",tv="_slider_11rpw_29",sv="_dots_11rpw_71",nv="_dot_11rpw_71",rv="_active_11rpw_90",av="_error_11rpw_95",Ct={shelf:Qy,chevron:Xy,loadingTitle:Zy,title:ev,slider:tv,dots:sv,dot:nv,active:rv,error:av},ov={[Z.xs]:1,[Z.sm]:2,[Z.md]:3,[Z.lg]:4,[Z.xl]:5},iv={[Z.xs]:1,[Z.sm]:1,[Z.md]:1,[Z.lg]:1,[Z.xl]:1},cv=Symbol("SHELF"),lv=({playlist:s,type:t,onCardHover:e,title:n,watchHistory:a,featured:o=!1,loading:i=!1,error:c=null,accessModel:l,isLoggedIn:d,hasSubscription:h,posterAspect:u,visibleTilesDelta:g=0})=>{const y=Ie(),{t:f}=T("common"),x=(o?iv[y]:ov[y])+g,w=m.useCallback(({item:C,isVisible:j})=>{const{mediaid:S,title:E}=C,P=Te({id:S,title:E,playlistId:s.feedid,play:t===yt.ContinueWatching});return r.jsx(Fl,{progress:a?a[C.mediaid]:void 0,onHover:typeof e=="function"?()=>e(C):void 0,featured:o,disabled:!j,loading:i,isLocked:Gn(l,d,h,C),posterAspect:u,item:C,url:P},C.mediaid)},[a,e,o,i,l,d,h,u,s.feedid,t]),_=m.useCallback(({onClick:C})=>r.jsx("button",{className:Ct.chevron,"aria-label":f("slide_next"),onClick:C,children:r.jsx(K,{icon:yn})}),[f]),b=m.useCallback(({onClick:C})=>r.jsx("button",{className:Ct.chevron,"aria-label":f("slide_previous"),onClick:C,children:r.jsx(K,{icon:wa})}),[f]),v=({page:C,pages:j})=>{const S=Array.from({length:j},(E,P)=>P);return r.jsxs(r.Fragment,{children:[r.jsx("div",{"aria-live":"polite",className:"hidden",children:f("slide_indicator",{page:C+1,pages:j})}),o&&r.jsx("div",{"aria-hidden":"true",className:Ct.dots,children:S.map(E=>r.jsx("span",{className:F(Ct.dot,{[Ct.active]:C===E})},E))})]})};return c||!(s!=null&&s.playlist)?r.jsx("h2",{className:Ct.error,children:"Could not load items"}):r.jsxs("div",{className:F(Ct.shelf),children:[o?null:i?r.jsx("div",{className:Ct.loadingTitle}):r.jsx("h2",{className:F(Ct.title),children:n||s.title}),r.jsx(qd,{className:Ct.slider,items:s.playlist,tilesToShow:x,cycleMode:Gd,showControls:!i,spacing:16,renderLeftControl:b,renderRightControl:_,renderPagination:v,renderTile:w})]})},dv=vs(cv,lv),uv="_infiniteScrollLoader_6rn4e_1",hv={infiniteScrollLoader:uv},ja=()=>r.jsx("div",{className:hv.infiniteScrollLoader,children:r.jsx(ys,{})}),Vs=({className:s,open:t=!0,duration:e=250,delay:n=0,onOpenAnimationEnd:a,onCloseAnimationEnd:o,keepMounted:i,children:c})=>{const d=`opacity ${e/1e3}s ease-in-out`,h=u=>({transition:d,opacity:u==="opening"||u==="open"?1:0,willChange:"opacity"});return r.jsx(ua,{className:s,createStyle:u=>h(u),open:t,duration:e,delay:n,onOpenAnimationEnd:a,onCloseAnimationEnd:o,keepMounted:i,children:c})},Bl=(s=300,t=30,e)=>{const n=he(()=>{const o=(document.scrollingElement||document.body).scrollTop,i=Math.max(0,Math.min(1,(o-s)/(t-s)));e(i)});m.useEffect(()=>{const{scrollingElement:a,documentElement:o,body:i}=document,c=a&&a!==o&&a!==i?a:window;return c.addEventListener("scroll",n,{passive:!0}),()=>{c.removeEventListener("scroll",n)}},[n])},pv="_shelf_19ep9_1",mv="_chevron_19ep9_19",fv="_loadingTitle_19ep9_47",gv="_title_19ep9_55",_v="_poster_19ep9_74",yv="_background_19ep9_108",vv="_image_19ep9_141",xv="_fade_19ep9_148",wv="_fade2_19ep9_157",bv="_swipeSlider_19ep9_171",Sv="_swipeSliderMobile_19ep9_178",jv="_metadata_19ep9_183",Cv="_error_19ep9_250",Pv="_dimmed_19ep9_290",Ev="_chevronLeft_19ep9_295",Iv="_chevronRight_19ep9_300",Av="_dots_19ep9_304",kv="_dotsList_19ep9_318",Tv="_dot_19ep9_304",Nv="_dotActive_19ep9_354",Lv="_dotPlaceholder_19ep9_363",Pe={shelf:pv,chevron:mv,loadingTitle:fv,title:gv,poster:_v,background:yv,image:vv,fade:xv,fade2:wv,swipeSlider:bv,swipeSliderMobile:Sv,metadata:jv,error:Cv,dimmed:Pv,chevronLeft:Ev,chevronRight:Iv,dots:Av,dotsList:kv,dot:Tv,dotActive:Nv,dotPlaceholder:Lv},$v="_truncatedText_vuggl_1",Rv={truncatedText:$v},Ul=({text:s,maximumLines:t,className:e})=>r.jsx("div",{className:F(Rv.truncatedText,e),style:{maxHeight:`calc(1.5em * ${t})`,WebkitLineClamp:t,lineClamp:t,display:"-webkit-box"},children:r.jsx(Hs,{markdownString:s,inline:!0})}),Ov=["data","isLoading"],qs=s=>{const{accessModel:t}=z(),{user:e,subscription:n}=U(({user:u,subscription:g})=>({user:u,subscription:g}),de),a=q(Tt,!1),o=s&&!Gn(t,!!e,!!n,s),i=(s==null?void 0:s.mediaOffers)||[],c=Fc(i.map(({offerId:u})=>({queryKey:["entitlements",u],queryFn:()=>a==null?void 0:a.getEntitlements({offerId:u}),enabled:!!s&&!!e&&!!e.id&&!!u&&!o,refetchOnMount:"always",notifyOnChangeProps:Ov}))),l=!!e&&c.some(u=>{var g,y;return u.isSuccess&&((y=(g=u.data)==null?void 0:g.responseData)==null?void 0:y.accessGranted)}),d=!l&&c.some(u=>u.isLoading);return{isEntitled:!!s&&(o||l),isMediaEntitlementLoading:d,mediaOffers:i}},Hl=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M8,5.14V19.14L19,12.14L8,5.14Z"})),Dv="_progressRail_14udi_1",Mv="_progress_14udi_1",yc={progressRail:Dv,progress:Mv},Gs=({item:s,playUrl:t,disabled:e=!1,onClick:n})=>{const{t:a}=T("video"),o=ae(),i=ue(),c=Ie(),l=z(v=>v.accessModel),h=!!U(v=>v.user),u=_t(v=>s&&v.getItem(s)),g=u==null?void 0:u.progress,y=be(v=>v.setRequestedMediaOffers),{isEntitled:f,mediaOffers:x}=qs(s),w=!!x.length,_=m.useMemo(()=>a(f?typeof g=="number"?"continue_watching":"start_watching":w?"buy":h?"complete_your_subscription":"sign_up_to_start_watching"),[f,h,w,g,a]),b=m.useCallback(()=>{if(f){if(n){n();return}return t&&o(t)}return o(h?w?J(i,"choose-offer"):"/u/payments":J(i,"create-account"))},[f,t,o,h,i,w,n]);return m.useEffect(()=>(y(x),()=>y([])),[x,y]),l===Me.AVOD&&!f?null:r.jsx(M,{color:"primary",variant:"contained",size:"large",label:_,startIcon:f?r.jsx(K,{icon:Hl}):void 0,onClick:b,fullWidth:c<Z.md,disabled:e,children:g?r.jsx("div",{className:yc.progressRail,children:r.jsx("div",{className:yc.progress,style:{width:`${g*100}%`}})}):null})},Pr=({item:s,loading:t,playlistId:e,style:n,hidden:a})=>{const o=ae(),{t:i}=T("common"),l=Ie()<Z.sm;if(!s)return null;const d=!Qt(s,nt.hub)&&!Qt(s,nt.liveChannel)&&!Qt(s,nt.page),u=s.sources.find(g=>g.file.indexOf(".m3u8")>-1||g.file.indexOf(".mp4")>-1)&&d&&!l;return r.jsxs("div",{className:Pe.metadata,"data-testid":void 0,style:{...n,visibility:a?"hidden":void 0},"aria-hidden":a?"true":void 0,children:[r.jsx("h2",{className:F(t?Pe.loadingTitle:Pe.title),children:!t&&(s==null?void 0:s.title)}),r.jsx(Ul,{text:s==null?void 0:s.description,maximumLines:3}),r.jsxs("div",{children:[u&&r.jsx(Gs,{item:s,playUrl:Te({id:s.mediaid,title:s.title,playlistId:e,play:!0})}),r.jsx(M,{label:i("common:more_info"),onClick:()=>o(Te({id:s.mediaid,title:s.title,playlistId:e})),startIcon:r.jsx(K,{icon:yn}),size:"large",variant:u?void 0:"contained",color:u?void 0:"primary"})]})]})},Fv=({item:s,style:t,hidden:e,onTransitionEnd:n})=>{if(!s)return null;const a=s==null?void 0:s.backgroundImage;return r.jsx("div",{style:{...t,visibility:e?"hidden":void 0},"aria-hidden":e?"true":void 0,onTransitionEnd:n,children:r.jsx(Ws,{className:Pe.image,image:a,width:1920,alt:s==null?void 0:s.title})},s.mediaid)},Er=Ne.memo(Fv),Bv=(s,t,e,n,a)=>{const o=s==="left",i=s==="right",c={semiEdgeLeft:t===e-n+1&&i,edgeLeft:t===e-n,newDotLeft:t===e-n-1,semiEdgeRight:t===e+n-1&&o,edgeRight:t===e+n,newDotRight:t===e+n+1};return c.semiEdgeLeft||c.semiEdgeRight?a:c.edgeLeft?i?0:o?1:a:c.edgeRight?o?0:i?1:a:c.newDotLeft?o?a:0:c.newDotRight?i?a:0:1},Uv=({playlist:s,index:t,direction:e,nextIndex:n,setIndex:a,range:o=3,animationDuration:i=200})=>{const{t:c}=T("common"),l=o+1,d=t+l,h=n+l,u=m.useMemo(()=>{const g=Array.from({length:l}).map(()=>!1);return[...g,...s.playlist,...g]},[s.playlist,l]);return r.jsxs(r.Fragment,{children:[r.jsx("div",{"aria-live":"polite",className:"hidden",children:c("slide_indicator",{page:t+1,pages:s.playlist.length})}),r.jsx("nav",{className:Pe.dots,children:r.jsx("ul",{className:Pe.dotsList,children:u.map((g,y)=>{if(y<d-o-1||y>d+o+1)return null;if(!g)return r.jsx("li",{className:F(Pe.dotPlaceholder),"aria-hidden":"true"},y);const x=Math.abs(d-h)*22,_=`translateX(${e==="left"?x:e==="right"?0-x:0}px)`,b=e?`transform ${i}ms ease-out ${i/3}ms, width ${i/2}ms ease-out ${i/3}ms`:"",v=Bv(e,y,d,o,.6),C=`scale(${v})`,j=e?`width ${i}ms ease-out, height ${i}ms ease-out, transform ${i}ms ease-out`:"",S=y===d,E=v!==1,P=E?void 0:c("slide_to",{item:y-l+1,items:s.playlist.length});return r.jsx("li",{"aria-hidden":E||void 0,"aria-current":S||void 0,children:r.jsx("button",{className:F(Pe.dot,y===h&&Pe.dotActive,!e&&y===d&&Pe.dotActive),style:{transform:_,transition:b},"aria-label":P,disabled:E||void 0,onClick:E||S?void 0:()=>a(y-l),children:r.jsx("div",{style:{transform:C,transition:j}})})},g==null?void 0:g.mediaid)})})})]})},Hv=({hasLeftItem:s,hasRightItem:t,renderItem:e,renderLeftItem:n,renderRightItem:a,direction:o,isSwipeAnimation:i,onSwipeLeft:c,onSwipeRight:l})=>{const d=m.useRef({x:0,y:0,start:Date.now()}),h=m.useRef(null),[u,g]=m.useState(null),f=Ie()<=Z.sm,x=he(b=>{o||(d.current={x:b.touches[0].clientX,y:b.touches[0].clientY,start:Date.now()},g(null))}),w=he(b=>{if(o||!h.current)return;const v=b.changedTouches[0].clientX-d.current.x,C=b.changedTouches[0].clientY-d.current.y,j=Math.abs(v)>Math.abs(C)?"slide":"scroll";if(u||g(j),j==="scroll"||u==="scroll")return;b.preventDefault(),b.stopPropagation();const S=t?-window.innerWidth:0,E=s?window.innerWidth:0,P=Math.max(Math.min(v,E),S);h.current.style.transform=`translateX(${P}px)`,h.current.style.transition="none"}),_=he(b=>{if(o||!h.current||u==="scroll")return;const v=d.current.x-b.changedTouches[0].clientX,C=Math.round(v/(Date.now()-d.current.start)*100),j=80;t&&(v>window.innerWidth/2||C>j)?l():s&&(v<-window.innerWidth/2||C<-j)?c():(h.current.style.transition="transform 0.2s ease-out",h.current.style.transform="translateX(0)"),g(null)});return m.useLayoutEffect(()=>{h.current&&(i&&o==="left"?(h.current.style.transition="transform 0.2s ease-out",h.current.style.transform="translateX(100%)"):i&&o==="right"?(h.current.style.transition="transform 0.2s ease-out",h.current.style.transform="translateX(-100%)"):(h.current.style.transform="translateX(0)",h.current.style.transition="none"))},[o,i]),m.useEffect(()=>{const b=h.current;if(b)return b.addEventListener("touchstart",x),b.addEventListener("touchmove",w,{passive:!1}),b.addEventListener("touchend",_),()=>{b.removeEventListener("touchstart",x),b.removeEventListener("touchmove",w),b.removeEventListener("touchend",_)}},[x,w,_]),r.jsxs("div",{ref:h,className:F(Pe.swipeSlider,f&&Pe.swipeSliderMobile),children:[n(u==="slide"),e(),a(u==="slide")]})},Wv=({playlist:s,loading:t=!1,error:e=null})=>{const[n,a]=m.useState(0),[o,i]=m.useState(0),{t:c}=T("common"),d=Ie()<=Z.sm,h=m.useRef(null),[u,g]=m.useState(null),[y,f]=m.useState(null),[x,w]=m.useState(!1);Bl(50,d?200:600,A=>{h.current&&(h.current.style.opacity=`${Math.max(1-A,d?0:.1)}`)});const _=(A,W=!1)=>{y||(i(A),g(A>n?"right":"left"),f("init"),w(W))},b=()=>_(n-1),v=()=>_(n+1),C=()=>_(n-1,!0),j=()=>_(n+1,!0),S=m.useCallback(A=>{A.propertyName==="transform"&&y==="start"&&f("end")},[y]);m.useEffect(()=>{if(u){if(y==="init"){f("start");return}y==="end"&&(a(o),g(null),f(null),w(!1))}},[y,u,o]);const E=y==="start"||y==="end",P=u==="left"?1:u==="right"?-1:0,I=A=>{const W=d?10:40;return A=="left"?{transform:`scale(1.2) translateX(${y==="init"?W*-1:0}px)`,opacity:E?1:0,transition:E?"opacity 0.3s ease-out, transform 0.3s ease-out":"none"}:A=="right"?{transform:`scale(1.2) translateX(${y==="init"?W:0}px)`,opacity:E?1:0,transition:E?"opacity 0.3s ease-out, transform 0.3s ease-out":"none"}:{transform:`scale(1.2) translateX(${E?W*P:0}px)`,opacity:E?0:1,transition:E?`opacity ${d?.3:.1}s ease-out, transform 0.3s ease-in`:"none"}},k=(A,W=!1)=>A==="left"?{left:W||x?"-100%":y==="init"?-60:0,opacity:W||x||E?1:0,transition:E?"opacity 0.2s ease-out, left 0.2s ease-out":"none",pointerEvents:"none"}:A==="right"?{left:W||x?"100%":y==="init"?60:0,opacity:W||x||E?1:0,transition:E?"opacity 0.2s ease-out, left 0.2s ease-out":"none",pointerEvents:"none"}:{left:E&&u?60*P:0,opacity:E?0:1,transition:E?"opacity 0.15s ease-out, left 0.15s ease-out":"none",pointerEvents:E?"none":"initial"},$=s.playlist[n],L=s.playlist[o<n?o:n-1]||null,D=s.playlist[o>n?o:n+1]||null,O=y!=="end"?$:u==="right"?L:D;return e||!(s!=null&&s.playlist)?r.jsx("h2",{className:Pe.error,children:"Could not load items"}):r.jsxs("div",{className:F(Pe.shelf),children:[r.jsxs("div",{className:Pe.poster,ref:h,children:[r.jsxs("div",{className:Pe.background,id:"background",children:[r.jsx(Er,{item:L,style:I("left"),hidden:u!=="left"},(O==null?void 0:O.mediaid)===(L==null?void 0:L.mediaid)?"left-item":L==null?void 0:L.mediaid),r.jsx(Er,{item:O,style:I(),onTransitionEnd:S},O==null?void 0:O.mediaid),r.jsx(Er,{item:D,style:I("right"),hidden:u!=="right"},(O==null?void 0:O.mediaid)===(D==null?void 0:D.mediaid)?"right-item":D==null?void 0:D.mediaid),r.jsx("div",{className:Pe.fade})]}),r.jsx("div",{className:Pe.fade2})]}),r.jsx("button",{className:F(Pe.chevron,Pe.chevronLeft),"aria-label":c("slide_previous"),disabled:!L,onClick:L?b:void 0,children:r.jsx(K,{icon:wa})}),r.jsx(Hv,{direction:u,isSwipeAnimation:x,loading:t,onSwipeLeft:C,onSwipeRight:j,hasLeftItem:!!L,hasRightItem:!!D,renderLeftItem:A=>r.jsx(Pr,{loading:t,item:L,playlistId:s.feedid,style:k("left",A),hidden:u!=="left"&&!A},(O==null?void 0:O.mediaid)===(L==null?void 0:L.mediaid)?"left-item":L==null?void 0:L.mediaid),renderItem:()=>r.jsx(Pr,{loading:t,item:O,playlistId:s.feedid,style:k()},O==null?void 0:O.mediaid),renderRightItem:A=>r.jsx(Pr,{loading:t,item:D,playlistId:s.feedid,style:k("right",A),hidden:u!=="right"&&!A},(O==null?void 0:O.mediaid)===(D==null?void 0:D.mediaid)?"right-item":D==null?void 0:D.mediaid)}),r.jsx("button",{className:F(Pe.chevron,Pe.chevronRight),"aria-label":c("slide_next"),disabled:!D,onClick:D?v:void 0,children:r.jsx(K,{icon:yn})}),r.jsx(Uv,{playlist:s,index:n,setIndex:_,nextIndex:o,direction:u||!1})]})},Vv="_shelfList_1mffp_1",qv="_shelfContainer_1mffp_6",Gv="_hero_1mffp_10",zv="_featured_1mffp_13",Tn={shelfList:Vv,shelfContainer:qv,hero:Gv,featured:zv},vc=6,Kv=4,Wl=({rows:s})=>{const{accessModel:t}=z(({accessModel:u})=>({accessModel:u}),de),[e,n]=m.useState(vc),{t:a}=T("error"),o=Xn("title"),i=_t(u=>u.getDictionaryWithSeries()),{user:c,subscription:l}=U(({user:u,subscription:g})=>({user:u,subscription:g}),de),d=gy(s,e);return m.useEffect(()=>()=>n(vc),[s]),d.every(({data:u,isSuccess:g})=>{var y;return g&&!((y=u==null?void 0:u.playlist)!=null&&y.length)})?r.jsx(rt,{title:a("empty_shelves_heading"),message:a("empty_shelves_description")}):r.jsx("div",{className:Tn.shelfList,children:r.jsx(ta,{style:{overflow:"hidden"},loadMore:()=>n(u=>u+Kv),hasMore:e<s.length,loader:r.jsx(ja,{},"loader"),useWindow:!1,children:s.slice(0,e).map(({type:u,featured:g,title:y,custom:f},x)=>{var I;const{data:w,isPlaceholderData:_,error:b}=d[x];if(!((I=w==null?void 0:w.playlist)!=null&&I.length))return null;const v=ul(w.cardImageAspectRatio||w.shelfImageAspectRatio),C=hl(v),S=(f==null?void 0:f[o])||(w==null?void 0:w[o])||y||(w==null?void 0:w.title),E=(f==null?void 0:f.layoutType)===Ha.hero&&x===0,P=!E&&((f==null?void 0:f.layoutType)===Ha.featured||g);return r.jsx("section",{className:F(Tn.shelfContainer,{[Tn.hero]:E,[Tn.featured]:P}),"data-testid":(`${E?"hero":P?"featured":u==="playlist"?qn(S):u}`,void 0),"aria-label":S,children:r.jsx(Vs,{duration:250,delay:x*33,open:!0,children:E?r.jsx(Wv,{loading:_,error:b,playlist:w}):r.jsx(dv,{loading:_,error:b,type:u,playlist:w,watchHistory:u===yt.ContinueWatching?i:void 0,title:S,featured:P,accessModel:t,isLoggedIn:!!c,hasSubscription:!!l,posterAspect:v,visibleTilesDelta:C})})},`${x}_${w.id}`)})})})},Jv=()=>{const{config:s}=z(({config:n,accessModel:a})=>({config:n,accessModel:a}),de),t=s==null?void 0:s.content,{t:e}=T("common");return r.jsxs(r.Fragment,{children:[r.jsx("h1",{className:"hideUntilFocus",children:e("home")}),r.jsx(Wl,{rows:t})]})},Fe=_s("UIStore",()=>({searchQuery:"",searchActive:!1,userMenuOpen:!1,sideBarOpen:!1,languageMenuOpen:!1})),Vl=()=>{const s=m.useRef(!0);return m.useEffect(()=>{s.current=!1},[]),s.current},Yv=(s,t)=>{const e=m.useRef(),n=m.useRef(vu((...a)=>{e.current&&e.current(...a)},t));return m.useEffect(()=>{e.current=s},[s]),n.current},ql=()=>{const s=ae(),t=Yv(a=>{s(`/q/${encodeURIComponent(a)}`)},350),e=m.useCallback(a=>{Fe.setState({searchQuery:a}),t(a)},[t]),n=m.useCallback(()=>{const a=Fe.getState().preSearchPage;Fe.setState({searchQuery:"",preSearchPage:void 0}),s(a||"/")},[s]);return{updateSearchQuery:e,resetSearchQuery:n}},Qv=dl(30),Xv=({siteId:s,enabled:t,query:e})=>{const n=q(Ee);return We(["app-search",e],async()=>await n.getContentSearch({siteId:s,params:{searchTerm:e}}),{placeholderData:t?Qv:void 0,enabled:t,staleTime:fs,cacheTime:ms})},Zv=s=>{var c,l;const{config:t}=z(({config:d})=>({config:d}),de),e=t==null?void 0:t.siteId,n=(c=t==null?void 0:t.features)==null?void 0:c.searchPlaylist,a=gs((l=t==null?void 0:t.custom)==null?void 0:l.appContentSearch),o=_n(n||"",{search:s||""},!a,!!s),i=Xv({siteId:e,enabled:a,query:s});return a?{data:i.data,isFetching:i.isFetching,error:i.error}:{isFetching:o.isFetching,error:o.error,data:o.data}},ex="_row_gdady_1",tx="_cell_gdady_5",xc={row:ex,cell:tx},sx=xu(function(s){s.scrollIntoView({behavior:"smooth",block:"center"})},300),nx=({className:s,columnCount:t,data:e,renderCell:n,getCellKey:a})=>{const[o,i]=m.useState(0),[c,l]=m.useState(0),d=m.useRef(null),h=Math.ceil(e.length/t),u=(f,x)=>{const w=document.getElementById(`layout_grid_${f}-${x}`),b=(w==null?void 0:w.querySelector('button, a, input, [tabindex]:not([tabindex="-1"])'))||w;i(f),l(x),b&&(b.focus({preventScroll:!0}),sx(b))},g=he(f=>{const{key:x,ctrlKey:w}=f;if(!["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(x))return;f.preventDefault();const _=h-1,b=c===0,v=c===t-1,C=o===0,j=o===_,S=(e.length%t||t)-1,E=j?S:t-1,P=Math.min(o+1,_),I=Math.max(o-1,0);switch(x){case"ArrowLeft":return b&&!C?u(I,t-1):u(o,Math.max(c-1,0));case"ArrowRight":return v&&!j?u(P,0):u(o,Math.min(c+1,E));case"ArrowUp":return u(I,c);case"ArrowDown":return u(P,P===_?Math.min(c,S):c);case"Home":return u(w?0:o,0);case"End":return w?u(_,S):u(o,E);case"PageUp":return u(I,c);case"PageDown":return u(P,P===_?Math.min(S,c):c);default:return}});m.useEffect(()=>{var x;if(!((x=d.current)!=null&&x.contains(document.activeElement)))return;const f=(e.length%t||t)-1;if(c>t-1)return u(o,t-1);if(o===h-1&&c>f)return u(o,f)},[t]);const y=m.useMemo(()=>({width:`${Math.floor(100/t*100)/100}%`}),[t]);return r.jsx("div",{role:"grid",ref:d,"aria-rowcount":h,className:s,onKeyDown:g,children:Array.from({length:h}).map((f,x)=>r.jsx("div",{role:"row","aria-rowindex":x+1,className:xc.row,children:e.slice(x*t,x*t+t).map((w,_)=>r.jsx("div",{role:"gridcell",id:`layout_grid_${x}-${_}`,"aria-colindex":_+1,className:xc.cell,style:y,children:n(w,o===x&&c===_?0:-1)},a(w)))},x))})},rx="_cell_1jw02_1",ax="_container_1jw02_6",wc={cell:rx,container:ax,"cols-1":"_cols-1_1jw02_10","cols-2":"_cols-2_1jw02_13","cols-3":"_cols-3_1jw02_16","cols-4":"_cols-4_1jw02_19","cols-5":"_cols-5_1jw02_22","cols-6":"_cols-6_1jw02_25","cols-7":"_cols-7_1jw02_28","cols-8":"_cols-8_1jw02_31","cols-9":"_cols-9_1jw02_34","cols-10":"_cols-10_1jw02_37"},bc=6,ox=4,ix={[Z.xs]:2,[Z.sm]:2,[Z.md]:3,[Z.lg]:4,[Z.xl]:5},cx=Symbol("CARD_GRID"),lx=s=>s.mediaid;function dx({playlist:s,watchHistory:t,isLoading:e=!1,cols:n=ix,currentCardItem:a,currentCardLabel:o,accessModel:i,isLoggedIn:c,hasSubscription:l,hasMore:d,getUrl:h,loadMore:u,onCardHover:g,headingLevel:y}){const f=Ie(),x=ul(s.cardImageAspectRatio||s.shelfImageAspectRatio),w=n[f]+hl(x),[_,b]=m.useState(bc),v=()=>b(S=>S+ox),C=_*w<s.playlist.length;m.useEffect(()=>{b(bc)},[s.feedid]);const j=m.useCallback((S,E)=>r.jsx(Fl,{tabIndex:E,progress:t?t[S.mediaid]:void 0,url:h(S),onHover:typeof g=="function"?()=>g(S):void 0,loading:e,isCurrent:a&&a.mediaid===S.mediaid,currentLabel:o,isLocked:Gn(i,c,l,S),posterAspect:x,item:S,headingLevel:y}),[i,a,o,h,l,y,e,c,g,x,t]);return r.jsx(ta,{pageStart:0,loadMore:u??v,hasMore:d??C,loader:r.jsx(ja,{},"loader"),useWindow:!1,children:r.jsx(nx,{className:F(wc.container,wc[`cols-${w}`]),data:u?s.playlist:s.playlist.slice(0,_*w),columnCount:w,renderCell:j,getCellKey:lx})})}const Zn=vs(cx,dx),ux="_search_1fatj_1",hx="_header_1fatj_17",px="_error_1fatj_33",mx="_subHeading_1fatj_38",Nn={search:ux,header:hx,error:px,subHeading:mx},fx=()=>{const{t:s}=T("search"),{config:t,accessModel:e}=z(({config:b,accessModel:v})=>({config:b,accessModel:v}),de),{siteName:n,features:a}=t,o=pt("search_heading"),i=Vl(),c=Fe(b=>b.searchQuery),{updateSearchQuery:l}=ql(),h=Ms()["*"],{isFetching:u,error:g,data:y}=Zv(h||""),{user:f,subscription:x}=U(({user:b,subscription:v})=>({user:b,subscription:v}),de),w=b=>Te({id:b.mediaid,title:b.title,playlistId:a==null?void 0:a.searchPlaylist}),_=m.useMemo(()=>u?s("heading"):h?y!=null&&y.playlist.length?s("title",{count:y.playlist.length,query:h}):s("no_results_heading",{query:h}):s("start_typing"),[u,y==null?void 0:y.playlist.length,h,s]);return m.useEffect(()=>{i&&h&&h!==c&&l(h)},[i,h,c,l]),m.useEffect(()=>()=>{Fe.setState({searchQuery:"",searchActive:!1})},[]),(g||!y)&&!u?r.jsxs(rt,{title:s("error_heading"),children:[r.jsx("h2",{className:Nn.subHeading,children:s("error_subheading")}),r.jsx("p",{children:s("error_description")})]}):h?y!=null&&y.playlist.length?r.jsxs("div",{className:Nn.search,children:[r.jsx(kt,{children:r.jsxs("title",{children:[_," - ",n]})}),r.jsx("header",{className:Nn.header,children:r.jsx("h2",{id:o,"aria-live":u?void 0:"polite",children:_})}),r.jsx(Zn,{"aria-labelledby":o,getUrl:w,playlist:y,isLoading:i,accessModel:e,isLoggedIn:!!f,hasSubscription:!!x})]}):r.jsxs(r.Fragment,{children:[r.jsx(kt,{children:r.jsxs("title",{children:[_," - ",n]})}),r.jsxs(rt,{title:_,children:[r.jsx("h2",{className:Nn.subHeading,children:s("suggestions")}),r.jsxs("ul",{children:[r.jsx("li",{children:s("tip_one")}),r.jsx("li",{children:s("tip_two")}),r.jsx("li",{children:s("tip_three")})]})]})]}):r.jsx(rt,{title:_})},Ca=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M12,19.2C9.5,19.2 7.29,17.92 6,16C6.03,14 10,12.9 12,12.9C14,12.9 17.97,14 18,16C16.71,17.92 14.5,19.2 12,19.2M12,5A3,3 0 0,1 15,8A3,3 0 0,1 12,11A3,3 0 0,1 9,8A3,3 0 0,1 12,5M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z"})),Gl=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M5,3C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V16.72C21.59,16.37 22,15.74 22,15V9C22,8.26 21.59,7.63 21,7.28V5A2,2 0 0,0 19,3H5M5,5H19V7H13A2,2 0 0,0 11,9V15A2,2 0 0,0 13,17H19V19H5V5M13,9H20V15H13V9M16,10.5A1.5,1.5 0 0,0 14.5,12A1.5,1.5 0 0,0 16,13.5A1.5,1.5 0 0,0 17.5,12A1.5,1.5 0 0,0 16,10.5Z"})),zl=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M19,3H5C3.89,3 3,3.89 3,5V9H5V5H19V19H5V15H3V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M10.08,15.58L11.5,17L16.5,12L11.5,7L10.08,8.41L12.67,11H3V13H12.67L10.08,15.58Z"})),Pa=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})),gx="_title_gkrmh_1",_x="_body_gkrmh_8",yx="_confirmButton_gkrmh_12",Sc={title:gx,body:_x,confirmButton:yx},Ea=({open:s,message:t,onClose:e,isSuccess:n,actionsOverride:a,titleOverride:o})=>{const{t:i}=T("common"),c=pt("alert-heading");return r.jsxs(pa,{open:s,onClose:e,role:"alertdialog","aria-modal":"true","aria-labelledby":c,children:[r.jsx("h2",{id:c,className:Sc.title,children:o??i(n?"alert.success":"alert.title")}),r.jsx("p",{className:Sc.body,children:t}),a??r.jsx(M,{label:i("alert.close"),variant:"outlined",onClick:e,fullWidth:!0})]})},vx="_flexBox_17rhj_1",xx="_controls_17rhj_9",wx="_submitConsents_17rhj_16",jc={flexBox:vx,controls:xx,submitConsents:wx};function bx({className:s,panelHeaderClassName:t,label:e,editButton:n,saveButton:a,cancelButton:o,onSubmit:i,content:c,readOnly:l=!1}){const d=pt(e),{formState:{values:h,activeSectionId:u,errors:g,isBusy:y},setFormState:f,isLoading:x,onCancel:w}=m.useContext(Kl),_=d===u,b=m.useCallback(({currentTarget:j})=>{if(!j)return;const{name:S,type:E}=j,P=E==="checkbox"?j.checked:j.value;_||w(),f(I=>{const k={...I.values};return S.split(".").reduce(($,L,D,O)=>(D===O.length-1?$[L]=P:$[L]={...$[L]},$[L]),k),{...I,values:k,activeSectionId:d}})},[_,w,d,f]),v=m.useCallback(async function(S){var E;if(S&&S.preventDefault(),i){let P;try{f(I=>({...I,isBusy:!0,errors:[]})),P=await i(h)}catch(I){P={errors:Array.of(I instanceof Error?I.message:I)}}if((E=P==null?void 0:P.errors)!=null&&E.length){f(I=>({...I,errors:P==null?void 0:P.errors,isBusy:!1}));return}}f(P=>({...P,activeSectionId:void 0,isBusy:!1}))},[i,f,h]),C=m.useCallback(function(){_||(w(),f(S=>({...S,activeSectionId:d})))},[_,w,d,f]);return r.jsxs("section",{"aria-labelledby":d,className:s,children:[r.jsx("div",{className:t,children:r.jsx("h2",{id:d,children:e})}),y&&_&&r.jsx(je,{transparentBackground:!0}),c&&r.jsx("form",{className:jc.flexBox,noValidate:!0,onSubmit:j=>j.preventDefault(),children:c({values:h,isEditing:_,isBusy:y,onChange:b,..._?{errors:g}:{}})}),(a||n||o)&&r.jsx("div",{className:jc.controls,children:_?r.jsxs(r.Fragment,{children:[a&&r.jsx(M,{label:a,type:"submit",onClick:v,disabled:x}),o&&r.jsx(M,{label:o,type:"reset",variant:"text",onClick:w})]}):!l&&n&&(typeof n=="object"?n:r.jsx(M,{label:n,type:"button",onClick:C,disabled:x}))})]})}const Kl=m.createContext(void 0);function Sx({isLoading:s,initialValues:t,onReset:e,children:n}){const[a,o]=m.useState({values:t,activeSectionId:void 0,isDirty:!1,isBusy:!1}),i=m.useCallback(function(){o(l=>({...l,values:t,isDirty:!1,activeSectionId:void 0,success:!1,errors:void 0})),e&&e()},[t,e]);return m.useEffect(()=>{a.activeSectionId||o(c=>({...c,values:t}))},[t,a.activeSectionId]),r.jsx(Kl.Provider,{value:{isLoading:s,onCancel:i,formState:a,setFormState:o},children:n==null?void 0:n.map((c,l)=>r.jsx(bx,{...c},l))})}const jx="_textWithButtonContainer_1cz0o_1",Cx="_customFields_1cz0o_7",Ir={textWithButtonContainer:jx,customFields:Cx},Px=({panelClassName:s,panelHeaderClassName:t,canUpdateEmail:e=!0})=>{var ee,Q;const n=q(ye),{t:a,i18n:o}=T("user"),i=Ke(),c=ae(),l=ue(),[d,h]=ma(),u=ut(n.exportAccountData),[g,y]=m.useState(!1),f=u.isSuccess?a("account.export_data_success"):a("account.export_data_error"),x=o.language!==H.APP_DEFAULT_LANGUAGE?H.APP_DEFAULT_LANGUAGE:void 0;m.useEffect(()=>{(u.isSuccess||u.isError)&&y(!0)},[u.isSuccess,u.isError]);const{customer:w,customerConsents:_,publisherConsents:b}=U(({user:N,customerConsents:R,publisherConsents:Y})=>({customer:N,customerConsents:R,publisherConsents:Y}),de),{canChangePasswordWithOldPassword:v,canExportAccountData:C,canDeleteAccount:j}=n.getFeatures(),S=(ee=w==null?void 0:w.metadata)==null?void 0:ee.register_source,E=S&&S!=="inplayer"||!1,P=E&&!((Q=w==null?void 0:w.metadata)!=null&&Q.has_password)||!1;m.useEffect(()=>{if(!b){n.getPublisherConsents();return}},[n,b]);const[I,k]=m.useMemo(()=>{const N=[],R=[];return b==null||b.forEach(Y=>{!(Y!=null&&Y.type)||(Y==null?void 0:Y.type)==="checkbox"?N.push(Y):R.push(Y)}),[N,R]},[b]),$=m.useMemo(()=>gh(b,_),[b,_]),L=m.useMemo(()=>fh(b,_),[b,_]),D=m.useMemo(()=>({...w,consents:$,consentsValues:L,confirmationPassword:""}),[w,$,L]),O=N=>{const R=Zr.sanitize(N),Y=/<a(.|\n)*?>/.test(R),G=/<\/a(.|\n)*?>/.test(R);return Y&&G?r.jsx("span",{dangerouslySetInnerHTML:{__html:N}}):N};function A(N){const R={};return N==null||N.flatMap(Y=>Y.split(",")).forEach(Y=>{switch(Y.trim()){case"Invalid param email":R.form=a("account.errors.validation_error"),R.email=a("account.errors.invalid_param_email");break;case"Customer email already exists":R.form=a("account.errors.validation_error"),R.email=a("account.errors.email_exists");break;case"Please enter a valid e-mail address.":R.form=a("account.errors.validation_error"),R.email=a("account.errors.please_enter_valid_email");break;case"Invalid confirmationPassword":{R.form=a("account.errors.validation_error"),R.confirmationPassword=a("account.errors.invalid_password");break}case"firstName can have max 50 characters.":{R.form=a("account.errors.validation_error"),R.firstName=a("account.errors.first_name_too_long");break}case"lastName can have max 50 characters.":{R.form=a("account.errors.validation_error"),R.lastName=a("account.errors.last_name_too_long");break}case"Email update not supported":{R.form=a("account.errors.email_update_not_supported");break}case"Wrong email/password combination":{R.form=a("account.errors.wrong_combination");break}default:{R.form=a("account.errors.unknown_error"),Ue("Account","Unknown error",{error:Y});break}}}),R}function W(N){return{...N,className:s,panelHeaderClassName:t,saveButton:a("account.save"),cancelButton:a("account.cancel"),content:R=>{var G;const Y=A(R.errors);return r.jsxs(r.Fragment,{children:[Y!=null&&Y.form?r.jsx(Oe,{variant:"error",children:Y.form}):null,(G=N.content)==null?void 0:G.call(N,{...R,errors:Y})]})}}}const X=async()=>{if(w){if(E&&P)return await n.resetPassword(w.email,""),c(J(l,"add-password"));c(J(l,v?"edit-password":"reset-password"))}};return r.jsxs(r.Fragment,{children:[r.jsx("h1",{className:"hideUntilFocus",children:a("nav.account")}),r.jsx(Sx,{initialValues:D,children:[W({label:a("account.about_you"),editButton:a("account.edit_information"),onSubmit:async N=>{const R=Mn(b,{...N.metadata,...N.consentsValues}),Y=await n.updateUser({firstName:N.firstName||"",lastName:N.lastName||"",metadata:{...N.metadata,...Gr(R),consents:JSON.stringify(R)}});return i(a("account.update_success",{section:a("account.about_you")}),"success"),Y},content:N=>{var R,Y,G,re;return r.jsxs(r.Fragment,{children:[r.jsx(me,{name:"firstName",label:a("account.firstname"),value:N.values.firstName||"",onChange:N.onChange,error:!!((R=N.errors)!=null&&R.firstName),helperText:(Y=N.errors)==null?void 0:Y.firstName,disabled:N.isBusy,editing:N.isEditing,autoComplete:"given-name",lang:x}),r.jsx(me,{name:"lastName",label:a("account.lastname"),value:N.values.lastName||"",onChange:N.onChange,error:!!((G=N.errors)!=null&&G.lastName),helperText:(re=N.errors)==null?void 0:re.lastName,disabled:N.isBusy,editing:N.isEditing,autoComplete:"family-name",lang:x})]})}}),W({label:a("account.email"),onSubmit:async N=>{if(!N.email||!N.confirmationPassword)throw new Error("Wrong email/password combination");const R=await n.updateUser({email:N.email||"",confirmationPassword:N.confirmationPassword});return i(a("account.update_success",{section:a("account.email")}),"success"),R},editButton:a("account.edit_account"),readOnly:!e,content:N=>{var R,Y,G,re;return r.jsxs(r.Fragment,{children:[r.jsx(me,{name:"email",label:a("account.email"),value:N.values.email||"",onChange:N.onChange,error:!!((R=N.errors)!=null&&R.email),helperText:(Y=N.errors)==null?void 0:Y.email,disabled:N.isBusy,editing:N.isEditing,autoComplete:"email",required:!0}),N.isEditing&&r.jsx(me,{name:"confirmationPassword",label:a("account.confirm_password"),value:N.values.confirmationPassword,onChange:N.onChange,error:!!((G=N.errors)!=null&&G.confirmationPassword),helperText:(re=N.errors)==null?void 0:re.confirmationPassword,type:d?"text":"password",disabled:N.isBusy,autoComplete:"current-password",rightControl:r.jsx(ze,{"aria-label":a("account.view_password"),onClick:()=>h(),"aria-pressed":d,children:r.jsx(K,{icon:d?fa:ga})}),required:!0})]})}}),W({label:a("account.security"),editButton:r.jsx(M,{label:a(P?"account.add_password":"account.edit_password"),type:"button",onClick:()=>w?X():null})}),W({label:a("account.terms_and_tracking"),saveButton:a("account.update_consents"),onSubmit:async N=>{const R=await n.updateConsents(Mn(b,N.consentsValues));return i(a("account.update_success",{section:a("account.terms_and_tracking")}),"success"),R},content:N=>r.jsx(r.Fragment,{children:I==null?void 0:I.map((R,Y)=>{var G;return r.jsx(Qn,{name:`consentsValues.${R.name}`,checked:gs((G=N.values.consentsValues)==null?void 0:G[R.name]),onChange:N.onChange,checkboxLabel:O(R.label),disabled:R.required||N.isBusy,required:R.required,lang:x},Y)})})}),(k==null?void 0:k.length)&&W({label:a("account.other_registration_details"),saveButton:a("account.update_consents"),onSubmit:N=>n.updateConsents(Mn(b,N.consentsValues)),content:N=>r.jsx("div",{className:Ir.customFields,"data-testid":void 0,children:k.map(R=>r.jsx(Dl,{type:R.type,name:`consentsValues.${R.name}`,options:R.options,label:O(R.label),placeholder:R.placeholder,value:N.values.consentsValues[R.name],disabled:R.type==="checkbox"&&R.required||N.isBusy,onChange:N.onChange,required:R.required},R.name))})}),C&&W({label:a("account.export_data_title"),content:N=>r.jsxs("div",{className:Ir.textWithButtonContainer,children:[r.jsx("div",{children:r.jsx(zd,{t:a,i18nKey:"account.export_data_body",values:{email:N.values.email}})}),r.jsx("div",{children:r.jsx(M,{label:a("account.export_data_title"),type:"button",disabled:u.isLoading,onClick:async()=>{u.mutate()}})})]})}),j&&W({label:a("account.delete_account.title"),content:()=>r.jsxs("div",{className:Ir.textWithButtonContainer,children:[r.jsx("div",{children:a("account.delete_account.body")}),r.jsx("div",{children:r.jsx(M,{label:a("account.delete_account.title"),type:"button",variant:"danger",onClick:()=>{c(J(l,P?"warning-account-deletion":"delete-account"))}})})]})})].filter(Cu)}),C&&r.jsx(Ea,{open:g,message:f,onClose:()=>y(!1),isSuccess:u.isSuccess})]})},Ex="_header_ljwt2_1",Ix={header:Ex},Ax={[Z.xs]:2,[Z.sm]:3,[Z.md]:3,[Z.lg]:3,[Z.xl]:3},kx=({playlist:s,accessModel:t,hasSubscription:e,onCardHover:n,onClearFavoritesClick:a})=>{const{t:o}=T("user"),i=c=>Te({id:c.mediaid,title:c.title,playlistId:c.feedid});return r.jsxs("div",{children:[r.jsxs("div",{className:Ix.header,children:[r.jsx("h1",{children:o("favorites.title")}),s.playlist.length>0?r.jsx(M,{label:o("favorites.clear"),onClick:a}):null]}),s.playlist.length>0?r.jsx(Zn,{getUrl:i,playlist:s,onCardHover:n,cols:Ax,isLoading:!1,accessModel:t,isLoggedIn:!0,hasSubscription:e}):r.jsx("p",{children:o("favorites.no_favorites")})]})},Tx=(s,t,e,n)=>{const a=q(ye),o=q(Tt),i=ut(a.updateUser,{onSuccess:()=>{U.setState({loading:!1})}});return ut(o.changeSubscription,{onSuccess:()=>{!s&&t&&i.mutate({firstName:(e==null?void 0:e.firstName)||"",lastName:(e==null?void 0:e.lastName)||"",metadata:{[`${n}_pending_downgrade`]:t}})}})},Nx="_user_15a6w_1",Lx="_leftColumn_15a6w_18",$x="_button_15a6w_29",Rx="_logoutLi_15a6w_41",Ox="_mainColumn_15a6w_50",Dx="_panel_15a6w_55",Mx="_panelHeader_15a6w_73",Fx="_checkbox_15a6w_86",Xe={user:Nx,leftColumn:Lx,button:$x,logoutLi:Rx,mainColumn:Ox,panel:Dx,panelHeader:Mx,checkbox:Fx},Bx=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"})),Ux="_offerSwitchContainer_booqe_1",Hx="_activeOfferSwitchContainer_booqe_13",Wx="_offerSwitchInfoContainer_booqe_18",Vx="_offerSwitchPlanContainer_booqe_28",qx="_currentPlanHeading_booqe_36",Gx="_activeCurrentPlanHeading_booqe_41",zx="_nextBillingDate_booqe_45",Kx="_price_booqe_51",Jx="_paymentFrequency_booqe_57",Ot={offerSwitchContainer:Ux,activeOfferSwitchContainer:Hx,offerSwitchInfoContainer:Wx,offerSwitchPlanContainer:Vx,currentPlanHeading:qx,activeCurrentPlanHeading:Gx,nextBillingDate:zx,price:Kx,paymentFrequency:Jx},Yx=({isCurrentOffer:s,pendingDowngradeOfferId:t,offer:e,selected:n,onChange:a,expiresAt:o})=>{const{t:i,i18n:c}=T(["user","account"]),{customerPriceInclTax:l,customerCurrency:d,period:h}=e,u=t===e.offerId;return r.jsxs("div",{className:F(Ot.offerSwitchContainer,{[Ot.activeOfferSwitchContainer]:n}),children:[r.jsx(Qn,{disabled:u,name:e.offerId,checked:n,onChange:()=>a(e.offerId)}),r.jsxs("div",{className:Ot.offerSwitchInfoContainer,children:[(s||u)&&r.jsxs("div",{className:F(Ot.currentPlanHeading,{[Ot.activeCurrentPlanHeading]:n}),children:[s&&i("user:payment.current_plan").toUpperCase(),u&&i("user:payment.pending_downgrade").toUpperCase()]}),r.jsxs("div",{className:Ot.offerSwitchPlanContainer,children:[r.jsx("div",{children:i(`user:payment.${h==="month"?"monthly":"annual"}_subscription`)}),(s||u)&&o&&r.jsxs("div",{className:Ot.nextBillingDate,children:[s&&!t&&i("user:payment.next_billing_date_on",{date:Et(new Date(o*1e3),c.language)}),u&&i("user:payment.downgrade_on",{date:Et(new Date(o*1e3),c.language)})]})]})]}),r.jsxs("div",{className:Ot.price,children:[dt(l,d,void 0),r.jsxs("span",{className:Ot.paymentFrequency,children:["/",i(`account:periods.${h}_one`)]})]})]})},Qx="_infoBox_6csa0_1",Xx="_transactionItem_6csa0_22",Zx="_pendingSwitch_6csa0_31",ew="_transactionDetails_6csa0_36",tw="_transactionPrice_6csa0_56",sw="_price_6csa0_60",nw="_explanation_6csa0_69",rw="_cardDetails_6csa0_73",aw="_paypal_6csa0_78",ow="_upgradeSubscription_6csa0_90",iw="_changePlanContainer_6csa0_99",cw="_changePlanButtons_6csa0_105",lw="_changePlanCancelButton_6csa0_112",dw="_editCard_6csa0_116",qe={infoBox:Qx,transactionItem:Xx,pendingSwitch:Zx,transactionDetails:ew,transactionPrice:tw,price:sw,explanation:nw,cardDetails:rw,paypal:aw,upgradeSubscription:ow,changePlanContainer:iw,changePlanButtons:cw,changePlanCancelButton:lw,editCard:dw},Cc=4,uw=({accessModel:s,activePaymentDetail:t,activeSubscription:e,pendingOffer:n,transactions:a,customer:o,isLoading:i,panelClassName:c,panelHeaderClassName:l,onShowAllTransactionsClick:d,showAllTransactions:h,onShowReceiptClick:u,canRenewSubscription:g=!1,canShowReceipts:y=!1,canUpdatePaymentMethod:f,onUpgradeSubscriptionClick:x,offerSwitchesAvailable:w,offers:_=[],pendingDowngradeOfferId:b="",changeSubscriptionPlan:v,onChangePlanClick:C,selectedOfferId:j,setSelectedOfferId:S,isUpgradeOffer:E,setIsUpgradeOffer:P,isExternalPaymentProvider:I,paymentProvider:k,paymentProviderLink:$})=>{var Ae;const L=pt("subscription-details"),D=pt("payment-method"),O=pt("billing-history"),{t:A,i18n:W}=T(["user","account"]),X=a?(a==null?void 0:a.length)-Cc:0,ee=X>0,Q=ae(),N=ue(),R=(e==null?void 0:e.period)==="granted",G=Ie()===Z.xs,[re,$e]=m.useState(!1);m.useEffect(()=>{re||S((e==null?void 0:e.accessFeeId)??null)},[e,re,S]),m.useEffect(()=>{$e(!1)},[e==null?void 0:e.status,e==null?void 0:e.pendingSwitchId]),m.useEffect(()=>{var se,Ve;j&&_&&P((((se=_.find(Je=>Je.offerId===j))==null?void 0:se.customerPriceInclTax)??0)>(((Ve=_.find(Je=>Je.offerId===(e==null?void 0:e.accessFeeId)))==null?void 0:Ve.customerPriceInclTax)??0))},[j,_,e,P]);function pe(){Q(J(N,"choose-offer"))}function Ce(){Q(J(N,"edit-card"))}function ce(){Q(J(N,"unsubscribe"))}function ve(){Q(J(N,"renew-subscription"))}function V(se){switch(se){case"month":return A("user:payment.monthly_subscription");case"year":return A("user:payment.annual_subscription");case"day":return A("user:payment.daily_subscription");case"week":return A("user:payment.weekly_subscription");case"granted":return A("user:payment.granted_subscription");default:return A("user:payment.other")}}const oe=!I&&w||!re&&!g;return r.jsxs(r.Fragment,{children:[r.jsx(Ea,{isSuccess:!v.isError,message:v.isError?A("user:payment.change_plan_error"):E?A("user:payment.upgrade_plan_success"):A("user:payment.downgrade_plan_success",{date:(e==null?void 0:e.expiresAt)&&Et(new Date(e.expiresAt*1e3),W.language)}),open:re&&(v.isSuccess||v.isError),onClose:()=>{v.reset(),$e(!1)}}),r.jsx("h1",{className:"hideUntilFocus",children:A("nav.payments")}),s===Me.SVOD&&r.jsxs("section",{"aria-labelledby":L,className:c,children:[r.jsx("div",{className:l,children:r.jsx("h2",{id:L,children:A(re?"user:payment.change_plan":"user:payment.subscription_details")})}),e?r.jsxs(Ne.Fragment,{children:[!re&&r.jsxs("div",{className:qe.infoBox,children:[r.jsxs("p",{children:[r.jsx("strong",{children:V(e.period)})," ",r.jsx("br",{}),e.status==="active"&&!R&&!b?A("user:payment.next_billing_date_on",{date:Et(new Date(e.expiresAt*1e3),W.language)}):A("user:payment.subscription_expires_on",{date:Et(new Date(e.expiresAt*1e3),W.language)}),(n||b)&&e.status!=="cancelled"&&r.jsx("span",{className:qe.pendingSwitch,children:A("user:payment.pending_offer_switch",{title:V((n==null?void 0:n.period)||((Ae=_.find(se=>se.offerId===b))==null?void 0:Ae.period)||"month")})})]}),!R&&r.jsxs("p",{className:qe.price,children:[r.jsx("strong",{children:dt(e.nextPaymentPrice,e.nextPaymentCurrency,o.country)}),r.jsxs("small",{children:["/",A(`account:periods.${e.period}`)]})]})]},e.subscriptionId),I?r.jsxs("p",{className:qe.explanation,children:[A("account:external_payment.explanation",{paymentProvider:k})," ",r.jsx(ln,{href:$,target:"_blank",children:A("account:external_payment.manage_subscription")})]}):oe&&r.jsx(M,{className:qe.upgradeSubscription,label:A("user:payment.change_subscription"),disabled:!g&&e.status==="cancelled",onClick:()=>{_.length>1&&!g?$e(!0):x==null||x()},fullWidth:G,color:"primary","data-testid":"change-subscription-button"}),(e.status==="active"||e.status==="active_trial")&&!R&&!re&&g?r.jsx(M,{label:A("user:payment.cancel_subscription"),onClick:ce,fullWidth:G,"data-testid":"cancel-subscription-button"}):g?r.jsx(M,{label:A("user:payment.renew_subscription"),onClick:ve}):null]}):i?null:r.jsxs(Ne.Fragment,{children:[r.jsx("p",{children:A("user:payment.no_subscription")}),r.jsx(M,{variant:"contained",color:"primary",label:A("user:payment.complete_subscription"),onClick:pe})]}),re&&r.jsxs("div",{className:qe.changePlanContainer,children:[_.filter(se=>se.planSwitchEnabled).map(se=>r.jsx(Yx,{isCurrentOffer:se.offerId===(e==null?void 0:e.accessFeeId),pendingDowngradeOfferId:b,offer:se,selected:j===se.offerId,onChange:Ve=>S(Ve),expiresAt:e==null?void 0:e.expiresAt},se.offerId)),r.jsxs("div",{className:qe.changePlanButtons,children:[r.jsx(M,{label:A("user:account.save"),onClick:C,disabled:j===(e==null?void 0:e.accessFeeId)||v.isLoading}),r.jsx(M,{label:A("user:account.cancel"),onClick:()=>$e(!1),variant:"text"}),(e==null?void 0:e.status)!=="cancelled"&&r.jsx(M,{className:qe.changePlanCancelButton,label:A("user:payment.cancel_subscription"),onClick:ce,variant:"danger","data-testid":"cancel-subscription-button"})]})]})]}),r.jsxs("section",{"aria-labelledby":D,className:c,children:[r.jsx("div",{className:l,children:r.jsx("h2",{id:D,children:A("user:payment.payment_method")})}),t?t.paymentMethod==="paypal"?r.jsxs("div",{children:[r.jsxs("div",{className:qe.paypal,children:[r.jsx(K,{icon:_a})," ",A("account:payment.paypal")]}),t.currency]}):r.jsxs("div",{children:[r.jsx(me,{label:A("user:payment.card_number"),name:"cardNumber",value:`•••• •••• •••• ${t.paymentMethodSpecificParams.lastCardFourDigits||""}`,"aria-label":A("user:payment.card_number_hidden",{number:t.paymentMethodSpecificParams.lastCardFourDigits}),editing:!1,autoComplete:"cc-number"}),r.jsxs("div",{className:qe.cardDetails,children:[r.jsx(me,{label:A("user:payment.expiry_date"),name:"cardExpiry",value:t.paymentMethodSpecificParams.cardExpirationDate,editing:!1,autoComplete:"cc-exp"}),r.jsx(me,{label:A("user:payment.security_code"),name:"cardSecurityCode",value:"******",editing:!1,"aria-label":A("user:payment.security_code_hidden"),autoComplete:"cc-csc"})]}),r.jsx(M,{className:F({[qe.editCard]:f}),label:A("account:payment.edit_card"),variant:"outlined",onClick:Ce})]},t.id):r.jsx("div",{children:r.jsx("p",{children:!i&&A("user:payment.no_payment_methods")})}),f&&r.jsx(M,{label:A("user:payment.update_payment_details"),type:"button",onClick:()=>Q(J(N,"payment-method"))})]}),r.jsxs("section",{"aria-labelledby":O,className:c,children:[r.jsx("div",{className:l,children:r.jsx("h2",{id:O,children:A("user:payment.billing_history")})}),a!=null&&a.length?r.jsxs(Ne.Fragment,{children:[a==null?void 0:a.slice(0,h?9999:Cc).map(se=>r.jsxs("div",{className:qe.infoBox,children:[r.jsxs("p",{className:qe.transactionItem,children:[r.jsx("strong",{children:Et(new Date(se.transactionDate*1e3),W.language)}),r.jsx("span",{children:se.offerTitle}),r.jsx("span",{children:se.transactionId})]}),r.jsxs("div",{className:qe.transactionDetails,children:[r.jsx("div",{className:qe.transactionPrice,children:!R&&A("user:payment.price_paid_with",{price:dt(parseFloat(se.transactionPriceInclTax),se.transactionCurrency,se.customerCountry),method:se.paymentMethod})}),y&&r.jsx(ze,{"aria-label":A("user:payment.show_receipt"),onClick:()=>!i&&u((se==null?void 0:se.trxToken)??se.transactionId),children:r.jsx(K,{icon:Bx})})]})]},se.transactionId)),!h&&ee?r.jsxs(Ne.Fragment,{children:[r.jsx("p",{children:A("user:payment.hidden_transactions",{count:X})}),r.jsx(M,{label:A("user:payment.show_all"),onClick:d})]}):null]}):r.jsx("div",{children:r.jsx("p",{children:!i&&A("user:payment.no_transactions")})})]}),i&&r.jsx(je,{inline:!0})]})},hw=(s,t)=>{if(s instanceof Blob){const e=window.URL.createObjectURL(new Blob([s])),n=document.createElement("a");n.href=e,n.setAttribute("download",`receipt_${t}.pdf`),document.body.appendChild(n),n.click()}else{const e=window.open("",`Receipt ${t}`,""),n=window.atob(s);e&&(e.opener=null,e.document.write(n),e.document.close())}},pw=["Apple In-App","Google In-App","Roku In-App"],mw={apple:"https://support.apple.com/118428",google:"https://support.google.com/googleplay/answer/7018481",roku:"https://support.roku.com/article/208756478"},fw=()=>{var A;const s=q(ye),t=ae(),{accessModel:e}=z(({accessModel:W})=>({accessModel:W}),de),{user:n,subscription:a,transactions:o,activePayment:i,pendingOffer:c,loading:l}=U(),{canUpdatePaymentMethod:d,canShowReceipts:h,canRenewSubscription:u}=s.getFeatures(),{subscriptionOffers:g,switchSubscriptionOffers:y}=ya(),[f,x]=m.useState(!1),[w,_]=m.useState(!1),[b,v]=m.useState((a==null?void 0:a.accessFeeId)??null),[C,j]=m.useState(void 0),S=ue(),E=async()=>t(J(S,"upgrade-subscription")),P=async W=>{_(!0);try{const X=await s.getReceipt(W);X&&hw(X,W)}catch(X){throw new Error("Couldn't parse receipt. "+(X instanceof Error?X.message:""))}_(!1)},I=Tx(C??!1,b,n,a==null?void 0:a.subscriptionId),k=async()=>{b&&(a!=null&&a.subscriptionId)&&I.mutate({accessFeeId:b.slice(1),subscriptionId:`${a.subscriptionId}`})};if(!n)return r.jsx(je,{});const $=((A=n.metadata)==null?void 0:A[`${a==null?void 0:a.subscriptionId}_pending_downgrade`])||"",L=!!a&&pw.includes(a.paymentMethod),D=(a==null?void 0:a.paymentMethod.split(" ")[0])||"unknown",O=mw[D.toLowerCase()];return r.jsx(uw,{accessModel:e,activeSubscription:a,activePaymentDetail:i,transactions:o,customer:n,pendingOffer:c,isLoading:l||w,panelClassName:Xe.panel,panelHeaderClassName:Xe.panelHeader,onShowAllTransactionsClick:()=>x(!0),showAllTransactions:f,canUpdatePaymentMethod:d,canRenewSubscription:u,onUpgradeSubscriptionClick:E,offerSwitchesAvailable:y.length>0,canShowReceipts:h,onShowReceiptClick:P,offers:g,pendingDowngradeOfferId:$,changeSubscriptionPlan:I,onChangePlanClick:k,selectedOfferId:b,setSelectedOfferId:W=>v(W),isUpgradeOffer:C,setIsUpgradeOffer:W=>j(W),isExternalPaymentProvider:L,paymentProvider:D,paymentProviderLink:O})},gw=()=>{const s=q(ps),t=q(ye),{accessModel:e,favoritesList:n}=z(w=>{var _;return{accessModel:w.accessModel,favoritesList:(_=w.config.features)==null?void 0:_.favoritesList}},de),a=ae(),{t:o}=T("user"),i=Ie(),[c,l]=m.useState(!1),d=i>Z.md,{user:h,subscription:u,loading:g}=U(),{canUpdateEmail:y}=t.getFeatures(),f=ft(w=>w.getPlaylist()),x=m.useCallback(async()=>{await t.logout()},[t]);return m.useEffect(()=>{!g&&!h&&a("/",{replace:!0})},[a,h,g]),h?r.jsxs("div",{className:Xe.user,children:[d&&r.jsx("nav",{className:Xe.leftColumn,children:r.jsx("div",{className:Xe.panel,children:r.jsxs("ul",{children:[r.jsx("li",{children:r.jsx(M,{to:nn,label:o("nav.account"),variant:"text",startIcon:r.jsx(K,{icon:Ca}),className:Xe.button})}),n&&r.jsx("li",{children:r.jsx(M,{to:Ur,label:o("nav.favorites"),variant:"text",startIcon:r.jsx(K,{icon:Pa}),className:Xe.button})}),e!==Me.AVOD&&r.jsx("li",{children:r.jsx(M,{to:Hr,label:o("nav.payments"),variant:"text",startIcon:r.jsx(K,{icon:Gl}),className:Xe.button})}),r.jsx("li",{className:Xe.logoutLi,children:r.jsx(M,{onClick:x,label:o("nav.logout"),variant:"text",startIcon:r.jsx(K,{icon:zl}),className:Xe.button})})]})})}),r.jsx("div",{className:Xe.mainColumn,children:r.jsxs(Bc,{children:[r.jsx(Ge,{path:nn,element:r.jsx(Px,{panelClassName:Xe.panel,panelHeaderClassName:Xe.panelHeader,canUpdateEmail:y})}),n&&r.jsx(Ge,{path:Ur,element:r.jsxs(r.Fragment,{children:[r.jsx(kx,{playlist:f,onClearFavoritesClick:()=>l(!0),accessModel:e,hasSubscription:!!u}),r.jsx(iy,{open:c,title:o("favorites.clear_favorites_title"),body:o("favorites.clear_favorites_body"),onConfirm:async()=>{await s.clear(),l(!1)},onClose:()=>l(!1)})]})}),r.jsx(Ge,{path:Hr,element:e!==Me.AVOD?r.jsx(fw,{}):r.jsx(hs,{to:nn})}),r.jsx(Ge,{path:"*",element:r.jsx(hs,{to:nn})})]})})]}):r.jsx("div",{className:Xe.user,children:r.jsx(je,{inline:!0})})},Ia=(s,t)=>{const e=[],n=pl(s.duration,t);return s.pubdate&&e.push(String(new Date(s.pubdate*1e3).getFullYear())),!t.episodesLabel&&n&&e.push(n),t.episodesLabel&&e.push(t.episodesLabel),s.genre&&e.push(s.genre),s.rating&&e.push(s.rating),e},_w=(s,t)=>{const e=[];return t&&e.push(t),s.genre&&e.push(s.genre),s.rating&&e.push(s.rating),e},yw=(s,t,e)=>{const n=[],a=Sh(t,s.scheduledStart,s.scheduledEnd),o=pl(s.duration,e);return a&&n.push(a),o&&n.push(o),s.genre&&n.push(s.genre),s.rating&&n.push(s.rating),n};function Xt(s,t=!0){const e=q(Ee),{i18n:n}=T(),a=n.language;return We(["media",s,a],()=>e.getMediaById({id:s,language:a}),{enabled:!!s&&t,refetchInterval:(o,i)=>o&&Yc(o)?1e3*30:!1,staleTime:60*1e3*10})}const er=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M19,19H5V5H19M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M10,8V16L15,12L10,8Z"})),vw="_filterRow_1pd69_1",xw="_dropDown_1pd69_10",ww="_filterDropDown_1pd69_17",Ar={filterRow:vw,dropDown:xw,filterDropDown:ww},Jl=({name:s,value:t,defaultLabel:e,options:n,setValue:a,forceDropdown:o=!1})=>{const{t:i}=T("common"),c=Ie();if(!n.length)return null;const l=h=>a(h.target.value),d=!o&&c>=Z.md&&n.length<6;return r.jsx(m.Fragment,{children:d?r.jsxs("div",{className:Ar.filterRow,role:"listbox","aria-label":i("filter_videos_by",{name:s}),children:[n.map(h=>{const u=typeof h=="string"?h:h.label,g=typeof h=="string"?h:h.value,y=t===g;return r.jsx(M,{label:u,onClick:()=>a(g),active:y,role:"option","aria-selected":y},g)}),r.jsx(M,{label:e,onClick:()=>a(""),active:t==="",role:"option","aria-selected":t===""},e)]}):r.jsx("div",{className:Ar.filterDropDown,children:r.jsx(kl,{className:Ar.dropDown,size:"small",options:n,defaultLabel:e,name:s,value:t,onChange:l,"aria-label":i("filter_videos_by",{name:s})})})})},bw="_hero_oabkm_1",Sw="_info_oabkm_10",jw="_title_oabkm_17",Cw="_description_oabkm_34",Pw="_poster_oabkm_41",Ew="_posterFade_oabkm_56",ls={hero:bw,info:Sw,title:jw,description:Cw,poster:Pw,posterFade:Ew},Yl=({image:s,children:t})=>{const e="",n=m.useRef(null),o=Ie()<=Z.sm;return Bl(50,o?150:500,i=>{n.current&&(n.current.style.opacity=`${Math.max(1-i,.1)}`)}),r.jsxs("div",{className:ls.hero,children:[r.jsx(Ws,{ref:n,className:ls.poster,image:s,width:1280,alt:e}),r.jsx("div",{className:ls.posterFade}),r.jsx("div",{className:ls.info,children:t})]})},Ql=({title:s})=>r.jsx("h1",{className:ls.title,children:s}),Iw="_collapsibleText_1ve3l_1",Aw="_dummyDiv_1ve3l_6",kw="_textContainer_1ve3l_11",Tw="_collapsed_1ve3l_15",Nw="_chevron_1ve3l_20",Lw="_expanded_1ve3l_33",Zs={collapsibleText:Iw,dummyDiv:Aw,textContainer:kw,collapsed:Tw,chevron:Nw,expanded:Lw},Xl=({text:s,className:t})=>{const e=m.useRef(),n=Ie(),[a,o]=m.useState(!1),[i,c]=m.useState(!1),l=i?"Collapse":"Expand",d=4,h=60;return m.useEffect(()=>{e.current&&o(e.current.scrollHeight>e.current.offsetHeight+d||h<e.current.offsetHeight)},[h,s,n]),r.jsxs("div",{className:F(Zs.collapsibleText),children:[r.jsx("p",{ref:e,id:"collapsible-content",className:F(Zs.textContainer,t,{[Zs.collapsed]:!i&&a}),style:{maxHeight:i?e.current.scrollHeight:h},children:r.jsx(Hs,{tag:"span",markdownString:s,inline:!0})}),a&&r.jsx(ze,{"aria-label":l,"aria-expanded":i,"aria-controls":"collapsible-content",className:F(Zs.chevron,{[Zs.expanded]:i}),onClick:()=>c(!i),children:r.jsx(K,{icon:yn})})]})},Zl=({className:s,description:t,maximumLines:e=8})=>Ie()===Z.xs?r.jsx(Xl,{text:t,className:F(ls.description,s)}):r.jsx(Ul,{text:t,maximumLines:e,className:F(ls.description,s)}),$w="_videoDetails_1pu6q_1",Rw="_metaContainer_1pu6q_5",Ow="_primaryMetadata_1pu6q_10",Dw="_secondaryMetadata_1pu6q_24",Mw="_description_1pu6q_39",Fw="_buttonBar_1pu6q_43",Bw="_playIcon_1pu6q_64",As={videoDetails:$w,metaContainer:Rw,primaryMetadata:Ow,secondaryMetadata:Dw,description:Mw,buttonBar:Fw,playIcon:Bw},ed=({title:s,description:t,primaryMetadata:e,secondaryMetadata:n,image:a,startWatchingButton:o,shareButton:i,favoriteButton:c,trailerButton:l,children:d})=>r.jsxs("div",{"data-testid":void 0,children:[r.jsx("header",{className:As.videoDetails,"data-testid":void 0,id:"video-details",children:r.jsxs(Yl,{image:a,children:[r.jsx(Ql,{title:s}),r.jsxs("div",{className:As.metaContainer,children:[r.jsx("div",{className:As.primaryMetadata,children:e}),n&&r.jsx("div",{className:As.secondaryMetadata,children:n})]}),r.jsx(Zl,{className:As.description,description:t}),r.jsxs("div",{className:As.buttonBar,children:[o,l,c,i]})]})}),d]}),Uw="_details_72tjp_1",Hw="_inlinePlayerMetadata_72tjp_23",Ww="_title_72tjp_39",Vw="_primaryMetadata_72tjp_65",qw="_buttonBar_72tjp_77",Gw="_description_72tjp_98",os={details:Uw,inlinePlayerMetadata:Hw,title:Ww,primaryMetadata:Vw,buttonBar:qw,description:Gw},zw=({title:s,description:t,primaryMetadata:e,shareButton:n,favoriteButton:a,trailerButton:o})=>{const c=Ie()===Z.xs,l=typeof s=="string"?"h1":"div";return r.jsxs("div",{className:os.details,"data-testid":void 0,children:[r.jsx(l,{className:os.title,children:s}),r.jsxs("div",{className:os.inlinePlayerMetadata,children:[r.jsx("div",{className:os.primaryMetadata,children:e}),r.jsxs("div",{className:os.buttonBar,children:[o,a,n]})]}),c?r.jsx(Xl,{text:t,className:os.description}):r.jsx(Hs,{markdownString:t,className:os.description})]})},Kw="_listItem_1hb3b_1",Jw="_poster_1hb3b_20",Yw="_posterImage_1hb3b_39",Qw="_visible_1hb3b_48",Xw="_activeLabel_1hb3b_58",Zw="_title_1hb3b_90",e1="_titleContainer_1hb3b_104",t1="_scheduledStart_1hb3b_109",s1="_tags_1hb3b_120",n1="_lock_1hb3b_127",r1="_scheduled_1hb3b_109",a1="_tag_1hb3b_120",o1="_live_1hb3b_155",i1="_progressContainer_1hb3b_159",c1="_progressBar_1hb3b_169",Le={listItem:Kw,poster:Jw,posterImage:Yw,visible:Qw,activeLabel:Xw,title:Zw,titleContainer:e1,scheduledStart:t1,tags:s1,lock:n1,scheduled:r1,tag:a1,live:o1,progressContainer:i1,progressBar:c1};function l1({onHover:s,progress:t,activeLabel:e,item:n,url:a,loading:o=!1,isActive:i=!1,isLocked:c=!0}){const{title:l,duration:d,seasonNumber:h,episodeNumber:u,cardImage:g,mediaStatus:y,scheduledStart:f}=n,{t:x,i18n:{language:w}}=T("common"),[_,b]=m.useState(!1),v=F(Le.posterImage,{[Le.visible]:_}),C=sl(n),j=y===Bt.LIVE||rl(n),S=y===Bt.SCHEDULED,E=()=>{if(o||!l)return null;if(C)return r.jsx("div",{className:Le.tag,children:x("video:series")});if(u)return r.jsx("div",{className:Le.tag,children:Kn(h,u)});if(d)return r.jsx("div",{className:Le.tag,children:la(d,{minutesAbbreviation:x("common:abbreviation.minutes")})});if(j)return r.jsx("div",{className:F(Le.tag,Le.live),children:x("live")});if(S)return r.jsxs("div",{className:Le.tag,children:[r.jsx(K,{icon:Sa,className:Le.scheduled}),x("scheduled")]})};return r.jsxs(hn,{role:"button",to:a,className:Le.listItem,onMouseEnter:s,tabIndex:0,"data-testid":void 0,children:[r.jsxs("div",{className:Le.titleContainer,children:[r.jsx("h3",{className:Le.title,children:l}),!!f&&r.jsx("div",{className:Le.scheduledStart,children:Bn(f,w)})]}),r.jsxs("div",{className:Le.poster,children:[r.jsx(Ws,{className:v,image:g,onLoad:()=>b(!0),width:320,alt:""}),r.jsxs("div",{className:Le.tags,children:[c&&r.jsx("div",{className:F(Le.tag,Le.lock),"aria-label":x("card_lock"),children:r.jsx(K,{icon:ba})}),E()]}),i&&r.jsx("div",{className:Le.activeLabel,children:e}),t?r.jsx("div",{className:Le.progressContainer,children:r.jsx("div",{className:Le.progressBar,style:{width:`${Math.round(t*100)}%`}})}):null]})]})}const d1=m.memo(l1),u1="_container_w9k9j_1",h1="_content_w9k9j_6",p1="_list_w9k9j_13",kr={container:u1,content:h1,list:p1},Pc=()=>{};function m1({playlist:s,header:t,onListItemHover:e,isLoading:n=!1,watchHistory:a,activeMediaId:o,activeLabel:i,className:c,accessModel:l,isLoggedIn:d,hasSubscription:h,hasMore:u,loadMore:g=Pc,getUrl:y}){var f;return r.jsxs("div",{className:F(kr.container,!!c&&c),"data-testid":void 0,children:[!!t&&t,r.jsx("div",{className:kr.content,children:r.jsx(ta,{element:"ul",pageStart:0,loadMore:g??Pc,hasMore:u??!1,className:kr.list,loader:r.jsx(ja,{},"loader"),useWindow:!1,children:(f=s==null?void 0:s.playlist)==null?void 0:f.map(x=>r.jsx("li",{children:r.jsx(d1,{url:y(x),progress:a?a[x.mediaid]:void 0,onHover:()=>e&&e(x),loading:n,isActive:o===x.mediaid,activeLabel:i,isLocked:Gn(l,d,h,x),item:x})},x.mediaid))})})]})}const f1="_videoInlineLayout_1o3za_1",g1="_player_1o3za_29",_1="_videoDetailsInline_1o3za_53",y1="_relatedVideosList_1o3za_58",v1="_relatedVideosListHeader_1o3za_62",x1="_relatedVideos_1o3za_58",w1="_relatedVideosGrid_1o3za_89",b1="_inlineLayout_1o3za_96",S1="_relatedVideosGridTitle_1o3za_112",j1="_relatedVideosListTitle_1o3za_121",C1="_filters_1o3za_129",P1="_filtersInline_1o3za_135",E1="_filterMetadata_1o3za_140",et={videoInlineLayout:f1,player:g1,videoDetailsInline:_1,relatedVideosList:y1,relatedVideosListHeader:v1,relatedVideos:x1,relatedVideosGrid:w1,inlineLayout:b1,relatedVideosGridTitle:S1,relatedVideosListTitle:j1,filters:C1,filtersInline:P1,filterMetadata:E1},tr=({inlineLayout:s,player:t,playlist:e,accessModel:n,isLoading:a,isLoggedIn:o,item:i,hasSubscription:c,title:l,description:d,image:h,primaryMetadata:u,secondaryMetadata:g,shareButton:y,favoriteButton:f,startWatchingButton:x,trailerButton:w,relatedTitle:_,watchHistory:b,activeLabel:v,filters:C,setFilter:j,filterMetadata:S,currentFilter:E="",defaultFilterLabel:P="",children:I,hasMore:k,loadMore:$,getURL:L})=>{const D=Ie(),O=D===Z.sm||D===Z.md,A=C&&C.length>1,W=A&&j,X=Q=>r.jsxs("div",{className:F(et.filters,{[et.filtersInline]:s}),children:[!!S&&s&&r.jsx("span",{className:et.filterMetadata,children:S}),W&&r.jsx(Jl,{name:"season",value:E,defaultLabel:P,options:C,setValue:j,forceDropdown:Q})]}),ee=(Q=!0)=>e?Q?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:F(et.relatedVideosGrid,{[et.inlineLayout]:s}),children:[r.jsx("h2",{className:et.relatedVideosGridTitle,children:_||" "}),A&&X(s)]}),r.jsx(Zn,{playlist:e,isLoading:a,watchHistory:b,accessModel:n,isLoggedIn:o,currentCardItem:i,currentCardLabel:v,hasSubscription:c,hasMore:k,loadMore:$,getUrl:L})]}):r.jsx("div",{className:et.relatedVideosList,children:r.jsx(m1,{header:r.jsxs("div",{className:et.relatedVideosListHeader,children:[l&&r.jsx("h2",{className:et.relatedVideosListTitle,children:_}),A&&X(!0)]}),activeMediaId:i==null?void 0:i.mediaid,activeLabel:v,playlist:e,watchHistory:b,isLoading:a,accessModel:n,isLoggedIn:o,hasSubscription:c,hasMore:k,loadMore:$,getUrl:L})}):null;return s?r.jsxs("div",{className:et.videoInlineLayout,"data-testid":void 0,children:[r.jsx("div",{className:et.player,children:t}),r.jsx("div",{className:et.videoDetailsInline,children:r.jsx(zw,{title:g||l,live:(i==null?void 0:i.duration)===0,description:d,primaryMetadata:u,shareButton:y,favoriteButton:f,trailerButton:w})}),ee(O),I]}):r.jsxs(ed,{title:l,description:d,image:h,startWatchingButton:x,favoriteButton:f,trailerButton:w,shareButton:y,primaryMetadata:u,secondaryMetadata:g,children:[e&&r.jsx("section",{className:et.relatedVideos,children:ee(!0)}),I,t]})},I1=3e5,A1=(s,t,e)=>{const n=m.useRef(null),a=q(Os),{features:o}=z(h=>h.config),c=!!(o==null?void 0:o.continueWatchingList),l=m.useCallback(()=>{if(!c||!n.current)return;const{item:h,seriesItem:u,progress:g}=n.current;a.saveItem(h,u,g),n.current=null},[c,a]),d=he(h=>{var g;if(h.duration<0)return;const u=Number((h.position/h.duration).toFixed(5));!isNaN(u)&&isFinite(u)&&(n.current={item:t,seriesItem:e,progress:u,timestamp:((g=n.current)==null?void 0:g.timestamp)||Date.now()},Date.now()-n.current.timestamp>I1&&l())});m.useEffect(()=>{if(!(!s||!c))return s.on("time",d),s.on("pause",l),s.on("complete",l),s.on("remove",l),()=>{s.off("time",d),s.off("pause",l),s.off("complete",l),s.off("remove",l)}},[s,c,l,d]),m.useEffect(()=>()=>{l()},[t==null?void 0:t.mediaid,l]),m.useLayoutEffect(()=>{const h=()=>document.visibilityState==="hidden"&&l();return window.addEventListener("pagehide",l),window.addEventListener("visibilitychange",h),()=>{window.removeEventListener("pagehide",l),window.removeEventListener("visibilitychange",h)}},[l])},k1=(s,t,e)=>{const{features:n}=z(c=>c.config),o=!!(n==null?void 0:n.continueWatchingList);A1(s,t,e);const i=_t(c=>t&&o?c.getItem(t):void 0);return m.useMemo(()=>{const c=i==null?void 0:i.progress;return c&&c>Yt.Min&&c<Yt.Max?c*t.duration:0},[t.duration,i==null?void 0:i.progress])},T1=(s,t)=>{const e=n=>{if(!s)return n;const a=[s,t].filter(Boolean).join("-");return{...n,allSources:void 0,sources:n.sources.map(o=>({...o,file:Se(o.file,{t:a})}))}};return he(async n=>e(n))},Ec=60*1e3*20,N1=({adScheduleId:s,enabled:t})=>{const e=q(Ee),{isLoading:n,data:a}=We(["ad-schedule",s],async()=>e.getAdSchedule(s),{enabled:t&&!!s,cacheTime:Ec,staleTime:Ec});return{isLoading:n,data:a}},L1=({mediaId:s})=>{const{adSchedule:t,adConfig:e,adScheduleUrls:n,adDeliveryMethod:a}=z(d=>d.config),o=!!e&&a!=="ssai",{data:i,isLoading:c}=N1({adScheduleId:t,enabled:!!t}),l=o?{client:"vast",schedule:Se((n==null?void 0:n.xml)||"",{media_id:s})}:void 0;return{isLoading:o?!1:c,data:o?l:i}},$1=(s,t,e,n={},a=!0,o)=>{var C;const i=q(cl),c=q(ca),{configId:l,signingConfig:d,contentProtection:h,jwp:u,urlSigning:g,isAccessBridgeEnabled:y}=z(({config:j,settings:S})=>{var E;return{configId:j.id,signingConfig:j.contentSigningService,contentProtection:j.contentProtection,jwp:j.integrations.jwp,urlSigning:gs((E=j==null?void 0:j.custom)==null?void 0:E.urlSigning),isAccessBridgeEnabled:!!(S!=null&&S.apiAccessBridgeUrl)}}),f=d==null?void 0:d.host,x=((C=h==null?void 0:h.drm)==null?void 0:C.defaultPolicyId)??(d==null?void 0:d.drmPolicyId),w=!!g||!!f||!!x&&!f,{data:_,isLoading:b}=We(["token",s,t,n],async()=>{if(t&&f){const S=await q(ye).getAuthData(),{host:E,drmPolicyId:P}=d;return i.getMediaToken(E,t,S==null?void 0:S.jwt,n,P)}if(u&&l&&t&&w)return c.getJWPMediaToken(l,t)},{enabled:w&&a&&!!t&&!y,keepPreviousData:!1,staleTime:15*60*1e3}),v=We([s,t,n,_],async()=>e(_,x),{enabled:!!t&&a&&(!w||!!_),placeholderData:t?o:void 0,retry:2,retryDelay:1e3,keepPreviousData:!1});return{...v,isLoading:b||v.isLoading}};function R1(s){const t=q(Ee),e=q(cn),{isAccessBridgeEnabled:n}=z(({settings:c})=>({isAccessBridgeEnabled:!!(c!=null&&c.apiAccessBridgeUrl)})),a=$1("media",s.mediaid,async(c,l)=>n?e.getMediaById(s.mediaid):t.getMediaById({id:s.mediaid,token:c,drmPolicyId:l})),{isLoading:o,data:i}=We(["media","geo",s.mediaid],()=>{var l;const c=(l=a.data)==null?void 0:l.sources.find(d=>d.file.indexOf(".m3u8")!==-1);return c?fetch(c.file,{method:"HEAD"}).then(d=>d.status===403):!1},{enabled:a.isFetched});return{...a,isGeoBlocked:i,isLoading:a.isLoading||o}}const O1=(s,t,e,n)=>n.some(a=>s===`${t}/manifests/${e}.${a}`),D1=(s,t,e,n)=>n.some(a=>s===`${t}/live/broadcast/${e}.${a}`),M1=({item:s,baseUrl:t,config:e,user:n,passport:a})=>{const{sources:o,mediaid:i}=s,{adConfig:c,siteId:l,adDeliveryMethod:d}=e,h=n==null?void 0:n.id,u=!!c&&d==="ssai";return o.map(g=>{const y=new URL(g.file),f=y.href,x=D1(f,t,i,["m3u8","mpd"]),w=O1(f,t,i,["m3u8","mpd"]),_=y.searchParams.has("exp")&&y.searchParams.has("sig");return w&&u&&!_?(y.href=`${t}/v2/sites/${l}/media/${i}/ssai.m3u8`,y.searchParams.set("ad_config_id",c)):(w||x)&&h&&y.searchParams.set("user_id",h),a&&F1(g,a),g.file=y.toString(),g})};function F1(s,t){var n,a,o,i,c,l;function e(d,h){const u=new URL(d);return u.searchParams.has("token")||u.searchParams.set("passport",h),u.toString()}return s!=null&&s.drm&&((a=(n=s.drm)==null?void 0:n.playready)!=null&&a.url&&(s.drm.playready.url=e(s.drm.playready.url,t)),(i=(o=s.drm)==null?void 0:o.widevine)!=null&&i.url&&(s.drm.widevine.url=e(s.drm.widevine.url,t)),(l=(c=s.drm)==null?void 0:c.fairplay)!=null&&l.processSpcUrl&&(s.drm.fairplay.processSpcUrl=e(s.drm.fairplay.processSpcUrl,t))),s}const B1=({item:s,baseUrl:t})=>{const e=z(o=>o.config),n=U(o=>o.user),a=Dn(o=>o.passport);return m.useMemo(()=>M1({item:s,baseUrl:t,config:e,user:n,passport:a}),[s,t,e,n,a])},U1="_container_79xjy_1",H1={container:U1},td=({item:s,adsData:t,onReady:e,onPlay:n,onPause:a,onComplete:o,onUserActive:i,onUserInActive:c,onBeforePlay:l,onFirstFrame:d,onRemove:h,onPlaylistItem:u,onPlaylistItemCallback:g,onNext:y,onBackClick:f,feedId:x,startTime:w=0,autostart:_})=>{const b=m.useRef(null),v=m.useRef(),C=m.useRef(!1),j=m.useRef(!1),[S,E]=m.useState(!!window.jwplayer),P=m.useRef(w),I=B1({item:s,baseUrl:H.APP_API_BASE_URL}),{settings:k}=z(ce=>ce),$=k.playerId,L=k.playerLicenseKey,D=he(l),O=he(n),A=he(a),W=he(o),X=he(i),ee=he(c),Q=he(()=>{var V;const ce=(V=v.current)==null?void 0:V.getContainer(),ve=ce==null?void 0:ce.querySelector('.jw-controlbar [aria-label="Play"], .jw-button-container [aria-label="Pause"]');ve==null||ve.focus(),d==null||d()}),N=he(h),R=he(u),Y=he(g),G=he(y),re=he(()=>{j.current=!0,f==null||f()}),$e=he(()=>e&&e(v.current)),pe=m.useCallback(()=>{var ce,ve,V,oe,Ae,se,Ve,Je,ws,es,ts,at,ss;(ce=v.current)==null||ce.on("ready",$e),(ve=v.current)==null||ve.on("beforePlay",D),(V=v.current)==null||V.on("complete",W),(oe=v.current)==null||oe.on("play",O),(Ae=v.current)==null||Ae.on("pause",A),(se=v.current)==null||se.on("userActive",X),(Ve=v.current)==null||Ve.on("userInactive",ee),(Je=v.current)==null||Je.on("firstFrame",Q),(ws=v.current)==null||ws.on("remove",N),(es=v.current)==null||es.on("playlistItem",R),(ts=v.current)==null||ts.on("nextClick",G),(at=v.current)==null||at.on("backClick",re),(ss=v.current)==null||ss.setPlaylistItemCallback(Y)},[$e,D,W,O,A,X,ee,Q,N,R,G,Y,re]),Ce=m.useCallback(()=>{var ce,ve,V,oe,Ae,se,Ve,Je;(ce=v.current)==null||ce.off("ready"),(ve=v.current)==null||ve.off("beforePlay"),(V=v.current)==null||V.off("complete"),(oe=v.current)==null||oe.off("play"),(Ae=v.current)==null||Ae.off("pause"),(se=v.current)==null||se.off("userActive"),(Ve=v.current)==null||Ve.off("userInactive"),(Je=v.current)==null||Je.off("firstFrame")},[]);return m.useEffect(()=>{if(!window.jwplayer&&!C.current){C.current=!0;const ce=`${H.APP_API_BASE_URL}/libraries/${$}.js`;rm(ce).then(()=>{E(!0),C.current=!1})}},[$]),m.useEffect(()=>{P.current=w},[w]),m.useEffect(()=>{const ce=()=>{var oe,Ae;if(!s||!v.current)return;const V=(oe=v.current)==null?void 0:oe.getPlaylistItem();if(V&&V.mediaid===s.mediaid){Zc("Player","Calling loadPlaylist with the same item, check the dependencies");return}typeof _<"u"&&((Ae=v.current)==null||Ae.setConfig({autostart:_})),v.current.load([Ai({...s,starttime:P.current,feedid:x})])},ve=()=>{if(!window.jwplayer||!b.current)return;v.current=window.jwplayer(b.current);const V={advertising:{...t,showCountdown:!0},timeSlider:{showAdMarkers:!1},aspectratio:!1,controls:!0,displaytitle:!1,displayHeading:!1,displaydescription:!1,floating:{mode:"never"},height:"100%",mute:!1,playbackRateControls:!0,pipIcon:"disabled",playlist:[Ai({...s,starttime:P.current,feedid:x,sources:I})],repeat:!1,cast:{},stretching:"uniform",width:"100%"};typeof _<"u"&&(V.autostart=_),L&&(V.key=L),v.current.setup(V),pe()};if(v.current)return ce();S&&ve()},[S,s,Ce,pe,$,_,t,L,I,x]),m.useEffect(()=>()=>{if(v.current){if(Ce(),j.current){j.current=!1;return}v.current.remove()}},[Ce,j]),r.jsx("div",{className:H1.container,"data-testid":void 0,children:r.jsx("div",{ref:b})})},W1="_error_4iaxi_1",V1="_title_4iaxi_11",Ic={error:W1,title:V1};var sd=(s=>(s.GEO_BLOCKED="GEO_BLOCKED",s))(sd||{});const q1=()=>{const{t:s}=T("video");return r.jsxs("div",{className:Ic.error,children:[r.jsx("h2",{className:Ic.title,children:s("player_error.geo_blocked_title")}),r.jsx("p",{children:s("player_error.geo_blocked_description")})]})},nd=({item:s,seriesItem:t,feedId:e,onPlay:n,onPause:a,onComplete:o,onUserActive:i,onUserInActive:c,onNext:l,onBackClick:d,liveEndDateTime:h,liveFromBeginning:u,liveStartDateTime:g,autostart:y})=>{const{data:f,isLoading:x}=L1({mediaId:s==null?void 0:s.mediaid}),{data:w,isLoading:_,isGeoBlocked:b}=R1(s),[v,C]=m.useState(),j=k1(v,s,t),S=m.useCallback(I=>{C(I)},[]),E=m.useCallback(()=>{u&&(v==null||v.seek(0))},[u,v]),P=T1(g,h);return!w||_||x?r.jsx(je,{inline:!0}):b?r.jsx(q1,{error:sd.GEO_BLOCKED}):r.jsx(td,{feedId:e,item:w,adsData:f,onReady:S,onFirstFrame:E,onPlay:n,onPause:a,onComplete:o,onUserActive:i,onUserInActive:c,onNext:l,onBackClick:d,onPlaylistItemCallback:P,startTime:j,autostart:y})},G1="_inlinePlayer_g5xl8_1",z1="_paywall_g5xl8_10",K1="_poster_g5xl8_26",J1="_lock_g5xl8_47",Y1="_title_g5xl8_62",Q1="_text_g5xl8_88",ks={inlinePlayer:G1,paywall:z1,poster:K1,lock:J1,title:Y1,text:Q1},sr=({item:s,seriesItem:t,onPlay:e,onPause:n,onComplete:a,feedId:o,liveStartDateTime:i,liveEndDateTime:c,liveFromBeginning:l,startWatchingButton:d,isLoggedIn:h,isEntitled:u,autostart:g,playable:y=!0,hasMediaOffers:f})=>{const x=z(j=>j.config.siteName),{t:w}=T(),_=ae(),b=ue(),v=()=>{_(J(b,"login"))},C=w(f?"video:buy_to_start_watching":"video:sign_up_to_start_watching");return r.jsxs("div",{className:ks.inlinePlayer,children:[r.jsx(Vs,{open:!y||!u,children:r.jsxs("div",{className:ks.paywall,children:[r.jsx(Ws,{className:ks.poster,image:s.backgroundImage,alt:s.title,width:1280}),!u&&r.jsxs(r.Fragment,{children:[r.jsx(K,{icon:ba,className:ks.lock}),r.jsx("h2",{className:ks.title,children:C}),r.jsx("span",{className:ks.text,children:w("account:choose_offer.watch_this_on_platform",{siteName:x})}),d,!h&&r.jsx(M,{onClick:v,label:w("common:sign_in")})]})]})}),u&&y&&r.jsx(nd,{item:s,seriesItem:t,feedId:o,autostart:g,onPlay:e,onPause:n,onComplete:a,liveEndDateTime:c,liveFromBeginning:l,liveStartDateTime:i})]})},X1="_cinemaContainer_b92ry_1",Z1="_cinema_b92ry_1",eb="_overlayFade_b92ry_13",tb="_playerOverlay_b92ry_18",sb="_playerContent_b92ry_36",nb="_backButton_b92ry_46",rb="_title_b92ry_58",ab="_metaContainer_b92ry_74",ob="_primaryMetadata_b92ry_79",ib="_secondaryMetadata_b92ry_93",Pt={cinemaContainer:X1,cinema:Z1,overlayFade:eb,playerOverlay:tb,playerContent:sb,backButton:nb,title:rb,metaContainer:ab,primaryMetadata:ob,secondaryMetadata:ib},vn=({open:s,item:t,seriesItem:e,title:n,primaryMetadata:a,secondaryMetadata:o,onPlay:i,onPause:c,onComplete:l,onClose:d,onNext:h,feedId:u,liveStartDateTime:g,liveEndDateTime:y,liveFromBeginning:f})=>{const{t:x}=T(),[w,_]=m.useState(!1),[b,v]=m.useState(!1),[C,j]=m.useState(!0),S=m.useCallback(()=>{_(!0),i&&i()},[i]),E=m.useCallback(()=>{_(!1),c&&c()},[c]),P=m.useCallback(()=>{l&&l()},[l]),I=m.useCallback(()=>{h&&h()},[h]),k=m.useCallback(()=>j(!0),[]),$=m.useCallback(()=>j(!1),[]);return m.useEffect(()=>{s&&j(!0)},[s]),r.jsx(Jn,{open:s,animationContainerClassName:Pt.cinemaContainer,onClose:d,"aria-label":x("videoplayer"),children:r.jsxs("div",{className:Pt.cinema,children:[r.jsx(Vs,{className:Pt.overlayFade,open:!w||C||b,keepMounted:!0,children:r.jsx("div",{className:Pt.playerOverlay,onFocus:()=>v(!0),onBlur:()=>v(!1),children:r.jsxs("div",{className:Pt.playerContent,children:[r.jsx(ze,{"aria-label":x("common:back"),onClick:d,className:Pt.backButton,children:r.jsx(K,{icon:Pl})}),r.jsxs("div",{children:[r.jsx("h1",{className:Pt.title,children:n}),r.jsxs("div",{className:Pt.metaContainer,children:[o&&r.jsx("div",{className:Pt.secondaryMetadata,children:o}),r.jsx("div",{className:Pt.primaryMetadata,children:a})]})]})]})})}),r.jsx(nd,{item:t,seriesItem:e,feedId:u,autostart:!0,onPlay:S,onPause:E,onComplete:P,onUserActive:k,onUserInActive:$,onNext:I,onBackClick:d,liveEndDateTime:y,liveFromBeginning:f,liveStartDateTime:g})]})})},cb="_container_98mgl_1",lb="_playerOverlay_98mgl_14",db="_title_98mgl_25",Tr={container:cb,playerOverlay:lb,title:db},nr=({item:s,open:t,title:e,onClose:n})=>{const[a,o]=m.useState(!1),[i,c]=m.useState(!0),l=m.useCallback(()=>o(!0),[]),d=m.useCallback(()=>o(!1),[]),h=m.useCallback(()=>c(!0),[]),u=m.useCallback(()=>c(!1),[]);return s?r.jsx(Jn,{open:t,onClose:n,"aria-labelledby":"trailer-modal-title",centered:!0,children:r.jsxs("div",{className:Tr.container,children:[r.jsx(td,{item:s,onPlay:l,onPause:d,onComplete:n,onUserActive:h,onUserInActive:u,autostart:!0}),r.jsxs(Vs,{open:!a||i,keepMounted:!0,children:[r.jsx("div",{className:Tr.playerOverlay,children:r.jsx("h1",{id:"trailer-modal-title",className:Tr.title,children:e})}),r.jsx(vl,{onClick:n})]})]})}):null},ub=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"})),hb=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z"})),pb=s=>{const t=document.activeElement,e=document.createElement("input");e.style.zIndex="-10",e.style.position="absolute",e.style.left="-1000",e.value=s,document.body.appendChild(e),e.select(),document.execCommand("copy"),e.blur(),document.body.removeChild(e),t==null||t.focus()},xn=({title:s,description:t,url:e})=>{const{t:n}=T(),a=Ie(),[o,i]=m.useState(!1),c=async()=>{if(typeof navigator.share=="function"){await navigator.share({title:s,text:t,url:e});return}pb(window.location.href),i(!0),setTimeout(()=>i(!1),2e3)};return r.jsx(M,{label:n(o?"video:copied_url":"video:share"),startIcon:o?r.jsx(K,{icon:ub}):r.jsx(K,{icon:hb}),onClick:c,active:o,fullWidth:a<Z.md})},mb=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M12.1,18.55L12,18.65L11.89,18.55C7.14,14.24 4,11.39 4,8.5C4,6.5 5.5,5 7.5,5C9.04,5 10.54,6 11.07,7.36H12.93C13.46,6 14.96,5 16.5,5C18.5,5 20,6.5 20,8.5C20,11.39 16.86,14.24 12.1,18.55M16.5,3C14.76,3 13.09,3.81 12,5.08C10.91,3.81 9.24,3 7.5,3C4.42,3 2,5.41 2,8.5C2,12.27 5.4,15.36 10.55,20.03L12,21.35L13.45,20.03C18.6,15.36 22,12.27 22,8.5C22,5.41 19.58,3 16.5,3Z"})),rr=({item:s})=>{const{t}=T(),e=Ie(),n=q(ps),{isFavorite:a,clearWarning:o,warning:i}=ft(l=>({isFavorite:!!s&&l.hasItem(s),clearWarning:l.clearWarning,warning:l.warning})),c=m.useCallback(async()=>{await n.toggleFavorite(s)},[s,n]);return m.useEffect(()=>()=>o(),[o]),r.jsxs(r.Fragment,{children:[r.jsx(M,{label:t("video:favorite"),"aria-label":t("video:favorite"),startIcon:a?r.jsx(K,{icon:Pa}):r.jsx(K,{icon:mb}),onClick:c,"aria-pressed":a,color:a?"primary":"default",fullWidth:e<Z.md}),r.jsx(Ea,{open:i!==null,message:i,onClose:o})]})},fb="_loading_1bc17_1",gb={loading:fb},xs=()=>r.jsx("div",{className:gb.loading,children:r.jsx(ys,{})}),_b="_separator_14n07_1",yb={separator:_b},Ds=({attributes:s,separator:t="•"})=>r.jsx("div",{children:s.map((e,n)=>r.jsxs(Ne.Fragment,{children:[r.jsx("span",{children:e}),n<s.length-1&&r.jsx("span",{className:yb.separator,"aria-hidden":"true",children:t})]},e))});function Un(s,t=!1){if(!s)return"";const e=new Date(s?s*1e3:0),n=e.getUTCHours(),a=e.getUTCMinutes(),o=e.getUTCSeconds();if(!t)return e.toISOString();let i="PT";return n>0&&(i+=n+"H"),a>0&&(i+=a+"M"),o>0&&(i+=o+"S"),i}const vb=()=>{const s=new Date(Date.UTC(2022,6,20,18,0,0));return/am|pm/.test(s.toLocaleTimeString())},xb=s=>((s==null?void 0:s.playlist)||[]).reduce((t,e)=>t.some(n=>(n==null?void 0:n.value)===(e==null?void 0:e.seasonNumber))?t:t.concat(e.seasonNumber?[{label:xe.t("video:season_number_filter_template",{seasonNumber:e.seasonNumber}),value:e.seasonNumber}]:[]),[]).slice().sort(),wb=(s,t)=>{if(s)return t===""?s:{...s,playlist:s.playlist.filter(({seasonNumber:e})=>e===t)}},bb=(s,t)=>{var n,a;if(!s||!t)return;const e=(n=t==null?void 0:t.playlist)==null?void 0:n.findIndex(({mediaid:o})=>o===s.mediaid);return(a=t==null?void 0:t.playlist)==null?void 0:a[e+1]},Sb=(s,t)=>{var e;if(t)return(e=t.playlist.filter(n=>n.seasonNumber===(s==null?void 0:s.seasonNumber)))==null?void 0:e.length},jb=(s,t)=>({"@type":"TVSeries","@id":`${H.APP_PUBLIC_URL}/s/${t}`,name:s.title,numberOfEpisodes:String(s.playlist.length),numberOfSeasons:String(s.playlist.reduce(function(n,a){return!a.seasonNumber||n.includes(a.seasonNumber)?n:n.concat(a.seasonNumber)},[]).length)}),Cb=(s,t,e,n)=>{const a=`${H.APP_PUBLIC_URL}${cs({episodeId:t==null?void 0:t.mediaid,seriesId:n})}`,o=jb(s,n);return JSON.stringify(t?{"@context":"http://schema.org/","@type":"TVEpisode","@id":a,episodeNumber:e==null?void 0:e.episodeNumber,seasonNumber:e==null?void 0:e.seasonNumber,name:t.title,uploadDate:Un(t.pubdate),partOfSeries:o}:o)},Pb=()=>{var zs,bs;const s=Ie(),{t}=T("video"),[e,n]=m.useState(!1),a=ae(),i=Ms().id||"",c=He("play")==="1",l=He("r"),d=He("e"),{isLoading:h,data:u,isError:g}=_n(i,{},!0,!1),{isLoading:y,data:f}=Xt(d||""),{isLoading:x,data:w}=Xt((f==null?void 0:f.trailerId)||""),_=m.useMemo(()=>({episodeNumber:(f==null?void 0:f.episodeNumber)||"0",seasonNumber:(f==null?void 0:f.seasonNumber)||"0"}),[f]),b=f||u,v=(b==null?void 0:b.image)||"",{config:C,accessModel:j}=z(({config:we,accessModel:Ss})=>({config:we,accessModel:Ss}),de),{features:S,siteName:E,custom:P}=C,I=!!(S!=null&&S.favoritesList),k=!!(P!=null&&P.inlinePlayer),$=m.useMemo(()=>xb(u),[u]),[L,D]=m.useState(void 0),O=m.useMemo(()=>{var we;return(we=u==null?void 0:u.playlist)==null?void 0:we[0]},[u]),A=m.useMemo(()=>wb(u,L),[u,L]),W=Sb(f,u),X=m.useMemo(()=>bb(f,u),[f,u]),ee=_t(we=>we.getDictionaryWithEpisodes()),{user:Q,subscription:N}=U(({user:we,subscription:Ss})=>({user:we,subscription:Ss}),de),{isEntitled:R,mediaOffers:Y}=qs(f||O),G=!!Y.length,re=!!Q,$e=!!N,pe=()=>f&&a(cs({episodeId:f.mediaid,seriesId:i,play:!1,playlistId:l})),Ce=we=>u?cs({episodeId:we.mediaid,seriesId:i,play:!1,playlistId:l}):"",ce=m.useCallback(async()=>{a(cs({episodeId:X==null?void 0:X.mediaid,seriesId:i,play:!!X,playlistId:l}))},[a,X,i,l]);m.useEffect(()=>{var we;(document.scrollingElement||document.body).scroll({top:0}),(we=document.querySelector("#video-details button"))==null||we.focus()},[f]),m.useEffect(()=>{var we;h||y||L===void 0&&D(parseInt(_==null?void 0:_.seasonNumber,10)?_==null?void 0:_.seasonNumber:((we=$==null?void 0:$[0])==null?void 0:we.value)||"")},[_,L,h,y,$]);const ve=h||y;if(ve)return r.jsx(xs,{});if(g||!u||!b||!O)return r.jsx(rt,{title:t("series_error")});const V=`${b.title} - ${E}`,oe=(b==null?void 0:b.description)||"",Ae=`${H.APP_PUBLIC_URL}${cs({episodeId:f==null?void 0:f.mediaid,seriesId:i})}`,se=b.backgroundImage||void 0,Ve=f?r.jsx(Ds,{attributes:Ia(f,{episodesLabel:t("video:total_episodes",{count:(zs=u==null?void 0:u.playlist)==null?void 0:zs.length}),hoursAbbreviation:t("common:abbreviation.hours"),minutesAbbreviation:t("common:abbreviation.minutes")})}):r.jsx(Ds,{attributes:_w(u,t("video:total_episodes",{count:(bs=u==null?void 0:u.playlist)==null?void 0:bs.length}))}),Je=_&&f&&r.jsxs(r.Fragment,{children:[r.jsx("strong",{children:Kn(_.seasonNumber,_.episodeNumber)})," - ",f.title]}),ws=_&&` ${t("video:season")} ${_.seasonNumber}/${$==null?void 0:$.length} - ${t("video:episode")} ${_.episodeNumber}/${W}`,es=r.jsx(xn,{title:b==null?void 0:b.title,description:oe,url:Ae}),ts=r.jsx(Gs,{item:f||O,playUrl:cs({episodeId:(f==null?void 0:f.mediaid)||(O==null?void 0:O.mediaid),seriesId:i,play:!0,playlistId:l})},d),at=I&&r.jsx(rr,{item:f||O}),ss=(!!w||x)&&r.jsx(M,{label:t("video:trailer"),"aria-label":t("video:watch_trailer"),startIcon:r.jsx(K,{icon:er}),onClick:()=>n(!0),active:e,fullWidth:s<Z.md,disabled:!w});return r.jsxs(Ne.Fragment,{children:[r.jsxs(kt,{children:[r.jsx("title",{children:V}),r.jsx("link",{rel:"canonical",href:Ae}),r.jsx("meta",{name:"description",content:oe}),r.jsx("meta",{property:"og:description",content:oe}),r.jsx("meta",{property:"og:title",content:V}),r.jsx("meta",{property:"og:type",content:f?"video.episode":"video.series"}),v&&r.jsx("meta",{property:"og:image",content:v==null?void 0:v.replace(/^https:/,"http:")}),v&&r.jsx("meta",{property:"og:image:secure_url",content:v==null?void 0:v.replace(/^http:/,"https:")}),v&&r.jsx("meta",{property:"og:image:width",content:v?"720":""}),v&&r.jsx("meta",{property:"og:image:height",content:v?"406":""}),r.jsx("meta",{name:"twitter:title",content:V}),r.jsx("meta",{name:"twitter:description",content:oe}),v&&r.jsx("meta",{name:"twitter:image",content:v}),r.jsx("meta",{property:"og:video",content:Ae.replace(/^https:/,"http:")}),r.jsx("meta",{property:"og:video:secure_url",content:Ae.replace(/^http:/,"https:")}),r.jsx("meta",{property:"og:video:type",content:"text/html"}),r.jsx("meta",{property:"og:video:width",content:"1280"}),r.jsx("meta",{property:"og:video:height",content:"720"}),b.tags?String(b.tags).split(",").map(we=>r.jsx("meta",{property:"og:video:tag",content:we},we)):null,u&&b?r.jsx("script",{type:"application/ld+json",children:Cb(u,f,_,i)}):null]}),r.jsx(tr,{item:f,title:b.title,description:oe,inlineLayout:k,primaryMetadata:Ve,secondaryMetadata:Je,image:se,shareButton:es,favoriteButton:at,trailerButton:ss,startWatchingButton:ts,isLoading:ve,accessModel:j,isLoggedIn:re,hasSubscription:$e,playlist:A,relatedTitle:k?b.title:t("episodes"),setFilter:D,currentFilter:L,defaultFilterLabel:t("all_seasons"),activeLabel:t("current_episode"),watchHistory:ee,filterMetadata:ws,filters:$,getURL:Ce,player:k&&(f||O)?r.jsx(sr,{isLoggedIn:re,item:f||O,onComplete:ce,feedId:l??void 0,startWatchingButton:ts,isEntitled:R,hasMediaOffers:G,autostart:c||void 0}):r.jsx(vn,{open:c&&R,onClose:pe,item:f||O,title:(f==null?void 0:f.title)||O.title,primaryMetadata:Ve,secondaryMetadata:Je,onComplete:ce,feedId:l??void 0})}),f&&r.jsx(nr,{item:w,title:`${f.title} - Trailer`,open:e,onClose:()=>n(!1)})]})};class Aa{constructor(){p(this,"defaultScreen");p(this,"definitions",[])}register(t,e){this.definitions.push({component:t,predicate:e})}registerByContentType(t,e){this.register(t,n=>!!n&&Qt(n,e))}registerDefault(t){this.defaultScreen=t}getScreen(t){var n;const e=(n=this.definitions.find(({predicate:a})=>a(t)))==null?void 0:n.component;if(e)return e;if(!this.defaultScreen)throw new Error("Default screen not defined");return this.defaultScreen}}const Eb="_mediaStaticPage_v6zr1_1",Ib={mediaStaticPage:Eb},Ab=({data:s})=>{const{config:t}=z(({config:o})=>({config:o}),de),{siteName:e}=t,n=`${s.title} - ${e}`,a=s?`${H.APP_PUBLIC_URL}${Te({id:s.mediaid,title:s.title})}`:window.location.href;return m.useEffect(()=>{(document.scrollingElement||document.body).scroll({top:0})},[s.mediaid]),r.jsxs(r.Fragment,{children:[r.jsxs(kt,{children:[r.jsx("title",{children:n}),r.jsx("link",{rel:"canonical",href:a}),r.jsx("meta",{property:"og:title",content:n}),r.jsx("meta",{name:"twitter:title",content:n})]}),r.jsx("div",{className:Ib.mediaStaticPage,children:r.jsx(Hs,{markdownString:s.markdown||s.description})})]})},ka=(s,t)=>{const{mediaid:e,title:n}=s,a=`${t}${Te({id:e,title:n})}`;return JSON.stringify({"@context":"http://schema.org/","@type":"VideoObject","@id":a,name:s.title,description:s.description,duration:Un(s.duration,!0),thumbnailUrl:s.image,uploadDate:Un(s.pubdate)})},kb=(s,t,e,n)=>({"@type":"TVSeries","@id":`${n}/m/${e}`,name:t.title,numberOfEpisodes:String((s==null?void 0:s.episode_count)||0),numberOfSeasons:String((s==null?void 0:s.season_count)||0)}),Tb=(s,t,e,n,a)=>{const o=`${e}/m/${s.series_id}?e=${n==null?void 0:n.mediaid}`,i=kb(s,t,s.series_id,e);return JSON.stringify(n?{"@context":"http://schema.org/","@type":"TVEpisode","@id":o,episodeNumber:(a==null?void 0:a.episodeNumber)||"0",seasonNumber:(a==null?void 0:a.seasonNumber)||"0",name:n.title,uploadDate:Un(n.pubdate),partOfSeries:i}:i)},rd=({data:s,isLoading:t})=>{var G,re,$e;const{t:e}=T("video"),[n,a]=m.useState(!1),o=Ie(),i=ae(),l=Ms().id||"",d=He("play")==="1",h=He("r"),{config:u,accessModel:g}=z(({config:pe,accessModel:Ce})=>({config:pe,accessModel:Ce}),de),{siteName:y,features:f,custom:x}=u,w=!!(f!=null&&f.favoritesList),_=!!(x!=null&&x.inlinePlayer),{isLoading:b,data:v}=Xt((s==null?void 0:s.trailerId)||""),{isLoading:C,data:j}=_n((f==null?void 0:f.recommendationsPlaylist)||"",{related_media_id:l}),{user:S,subscription:E}=U(({user:pe,subscription:Ce})=>({user:pe,subscription:Ce}),de),{isEntitled:P,mediaOffers:I}=qs(s),k=!!I.length,$=()=>s&&i(Te({id:s.mediaid,title:s.title,playlistId:h,play:!1})),L=pe=>Te({id:pe.mediaid,title:pe.title,playlistId:f==null?void 0:f.recommendationsPlaylist}),D=m.useCallback(()=>{if(!l||!j)return;const pe=j.playlist.findIndex(({mediaid:ce})=>ce===l),Ce=j.playlist[pe+1];return Ce&&i(Te({id:Ce.mediaid,title:Ce.title,playlistId:f==null?void 0:f.recommendationsPlaylist,play:!0}))},[l,j,i,f==null?void 0:f.recommendationsPlaylist]);m.useEffect(()=>{var pe;(document.scrollingElement||document.body).scroll({top:0}),(pe=document.querySelector("#video-details button"))==null||pe.focus()},[l]);const O=`${s.title} - ${y}`,A=s?`${H.APP_PUBLIC_URL}${Te({id:s.mediaid,title:s.title})}`:window.location.href,W=r.jsx(Ds,{attributes:Ia(s,{hoursAbbreviation:e("common:abbreviation.hours"),minutesAbbreviation:e("common:abbreviation.minutes")})}),X=r.jsx(xn,{title:s.title,description:s.description,url:A}),ee=r.jsx(Gs,{item:s,playUrl:Te({id:s.mediaid,title:s.title,playlistId:h,play:!0})},l),Q=w&&r.jsx(rr,{item:s}),N=(!!v||b)&&r.jsx(M,{label:e("video:trailer"),"aria-label":e("video:watch_trailer"),startIcon:r.jsx(K,{icon:er}),onClick:()=>a(!0),active:n,fullWidth:o<Z.md,disabled:!v}),R=!!S,Y=!!E;return r.jsxs(Ne.Fragment,{children:[r.jsxs(kt,{children:[r.jsx("title",{children:O}),r.jsx("link",{rel:"canonical",href:A}),r.jsx("meta",{name:"description",content:s.description}),r.jsx("meta",{property:"og:description",content:s.description}),r.jsx("meta",{property:"og:title",content:O}),r.jsx("meta",{property:"og:type",content:"video.other"}),s.image&&r.jsx("meta",{property:"og:image",content:(G=s.image)==null?void 0:G.replace(/^https:/,"http:")}),s.image&&r.jsx("meta",{property:"og:image:secure_url",content:(re=s.image)==null?void 0:re.replace(/^http:/,"https:")}),r.jsx("meta",{property:"og:image:width",content:s.image?"720":""}),r.jsx("meta",{property:"og:image:height",content:s.image?"406":""}),r.jsx("meta",{name:"twitter:title",content:O}),r.jsx("meta",{name:"twitter:description",content:s.description}),r.jsx("meta",{name:"twitter:image",content:s.image}),r.jsx("meta",{property:"og:video",content:A.replace(/^https:/,"http:")}),r.jsx("meta",{property:"og:video:secure_url",content:A.replace(/^http:/,"https:")}),r.jsx("meta",{property:"og:video:type",content:"text/html"}),r.jsx("meta",{property:"og:video:width",content:"1280"}),r.jsx("meta",{property:"og:video:height",content:"720"}),($e=s.tags)==null?void 0:$e.split(",").map(pe=>r.jsx("meta",{property:"og:video:tag",content:pe},pe)),s?r.jsx("script",{type:"application/ld+json",children:ka(s,H.APP_PUBLIC_URL)}):null]}),r.jsx(tr,{item:s,inlineLayout:_,isLoading:t||C,accessModel:g,isLoggedIn:R,hasSubscription:Y,title:s.title,description:s.description,image:s.backgroundImage,primaryMetadata:W,shareButton:X,favoriteButton:Q,trailerButton:N,startWatchingButton:ee,playlist:j,relatedTitle:j==null?void 0:j.title,getURL:L,activeLabel:e("current_video"),player:_?r.jsx(sr,{isLoggedIn:R,item:s,onComplete:D,feedId:h??void 0,startWatchingButton:ee,isEntitled:P,hasMediaOffers:k,autostart:d||void 0}):r.jsx(vn,{open:d&&P,onClose:$,item:s,title:s.title,primaryMetadata:W,onComplete:D,feedId:h??void 0,onNext:D})}),r.jsx(nr,{item:v,title:`${s.title} - Trailer`,open:n,onClose:()=>a(!1)})]})},Nb=s=>s&&"seasons"in s?s.seasons.map(t=>({label:t.season_title||String(t.season_number),value:String(t.season_number)})):[],Lb=(s,t)=>{var e;return(e=((t==null?void 0:t.seasons)||[]).find(n=>n.season_number===Number(s==null?void 0:s.seasonNumber)))==null?void 0:e.episode_count},$b=s=>{const t=q(Ee),{data:e,isLoading:n,error:a}=We(["series",s],async()=>await t.getSeries(s||""),{enabled:!!s,staleTime:fs,cacheTime:ms,retry:(o,i)=>i.code!==404&&o<2});return{data:e,isLoading:n,error:a}},Rb=s=>{const{page:t,page_limit:e,total:n}=s;if(!(e*t>=n))return t},Ob=(s,t,e)=>{const n=q(Ee),{i18n:a}=T(),o=a.language,{data:i,fetchNextPage:c,isLoading:l,hasNextPage:d=!1}=Kd([s,t,o],async({pageParam:h=0})=>{if(Number(t)){const u=await n.getSeasonWithEpisodes({seriesId:s,seasonNumber:Number(t),pageOffset:h,language:o});return{pagination:u.pagination,episodes:u.episodes}}else return await n.getEpisodes({seriesId:s,pageOffset:h,language:o})},{getNextPageParam:h=>Rb(h==null?void 0:h.pagination),enabled:e.enabled,staleTime:fs,cacheTime:ms});return{data:(i==null?void 0:i.pages)||[],isLoading:l,fetchNextPage:c,hasNextPage:d}},ad=s=>{const t=q(Ee),{isLoading:e,data:n}=We(["seriesLookup",s],async()=>{var i;if(!s)return;const a=await t.getSeriesByMediaIds([s]);return(i=a==null?void 0:a[s])==null?void 0:i[0]},{staleTime:fs,cacheTime:ms,enabled:!!s});return{isLoading:e,data:n}},Db=({series:s,episodeId:t})=>{const e=q(Ee),{i18n:n}=T(),a=n.language,{isLoading:o,data:i}=We(["next-episode",s==null?void 0:s.series_id,t,a],async()=>{var l;const c=await e.getEpisodes({seriesId:s==null?void 0:s.series_id,pageLimit:1,afterId:t,language:a});return(l=c==null?void 0:c.episodes)==null?void 0:l[0]},{staleTime:fs,cacheTime:ms,enabled:!!(s!=null&&s.series_id&&t)});return{isLoading:o,data:i}},Mb=({series:s})=>{const t=q(Ee),{i18n:e}=T(),{isLoading:n,data:a}=We(["first-episode",s==null?void 0:s.series_id],async()=>{var i;const o=await t.getEpisodes({seriesId:s==null?void 0:s.series_id,pageLimit:1,language:e.language});return(i=o==null?void 0:o.episodes)==null?void 0:i[0]},{staleTime:fs,cacheTime:ms,enabled:!!(s!=null&&s.series_id)});return{isLoading:n,data:a}},od=({data:s})=>{var $a,Ra,Oa;const t=Ie(),{t:e}=T("video"),[n,a]=m.useState(!1),[o,i]=un(),c=s.mediaid,l=o.get("play")==="1",d=o.get("r"),h=o.get("e"),{isLoading:u,data:g,error:y}=$b(c),{isLoading:f,data:x}=Xt(h||""),{isLoading:w,data:_}=Xt((x==null?void 0:x.trailerId)||""),{isLoading:b,data:v}=ad(h||void 0),{isLoading:C,data:j}=Mb({series:g}),S=x||s,{config:E,accessModel:P}=z(({config:le,accessModel:ar})=>({config:le,accessModel:ar}),de),{features:I,siteName:k,custom:$}=E,L=!!(I!=null&&I.favoritesList),D=!!($!=null&&$.inlinePlayer),O=m.useMemo(()=>Nb(g),[g]),[A,W]=m.useState(void 0),{data:X,fetchNextPage:ee,hasNextPage:Q}=Ob(c,A,{enabled:A!==void 0&&!!g}),N=m.useMemo(()=>v&&{episodeNumber:v!=null&&v.episode_number?String(v.episode_number):"",seasonNumber:v!=null&&v.season_number?String(v.season_number):""},[v]),R=m.useMemo(()=>({title:s.title,description:s.description,feedid:g==null?void 0:g.series_id,playlist:(X==null?void 0:X.flatMap(le=>le.episodes))||[]}),[s,g,X]),Y=Lb(N,g),{data:G}=Db({series:g,episodeId:(x==null?void 0:x.mediaid)||(j==null?void 0:j.mediaid)}),re=_t(le=>le.watchHistory),$e=_t(le=>le.getDictionaryWithEpisodes()),pe=re.find(le=>(le==null?void 0:le.seriesId)===c&&le.progress>Yt.Min&&le.progress<Yt.Max),{user:Ce,subscription:ce}=U(({user:le,subscription:ar})=>({user:le,subscription:ar}),de),{isEntitled:ve,mediaOffers:V}=qs(x||j),oe=!!V.length,Ae=!!Ce,se=!!ce,Ve=ue(),Je=le=>yl(Ve,{e:le.mediaid}),ws=m.useCallback(()=>{i({...o,e:x==null?void 0:x.mediaid,r:d||""})},[i,o,x,d]),es=m.useCallback(async()=>{var le;i({...o,e:(le=G||x)==null?void 0:le.mediaid,r:d||"",play:G?"1":"0"})},[i,G,x,d,o]),ts=m.useCallback(async()=>{x||i({...o,e:j==null?void 0:j.mediaid,r:d||"",play:"1"})},[i,j,d,x,o]);m.useEffect(()=>{var le;(document.scrollingElement||document.body).scroll({top:0}),(le=document.querySelector("#video-details button"))==null||le.focus()},[x]),m.useEffect(()=>{pe&&!o.get("e")&&i({...o,e:pe.mediaid,r:d||""},{replace:!0})},[pe,i,o,d]),m.useEffect(()=>{var le;if(!(u||f||b)){if(!h&&A===void 0){W(((le=O[0])==null?void 0:le.value)||"");return}A===void 0&&N&&W(N.seasonNumber)}},[N,A,u,f,b,O,h]);const at=x||j,ss=u||b||f||C,zs=m.useMemo(()=>at&&r.jsx(Gs,{item:at,onClick:()=>{i({...o,e:at.mediaid,r:d||"",play:"1"},{replace:!0})}},h),[h,at,i,o,d]);if(ss)return r.jsx(xs,{});if((y==null?void 0:y.code)===404){const le=ol(s,l,d);return r.jsx(hs,{to:le,replace:!0})}if(!s||!g||!at)return r.jsx(rt,{title:e("series_error")});const bs=`${S.title} - ${k}`,we=`${H.APP_PUBLIC_URL}${Te({id:s.mediaid,title:s.title,episodeId:x==null?void 0:x.mediaid})}`,Ss=r.jsx(Ds,{attributes:Ia(S,{episodesLabel:e("video:total_episodes",{count:g.episode_count}),hoursAbbreviation:e("common:abbreviation.hours"),minutesAbbreviation:e("common:abbreviation.minutes")})}),La=N&&x&&r.jsxs(r.Fragment,{children:[r.jsx("strong",{children:Kn(N.seasonNumber,N.episodeNumber)})," - ",x.title]}),fd=N&&` ${e("video:season")} ${N.seasonNumber}/${O==null?void 0:O.length} - ${e("video:episode")} ${N.episodeNumber}/${Y}`,gd=r.jsx(xn,{title:S==null?void 0:S.title,description:S.description,url:we}),_d=L&&r.jsx(rr,{item:s||j}),yd=(!!_||w)&&r.jsx(M,{label:e("video:trailer"),"aria-label":e("video:watch_trailer"),startIcon:r.jsx(K,{icon:er}),onClick:()=>a(!0),active:n,fullWidth:t<Z.md,disabled:!_});return r.jsxs(Ne.Fragment,{children:[r.jsxs(kt,{children:[r.jsx("title",{children:bs}),r.jsx("link",{rel:"canonical",href:we}),r.jsx("meta",{name:"description",content:S.description}),r.jsx("meta",{property:"og:description",content:S.description}),r.jsx("meta",{property:"og:title",content:bs}),r.jsx("meta",{property:"og:type",content:x?"video.episode":"video.series"}),S.image&&r.jsx("meta",{property:"og:image",content:($a=S.image)==null?void 0:$a.replace(/^https:/,"http:")}),S.image&&r.jsx("meta",{property:"og:image:secure_url",content:(Ra=S.image)==null?void 0:Ra.replace(/^http:/,"https:")}),S.image&&r.jsx("meta",{property:"og:image:width",content:S.image?"720":""}),S.image&&r.jsx("meta",{property:"og:image:height",content:S.image?"406":""}),r.jsx("meta",{name:"twitter:title",content:bs}),r.jsx("meta",{name:"twitter:description",content:S.description}),r.jsx("meta",{name:"twitter:image",content:S.image}),r.jsx("meta",{property:"og:video",content:we.replace(/^https:/,"http:")}),r.jsx("meta",{property:"og:video:secure_url",content:we.replace(/^http:/,"https:")}),r.jsx("meta",{property:"og:video:type",content:"text/html"}),r.jsx("meta",{property:"og:video:width",content:"1280"}),r.jsx("meta",{property:"og:video:height",content:"720"}),(Oa=S.tags)==null?void 0:Oa.split(",").map(le=>r.jsx("meta",{property:"og:video:tag",content:le},le)),S?r.jsx("script",{type:"application/ld+json",children:Tb(g,s,H.APP_PUBLIC_URL,x,N)}):null]}),r.jsx(tr,{item:S,title:D?S.title:s.title,description:S.description||s.description,inlineLayout:D,primaryMetadata:Ss,secondaryMetadata:La,image:S.backgroundImage,shareButton:gd,favoriteButton:_d,trailerButton:yd,startWatchingButton:zs,isLoading:ss,accessModel:P,isLoggedIn:Ae,hasSubscription:se,playlist:R,relatedTitle:D?s.title:e("episodes"),getURL:Je,setFilter:W,currentFilter:A,defaultFilterLabel:e("all_seasons"),activeLabel:e("current_episode"),watchHistory:$e,filterMetadata:fd,filters:O,hasMore:Q,loadMore:ee,player:D?r.jsx(sr,{isLoggedIn:Ae,item:at,seriesItem:s,onComplete:es,feedId:d??void 0,onPlay:ts,startWatchingButton:zs,isEntitled:ve,hasMediaOffers:oe,autostart:l||void 0}):r.jsx(vn,{open:l&&ve,onClose:ws,item:at,seriesItem:s,title:s.title,primaryMetadata:Ss,secondaryMetadata:La,onComplete:es,feedId:d??void 0})}),x&&r.jsx(nr,{item:_,title:`${x.title} - Trailer`,open:n,onClose:()=>a(!1)})]})},Fb=({data:s,isLoading:t})=>{const e=s.liveChannelsId;return t?r.jsx(xs,{}):e?r.jsx(hs,{to:Ns(e,s.mediaid),replace:!0}):r.jsx(rd,{data:s,isLoading:t})},id=({data:s,isLoading:t})=>{const e=s.mediaid,[n]=un(),a=n.get("play")==="1",o=n.get("r"),{data:i,isLoading:c}=ad(s.mediaid),{isLoading:l,data:d}=Xt((i==null?void 0:i.series_id)||"");if(t||c||l)return r.jsx(xs,{});if(!i)return r.jsx(hs,{to:ol(s,a,o),replace:!0});const{mediaid:h,title:u}=d;return r.jsx(hs,{to:Te({episodeId:e,id:h,title:u,play:a,playlistId:o}),replace:!0})};function Bb(s){return{isLiveEvent:Jc(s),isPlayable:Eu(s)}}const Ub="_tag_gc1jh_1",Hb="_normal_gc1jh_11",Wb="_large_gc1jh_20",Vb="_live_gc1jh_31",Nr={tag:Ub,normal:Hb,large:Wb,live:Vb},Qr=({children:s,className:t,isLive:e=!1,size:n="normal"})=>r.jsx("div",{className:F(t,Nr.tag,Nr[n],{[Nr.live]:e}),children:s}),qb="_icon_1fdnv_1",Ac={icon:qb};function Gb({mediaStatus:s}){const{t}=T("video");return s===Bt.SCHEDULED||s===Bt.VOD?r.jsx(K,{icon:Sa,className:Ac.icon}):s===Bt.LIVE?r.jsx(Qr,{isLive:!0,className:Ac.icon,children:t("live")}):null}const zb=({data:s,isLoading:t})=>{var Ce,ce,ve;const{t:e,i18n:n}=T(["video","common"]),[a,o]=m.useState(!1),i=Ie(),c=ae(),d=Ms().id||"",h=He("play")==="1",u=He("r"),{config:g,accessModel:y}=z(({config:V,accessModel:oe})=>({config:V,accessModel:oe}),de),{siteName:f,features:x,custom:w}=g,_=!!(x!=null&&x.favoritesList),b=!!(w!=null&&w.inlinePlayer),{isLoading:v,data:C}=Xt((s==null?void 0:s.trailerId)||""),{isLoading:j,data:S}=_n(u||""),E=Bb(s),{user:P,subscription:I}=U(({user:V,subscription:oe})=>({user:V,subscription:oe}),de),{isEntitled:k,mediaOffers:$}=qs(s),L=!!$.length,D=()=>s&&c(Te({id:s.mediaid,title:s.title,playlistId:u,play:!1})),O=V=>Te({id:V.mediaid,title:V.title,playlistId:u}),A=m.useCallback(()=>{if(!d||!S)return;const V=S.playlist.findIndex(({mediaid:Ae})=>Ae===d),oe=S.playlist[V+1];if(oe.mediaStatus!==Bt.SCHEDULED)return oe&&c(Te({id:oe.mediaid,title:oe.title,playlistId:u,play:!0}))},[d,S,c,u]);m.useEffect(()=>{var V;(document.scrollingElement||document.body).scroll({top:0}),(V=document.querySelector("#video-details button"))==null||V.focus()},[d]);const{title:W,mediaid:X}=s,ee=`${W} - ${f}`,Q=s?`${H.APP_PUBLIC_URL}${Te({id:X,title:W})}`:window.location.href,N=r.jsxs(r.Fragment,{children:[r.jsx(Gb,{mediaStatus:s.mediaStatus}),r.jsx(Ds,{attributes:yw(s,n.language,{minutesAbbreviation:e("common:abbreviation.minutes"),hoursAbbreviation:e("common:abbreviation.hours")})})]}),R=r.jsx(xn,{title:s.title,description:s.description,url:Q}),Y=r.jsx(Gs,{item:s,playUrl:Te({id:X,title:W,playlistId:u,play:!0}),disabled:!E.isPlayable},d),G=_&&r.jsx(rr,{item:s}),re=(!!C||v)&&r.jsx(M,{label:e("video:trailer"),"aria-label":e("video:watch_trailer"),startIcon:r.jsx(K,{icon:er}),onClick:()=>o(!0),active:a,fullWidth:i<Z.md,disabled:!C}),$e=!!P,pe=!!I;return r.jsxs(Ne.Fragment,{children:[r.jsxs(kt,{children:[r.jsx("title",{children:ee}),r.jsx("link",{rel:"canonical",href:Q}),r.jsx("meta",{name:"description",content:s.description}),r.jsx("meta",{property:"og:description",content:s.description}),r.jsx("meta",{property:"og:title",content:ee}),r.jsx("meta",{property:"og:type",content:"video.other"}),s.image&&r.jsx("meta",{property:"og:image",content:(Ce=s.image)==null?void 0:Ce.replace(/^https:/,"http:")}),s.image&&r.jsx("meta",{property:"og:image:secure_url",content:(ce=s.image)==null?void 0:ce.replace(/^http:/,"https:")}),r.jsx("meta",{property:"og:image:width",content:s.image?"720":""}),r.jsx("meta",{property:"og:image:height",content:s.image?"406":""}),r.jsx("meta",{name:"twitter:title",content:ee}),r.jsx("meta",{name:"twitter:description",content:s.description}),r.jsx("meta",{name:"twitter:image",content:s.image}),r.jsx("meta",{property:"og:video",content:Q.replace(/^https:/,"http:")}),r.jsx("meta",{property:"og:video:secure_url",content:Q.replace(/^http:/,"https:")}),r.jsx("meta",{property:"og:video:type",content:"text/html"}),r.jsx("meta",{property:"og:video:width",content:"1280"}),r.jsx("meta",{property:"og:video:height",content:"720"}),(ve=s.tags)==null?void 0:ve.split(",").map(V=>r.jsx("meta",{property:"og:video:tag",content:V},V)),s?r.jsx("script",{type:"application/ld+json",children:ka(s,H.APP_PUBLIC_URL)}):null]}),r.jsx(tr,{item:s,inlineLayout:b,isLoading:t||j,accessModel:y,isLoggedIn:$e,hasSubscription:pe,title:s.title,description:s.description,image:s.backgroundImage,primaryMetadata:N,shareButton:R,favoriteButton:G,trailerButton:re,startWatchingButton:Y,playlist:S,relatedTitle:S==null?void 0:S.title,getURL:O,activeLabel:e("current_video"),player:b?r.jsx(sr,{isLoggedIn:$e,item:s,onComplete:A,feedId:u??void 0,startWatchingButton:Y,isEntitled:k,hasMediaOffers:L,autostart:E.isPlayable&&(h||void 0),playable:E.isPlayable}):r.jsx(vn,{open:h&&k,onClose:D,item:s,title:s.title,primaryMetadata:N,onComplete:A,feedId:u??void 0,onNext:A})}),r.jsx(nr,{item:C,title:`${s.title} - Trailer`,open:a,onClose:()=>o(!1)})]})},Lt=new Aa;Lt.registerByContentType(od,nt.series);Lt.registerByContentType(id,nt.episode);Lt.registerByContentType(Fb,nt.liveChannel);Lt.registerByContentType(zb,nt.liveEvent);Lt.registerByContentType(Ab,nt.page);Lt.registerDefault(rd);Lt.register(id,s=>!!s&&nl(s));Lt.register(od,s=>!!s&&tl(s));const Kb=()=>{const t=Ms().id||"",{isLoading:e,isFetching:n,error:a,data:o}=Xt(t),{t:i}=T("error");if(e)return r.jsx(xs,{});if(a||!o)return r.jsx(rt,{title:i("video_not_found")});const c=Lt.getScreen(o);return r.jsx(Vs,{open:!0,children:r.jsx(c,{data:o,isLoading:n})})},Jb="_playlist_1tsu4_1",Yb="_header_1tsu4_17",kc={playlist:Jb,header:Yb},cd=({data:s,isLoading:t})=>{const e=Xn("title"),{config:n,accessModel:a}=z(({config:x,accessModel:w})=>({config:x,accessModel:w}),de),[o,i]=m.useState(""),c=ph(n,s.feedid),l=m.useMemo(()=>mh(s,o),[s,o]),d=!!c.length,{user:h,subscription:u}=U(({user:x,subscription:w})=>({user:x,subscription:w}),de);m.useEffect(()=>{i("")},[s.feedid]);const g=(s==null?void 0:s[e])||s.title,y=`${g} - ${n.siteName}`,f=x=>Te({id:x.mediaid,title:x.title,playlistId:x.feedid});return r.jsxs("div",{className:kc.playlist,children:[r.jsxs(kt,{children:[r.jsx("title",{children:y}),r.jsx("meta",{property:"og:title",content:y}),r.jsx("meta",{name:"twitter:title",content:y})]}),r.jsxs("header",{className:kc.header,children:[r.jsx("h1",{children:g}),d&&r.jsx(Jl,{name:"genre",value:o,defaultLabel:"All",options:c,setValue:i})]}),r.jsx(Zn,{getUrl:f,playlist:l,accessModel:a,isLoggedIn:!!h,hasSubscription:!!u,isLoading:t,headingLevel:2})]})},Ta=s=>{const t=new Date(s.startTime),e=new Date(s.endTime);return Uc(t)&&Jd(e)},Qb=s=>{const t=new Date(s.endTime);return Uc(t)},Xb=(s,t=8)=>{const e=new Date(s.startTime),n=Hc(new Date,t);return Yd(e,n)},Ln=s=>s.programs.find(Ta),Zb=({playlist:s,initialChannelId:t,enableAutoUpdate:e=!0})=>{const n=q(ll),{data:a=[]}=We(["schedules",...s.map(({mediaid:g})=>g)],()=>n.getSchedules(s),{refetchInterval:mu}),[o,i]=m.useState(e),[c,l]=m.useState(),[d,h]=m.useState();m.useEffect(()=>{if(!o||!e)return;const g=window.setInterval(()=>c&&h(Ln(c)),5e3);return()=>clearInterval(g)},[c,o,e]),m.useEffect(()=>{const g=a.find(({id:y})=>y===t)||a[0];if(!c&&g&&(l(g),h(Ln(g))),c){const y=a.find(({id:x})=>x===c.id);let f=d&&(y==null?void 0:y.programs.find(({id:x})=>x===(d==null?void 0:d.id)));!f&&y&&(f=Ln(y)),l(y),h(f)}},[a]);const u=m.useCallback((g,y)=>{const f=a==null?void 0:a.find(w=>w.id===g);if(!f)return;const x=y?f.programs.find(w=>w.id===y):Ln(f);l(f),h(x),i(!x||Ta(x))},[a]);return{channel:c,channels:a,program:d,setActiveChannel:u}},eS=({program:s,catchupHours:t})=>{const[e,n]=m.useState(!1),[a,o]=m.useState(!1),[i,c]=m.useState(!1);return m.useEffect(()=>{const l=()=>{n(!!s&&Ta(s)),o(!!s&&Qb(s)),c(!!s&&Xb(s,t))},d=setInterval(l,5e3);return l(),()=>clearInterval(d)},[t,s]),{isLive:e,isVod:a,isWatchableFromBeginning:i}},tS=vb(),sS=({id:s,channelLogoImage:t,backgroundImage:e})=>({uuid:s,logo:t,channelLogoImage:t,backgroundImage:e}),nS=(s,{id:t,title:e,cardImage:n,backgroundImage:a,description:o,endTime:i,startTime:c})=>({channelUuid:s,id:t,title:e,image:n||"",cardImage:n||"",backgroundImage:a||"",description:o||"",till:i,since:c}),rS=({channels:s,sidebarWidth:t,itemHeight:e})=>{const[n,a]=m.useMemo(()=>[s.map(sS),s.flatMap(d=>d.programs.map(h=>nS(d.id,h)))],[s]),o=m.useMemo(()=>aS(),[]),i=Qd().toJSON(),[c,l]=m.useMemo(()=>[Xd(new Date(i)),Zd()],[i]);return eu({channels:n,epg:a,dayWidth:7200,sidebarWidth:t,itemHeight:e,isSidebar:!0,isTimeline:!0,isLine:!0,isBaseTimeFormat:tS,startDate:c,endDate:l,theme:o})},aS=()=>({primary:{600:"var(--epg-background-color, var(--body-background-color))",900:"var(--epg-background-color, var(--body-background-color))"},grey:{300:"#fff"},white:"#fff",green:{300:"#fff"},loader:{teal:"",purple:"",pink:"",bg:""},scrollbar:{border:"",thumb:{bg:""}},gradient:{blue:{300:"",600:"",900:""}},text:{grey:{300:"",500:""}},timeline:{divider:{bg:""}}}),oS="_epgChannelBox_15tvm_1",iS="_epgChannel_15tvm_1",cS="_epgChannelLogo_15tvm_27",$n={epgChannelBox:oS,epgChannel:iS,epgChannelLogo:cS},lS=({channel:s,channelItemWidth:t,sidebarWidth:e,onClick:n,isActive:a,title:o})=>{const{position:i,uuid:c,channelLogoImage:l}=s,d={top:i.top,height:i.height,width:e};return r.jsx("div",{className:$n.epgChannelBox,style:d,children:r.jsx("div",{className:F($n.epgChannel,{[$n.active]:a}),style:{width:t},onClick:()=>n&&n(s),"data-testid":void 0,role:"button",children:r.jsx(Ws,{className:$n.epgChannelLogo,image:l,alt:o,width:320})})})},dS="_epgProgramBox_h87h7_1",uS="_epgProgram_h87h7_1",hS="_disabled_h87h7_24",pS="_live_h87h7_28",mS="_selected_h87h7_31",fS="_epgProgramTitle_h87h7_34",gS="_epgProgramText_h87h7_37",_S="_epgLiveTag_h87h7_50",yS="_epgProgramContent_h87h7_77",vS="_epgProgramImage_h87h7_119",lt={epgProgramBox:dS,epgProgram:uS,disabled:hS,live:pS,selected:mS,epgProgramTitle:fS,epgProgramText:gS,epgLiveTag:_S,epgProgramContent:yS,epgProgramImage:vS},xS=({program:s,onClick:t,isActive:e,compact:n,disabled:a,isBaseTimeFormat:o})=>{const{styles:{position:i},formatTime:c,set12HoursTimeFormat:l,isLive:d,isMinWidth:h}=tu({program:s,isBaseTimeFormat:o}),{t:u}=T("common"),{data:g}=s,{image:y,title:f,since:x,till:w}=g,_=c(x,l()).toLowerCase(),b=c(w,l()).toLowerCase(),v=!n&&h,C=!n&&h&&d,j="";return r.jsx("div",{className:lt.epgProgramBox,style:i,onClick:()=>t&&t(s),children:r.jsxs("div",{className:F(lt.epgProgram,{[lt.selected]:e,[lt.live]:d,[lt.disabled]:a}),style:{width:lt.width},"data-testid":(s.data.id,void 0),children:[v&&r.jsx("img",{className:lt.epgProgramImage,src:y,alt:j}),C&&r.jsx("div",{className:lt.epgLiveTag,children:u("live")}),r.jsxs("div",{className:lt.epgProgramContent,children:[n&&d&&r.jsx("div",{className:lt.epgLiveTag,children:u("live")}),r.jsx("h2",{className:lt.epgProgramTitle,children:f}),r.jsxs("span",{className:lt.epgProgramText,children:[_," - ",b]})]})]})})},wS="_timelineBox_10xo1_1",bS="_timelineTime_10xo1_5",SS="_timelineContainer_10xo1_16",jS="_timelineDividers_10xo1_23",CS="_timelineDivider_10xo1_23",en={timelineBox:wS,timelineTime:bS,timelineContainer:SS,timelineDividers:jS,timelineDivider:CS},PS=({isBaseTimeFormat:s,dayWidth:t,hourWidth:e,numberOfHoursInDay:n,offsetStartHoursRange:a,isSidebar:o,sidebarWidth:i})=>{const{time:c,dividers:l,formatTime:d}=su(n,s),h=()=>l.map((g,y)=>r.jsx("div",{className:en.timelineDivider,style:{marginRight:e/4}},y)),u=g=>r.jsxs("div",{className:en.timelineBox,style:{width:e},children:[r.jsx("time",{className:en.timelineTime,children:d(g+a).toLowerCase()}),r.jsx("div",{className:en.timelineDividers,children:h()})]},g);return r.jsx("div",{className:en.timelineContainer,style:{width:t,left:o?i:0},children:c.map((g,y)=>u(y))})},ES="_epg_j4bmq_1",IS="_firstFrame_j4bmq_8",AS="_epgSpinner_j4bmq_42",kS="_timelineControl_j4bmq_50",TS="_timelineNowButton_j4bmq_65",NS="_leftControl_j4bmq_76",LS="_rightControl_j4bmq_77",is={epg:ES,firstFrame:IS,epgSpinner:AS,timelineControl:kS,timelineNowButton:TS,leftControl:NS,rightControl:LS};function $S({channels:s,selectedChannel:t,onChannelClick:e,onProgramClick:n,program:a}){const o=Vl(),i=Ie(),{t:c}=T("common"),l=i<Z.sm,d=l?70:184,h=l?d-10:d-24,u=l?80:106,{getEpgProps:g,getLayoutProps:y,onScrollToNow:f,onScrollLeft:x,onScrollRight:w}=rS({channels:s,sidebarWidth:d,itemHeight:u}),_=m.useMemo(()=>Object.fromEntries(s.map(v=>[v.id,v.catchupHours])),[s]),b=m.useMemo(()=>Object.fromEntries(s.map(v=>[v.id,v.title])),[s]);return r.jsxs("div",{className:F(is.epg,o&&is.firstFrame),children:[r.jsxs("div",{className:is.timelineControl,children:[r.jsx(M,{className:is.timelineNowButton,variant:"contained",label:c("now"),color:"primary",onClick:f,size:"small"}),r.jsx(ze,{className:is.leftControl,"aria-label":c("slide_left"),onClick:()=>x(),children:r.jsx(K,{icon:wa})}),r.jsx(ze,{className:is.rightControl,"aria-label":c("slide_right"),onClick:()=>w(),children:r.jsx(K,{icon:yn})})]}),r.jsx(nu,{...g(),loader:r.jsx(ys,{className:is.epgSpinner}),children:r.jsx(ru,{...y(),renderTimeline:v=>r.jsx(PS,{...v}),renderChannel:({channel:v})=>r.jsx(lS,{channel:v,channelItemWidth:h,sidebarWidth:d,onClick:C=>{e(C.uuid),f()},title:b[v.uuid]||"",isActive:(t==null?void 0:t.id)===v.uuid},v.uuid),renderProgram:({program:v,isBaseTimeFormat:C})=>{const j=_[v.data.channelUuid],S=au(new Date(v.data.since),Hc(new Date,j));return r.jsx(xS,{program:v,disabled:S,onClick:E=>!S&&n(E.data.id,E.data.channelUuid),isActive:(a==null?void 0:a.id)===v.data.id,compact:l,isBaseTimeFormat:C},v.data.id)}})})]})}const RS="_epgContainer_17asv_1",OS="_catchupButton_17asv_11",DS="_tag_17asv_17",Lr={epgContainer:RS,catchupButton:OS,tag:DS},MS=({data:{feedid:s,playlist:t}})=>{var W,X,ee;const{t:e}=T("epg"),{config:n}=z(({config:Q})=>({config:Q}),de),{siteName:a}=n,o=ue(),i=ae(),c=m.useMemo(()=>new URLSearchParams(o.search),[o.search]),l=c.get("play")==="1",d=c.get("channel")??void 0,h=c.get("start"),u=c.get("end"),g=c.get("beginning")==="1",y=()=>s&&i(Ns(s,d)),[f]=m.useState(d),{channels:x,channel:w,program:_,setActiveChannel:b}=Zb({playlist:t,initialChannelId:f,enableAutoUpdate:!g}),{isLive:v,isVod:C,isWatchableFromBeginning:j}=eS({program:_,catchupHours:w==null?void 0:w.catchupHours}),S=m.useMemo(()=>t.find(({mediaid:Q})=>(w==null?void 0:w.id)===Q),[w==null?void 0:w.id,t]),{isEntitled:E}=qs(S),P=m.useMemo(()=>_?{title:_.title,description:_.description||"",image:_.backgroundImage,canWatch:v||C&&j,canWatchFromBeginning:E&&v&&j}:{title:(w==null?void 0:w.title)||"",description:(w==null?void 0:w.description)||"",image:w==null?void 0:w.backgroundImage,canWatch:!0,canWatchFromBeginning:!1},[w==null?void 0:w.backgroundImage,w==null?void 0:w.description,w==null?void 0:w.title,E,v,C,j,_]),I=m.useMemo(()=>{if(!w)return"";if(!_)return r.jsx(Qr,{isLive:!0,children:e("common:live")});const Q=new Date(_.startTime),N=new Date(_.endTime),R=ou(N,Q),Y=la(R,{minutesAbbreviation:e("common:abbreviation.minutes")}),G=[e("on_channel",{name:w.title}),Y].filter(Boolean);return r.jsxs(r.Fragment,{children:[r.jsx(Qr,{className:Lr.tag,isLive:v,children:v?e("common:live"):`${Ba(Q,"p")} - ${Ba(N,"p")}`}),r.jsx(Ds,{attributes:G})]})},[w,v,_,e]),k=(Q,N)=>{b(N,Q),(document.scrollingElement||document.body).scroll({top:0,behavior:"smooth"})},$=Q=>{b(Q)};if(m.useEffect(()=>{w&&s&&d!==w.id&&i(Ns(s,w.id),{replace:!0})},[i,s,w,d]),!w||!s)return r.jsx(xs,{});const L=`${H.APP_PUBLIC_URL}${Ns(s,w.id)}`,D=`${w.title} - ${a}`,O=S?r.jsx(xn,{title:S.title,description:S.description,url:window.location.href}):null,A=S?r.jsxs(r.Fragment,{children:[r.jsx(Gs,{item:S,playUrl:Se(Ns(s,d,!0),{start:C?_==null?void 0:_.startTime:void 0,end:C?_==null?void 0:_.endTime:void 0}),disabled:!P.canWatch}),P.canWatchFromBeginning&&r.jsx(M,{className:Lr.catchupButton,onClick:()=>i(Se(Ns(s||"",d,!0),{start:_==null?void 0:_.startTime,beginning:1})),label:e("start_from_beginning"),startIcon:r.jsx(K,{icon:Hl})})]}):null;return r.jsxs(r.Fragment,{children:[r.jsxs(kt,{children:[r.jsx("title",{children:D}),r.jsx("link",{rel:"canonical",href:L}),r.jsx("meta",{name:"description",content:S==null?void 0:S.description}),r.jsx("meta",{property:"og:description",content:S==null?void 0:S.description}),r.jsx("meta",{property:"og:title",content:D}),r.jsx("meta",{property:"og:type",content:"video.other"}),(S==null?void 0:S.image)&&r.jsx("meta",{property:"og:image",content:(W=S.image)==null?void 0:W.replace(/^https:/,"http:")}),(S==null?void 0:S.image)&&r.jsx("meta",{property:"og:image:secure_url",content:(X=S.image)==null?void 0:X.replace(/^http:/,"https:")}),r.jsx("meta",{property:"og:image:width",content:S!=null&&S.image?"720":""}),r.jsx("meta",{property:"og:image:height",content:S!=null&&S.image?"406":""}),r.jsx("meta",{name:"twitter:title",content:D}),r.jsx("meta",{name:"twitter:description",content:S==null?void 0:S.description}),r.jsx("meta",{name:"twitter:image",content:S==null?void 0:S.image}),r.jsx("meta",{property:"og:video",content:L.replace(/^https:/,"http:")}),r.jsx("meta",{property:"og:video:secure_url",content:L.replace(/^http:/,"https:")}),r.jsx("meta",{property:"og:video:type",content:"text/html"}),r.jsx("meta",{property:"og:video:width",content:"1280"}),r.jsx("meta",{property:"og:video:height",content:"720"}),(ee=S==null?void 0:S.tags)==null?void 0:ee.split(",").map(Q=>r.jsx("meta",{property:"og:video:tag",content:Q},Q)),S?r.jsx("script",{type:"application/ld+json",children:ka(S,H.APP_PUBLIC_URL)}):null]}),r.jsxs(ed,{title:P.title,description:P.description,image:P.image,startWatchingButton:A,shareButton:O,primaryMetadata:I,children:[S&&r.jsx(vn,{open:l&&E,onClose:y,item:S,title:P.title,primaryMetadata:I,feedId:s,liveStartDateTime:h,liveEndDateTime:u,liveFromBeginning:g}),r.jsx("div",{className:Lr.epgContainer,children:r.jsx($S,{channels:x,onChannelClick:$,onProgramClick:k,selectedChannel:w,program:_})})]})]})},Na=new Aa,ld=new Aa;Na.registerDefault(cd);Na.registerByContentType(MS,fu.live);ld.registerDefault(cd);const Tc=({type:s})=>{const e=Ms().id||"",{isFetching:n,error:a,data:o}=_n(e,{},!0,!0,s),{t:i}=T("error");if(n)return r.jsx(xs,{});if(a||!o)return r.jsx(rt,{title:i("playlist_not_found")});if(o.playlist.length===0)return r.jsx(rt,{title:i("empty_shelves_heading"),message:i("empty_shelves_description")});const c=s===Ft.content_list?ld.getScreen(o):Na.getScreen(o);return r.jsx(Vs,{open:!0,children:r.jsx(c,{data:o,isLoading:n})},e)},FS="_header_1ydaw_1",BS="_fixed_1ydaw_7",US="_container_1ydaw_18",HS="_menu_1ydaw_27",WS="_iconButton_1ydaw_31",VS="_brand_1ydaw_39",qS="_nav_1ydaw_43",GS="_skipToContent_1ydaw_68",zS="_actions_1ydaw_102",KS="_search_1ydaw_113",JS="_brandCentered_1ydaw_117",YS="_navButton_1ydaw_121",QS="_searchActive_1ydaw_147",ht={header:FS,fixed:BS,static:"_static_1ydaw_12",container:US,menu:HS,iconButton:WS,brand:VS,nav:qS,skipToContent:GS,actions:zS,search:KS,brandCentered:JS,navButton:YS,searchActive:QS},XS=Symbol("HEADER"),ZS=({children:s,className:t,headerType:e="static",searchActive:n})=>{const a=F(ht.header,ht[e],t,{[ht.searchActive]:n});return r.jsx("header",{className:a,children:r.jsx("div",{className:ht.container,children:s})})},ej=vs(XS,ZS),tj="_footer_pj6tn_1",sj="_list_pj6tn_10",nj="_testFixMargin_pj6tn_23",$r={footer:tj,list:sj,testFixMargin:nj},rj=({text:s})=>{const t=s.split("|").map(a=>a.trim()),e=t.map((a,o)=>r.jsx(Hs,{markdownString:a,inline:!0,tag:t.length>1?"li":"div"},o)),n=t.length>1?r.jsx("ul",{className:$r.list,children:e}):e;return r.jsx("footer",{className:F($r.footer,{[$r.testFixMargin]:Su}),children:n})},aj=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),m.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"})),oj=({className:s,sideBarOpen:t,onClick:e})=>{const{t:n}=T("menu");return r.jsx("div",{className:F(ht.menu,s),children:r.jsx(ze,{className:ht.iconButton,"aria-label":n("open_menu"),"aria-expanded":t,onClick:e,children:r.jsx(K,{icon:aj})})})},ij=100,cj=({className:s,navItems:t})=>{const e=m.useRef(null),n=a=>{if(!e.current)return;const o=e.current.getBoundingClientRect(),c=a.target.getBoundingClientRect().left+e.current.scrollLeft-o.left,l=c<o.width/2?0:c-ij;e.current.scrollTo({left:l,behavior:"smooth"})};return r.jsx("nav",{className:F(ht.nav,s),ref:e,children:r.jsx("ul",{onFocus:n,children:t.map((a,o)=>r.jsx("li",{children:r.jsx(M,{activeClassname:ht.navButton,label:a.label,to:a.to,variant:"text"})},o))})})},lj="_logo_1yd6a_1",dj={logo:lj},uj=({src:s,alt:t="logo",onLoad:e})=>{const[n,a]=m.useState({height:void 0,width:void 0}),o=i=>{const{height:c,width:l}=i.currentTarget;a({height:c,width:l}),e()};return r.jsx(hn,{to:"/",children:r.jsx("img",{className:dj.logo,alt:t,src:s,height:n.height,width:n.width,onLoad:o,onError:e})})},hj=({className:s,siteName:t,logoSrc:e,setLogoLoaded:n})=>{const{t:a}=T("menu");return e?r.jsx("div",{className:F(ht.brand,s),children:r.jsx(uj,{alt:a("logo_alt",{siteName:t}),src:e,onLoad:()=>n(!0)})}):null},pj=({children:s,className:t})=>r.jsx("div",{className:F(ht.actions,t),children:s}),mj=({className:s})=>{const{t}=T("menu");return r.jsx("a",{href:"#content",className:F(ht.skipToContent,s),children:t("skip_to_content")})},fj="_sidebar_1ve1d_1",gj="_heading_1ve1d_20",_j="_group_1ve1d_25",Rr={sidebar:fj,heading:gj,group:_j},yj=Symbol("SIDEBAR"),vj=({children:s,...t})=>r.jsx(ha,{direction:"left",...t,children:s}),xj=({isOpen:s,onClose:t,children:e})=>{const{t:n}=T("menu");return r.jsx(Jn,{open:s,onClose:t,AnimationComponent:vj,children:r.jsxs("div",{className:Rr.sidebar,id:"sidebar",children:[r.jsx("div",{className:Rr.heading,children:r.jsx(ze,{onClick:t,"aria-label":n("close_menu"),children:r.jsx(K,{icon:Yn})})}),r.jsx("nav",{className:Rr.group,onClick:t,children:e})]})})},wj=vs(yj,xj),bj="_menuButton_5vhgl_1",Sj="_small_5vhgl_24",jj="_startIcon_5vhgl_28",Cj="_active_5vhgl_41",Ts={menuButton:bj,small:Sj,startIcon:jj,active:Cj},Pj=Symbol("MENU_BUTTON"),Ej=({label:s,to:t,onClick:e,onBlur:n,onFocus:a,tabIndex:o=0,active:i=!1,startIcon:c,small:l=!1,...d})=>{const h=c?r.jsx("div",{className:Ts.startIcon,children:c}):null,u=g=>F(Ts.menuButton,{[Ts.small]:l},{[Ts.active]:g});return t?r.jsxs(Mc,{onBlur:n,onFocus:a,onClick:e,className:({isActive:g})=>u(g||i),to:t,tabIndex:o,end:!0,children:[h,r.jsx("span",{className:Ts.label,children:s})]}):r.jsxs("div",{role:"button",onBlur:n,onFocus:a,className:u(i),onClick:e,tabIndex:o,...d,children:[h,r.jsx("span",{className:Ts.label,children:s})]})},Ls=vs(Pj,Ej),Ij="_popover_px6io_1",Aj="_menuItems_px6io_5",kj="_divider_px6io_16",Tj="_small_px6io_29",Nj="_sectionHeader_px6io_43",rn={popover:Ij,menuItems:Aj,divider:kj,small:Tj,sectionHeader:Nj},dd=({showPaymentItems:s,small:t=!1,onButtonClick:e,favoritesEnabled:n,focusable:a,titleId:o})=>{const{t:i}=T("user"),c=ae(),l=q(ye),d=a?0:-1,h=m.useCallback(async()=>{e&&e(),await l.logout(),c("/",{replace:!0})},[e,c,l]);return r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:rn.sectionHeader,id:o,children:i("nav.settings")}),r.jsxs("ul",{className:rn.menuItems,children:[r.jsx("li",{children:r.jsx(Ls,{small:t,onClick:e,to:Nu,label:i("nav.account"),startIcon:r.jsx(K,{icon:Ca}),tabIndex:d})}),n&&r.jsx("li",{children:r.jsx(Ls,{small:t,onClick:e,to:Lu,label:i("nav.favorites"),startIcon:r.jsx(K,{icon:Pa}),tabIndex:d})}),s&&r.jsx("li",{children:r.jsx(Ls,{small:t,onClick:e,to:$u,label:i("nav.payments"),startIcon:r.jsx(K,{icon:Gl}),tabIndex:d})}),r.jsx("li",{className:F(rn.divider,{[rn.small]:t}),children:r.jsx(Ls,{small:t,onClick:h,label:i("nav.logout"),startIcon:r.jsx(K,{icon:zl}),tabIndex:d})})]})]})},Lj="_buttonContainer_ak6a2_1",$j="_separator_ak6a2_10",ud={buttonContainer:Lj,separator:$j},Rj=({sideBarOpen:s,canLogin:t,isLoggedIn:e,favoritesEnabled:n,onLoginClick:a,onSignUpClick:o})=>{const{t:i}=T("menu"),c=pt("usermenu-title");return t?e?r.jsx("section",{"aria-labelledby":c,children:r.jsx(dd,{focusable:s,favoritesEnabled:n,titleId:c,showPaymentItems:!0})}):r.jsxs("div",{className:ud.buttonContainer,children:[r.jsx(M,{tabIndex:s?0:-1,onClick:a,label:i("sign_in"),fullWidth:!0}),r.jsx(M,{tabIndex:s?0:-1,variant:"contained",color:"primary",onClick:o,label:i("sign_up"),fullWidth:!0})]}):null},Oj=()=>{const{t:s}=T("common"),t=Xn("title"),e=ae(),n=ue(),a=Fe(f=>f.sideBarOpen),{config:{menu:o,features:i},accessModel:c}=z(f=>({config:f.config,accessModel:f.accessModel})),l=U(({user:f})=>!!f),d=!!(i!=null&&i.favoritesList),h=c!==Me.AVOD,u=()=>Fe.setState({sideBarOpen:!1}),g=()=>{e(J(n,"login"))},y=()=>{e(J(n,"create-account"))};return r.jsxs(wj,{isOpen:a,onClose:u,children:[r.jsxs("ul",{children:[r.jsx("li",{children:r.jsx(Ls,{label:s("home"),to:"/"})}),o.map(({contentId:f,type:x,label:w,custom:_})=>r.jsx("li",{children:r.jsx(Ls,{label:(_==null?void 0:_[t])||w,to:al({type:x,contentId:f})})},f))]}),r.jsx("hr",{className:ud.separator}),r.jsx(Rj,{sideBarOpen:a,favoritesEnabled:d,canLogin:h,isLoggedIn:l,onLoginClick:g,onSignUpClick:y})]})},Dj=()=>{const{t:s}=T("common"),{siteName:t,description:e}=z(({config:a})=>a,de),n=e||s("default_description");return r.jsxs(kt,{children:[r.jsx("title",{children:t}),r.jsx("meta",{name:"description",content:n}),r.jsx("meta",{property:"og:description",content:n}),r.jsx("meta",{property:"og:title",content:t}),r.jsx("meta",{name:"twitter:title",content:t}),r.jsx("meta",{name:"twitter:description",content:n})]})},hd=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})),Mj=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{d:"M9 1C4.58 1 1 4.58 1 9s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm4 10.87L11.87 13 9 10.13 6.13 13 5 11.87 7.87 9 5 6.13 6.13 5 9 7.87 11.87 5 13 6.13 10.13 9 13 11.87z"})),Fj="_searchBar_1plps_1",Bj="_searchForm_1plps_6",Uj="_icon_1plps_10",Hj="_input_1plps_18",Wj="_clearButton_1plps_42",tn={searchBar:Fj,searchForm:Bj,icon:Uj,input:Hj,clearButton:Wj},Vj=({query:s,onQueryChange:t,onClearButtonClick:e,onClose:n,inputRef:a})=>{const{t:o}=T("search"),i=c=>{var l;c.preventDefault(),a==null||a.current.focus(),(l=document.querySelector("#content"))==null||l.focus()};return r.jsxs("div",{className:tn.searchBar,children:[r.jsx(K,{icon:hd,className:tn.icon}),r.jsxs("form",{className:tn.searchForm,role:"search",onSubmit:i,children:[r.jsx("label",{htmlFor:"searchbar-input",className:"hidden",children:o("search_bar.search_label")}),r.jsx("input",{className:tn.input,id:"searchbar-input",type:"search",value:s,onChange:t,onKeyDown:c=>c.key==="Escape"&&(n==null?void 0:n()),placeholder:o("search_bar.search_placeholder"),ref:a}),s?r.jsx(ze,{className:tn.clearButton,"aria-label":o("search_bar.clear_search_label"),onClick:e,children:r.jsx(K,{icon:Mj})}):null]})]})},Hn=({children:s,className:t,...e})=>r.jsx(ze,{className:F(ht.iconButton,t),...e,children:s}),qj="_searchContainer_1s5uc_1",Gj={searchContainer:qj},zj=()=>{const{t:s}=T("menu"),t=ue(),e=m.useRef(null),n=z(({config:x})=>x),{features:a,custom:o}=n,{searchPlaylist:i}=a||{},c=gs(o==null?void 0:o.appContentSearch),l=!!i||c,{searchQuery:d,searchActive:h}=Fe(({searchQuery:x,searchActive:w,userMenuOpen:_,languageMenuOpen:b})=>({languageMenuOpen:b,searchQuery:x,searchActive:w,userMenuOpen:_}),de),{updateSearchQuery:u,resetSearchQuery:g}=ql(),y=()=>{g(),Fe.setState({searchActive:!1})},f=()=>{Fe.setState({searchActive:!0,preSearchPage:`${t.pathname}${t.search||""}`})};return m.useEffect(()=>{h&&e.current&&e.current.focus()},[h]),l?h?r.jsxs("div",{className:Gj.searchContainer,children:[r.jsx(Vj,{query:d,onQueryChange:x=>u(x.target.value),onClearButtonClick:()=>u(""),inputRef:e,onClose:y}),r.jsx(Hn,{"aria-label":s("search_close"),onClick:y,children:r.jsx(K,{icon:Yn})})]}):r.jsx(Hn,{"aria-label":s("search_open"),onClick:f,children:r.jsx(K,{icon:hd})}):null},Kj=s=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...s},m.createElement("path",{fill:"currentColor",d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"})),Jj="_panel_jhs6c_1",Yj={panel:Jj},pd=({children:s,...t})=>r.jsx("div",{className:Yj.panel,...t,children:s}),Qj=({callback:s,children:t})=>{const e=m.useRef();return m.useEffect(()=>{const n=a=>{var o;!e.current||!(a.target instanceof Node)||e.current!==a.target&&!((o=e.current)!=null&&o.contains(a.target))&&s()};return setTimeout(()=>document.addEventListener("click",n),1),()=>document.removeEventListener("click",n)},[s]),Ne.cloneElement(t,{ref:n=>{e.current=n}})},Xj="_popover_1efkk_1",Zj={popover:Xj},md=({children:s,className:t,isOpen:e,onClose:n})=>r.jsx(ha,{open:e,duration:250,direction:"right",style:{position:"relative"},children:r.jsx(Qj,{callback:n,children:r.jsx("div",{className:F(Zj.popover,t),children:s})})}),eC="_popover_1oh0j_1",tC="_menuItems_1oh0j_5",sC="_header_1oh0j_11",nC="_menuItem_1oh0j_5",rC="_menuItemActive_1oh0j_28",Or={popover:eC,menuItems:tC,header:sC,menuItem:nC,menuItemActive:rC},aC=({onClick:s,className:t,languages:e,currentLanguage:n,languageMenuOpen:a,closeLanguageMenu:o,openLanguageMenu:i})=>{const{t:c}=T("menu"),l=(h,u)=>{h.preventDefault(),s&&s(u),o()},d=()=>{a?o():i()};return r.jsxs("div",{children:[r.jsx(Hn,{"data-testid":void 0,"aria-controls":"language-panel","aria-expanded":a,"aria-haspopup":"menu",className:t,"aria-label":c("language_menu"),onClick:d,onBlur:o,children:r.jsx(K,{icon:Kj})}),r.jsx(md,{isOpen:a,onClose:o,children:r.jsx(pd,{id:"language-panel",children:r.jsx("ul",{className:Or.menuItems,children:e.map(({code:h,displayName:u})=>{const g=(n==null?void 0:n.code)===h,y=F(Or.menuItem,{[Or.menuItemActive]:g});return r.jsx("li",{className:y,onClick:f=>l(f,h),children:r.jsx(ln,{onFocus:i,onBlur:o,href:"#","aria-current":g,children:u})},h)})})})})]})},oC=()=>{const{i18n:s}=T("menu"),t=z(d=>d.supportedLanguages),e=Fe(d=>d.languageMenuOpen),n=q(ps),a=q(Os),o=m.useCallback(()=>Fe.setState({languageMenuOpen:!0}),[]),i=m.useCallback(()=>Fe.setState({languageMenuOpen:!1}),[]),c=d=>{s.changeLanguage(d),n.restoreFavorites(d),a.restoreWatchHistory(d)},l=m.useMemo(()=>t.find(({code:d})=>d===s.language),[s.language,t]);return t.length<2?null:r.jsx(aC,{openLanguageMenu:o,closeLanguageMenu:i,languageMenuOpen:e,onClick:c,languages:t,currentLanguage:l})},iC=({isLoggedIn:s,favoritesEnabled:t,open:e,onClose:n,onOpen:a,onLoginButtonClick:o,onSignUpButtonClick:i})=>{const{t:c}=T("menu");return s?r.jsxs("div",{children:[r.jsx(Hn,{"aria-label":c("open_user_menu"),"aria-controls":"menu_panel","aria-expanded":e,"aria-haspopup":"menu",onClick:a,onBlur:n,children:r.jsx(K,{icon:Ca})}),r.jsx(md,{className:rn.popover,isOpen:e,onClose:n,children:r.jsx(pd,{id:"menu_panel",children:r.jsx("div",{onFocus:a,onBlur:n,children:r.jsx(dd,{focusable:e,onButtonClick:n,showPaymentItems:!0,favoritesEnabled:t,small:!0})})})})]}):r.jsxs(r.Fragment,{children:[r.jsx(M,{onClick:o,label:c("sign_in"),"aria-haspopup":"dialog"}),r.jsx(M,{variant:"contained",color:"primary",onClick:i,label:c("sign_up"),"aria-haspopup":"dialog"})]})},cC=()=>{const s=Ie(),t=ae(),e=ue(),n=Fe(y=>y.userMenuOpen),{config:{features:a},accessModel:o}=z(y=>({config:y.config,accessModel:y.accessModel})),i=U(({user:y})=>!!y),c=!!(a!=null&&a.favoritesList),l=o!==Me.AVOD,d=m.useCallback(()=>Fe.setState({userMenuOpen:!0}),[]),h=m.useCallback(()=>Fe.setState({userMenuOpen:!1}),[]),u=()=>t(J(e,"login")),g=()=>t(J(e,"create-account"));return!l||s<=Z.sm?null:r.jsx(iC,{open:n,onOpen:d,onClose:h,isLoggedIn:i,favoritesEnabled:c,onLoginButtonClick:u,onSignUpButtonClick:g})},lC="_layout_1116c_1",dC="_main_1116c_6",Nc={layout:lC,main:dC},uC=()=>{const{t:s}=T("common"),t=Xn("label"),{config:e}=z(({config:x,accessModel:w,supportedLanguages:_})=>({config:x,accessModel:w,supportedLanguages:_}),de),{menu:n,assets:a,siteName:o,styling:i}=e,{footerText:c}=i||{},l=c||wu(H.APP_FOOTER_TEXT),{sideBarOpen:d,searchActive:h}=Fe(x=>({sideBarOpen:x.sideBarOpen,searchActive:x.searchActive})),u=a.banner,g=()=>Fe.setState({sideBarOpen:!0}),y=[{label:s("home"),to:"/"},...n.map(({label:x,contentId:w,type:_,custom:b})=>({label:(b==null?void 0:b[t])||x,to:al({type:_,contentId:w,label:x})}))],f={inert:d?"":void 0};return r.jsxs("div",{className:Nc.layout,children:[r.jsx(Dj,{}),r.jsxs("div",{...f,children:[r.jsxs(ej,{searchActive:h,children:[r.jsx(mj,{}),r.jsx(oj,{sideBarOpen:d,onClick:g}),r.jsx(hj,{siteName:o,logoSrc:u,setLogoLoaded:()=>{}}),r.jsx(cj,{navItems:y}),r.jsxs(pj,{children:[r.jsx(zj,{}),r.jsx(oC,{}),r.jsx(cC,{})]})]}),r.jsx("main",{id:"content",className:Nc.main,tabIndex:-1,children:r.jsx(Wc,{})}),!!l&&r.jsx(rj,{text:l})]}),r.jsx(Oj,{})]})};function hC(){const s=ae(),t=ue(),e=U(i=>{var c;return typeof((c=i.user)==null?void 0:c.uuid)=="string"?i.user.uuid:void 0}),n=q(ye),{hasNotifications:a}=(n==null?void 0:n.getFeatures())||{},o=he((i,c)=>{s(J(t,i,c))});m.useEffect(()=>{!e||!a||n==null||n.subscribeToNotifications({uuid:e,onMessage:async i=>{var c,l;if(i){const d=JSON.parse(i);switch(d.type){case".failed":case"payment.card.failed":case"subscribe.failed":o("payment-error",(c=d.resource)==null?void 0:c.message);break;case"payment.card.success":await fl.invalidateQueries(["entitlements"]),o(null);break;case"subscribe.success":await n.reloadSubscriptions();break;case"access.revoked":await n.reloadSubscriptions();break;case"payment.card.requires.action":case"subscribe.requires.action":window.location.href=(l=d.resource)==null?void 0:l.redirect_to_url;break}}}})},[n,a,o,e])}const pC=()=>{const{i18n:s}=T(),t=ue(),e=U(n=>({loading:n.loading,user:n.user}),de);return hC(),m.useEffect(()=>{document.documentElement.setAttribute("lang",s.language)},[s.language]),e.user&&!e.loading&&window.location.href.includes("#token")?r.jsx(hs,{to:{...t,hash:""},replace:!0}):r.jsx(Wc,{})};function mC(){const{t:s}=T("error");return r.jsx(Bc,{children:r.jsx(Ge,{element:r.jsx(pC,{}),children:r.jsxs(Ge,{element:r.jsx(uC,{}),errorElement:r.jsx(cy,{}),children:[r.jsx(Ge,{index:!0,element:r.jsx(Jv,{})}),r.jsx(Ge,{path:oa,element:r.jsx(Tc,{type:Ft.playlist})}),r.jsx(Ge,{path:Xc,element:r.jsx(Tc,{type:Ft.content_list})}),r.jsx(Ge,{path:Qc,element:r.jsx(Kb,{})}),r.jsx(Ge,{path:Iu,element:r.jsx(Pb,{})}),r.jsx(Ge,{path:Au,element:r.jsx(fx,{})}),r.jsx(Ge,{path:Tu,element:r.jsx(gw,{})}),r.jsx(Ge,{path:ku,element:r.jsx(py,{})}),r.jsx(Ge,{path:"/*",element:r.jsx(rt,{title:s("notfound_error_heading","Not found"),message:s("notfound_error_description","This page doesn't exist.")})})]})})})}const fC=s=>(typeof s=="string"?s.replace(/\s+/g,"").split(","):[]).map(e=>({type:"playlist",contentId:e})),gC=({data:s})=>{const t=m.useMemo(()=>fC(s.playlists||s.playlist),[s.playlist,s.playlists]);return m.useEffect(()=>{var e;(document.scrollingElement||document.body).scroll({top:0}),(e=document.querySelector("#video-details button"))==null||e.focus()},[s]),r.jsxs("header",{children:[r.jsxs(Yl,{image:s.backgroundImage,children:[r.jsx(Ql,{title:s.title}),r.jsx(Zl,{description:s.description})]}),r.jsx(Wl,{rows:t})]})};function _C(){Lt.registerByContentType(gC,nt.hub)}function yC(s,t){const[e,n]=un();return m.useLayoutEffect(()=>{s&&(e.has(sn)&&(!t||t===(s==null?void 0:s.defaultConfigSource))&&n(a=>(a.delete(sn),a),{replace:!0}),t&&t!==(s==null?void 0:s.defaultConfigSource)&&e.get(sn)!==t&&n(a=>(a.set(sn,t),a),{replace:!0}))},[t,e,n,s]),t}const vC=aa,xC=({error:s})=>s instanceof $s?r.jsx(rt,{title:s.payload.title,message:s.payload.description,helpLink:s.payload.helpLink,error:s}):r.jsx(rt,{error:s}),wC=({query:s})=>{const{isLoading:t,error:e,data:n}=s;return t?r.jsx(je,{}):r.jsxs(r.Fragment,{children:[e&&r.jsx(xC,{error:e}),vC,aa]})},bC=({onReady:s})=>{var e,n;const t=sy(window.location.href,s);return yC((e=t.data)==null?void 0:e.settings,(n=t.data)==null?void 0:n.configSource),r.jsx(wC,{query:t})},SC=()=>{const[s,t]=m.useState(!1);m.useEffect(()=>{_C()},[]);const e=m.useCallback(async n=>{n&&(ny(n),t(!0))},[]);return r.jsxs(r.Fragment,{children:[s&&r.jsx(mC,{}),s&&r.jsx(X_,{}),r.jsx(bC,{onReady:e})]})};function jC(){const[s,t]=m.useState({isLoading:!0});return m.useEffect(()=>{Np().then(()=>t({isLoading:!1})).catch(e=>t({isLoading:!1,error:e}))},[]),s.isLoading?r.jsx(je,{}):s.error?(Ue("App","Failed to load translations",{error:s.error}),r.jsx(gl,{title:"Unable to load translations",message:"Check your language settings and try again later. If the problem persists contact technical support.",error:s.error})):r.jsx(ap,{children:r.jsx(iu,{children:r.jsx(Ip,{children:r.jsx(SC,{})})})})}const CC=()=>{let s=!1;document.addEventListener("keydown",t=>{t.key==="Tab"&&!s&&(s=!0,document.body.classList.add("is-tabbing"))}),document.addEventListener("mousedown",()=>{s&&(s=!1,document.body.classList.remove("is-tabbing"))})};var Dr={APP_API_BASE_URL:"https://cdn.jwplayer.com",APP_PLAYER_ID:"M4qoGvUk",APP_VERSION:"4.30.0",APP_FOOTER_TEXT:"\\u00a9 JW Player | [jwplayer.com](https://www.jwplayer.com/) | v4.30.0",APP_DEFAULT_LANGUAGE:"en",APP_ENABLED_LANGUAGES:"en,es",BASE_URL:"/",MODE:"${MODE:=prod}",DEV:!1,PROD:!0,SSR:!1,APP_BODY_FONT:"",APP_BODY_ALT_FONT:""};uu({APP_VERSION:"4.30.0",APP_API_BASE_URL:"https://cdn.jwplayer.com",APP_PLAYER_ID:"M4qoGvUk",APP_DEFAULT_CONFIG_SOURCE:Dr.APP_DEFAULT_CONFIG_SOURCE,APP_PLAYER_LICENSE_KEY:Dr.APP_PLAYER_LICENSE_KEY,APP_FOOTER_TEXT:"\\u00a9 JW Player | [jwplayer.com](https://www.jwplayer.com/) | v4.30.0",APP_BODY_FONT:"",APP_BODY_ALT_FONT:"",APP_PUBLIC_URL:Dr.APP_PUBLIC_URL||window.location.origin});CC();const Lc=document.getElementById("root");Lc?Sd(Lc).render(r.jsx(jC,{})):console.info("Application - rootElement not found");const PC=du({immediate:!0,onNeedRefresh:()=>PC(!0)});export{Vc as _,l0 as a,LC as c,$C as g};
//# sourceMappingURL=index-B5wzJenI.js.map
