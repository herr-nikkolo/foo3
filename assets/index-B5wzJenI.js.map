{"version":3,"mappings":"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AA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,MAqSCA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,MAmE/B,MAAMC,GAAkBD;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,MAoelBE,GAAwBF;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,MAiWxBG,GAAmBH;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;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","names":["registerSW","options","immediate","onNeedRefresh","onOfflineReady","onRegistered","onRegisteredSW","onRegisterError","wb","registerPromise","updateServiceWorker","_reloadPage","register","__vitePreload","Workbox","e","event","r","env","APP_VERSION","APP_API_BASE_URL","APP_API_ACCESS_BRIDGE_URL","APP_PLAYER_ID","APP_FOOTER_TEXT","APP_DEFAULT_LANGUAGE","APP_PUBLIC_URL","configureEnv","APP_DEFAULT_CONFIG_SOURCE","APP_PLAYER_LICENSE_KEY","APP_BODY_FONT","APP_BODY_ALT_FONT","PersonalShelf","ContinueWatching","Favorites","PersonalShelves","INTEGRATION","JWP","CLEENG","ACCESS_MODEL","AVOD","AUTHVOD","SVOD","VideoProgressMinMax","Min","Max","PLAYLIST_LIMIT","ADYEN_TEST_CLIENT_KEY","ADYEN_LIVE_CLIENT_KEY","LIVE_CHANNELS_REFETCH_INTERVAL","MEDIA_CONTENT_TYPE","series","episode","liveChannel","liveEvent","page","hub","PLAYLIST_CONTENT_TYPE","live","SHELF_LAYOUT_TYPE","hero","featured","OTT_GLOBAL_PLAYER_ID","CONFIG_QUERY_KEY","CONFIG_FILE_STORAGE_KEY","CACHE_TIME","STALE_TIME","CARD_ASPECT_RATIOS","MAX_WATCHLIST_ITEMS_COUNT","DEFAULT_FEATURES","canUpdateEmail","canSupportEmptyFullName","canChangePasswordWithOldPassword","canRenewSubscription","canExportAccountData","canDeleteAccount","canUpdatePaymentMethod","canShowReceipts","hasSocialURLs","hasNotifications","watchListSizeLimit","EPG_TYPE","jwp","viewNexa","APP_CONFIG_ITEM_TYPE","playlist","continue_watching","favorites","content_list","media","container","Container","defaultScope","skipBaseClassChecks","getModule","constructorFunction","required","module","getAll","Error","String","getAllModules","getNamedModule","name","getAllNamed","err","message","includes","error","assertModuleMethod","method","assertFeature","isEnabled","featureName","INTEGRATION_TYPE","Symbol","DETERMINE_INTEGRATION_TYPE","GET_CUSTOMER_IP","API_ACCESS_BRIDGE_URL","BROADCAST_CHANNEL","debounce","callback","wait","timeout","debounced","args","setTimeout","cancel","clearTimeout","throttle","func","limit","lastFunc","lastRan","throttled","timeSinceLastRan","Date","now","apply","undefined","unicodeToChar","text","replace","match","fromCharCode","parseInt","hexToRgb","color","indexOf","slice","length","g","b","calculateContrastColor","rgb","IS_DEVELOPMENT_BUILD","__dev__","IS_PREVIEW_MODE","__mode__","isContentType","item","contentType","toLowerCase","isTruthyCustomParamValue","value","isFalsyCustomParamValue","isTruthy","Boolean","MediaStatus","LIVE","VOD","SCHEDULED","isLiveEvent","playlistItem","isScheduledOrLiveMedia","mediaStatus","getMediaStatusFromEventState","eventState","scheduledStart","scheduledEnd","EventState","isPlayable","PATH_MEDIA","PATH_PLAYLIST","PATH_CONTENT_LIST","PATH_LEGACY_SERIES","PATH_SEARCH","PATH_ABOUT","PATH_USER_BASE","PATH_USER","RELATIVE_PATH_USER_ACCOUNT","RELATIVE_PATH_USER_FAVORITES","RELATIVE_PATH_USER_PAYMENTS","PATH_USER_ACCOUNT","PATH_USER_FAVORITES","PATH_USER_PAYMENTS","LogLevel","DEBUG","INFO","WARN","ERROR","FATAL","SILENT","LogTransporter","wrapError","makeLogFn","logLevel","scope","extra","forEach","transporter","log","logDebug","logInfo","logWarn","logError","getSeriesPlaylistIdFromCustomParams","seriesPlayListId","seriesPlaylistId","seriesId","isLegacySeriesFlow","isSeriesContentType","isSeries","isEpisode","episodeNumber","getLegacySeriesPlaylistIdFromEpisodeTags","seriesIdTag","tags","split","find","tag","test","isLiveChannel","createURL","url","queryParams","baseUrl","urlQueryString","urlSearchParams","URLSearchParams","entries","key","delete","formattedValue","Array","isArray","join","set","queryString","toString","createPath","originalPath","pathParams","path","map","segment","Object","filter","_","startsWith","isOptional","endsWith","paramName","paramValue","slugify","whitespaceChar","mediaURL","id","title","playlistId","play","episodeId","playlistURL","contentListURL","determinePath","type","contentId","label","liveChannelsURL","channelId","channel","legacySeriesURL","buildLegacySeriesUrlFromMediaItem","legacyPlaylistIdFromTags","legacyPlaylistIdFromCustomParams","mediaid","ApiError","constructor","code","getDataOrThrow","response","data","json","ok","status","apiMessage","isLocked","accessModel","isLoggedIn","hasSubscription","isItemFree","requiresSubscription","free","mediaOffers","some","offer","premier","filterMediaOffers","vendorPrefix","offerIds","reduce","offers","offerId","createStore","storeFn","store","subscribeWithSelector","create","useConfigStore","loaded","config","siteName","description","player","siteId","assets","content","menu","integrations","cleeng","useSandbox","clientId","assetId","styling","settings","additionalAllowedConfigSources","playerId","supportedLanguages","integrationType","PAGE_LIMIT","ApiService","_dec","injectable","_class","generateAlternateImageURL","mediaId","playlistLabel","pathname","poster_fallback","fallback","parseDate","prop","date","isValid","parseISO","getTranslatedFields","language","defaultLanguage","transformedItem","transformContentList","contentList","list","rest","custom_params","media_id","feedid","sources","images","image","link","pubdate","transformMediaItem","transformPlaylist","relatedMediaId","ConfigStore","getState","offerKeys","keys","imageLabel","translatedFields","transformedMediaItem","cardImage","ImageProperty","channelLogoImage","backgroundImage","productIds","transformEpisodes","episodesRes","seasonNumber","episodes","page_limit","total","el","media_item","season_number","episode_number","pagination","getMediaByWatchlist","mediaIds","token","media_ids","fetch","getMediaById","drmPolicyId","mediaItem","getMediaByIdWithPassport","planId","passport","plan_id","getSeries","params","getSeriesByMediaIds","getEpisodes","pageOffset","pageLimit","afterId","page_offset","after_id","episodesResponse","getSeasonWithEpisodes","getAdSchedule","credentials","getPlaylistById","related_media_id","getContentList","getContentSearch","search_query","searchTerm","StorageService","AccountService","features","schema","array","object","shape","string","progress","number","WatchHistoryService","_dec2","target","inject","_dec3","_dec4","_dec5","Reflect","metadata","Function","_dec6","apiService","storageService","PERSIST_KEY_WATCH_HISTORY","accountService","getWatchHistoryItems","continueWatchingList","ids","watchHistoryItems","watchHistoryItemsDict","fromEntries","getWatchHistorySeriesItems","mediaWithSeries","seriesIds","series_id","uniqueSerieIds","Set","seriesItems","seriesItemsDict","acc","seriesItemId","getWatchHistory","user","savedItems","getWatchHistoryFromAccount","getWatchHistoryFromStorage","parentSeries","historyItem","createWatchHistoryItem","serializeWatchHistory","watchHistory","persistWatchHistory","_a","updateWatchHistory","history","setItem","JSON","stringify","videoProgress","duration","getMaxWatchHistoryCount","_b","saveItem","seriesItem","watchHistoryItem","updatedHistory","unshift","splice","validateWatchHistory","validateSync","getItem","GenericEntitlementService","getToken","body","jwt","headers","Authorization","getMediaToken","host","entitled","INPLAYER_TOKEN_KEY","INPLAYER_IOT_KEY","CONTENT_TYPES","form","JWPAPIService","useSandboxEnv","setup","getBaseUrl","setToken","refreshToken","expires","tokenObject","removeToken","Promise","all","removeItem","isAuthenticated","performRequest","responseType","withAuthentication","keepalive","includeFullResponse","searchParams","formData","innerKey","innerValue","append","endpoint","resp","resParsed","get","patch","put","post","remove","__publicField","isCommonError","JWPEntitlementService","getJWPMediaToken","configId","app_config_id","getEntitledPlans","FavoriteService","PERSIST_KEY_FAVORITES","getFavorites","favoritesList","getFavoritesFromAccount","getFavoritesFromStorage","playlistItems","createFavorite","serializeFavorites","persistFavorites","updateFavorites","getMaxFavoritesCount","validateFavorites","contentSchema","notRequired","boolean","backgroundColor","nullable","mixed","oneOf","custom","defined","menuSchema","filterTags","featuresSchema","recommendationsPlaylist","searchPlaylist","cleengSchema","monthlyOffer","yearlyOffer","default","jwpSchema","stylingSchema","highlightColor","headerBackground","footerText","configSchema","analyticsToken","adSchedule","adDeliveryMethod","adConfig","banner","of","adScheduleUrls","xml","contentSigningService","contentProtection","drm","defaultPolicyId","AppError","payload","ConfigService","CONFIG_HOST","DEFAULT_CONFIG","enrichConfig","updatedContent","assign","i18next","t","getDefaultConfig","validateConfig","validate","strict","formatSourceLocation","source","loadConfig","configLocation","i18n","getI18n","errorPayload","helpLink","Accept","catch","SettingsService","isValidConfigSource","UNSAFE_allowAnyConfigSource","defaultConfigSource","initialize","then","result","ini","parse","iniString","playerLicenseKey","apiAccessBridgeUrl","getConfigSource","configKey","storedSource","useAccountStore","loading","subscription","transactions","entitledPlan","activePayment","customerConsents","publisherConsents","publisherConsentsLoading","pendingOffer","setLoading","getAccountInfo","customerId","customer","useWatchHistoryStore","playlistItemsLoaded","continueWatchingPlaylistId","getPlaylist","getDictionaryWithEpisodes","dict","getDictionaryWithSeries","WatchHistoryController","watchHistoryService","restoreWatchHistory","setState","CheckoutService","SubscriptionService","useCheckoutStore","requestedMediaOffers","subscriptionOffers","switchSubscriptionOffers","selectedOffer","defaultOfferId","order","paymentMethods","setRequestedMediaOffers","setOrder","setPaymentMethods","FormValidationError","errors","values","flat","determineSwitchDirection","currentPeriod","period","findDefaultCardMethodId","methodName","CheckoutController","IntegrationType","GetCustomerIP","getCustomerIP","checkoutService","subscriptionService","initialiseOffers","getOffers","svodOfferIds","subscriptionSwitches","getSubscriptionSwitches","getSubscriptionOfferIds","chooseOffer","initialiseOrder","getPaymentMethods","paymentMethodId","createOrderArgs","country","createOrder","responseData","updateOrder","couponCode","paymentWithoutDetails","captchaValue","orderId","rejectedReason","directPostCardPayment","cardPaymentPayload","referrer","returnUrl","createAdyenPaymentSession","isInitialPayment","initialAdyenPayment","paymentMethod","customerIP","finalizeAdyenPayment","details","paymentData","paypalPayment","successUrl","waitingUrl","cancelUrl","errorUrl","paymentWithPayPal","redirectUrl","getOffer","available","toOfferId","switchSubscription","switchDirection","switchSubscriptionPayload","changeSubscription","accessFeeId","subscriptionId","updatePayPalPaymentMethod","currentPaymentId","updatePaymentMethodWithPayPal","deletePaymentMethod","paymentDetailsId","addAdyenPaymentDetails","finalizeAdyenPaymentDetails","getEntitlements","useFavoritesStore","warning","favoritesPlaylistId","setWarning","clearWarning","hasItem","favoriteItem","FavoritesController","favoritesService","restoreFavorites","items","concat","toggleFavorite","maxCount","clear","AccessService","generateAccessTokens","refreshAccessTokens","refresh_token","useAccessStore","ACCESS_TOKENS","AccessController","_dec7","accessService","generateOrRefreshAccessTokens","accessTokens","existingAccessTokens","getAccessTokens","shouldRefresh","auth","getAuthData","setAccessTokens","getTime","removeAccessTokens","AccountController","accessController","favoritesController","watchHistoryController","entitlementService","refreshEntitlements","loadUserData","getAccount","logout","updateUser","getFeatures","prototype","hasOwnProperty","call","validateInputLength","email","updatedUser","updateCustomer","getUser","afterLogin","login","password","clearLoginState","_c","consentsValues","consents","errorMessage","updateConsents","updatedConsents","updateCustomerConsents","getCustomerConsents","getPublisherConsents","getCaptureStatus","updateCaptureAnswers","capture","updatedCustomer","resetPassword","resetUrl","customerEmail","changePasswordWithOldPassword","oldPassword","newPassword","newPasswordConfirmation","changePasswordWithToken","resetPasswordToken","changePasswordWithResetToken","updateSubscription","unsubscribeUrl","reloadSubscriptions","retry","updateCardDetails","cardName","cardNumber","cvc","expMonth","expYear","currency","getActivePayment","checkEntitlements","accessGranted","plans","plan","access_model","delay","resolve","finally","activeSubscription","getActiveSubscription","getAllTransactions","retryDelay","pendingSwitchId","getSubscriptionSwitch","switchOffer","switchId","exportAccountData","getSocialLoginUrls","getSocialUrls","deleteAccountData","deleteAccount","getReceipt","transactionId","fetchReceipt","subscribeToNotifications","uuid","onMessage","Number","firstName","push","lastName","getSandbox","sandbox","registration","allSettled","AppController","configService","settingsService","loadAndValidateConfig","configSource","defaultConfig","state","merge","initializeApp","calculateIntegrationType","activatedIntegrationTypes","previousValue","getIntegrationType","configState","getApiAccessBridgeUrl","EpgService","isFulfilled","input","reason","EpgController","parseSchedule","demo","scheduleDemo","epgService","getEpgService","programs","transformProgram","program","generateDemoPrograms","getSchedule","schedule","fetchSchedule","catchupHours","scheduleType","toLocaleLowerCase","service","getSchedules","today","startDate","startTime","utcStartDate","UTC","getUTCFullYear","getUTCMonth","getUTCDate","daysDelta","differenceInDays","idx","addDays","toJSON","endTime","viewNexaEpgProgramSchema","desc","icon","src","start","stop","parseData","toISOString","ViewNexaEpgService","XMLParser","n","scheduleUrl","xmlParserOptions","ignoreAttributes","attributeNamePrefix","res","tv","programme","AUTHENTICATION_HEADER","jwEpgProgramSchema","chapterPointCustomProperties","JWEpgService","Headers","scheduleToken","context","PromiseQueue","queue","getLength","enqueue","reject","promises","AUTH_PERSIST_KEY","tokensSchema","accessToken","isValidTokens","candidate","isValidSync","getTokenExpiration","decodedToken","jwtDecode","exp","CleengService","optional","BroadcastChannel","isRefreshing","expiration","tokens","logoutCallback","getNewTokens","newTokens","handleBroadcastMessage","action","setTokens","sendBroadcastMessage","postMessage","authenticate","getAccessTokenOrThrow","restoreTokensFromStorage","maybeRefreshAccessToken","persistInStorage","clearTokens","tokensString","accessTokenIsExpired","hasTokens","refreshTokens","getAccessToken","getLocales","addEventListener","formatCustomer","fullName","externalData","formatPublisherConsent","consent","defaultValue","placeholder","enabledByDefault","version","CleengAccountService","cleengService","publisherId","handleErrors","getCustomerIdFromAuthData","getCustomer","_url","cleengConfig","localesResponse","locale","authData","CleengCheckoutService","locales","ipAddress","createOrderPayload","getOrder","paypalPayload","attemptAuthentication","CleengSubscriptionService","getSubscriptions","getTransactions","getPaymentDetails","paymentDetails","active","offset","getFiltersFromConfig","menuItem","filterPlaylist","generatePlaylistPlaceholder","playlistLength","fill","_value","index","genre","rating","tracks","formatConsentValues","publisherConsent","customerConsent","isCustomRegisterField","formatConsents","extractConsentValues","formatConsentsFromValues","checkConsentsFromValues","consentsErrors","isNotEmptyConsent","formatConsentToRegisterField","collection","val","formatConsentsToRegisterFields","deepCopy","obj","parseAspectRatio","parseTilesDelta","posterAspect","parts","Math","floor","JW_TERMS_URL","JWPAccountService","parseJson","formatFavorite","favorite","formatHistoryItem","formatAccount","account","full_name","created_at","createdAt","regDate","toLocaleString","first_name","surname","lastUserIp","_logoutFn","jwpConfig","InPlayerEnv","InPlayer","setConfig","terms","field","default_value","getTermsConsent","existingAccountData","formatUpdateAccount","newAnswers","old_password","password_confirmation","merchant_uuid","branding_id","client_id","grant_type","username","access_token","formatAuth","Notifications","isSubscribed","unsubscribe","trim","firstNameTrimmed","lastNameTrimmed","isCaptureEnabled","shouldCaptureBeDisplayed","answer","enabled","termsUrl","termsLink","current","savedHistory","currentFavoriteIds","payloadFavoriteIds","favoritesData","watchHistoryData","subscribe","onOpen","socialState","base64Encode","redirect","socialResponse","social_urls","formatDurationTag","seconds","minutesAbbreviation","ceil","formatDuration","hoursAbbreviation","hours","minutes","round","hoursString","minutesString","formatPrice","price","Intl","NumberFormat","style","format","formatSeriesMetaString","formatVideoSchedule","formatLocalizedDateTime","formatLocalizedTime","formatLocalizedDate","DateTimeFormat","day","month","year","hour","minute","separator","getOfferPrice","customerPriceInclTax","customerCurrency","customerCountry","isSVODOffer","JWPCheckoutService","cardPaymentProvider","formatPaymentMethod","method_name","provider","logoUrl","formatEntitlements","expiresAt","formatOffer","formatOfferId","offerCurrency","amount","offerTitle","access_type","quantity","freePeriods","trial_period","planSwitchEnabled","plan_switch_enabled","formatOrder","totalPrice","priceBreakdown","offerPrice","discountAmount","discountedPrice","paymentMethodFee","taxValue","taxRate","requiredPaymentDetails","success","parseOfferId","origin","access_fee","payment_method","voucher_code","iFrameCardPayment","access_fee_id","updatedOrder","discount","applied","periods","discount_duration","expires_at","card_name","cardholderName","exp_month","cardExpMonth","exp_year","cardExpYear","cvv","cardCVC","return_url","item_id","JWPSubscriptionService","named","formatCardDetails","card","card_type","account_id","zeroFillExpMonth","paymentGateway","paymentMethodSpecificParams","holderName","variant","lastCardFourDigits","cardExpirationDate","formatTransaction","transaction","purchasedAmount","charged_amount","transaction_token","transactionDate","trxToken","trx_token","offerType","item_type","item_title","offerPeriod","transactionPriceExclTax","transactionCurrency","currency_iso","discountedOfferPrice","offerPriceExclTax","applicableTax","transactionPriceInclTax","consumer_id","customerLocale","customerIpCountry","payment_method_name","formatActiveSubscription","action_type","subscription_id","nextPaymentAt","next_rebill_date","nextPaymentPrice","subscription_price","nextPaymentCurrency","unsubscribe_url","formatGrantedSubscription","hasAccess","cards","inplayer_token","isCleengIntegrationType","isJwpIntegrationType","getApolloClient","targetEndpoint","subscriptionEndpoint","httpLink","createHttpLink","uri","ApolloClient","cache","InMemoryCache","addTypename","KeywordSearchDocument","gql","GetItemDocument","GetCollectionDocument","GetItemsDocument","CATALOG_API_BASE_URL","IMAGE_API_BASE_URL","apolloClient","notImplemented","AxinomApiService","transformToPlaylistItem","isTrailer","nodes","node","width","videos","hlsManifest","dashManifest","file","lengthInSeconds","has_any_trailer","genres","pop","movieGenre","tvshowGenre","p","trailerId","cast","tranformEpisodeToPlayListItem","tranformMovieToPlayListItem","movie","tranformSeasonToPlayListItem","season","tranformTvShowToPlayListItem","tvshow","transformAxinomMediaItem","query_result","query","variables","fetchPolicy","transformedMediaItemAxinom","seasons","seasonDuration","video","v","season_id","season_title","season_description","synopsis","episode_count","total_duration","episodeCount","count","totalDuration","season_count","createMediaObject","entity","media_object","tvshowId","serie","season_episode","totalEpisodes","totalPages","max","startIndex","min","endIndex","filtered_episodes","doKeyWordSearch","keyword","search","transformedCollection","movies","tvshows","related_media_item","cardImageAspectRatio","relationType","movie_playlist_item","arePlayListItemsRelated","a","AxinomConfigService","mosaicConfig","bind","toSelf","to","whenTargetNamed","toDynamicValue","toConstantValue","rebind","ConsoleTransporter","level","warn","console","LocalStorageService","prefix","getStorageKey","usePrefix","window","localStorage","btoa","base64Decode","atob","getOverrideIP","queryClient","QueryClient","defaultOptions","queries","staleTime","refetchOnWindowFocus","retryOnMount","QueryProvider","children","jsx","QueryClientProvider","ErrorPage","learnMoreLabel","useTranslation","ErrorPageWithoutTranslation","logo","s","styles","errorPage","jsxs","box","main","Spinner","size","className","classNames","buffer","small","large","LoadingOverlay","transparentBackground","inline","loadingOverlay","transparent","fixed","variantAriaMap","info","FormFeedback","visible","formFeedback","hidden","ariaLive","AriaAnnouncerContext","createContext","useAriaAnnouncer","announce","useContext","AriaAnnouncerProvider","announcement","setAnnouncement","useState","useCallback","secondsToMilliseconds","createPortal","document","filterSupportedLanguages","definedLanguages","enabledLanguages","languages","languageCode","foundLanguage","NAMESPACES","DEFINED_LANGUAGES","displayName","initI18n","import","use","I18NextHttpBackend","LanguageDetector","initReactI18next","init","supportedLngs","fallbackLng","returnEmptyString","ns","defaultNS","fallbackNS","interpolation","escapeValue","detection","caches","lookupLocalStorage","react","useSuspense","createURLFromLocation","location","modalURLFromLocation","u","modalURLFromWindowLocation","href","useEventCallback","fnRef","useRef","useLayoutEffect","useQueryParam","useSearchParams","useCountdown","durationSeconds","intervalSeconds","completeHandler","timerRef","countdown","setCountdown","useEffect","createInjectableComponent","identifier","DefaultComponent","props","isBound","OverriddenComponent","ButtonIdentifier","Button","startIcon","fullWidth","disabled","busy","onClick","activeClassname","buttonClassName","isActive","button","centerAbsolute","NavLink","Button$1","Welcome","onCloseButtonClick","onCountdownCompleted","welcome","PaymentFailed","triggerReflow","element","scrollTop","Animation","createStyle","open","onOpenAnimationEnd","onCloseAnimationEnd","keepMounted","nodeRef","setStatus","hasOpenedBefore","setHasOpenedBefore","timeout2","openEvent","closeEvent","Grow","transition","transform","canUseDOM","createElement","scrollbarSize","recalc","scrollDiv","position","top","height","overflow","appendChild","offsetWidth","clientWidth","removeChild","addScript","script","async","onload","onerror","removeBodyScrolling","marginRight","overflowY","restoreBodyScrolling","from","querySelectorAll","dialog","removeProperty","originElement","useModal","restoreFocus","activeElement","focus","handleOpen","handleClose","Modal","onClose","centered","role","AnimationComponent","animationContainerClassName","ariaAttributes","modalRef","mouseEventTargetsPairRef","downTarget","upTarget","closeModalEvent","onAnimationEndHandler","classList","close","removeEventListener","add","openModalEvent","showModal","keyDownHandler","contains","preventDefault","closeHandler","closeAnimationEndHandler","clickHandler","ReactDOM","querySelector","Slide","direction","directions","left","right","bottom","opacity","zIndex","SvgClose","React.createElement","IconButton","ariaProps","iconButton","Icon","IconComponent","ModalCloseButton","modalCloseButton","Close","Dialog","testId","useForm","initialValues","validationSchema","validateOnBlur","onSubmit","onSubmitSuccess","onSubmitError","touched","setTouched","setValues","submitting","setSubmitting","setErrors","validationSchemaError","setValidationSchemaError","reset","validateField","formValues","validateSyncAt","ValidationError","setValue","handleChange","HTMLInputElement","checked","newValues","handleBlur","abortEarly","newErrors","inner","every","handleSubmit","resetValue","useToggle","initialState","forceValue","SvgVisibility","SvgVisibilityOff","generateId","suffix","randomId","random","useOpaqueId","override","setId","HelperText","helperId","helperText","FormField","renderInput","editing","formFieldClassName","formField","helperTextId","isTextArea","_props","multiline","Input","textAreaRef","inputRef","leftControl","rightControl","inputProps","inputType","containerClassName","commonProps","rows","readOnly","control","TextField","textField","fieldProps","PASSWORD_REGEX","PasswordStrength","strength","labels","passwordStrength","passwordStrengthBar","passwordStrengthFill","PasswordField","showToggleView","showHelperText","viewPassword","toggleViewPassword","React","Visibility","VisibilityOff","DeleteAccountModal","accountController","enteredPassword","setEnteredPassword","navigate","useNavigate","useLocation","resetForm","useMutation","onSuccess","onError","handleCancel","heading","disclaimer","warningBox","buttons","isLoading","mutate","paragraph","stacked","FinalizePayment","checkoutController","redirectResult","orderIdQueryParam","setErrorMessage","paymentSuccessUrl","useMemo","checkPaymentResult","decodeURI","Fragment","useCheckAccess","intervalRef","intervalCheckAccess","interval","iterations","setInterval","clearInterval","WaitingForPayment","center","UpgradeSubscription","typeToAnnounce","pending","DeleteAccountPasswordWarning","proceedToAddPasswordClickHandler","formContainer","passwordButtonsContainer","SvgCreditcard","SvgPaypal","PaymentMethodForm","onPaymentMethodChange","renderPaymentMethod","updateSuccess","cardPaymentMethod","paypalPaymentMethod","paymentMethodsInputs","radio","paymentMethodLabel","CreditCard","PayPal","payPal","Adyen","configuration","checkoutElementRef","checkoutRef","session","checkout","AdyenCheckout","mount","unmount","adyen","submit","AdyenPaymentDetails","setProcessing","setPaymentError","isSandbox","setSession","finalize","finalizePaymentDetails","handleAction","adyenConfiguration","showPayButton","environment","clientKey","paymentMethodsConfiguration","hasHolderName","holderNameRequired","onAdditionalDetails","component","UpdatePaymentMethod","paymentMethodIdQueryParam","parsedPaymentMethodId","paymentError","setPaymentMethodId","processing","handlePaymentMethodChange","toPaymentMethodId","handlePayPalSubmit","EditCardDetailsForm","onCancel","cancelButton","CreditCardCVCField","onChange","formatCVC","clearValue","CreditCardExpiryField","formatExpirationDate","cardIssuers","visa","mastercard","maestro","amex","discover","diners","dinersclub","unionpay","hiper","CreditCardNumberField","onBlur","cardIssuer","setCardIssuer","formatCreditCardNumber","issuer","Payment","fns","cardType","nextValue","cardTypeWrapper","EditCardPaymentForm","setUpdatingCardDetails","mutateCardDetails","shallow","cardExpiry","validateCardNumber","validateCardExpiry","validateCardCVC","onSettled","expiry","cardExpiryVal","paymentForm","columns","EditCardDetails","updatingCardDetails","EditPasswordForm","showOldPasswordField","showResetTokenField","validationError","onResendEmailClick","resendLink","passwordConfirmation","ResetPassword","resetPasswordTokenParam","emailParam","passwordSubmitHandler","resetToken","passwordForm","matches","resendEmailClickHandler","RenewSubscriptionForm","onConfirm","infoBox","confirmButton","SubscriptionRenewed","RenewSubscription","renewed","setRenewed","setError","renewSubscriptionConfirmHandler","CancelSubscriptionForm","SubscriptionCancelled","expiresDate","CancelSubscription","cancelled","setCancelled","expirationDateFormatted","cancelSubscriptionConfirmHandler","ResetPasswordForm","onReset","ForgotPasswordForm","ConfirmationForm","onBackToLogin","loggedIn","forgotPasswordForm","notSure","Link","resetPasswordSubmitting","setResetPasswordSubmitting","cancelClickHandler","backToLoginClickHandler","resetPasswordClickHandler","emailSubmitHandler","emailForm","useCheckout","onUpdateOrderSuccess","onSubmitPaymentWithoutDetailsSuccess","onSubmitPaypalPaymentSuccess","onSubmitStripePaymentSuccess","mutationKey","mutationFn","submitPaymentWithoutDetails","submitPaymentPaypal","submitPaymentStripe","isError","isSubmitting","SvgArrowLeft","DialogBackButton","dialogBackButton","ArrowLeft","RecaptchaField","forwardRef","siteKey","ref","captcha","ReCaptcha","CheckoutForm","onBackButtonClick","couponFormOpen","couponInputValue","couponFormError","couponFormApplied","couponFormSubmitting","onCouponInputChange","onCloseCouponFormClick","onCouponFormSubmit","onRedeemCouponButtonClick","captchaSiteKey","recaptchaRef","getOfferPeriod","getFreeTrialText","freeDays","orderTitle","orderInfo","orderTitleMargin","orderBillingDate","orderPrice","couponForm","redeemCoupon","couponInput","orderTotals","couponCell","divider","NoPaymentRequired","noPaymentRequired","PaymentForm","onPaymentFormSubmit","parent","formError","AdyenInitialPayment","setUpdatingOrder","getCaptchaValue","useRecaptcha","executeAsync","Checkout","adyenUpdating","setAdyenUpdating","setCouponFormOpen","showCouponCodeSuccess","setShowCouponCodeSuccess","chooseOfferUrl","welcomeUrl","closeModalUrl","backButtonClickHandler","mutateAsync","successUrlPaypal","isStripePayment","isAdyenPayment","isPayPalPayment","useOffers","isInitialisationLoading","useQuery","queryKey","queryFn","hasMediaOffers","hasSubscriptionOffers","hasPremierOffers","mediaOffer","hasMultipleOfferTypes","defaultOfferType","SvgCheckCircle","OfferBox","selected","renderListItem","renderOption","periodString","secondBenefit","offerDivider","offerBenefits","CheckCircle","isMonthly","durationPeriod","durationAmount","ChooseOfferForm","showOfferTypeSwitch","onBackButtonClickHandler","selectedOfferType","selectedOfferId","subtitle","offerGroupSwitch","offerGroupLabel","ChooseOffer","isSwitch","isPendingOffer","checkoutUrl","upgradePendingUrl","upgradeSuccessUrl","upgradeErrorUrl","visibleOffers","Select","defaultLabel","optionsStyle","select","option","Dropdown","lang","Checkbox","checkboxLabel","fieldClassName","checkbox","row","Radio","optionValue","optionLabel","parseDateString","dateString","isNaN","padLeft","clamp","parseBlurValue","parsed","parseInputValue","DateField","onFocus","parsedDate","getDate","getMonth","getFullYear","hiddenInputRef","dateFieldClassName","dateField","handleFocus","currentTarget","handleKeyDown","previousElementSibling","triggerChangeEvent","nativeInputValueSetter","getOwnPropertyDescriptor","newValue","inputEvent","Event","bubbles","dispatchEvent","nextSibling","nextElementSibling","hiddenInput","PersonalDetailsForm","fields","questions","onQuestionChange","questionValues","questionErrors","renderQuestion","question","firstNameLastName","companyName","address","address2","city","postCode","phoneNumber","birthDate","continue","yupConditional","PersonalDetails","setQuestionValues","setQuestionErrors","nextStep","hasOffers","questionChangeHandler","submitHandler","requiredMessage","address1","removeEmpty","customAnswers","questionId","useSocialLoginUrls","urls","CustomRegisterField","optionsList","getResourceBundle","linkClassName","RouterLink","RegistrationForm","consentValues","onConsentChange","consentErrors","htmlLang","formatConsentLabel","sanitizedLabel","DOMPurify","sanitize","hasHrefOpenTag","hasHrefCloseTag","__html","scrollIntoView","behavior","block","customFields","consentError","Registration","setConsentValues","setConsentErrors","handleChangeConsent","socialLoginURLs","LoginForm","Login","PUBLIC_VIEWS","AccountModal","viewParam","viewParamRef","isPublicView","toLogin","view","renderForm","EditPassword","shouldShowBanner","dialogSize","testConfigs","jwpAuth","jwpSvod","jwpAuthNoWatchlist","basicNoAuth","noStyling","inlinePlayer","cleengAuthvod","cleengAuthvodNoWatchlist","svod","configs","applicationController","useBootstrapApp","onReady","useQueryClient","invalidateQueries","isSuccess","refetch","refetchInterval","cacheTime","setThemingVariables","root","bodyFont","bodyAltFont","setProperty","bodyColor","ConfirmationDialog","RootErrorPage","useRouteError","renderer","marked","Renderer","externalLink","targetAttr","relAttr","titleAttr","attributes","inlineRenderer","gfm","MarkdownComponent","markdownString","sanitizedHTMLString","dirtyHTMLString","parseInline","ADD_ATTR","dangerouslySetInnerHTML","markdown","About","about","placeholderData","getPlaylistQueryOptions","usePlaceholderData","setQueryData","usePlaylist","queryOptions","isPlaylistType","pType","usePlaylists","rowsToLoad","playlistQueries","useQueries","isPlaceholderData","useTranslationKey","SvgChevronLeft","SvgChevronRight","addMediaQueryListChangeListener","mediaQuery","addListener","removeMediaQueryListChangeListener","removeListener","XS_MATCH_MEDIA","matchMedia","SM_MATCH_MEDIA","MD_MATCH_MEDIA","LG_MATCH_MEDIA","Breakpoint","xs","sm","md","lg","xl","getScreenSize","useBreakpoint","breakpoint","setBreakpoint","changeEventHandler","SvgLock","SvgToday","setWidth","Map","resolveImageURL","imgUrl","requestUrl","has","redirected","Image","onLoad","alt","setSrc","resolvedImage","Image$1","memo","CardIdentifier","Card","onHover","isCurrent","currentLabel","headingLevel","tabIndex","cardClassName","aspectRatioClass","posterClassNames","poster","isSeriesItem","isLive","isScheduled","renderTag","Today","scheduled","titleContainer","posterImage","meta","lock","Lock","progressContainer","progressBar","tileBreakpoints","featuredTileBreakpoints","ShelfIdentifier","Shelf","onCardHover","visibleTilesDelta","tilesToShow","renderTile","isVisible","renderRightControl","chevron","ChevronRight","renderLeftControl","ChevronLeft","renderPagination","pages","pageIndex","dots","dot","shelf","loadingTitle","TileSlider","slider","CYCLE_MODE_RESTART","Shelf$1","InfiniteScrollLoader","infiniteScrollLoader","Fade","willChange","useScrolledDown","end","handleScroll","scrollPosition","scrollingElement","documentElement","listenerElement","passive","TruncatedText","maximumLines","truncatedText","maxHeight","WebkitLineClamp","lineClamp","display","notifyOnChangeProps","useEntitlement","isPreEntitled","mediaEntitlementQueries","refetchOnMount","isMediaEntitled","isMediaEntitlementLoading","isEntitled","SvgPlay","StartWatchingButton","playUrl","startWatchingLabel","handleStartWatchingClick","Play","progressRail","HeroShelfMetadata","isMobile","isWatchable","showStartWatchingButton","visibility","HeroShelfBackground","onTransitionEnd","HeroShelfBackground$1","calculateDotSize","itemIndex","range","sizeSmall","isAnimatingLeft","isAnimatingRight","dotPosition","semiEdgeLeft","edgeLeft","newDotLeft","semiEdgeRight","edgeRight","newDotRight","HeroShelfPagination","indexIn","nextIndex","nextIndexIn","setIndex","animationDuration","placeholderCount","playlistWithPlaceholders","placeholders","dotsList","dotPlaceholder","movementTotal","abs","transformDiv","transitionDiv","ariaLabel","dotActive","HeroSwipeSlider","hasLeftItem","hasRightItem","renderItem","renderLeftItem","renderRightItem","isSwipeAnimation","onSwipeLeft","onSwipeRight","movementRef","x","y","containerRef","swipeAction","setSwipeAction","handleTouchStart","touches","clientX","clientY","handleTouchMove","movementX","changedTouches","movementY","currentSwipeAction","stopPropagation","maxLeft","innerWidth","maxRight","limitedMovementX","handleTouchEnd","velocity","velocityTreshold","swipeSlider","swipeSliderMobile","HeroShelf","setNextIndex","posterRef","setDirection","animationPhase","setAnimationPhase","setIsSwipeAnimation","slideTo","toIndex","isSwiping","handleSlideLeft","handleSlideRight","handleSwipeLeft","handleSwipeRight","handleBackgroundAnimationEnd","propertyName","isAnimating","directionFactor","getBackgroundStyle","side","backgroundX","getMetadataStyle","pointerEvents","leftItem","rightItem","renderedItem","background","fade","fade2","chevronLeft","chevronRight","INITIAL_ROWS_TO_LOAD","ROWS_TO_LOAD_STEP","ShelfList","setRowsToLoad","translationKey","watchHistoryDictionary","playlists","shelfList","InfiniteScroll","shelfImageAspectRatio","translatedTitle","isHero","layoutType","isFeatured","shelfContainer","Home","useUIStore","searchQuery","searchActive","userMenuOpen","sideBarOpen","languageMenuOpen","useFirstRender","firstRenderRef","useDebounce","time","debounceRef","useSearchQueryUpdater","updateSearchPath","encodeURIComponent","updateSearchQuery","resetSearchQuery","returnPage","preSearchPage","useAppContentSearch","appContentSearchQuery","useSearch","hasAppContentSearch","appContentSearch","playlistQuery","isFetching","scrollIntoViewThrottled","focusedElement","LayoutGrid","columnCount","renderCell","getCellKey","currentRowIndex","setCurrentRowIndex","currentColumnIndex","setCurrentColumnIndex","gridRef","rowCount","focusGridCell","rowIndex","columnIndex","gridCell","getElementById","elementToFocus","preventScroll","ctrlKey","maxRow","isOnFirstColumn","isOnLastColumn","isOnFirstRow","isOnLastRow","maxRightLastRow","nextRowIndex","previousRowIndex","gridCellStyle","cell","INITIAL_ROW_COUNT","LOAD_ROWS_COUNT","defaultCols","CardGridIdentifier","CardGrid","cols","currentCardItem","currentCardLabel","hasMore","getUrl","loadMore","visibleTiles","setRowCount","defaultLoadMore","defaultHasMore","CardGrid$1","Search","headingId","firstRender","useParams","getURL","subHeading","Helmet","header","SvgAccountCircle","SvgBalanceWallet","SvgExit","SvgFavorite","Alert","actionsOverride","titleOverride","FormSection","panelHeaderClassName","editButton","saveButton","sectionId","formState","activeSectionId","formErrors","isBusy","setFormState","FormContext","isEditing","oldState","arr","onEdit","flexBox","controls","Form","isDirty","i","Account","panelClassName","exportData","isAlertVisible","setIsAlertVisible","exportDataMessage","registerSource","register_source","isSocialLogin","shouldAddPassword","has_password","termsConsents","nonTermsConsents","nonTerms","confirmationPassword","translateErrors","flatMap","formSection","editPasswordClickHandler","section","textWithButtonContainer","Trans","onClearFavoritesClick","useSubscriptionChange","isUpgradeOffer","activeSubscriptionId","updateSubscriptionMetadata","SvgExternalLink","OfferSwitch","isCurrentOffer","pendingDowngradeOfferId","isPendingDowngrade","offerSwitchContainer","activeOfferSwitchContainer","offerSwitchInfoContainer","currentPlanHeading","activeCurrentPlanHeading","toUpperCase","offerSwitchPlanContainer","nextBillingDate","paymentFrequency","VISIBLE_TRANSACTIONS","activePaymentDetail","onShowAllTransactionsClick","showAllTransactions","onShowReceiptClick","onUpgradeSubscriptionClick","offerSwitchesAvailable","changeSubscriptionPlan","onChangePlanClick","setSelectedOfferId","setIsUpgradeOffer","isExternalPaymentProvider","paymentProvider","paymentProviderLink","subscriptionDetailsId","billingHistoryId","hiddenTransactionsCount","hasMoreTransactions","isGrantedSubscription","isChangingOffer","setIsChangingOffer","onCompleteSubscriptionClick","onEditCardDetailsClick","onCancelSubscriptionClick","onRenewSubscriptionClick","getTitle","showChangeSubscriptionButton","pendingSwitch","explanation","upgradeSubscription","changePlanContainer","o","changePlanButtons","changePlanCancelButton","paypal","cardDetails","editCard","transactionItem","transactionDetails","transactionPrice","parseFloat","ExternalLink","processBillingReceipt","receipt","Blob","URL","createObjectURL","setAttribute","click","newWindow","htmlString","opener","write","EXTERNAL_PAYMENT_METHODS","STORE_LINKS","apple","google","roku","PaymentContainer","setShowAllTransactions","isLoadingReceipt","setIsLoadingReceipt","handleUpgradeSubscriptionClick","handleShowReceiptClick","panel","panelHeader","User","clearFavoritesOpen","setClearFavoritesOpen","isLargeScreen","onLogout","leftColumn","AccountCircle","Favorite","BalanceWallet","logoutLi","Exit","mainColumn","Routes","Route","AccountComponent","Navigate","createVideoMetadata","metaData","episodesLabel","createPlaylistMetadata","createLiveEventMetadata","useMedia","SvgPlayTrailer","Filter","forceDropdown","showFilterRow","filterRow","filterDropDown","dropDown","Hero","posterFade","HeroTitle","CollapsibleText","divRef","doesFlowOver","setDoesFlowOver","expanded","setExpanded","clippablePixels","scrollHeight","offsetHeight","collapsibleText","textContainer","collapsed","HeroDescription","VideoDetails","primaryMetadata","secondaryMetadata","startWatchingButton","shareButton","favoriteButton","trailerButton","videoDetails","metaContainer","buttonBar","VideoDetailsInline","TitleComponent","inlinePlayerMetadata","VideoListItem","activeLabel","imageLoaded","setImageLoaded","posterImageClassNames","listItem","VideoList","onListItemHover","activeMediaId","VideoLayout","inlineLayout","relatedTitle","filters","setFilter","filterMetadata","currentFilter","defaultFilterLabel","isTablet","hasFilters","showFilters","renderFilters","filtersInline","renderRelatedVideos","grid","relatedVideosGrid","relatedVideosGridTitle","relatedVideosList","relatedVideosListHeader","relatedVideosListTitle","videoInlineLayout","videoDetailsInline","relatedVideos","PROGRESSIVE_SAVE_INTERVAL","useWatchHistoryListener","queuedWatchProgress","watchHistoryEnabled","maybeSaveWatchProgress","handleTimeUpdate","toFixed","isFinite","timestamp","on","off","visibilityListener","visibilityState","useWatchHistory","usePlaylistItemCallback","startDateTime","endDateTime","applyLiveStreamOffset","timeParam","allSources","useLegacyStandaloneAds","adScheduleId","useAds","adConfigId","useAdConfigFlow","isAdScheduleLoading","client","useContentProtection","genericEntitlementService","jwpEntitlementService","signingConfig","urlSigning","isAccessBridgeEnabled","signingEnabled","keepPreviousData","queryResult","useProtectedMedia","contentProtectionQuery","isGeoBlocked","m3u8","isFetched","isVODManifestType","sourceUrl","extensions","ext","isBCLManifestType","getSources","userId","hasServerAds","isBCLManifest","isVODManifest","isDRM","attachPassportToSourceWithDRM","updateUrl","urlString","playready","widevine","fairplay","processSpcUrl","useMediaSources","Player","adsData","onPlay","onPause","onComplete","onUserActive","onUserInActive","onBeforePlay","onFirstFrame","onRemove","onPlaylistItem","onPlaylistItemCallback","onNext","onBackClick","feedId","autostart","playerElementRef","playerRef","loadingRef","backClickRef","libLoaded","setLibLoaded","jwplayer","startTimeRef","handleBeforePlay","handlePlay","handlePause","handleComplete","handleUserActive","handleUserInactive","handleFirstFrame","playerContainer","getContainer","playPauseButton","handleRemove","handlePlaylistItem","handlePlaylistItemCallback","handleNextClick","handleBackClick","handleReady","attachEvents","setPlaylistItemCallback","detachEvents","scriptUrl","loadPlaylist","currentItem","getPlaylistItem","load","starttime","initializePlayer","playerOptions","advertising","showCountdown","timeSlider","showAdMarkers","aspectratio","displaytitle","displayHeading","displaydescription","floating","mode","mute","playbackRateControls","pipIcon","repeat","stretching","PlayerErrorState","GEO_BLOCKED","PlayerError","PlayerContainer","liveEndDateTime","liveFromBeginning","liveStartDateTime","isAdsLoading","playableItem","playerInstance","setPlayerInstance","seek","InlinePlayer","playable","loginButtonClickHandler","buyLabel","paywall","Cinema","isPlaying","setIsPlaying","overlayHasFocus","setOverlayHasFocus","userActive","setUserActive","handleNext","cinemaContainer","cinema","overlayFade","playerOverlay","playerContent","backButton","TrailerModal","SvgCheck","SvgShare","copyToClipboard","inputElement","execCommand","blur","ShareButton","hasShared","setHasShared","onShareClick","navigator","share","Check","Share","SvgFavoriteBorder","FavoriteButton","isFavorite","onFavoriteButtonClick","FavoriteBorder","Loading","VideoMetaData","secondsToISO8601","timeOnly","getUTCHours","getUTCMinutes","getUTCSeconds","isoString","is12HourClock","toLocaleTimeString","getFiltersFromSeries","sort","filterSeries","getNextItem","seriesPlaylist","findIndex","getEpisodesInSeason","generateLegacySeriesMetadata","numberOfEpisodes","numberOfSeasons","generateLegacyEpisodeJSONLD","episodeMetadata","episodeCanonical","seriesMetadata","uploadDate","partOfSeries","LegacySeries","playTrailer","setPlayTrailer","isSeriesPlaylistLoading","isPlaylistError","isEpisodeLoading","isTrailerLoading","trailerItem","selectedItem","selectedItemImage","isFavoritesEnabled","seasonFilter","setSeasonFilter","firstEpisode","filteredPlaylist","episodesInSeason","nextItem","goBack","toEpisode","scroll","pageTitle","pageDescription","canonicalUrl","PlayTrailer","ScreenMap","defaultScreen","definitions","predicate","registerByContentType","registerDefault","getScreen","screen","MediaStaticPage","mediaStaticPage","generateMovieJSONLD","movieCanonical","thumbnailUrl","generateSeriesMetadata","generateEpisodeJSONLD","MediaMovie","isPlaylistLoading","useSeries","failureCount","getNextPageParam","useEpisodes","fetchNextPage","hasNextPage","useInfiniteQuery","pageParam","lastPage","useSeriesLookup","firstSeries","useNextEpisode","useFirstEpisode","MediaSeries","seriesMedia","setSearchParams","isSeriesDataLoading","seriesError","isSeriesDictionaryLoading","episodeInSeries","isFirstEpisodeLoading","fetchNextEpisodes","hasNextEpisodesPage","watchHistoryArray","episodeInProgress","handleInlinePlay","playEpisode","MediaLiveChannel","liveChannelsId","MediaEpisode","isMediaLoading","isSeriesIdLoading","isSeriesMediaLoading","useLiveEvent","Tag","StatusIcon","MediaEvent","mediaScreenMap","MediaScreenRouter","MediaScreen","PlaylistGrid","categories","shouldShowFilter","programIsLive","isPast","isFuture","programIsVod","programIsFullyWatchable","liveStreamCatchupHours","maxStartTime","subHours","isAfter","getLiveProgram","useLiveChannels","initialChannelId","enableAutoUpdate","epgController","channels","autoUpdate","setAutoUpdate","setChannel","setProgram","intervalId","selectedChannel","updatedChannel","updatedProgram","setActiveChannel","programId","useLiveProgram","setIsLive","isVod","setIsVod","isWatchableFromBeginning","setIsWatchableFromBeginning","calculateStatus","isBaseTimeFormat","formatChannel","formatProgram","channelUuid","till","since","usePlanByEpg","sidebarWidth","itemHeight","epgChannels","epgPrograms","theme","makeTheme","startOfToday","endDate","startOfDay","startOfTomorrow","useEpg","epg","dayWidth","isSidebar","isTimeline","isLine","primary","grey","white","green","loader","teal","purple","pink","bg","scrollbar","border","thumb","gradient","blue","timeline","EpgChannelItem","channelItemWidth","epgChannelBox","epgChannel","epgChannelLogo","ProgramItem","compact","formatTime","set12HoursTimeFormat","isMinWidth","useProgram","sinceTime","tillTime","showImage","showLiveTagInImage","epgProgramBox","epgProgram","epgProgramImage","epgLiveTag","epgProgramContent","epgProgramTitle","epgProgramText","EpgTimeline","hourWidth","numberOfHoursInDay","offsetStartHoursRange","dividers","useTimeline","renderDividers","timelineDivider","renderTime","timelineBox","timelineTime","timelineDividers","timelineContainer","Epg","onChannelClick","onProgramClick","getEpgProps","getLayoutProps","onScrollToNow","onScrollLeft","onScrollRight","catchupHoursDict","titlesDict","firstFrame","timelineControl","timelineNowButton","EpgContainer","epgSpinner","Layout","toChannel","programItem","isBefore","EpgProgramItem","PlaylistLiveChannels","channelMediaItem","canWatch","canWatchFromBeginning","durationInSeconds","differenceInSeconds","handleProgramClick","handleChannelClick","catchupButton","beginning","epgContainer","playlistScreenMap","contentScreenMap","PlaylistScreenRouter","Screen","HeaderIdentifier","Header","headerType","headerClassName","Header$1","Footer","chunks","chuck","footerContent","wrapper","footer","testFixMargin","SvgMenu","HeaderMenu","Menu","scrollOffset","HeaderNavigation","navItems","navRef","focusHandler","navRect","getBoundingClientRect","targetScrollTo","scrollLeft","scrollTo","nav","navButton","Logo","imgDimensions","updateImgDimensions","onLoadHandler","HeaderBrand","logoSrc","setLogoLoaded","brand","HeaderActions","actions","HeaderSkipLink","skipToContent","SidebarIdentifier","SlideLeft","Sidebar","isOpen","sidebar","group","Sidebar$1","MenuButtonIdentifier","MenuButton","getClassName","menuButton","MenuButton$1","UserMenuNav","showPaymentItems","onButtonClick","favoritesEnabled","focusable","titleId","sectionHeader","menuItems","SidebarUserActions","canLogin","onLoginClick","onSignUpClick","userMenuTitleId","buttonContainer","SidebarContainer","closeSideBar","signUpButtonClickHandler","SiteMetadata","metaDescription","SvgSearch","SvgCancel","SearchBar","onQueryChange","onClearButtonClick","searchBar","searchForm","clearButton","Cancel","HeaderActionButton","HeaderSearch","searchInputRef","searchEnabled","closeSearchButtonClickHandler","searchButtonClickHandler","searchContainer","CloseIcon","SearchIcon","SvgLanguage","Panel","DetectOutsideClick","elementRef","handleClick","Node","cloneElement","Popover","popover","LanguageMenu","currentLanguage","closeLanguageMenu","openLanguageMenu","handleLanguageSelect","handleMenuToggle","Language","menuItemClassname","menuItemActive","HeaderLanguageSwitcher","watchlistController","languageClickHandler","changeLanguage","UserMenu","onLoginButtonClick","onSignUpButtonClick","HeaderUserMenu","openUserPanel","closeUserPanel","configFooterText","openSideBar","containerProps","inert","layout","Outlet","useNotifications","navigateToModal","notification","NotificationsTypes","resource","redirect_to_url","RoutesContainer","userData","hash","AppRoutes","parsePlaylistIds","MediaHub","registerCustomScreens","useTrackConfigKeyChange","IS_DEMO_OR_PREVIEW","BootstrapError","DemoContentLoader","RootLoader","Root","isReady","setIsReady","onReadyCallback","App","i18nState","seti18nState","BrowserRouter","attachAccessibilityListener","isTabbing","rootElement","createRoot","render","refresh"],"ignoreList":[],"sources":["../../../../../../../../@vite-plugin-pwa/virtual:pwa-register","../../../../../packages/common/src/env.ts","../../../../../packages/common/src/constants.ts","../../../../../packages/common/src/modules/container.ts","../../../../../packages/common/src/modules/types.ts","../../../../../packages/common/src/utils/common.ts","../../../../../packages/common/src/utils/liveEvent.ts","../../../../../packages/common/src/paths.tsx","../../../../../packages/common/src/services/logging/LogLevel.ts","../../../../../packages/common/src/services/logging/LogTransporter.ts","../../../../../packages/common/src/logger.ts","../../../../../packages/common/src/utils/media.ts","../../../../../packages/common/src/utils/urlFormatting.ts","../../../../../packages/common/src/utils/api.ts","../../../../../packages/common/src/utils/entitlements.ts","../../../../../packages/common/src/stores/utils.ts","../../../../../packages/common/src/stores/ConfigStore.ts","../../../../../packages/common/src/services/ApiService.ts","../../../../../packages/common/src/services/StorageService.ts","../../../../../packages/common/src/services/integrations/AccountService.ts","../../../../../packages/common/src/services/WatchHistoryService.ts","../../../../../packages/common/src/services/GenericEntitlementService.ts","../../../../../packages/common/src/services/integrations/jwp/JWPAPIService.ts","../../../../../packages/common/src/services/JWPEntitlementService.ts","../../../../../packages/common/src/services/FavoriteService.ts","../../../../../packages/common/src/utils/configSchema.ts","../../../../../packages/common/src/utils/error.ts","../../../../../packages/common/src/services/ConfigService.ts","../../../../../packages/common/src/services/SettingsService.ts","../../../../../packages/common/src/stores/AccountStore.ts","../../../../../packages/common/src/stores/WatchHistoryStore.ts","../../../../../packages/common/src/controllers/WatchHistoryController.ts","../../../../../packages/common/src/services/integrations/CheckoutService.ts","../../../../../packages/common/src/services/integrations/SubscriptionService.ts","../../../../../packages/common/src/stores/CheckoutStore.ts","../../../../../packages/common/src/errors/FormValidationError.ts","../../../../../packages/common/src/utils/subscription.ts","../../../../../packages/common/src/utils/payments.ts","../../../../../packages/common/src/controllers/CheckoutController.ts","../../../../../packages/common/src/stores/FavoritesStore.ts","../../../../../packages/common/src/controllers/FavoritesController.ts","../../../../../packages/common/src/services/AccessService.ts","../../../../../packages/common/src/stores/AccessStore.ts","../../../../../packages/common/src/controllers/AccessController.ts","../../../../../packages/common/src/controllers/AccountController.ts","../../../../../packages/common/src/controllers/AppController.ts","../../../../../packages/common/src/services/EpgService.ts","../../../../../packages/common/src/controllers/EpgController.ts","../../../../../packages/common/src/services/epg/ViewNexaEpgService.ts","../../../../../packages/common/src/services/epg/JWEpgService.ts","../../../../../packages/common/src/modules/functions/getApiAccessBridgeUrl.ts","../../../../../packages/common/src/utils/promiseQueue.ts","../../../../../packages/common/src/services/integrations/cleeng/CleengService.ts","../../../../../packages/common/src/services/integrations/cleeng/formatters/customer.ts","../../../../../packages/common/src/services/integrations/cleeng/formatters/consents.ts","../../../../../packages/common/src/services/integrations/cleeng/CleengAccountService.ts","../../../../../packages/common/src/services/integrations/cleeng/CleengCheckoutService.ts","../../../../../packages/common/src/services/integrations/cleeng/CleengSubscriptionService.ts","../../../../../packages/common/src/utils/collection.ts","../../../../../packages/common/src/services/integrations/jwp/JWPAccountService.ts","../../../../../packages/common/src/utils/formatting.ts","../../../../../packages/common/src/utils/offers.ts","../../../../../packages/common/src/services/integrations/jwp/JWPCheckoutService.ts","../../../../../packages/common/src/services/integrations/jwp/JWPSubscriptionService.ts","../../../../../packages/common/src/modules/functions/getIntegrationType.ts","../../../../../packages/common/src/modules/functions/calculateIntegrationType.ts","../../../../../packages/common/src/services/integrations/axinom/apollo-client.ts","../../../../../packages/common/src/services/integrations/axinom/types/catalog-service-auto-generated.ts","../../../../../packages/common/src/services/integrations/axinom/AxinomApiService.ts","../../../../../packages/common/src/services/integrations/axinom/AxinomConfigService.ts","../../../../../packages/common/src/modules/register.ts","../../../../../packages/common/src/services/logging/ConsoleTransporter.ts","../../../src/services/LocalStorageService.ts","../../../src/modules/register.ts","../../../../../packages/ui-react/src/containers/QueryProvider/QueryProvider.tsx","../../../../../packages/ui-react/src/components/ErrorPage/ErrorPage.tsx","../../../../../packages/ui-react/src/components/Spinner/Spinner.tsx","../../../../../packages/ui-react/src/components/LoadingOverlay/LoadingOverlay.tsx","../../../../../packages/ui-react/src/components/FormFeedback/FormFeedback.tsx","../../../../../packages/ui-react/src/containers/AnnouncementProvider/AnnoucementProvider.tsx","../../../../../packages/common/src/utils/i18n.ts","../../../src/i18n/resources.ts","../../../src/i18n/config.ts","../../../../../packages/ui-react/src/utils/location.ts","../../../../../packages/hooks-react/src/useEventCallback.ts","../../../../../packages/ui-react/src/hooks/useQueryParam.ts","../../../../../packages/hooks-react/src/useCountdown.ts","../../../../../packages/ui-react/src/modules/container.ts","../../../../../packages/ui-react/src/modules/createInjectableComponent.tsx","../../../../../packages/ui-react/src/components/Button/Button.tsx","../../../../../packages/ui-react/src/components/Welcome/Welcome.tsx","../../../../../packages/ui-react/src/components/PaymentFailed/PaymentFailed.tsx","../../../../../packages/ui-react/src/components/Animation/Animation.tsx","../../../../../packages/ui-react/src/components/Animation/Grow/Grow.tsx","../../../../../packages/ui-react/src/utils/dom.ts","../../../../../packages/ui-react/src/hooks/useModal.ts","../../../../../packages/ui-react/src/components/Modal/Modal.tsx","../../../../../packages/ui-react/src/components/Animation/Slide/Slide.tsx","../../../../../packages/theme/assets/icons/close.svg?react","../../../../../packages/ui-react/src/components/IconButton/IconButton.tsx","../../../../../packages/ui-react/src/components/Icon/Icon.tsx","../../../../../packages/ui-react/src/components/ModalCloseButton/ModalCloseButton.tsx","../../../../../packages/ui-react/src/components/Dialog/Dialog.tsx","../../../../../packages/hooks-react/src/useForm.ts","../../../../../packages/hooks-react/src/useToggle.ts","../../../../../packages/theme/assets/icons/visibility.svg?react","../../../../../packages/theme/assets/icons/visibility_off.svg?react","../../../../../packages/hooks-react/src/useOpaqueId.ts","../../../../../packages/ui-react/src/components/HelperText/HelperText.tsx","../../../../../packages/ui-react/src/components/FormField/FormField.tsx","../../../../../packages/ui-react/src/components/Input/Input.tsx","../../../../../packages/ui-react/src/components/form-fields/TextField/TextField.tsx","../../../../../packages/ui-react/src/components/PasswordStrength/PasswordStrength.tsx","../../../../../packages/ui-react/src/components/form-fields/PasswordField/PasswordField.tsx","../../../../../packages/ui-react/src/components/DeleteAccountModal/DeleteAccountModal.tsx","../../../../../packages/ui-react/src/components/FinalizePayment/FinalizePayment.tsx","../../../../../packages/hooks-react/src/useCheckAccess.ts","../../../../../packages/ui-react/src/components/WaitingForPayment/WaitingForPayment.tsx","../../../../../packages/ui-react/src/components/UpgradeSubscription/UpgradeSubscription.tsx","../../../../../packages/ui-react/src/components/DeleteAccountPasswordWarning/DeleteAccountPasswordWarning.tsx","../../../../../packages/theme/assets/icons/creditcard.svg?react","../../../../../packages/theme/assets/icons/paypal.svg?react","../../../../../packages/ui-react/src/components/PaymentMethodForm/PaymentMethodForm.tsx","../../../../../packages/ui-react/src/components/PayPal/PayPal.tsx","../../../../../packages/ui-react/src/components/Adyen/Adyen.tsx","../../../../../packages/ui-react/src/containers/AdyenPaymentDetails/AdyenPaymentDetails.tsx","../../../../../packages/ui-react/src/containers/UpdatePaymentMethod/UpdatePaymentMethod.tsx","../../../../../packages/ui-react/src/components/EditForm/EditCardDetailsForm.tsx","../../../../../packages/ui-react/src/components/form-fields/CreditCardCVCField/CreditCardCVCField.tsx","../../../../../packages/ui-react/src/components/form-fields/CreditCardExpiryField/CreditCardExpiryField.tsx","../../../../../packages/ui-react/src/components/form-fields/CreditCardNumberField/CreditCardNumberField.tsx","../../../../../packages/ui-react/src/components/EditCardPaymentForm/EditCardPaymentForm.tsx","../../../../../packages/ui-react/src/containers/AccountModal/forms/EditCardDetails.tsx","../../../../../packages/ui-react/src/components/EditPasswordForm/EditPasswordForm.tsx","../../../../../packages/ui-react/src/containers/AccountModal/forms/EditPassword.tsx","../../../../../packages/ui-react/src/components/RenewSubscriptionForm/RenewSubscriptionForm.tsx","../../../../../packages/ui-react/src/components/SubscriptionRenewed/SubscriptionRenewed.tsx","../../../../../packages/ui-react/src/containers/AccountModal/forms/RenewSubscription.tsx","../../../../../packages/ui-react/src/components/CancelSubscriptionForm/CancelSubscriptionForm.tsx","../../../../../packages/ui-react/src/components/SubscriptionCancelled/SubscriptionCancelled.tsx","../../../../../packages/ui-react/src/containers/AccountModal/forms/CancelSubscription.tsx","../../../../../packages/ui-react/src/components/ResetPasswordForm/ResetPasswordForm.tsx","../../../../../packages/ui-react/src/components/ForgotPasswordForm/ForgotPasswordForm.tsx","../../../../../packages/ui-react/src/components/ConfirmationForm/ConfirmationForm.tsx","../../../../../packages/ui-react/src/containers/AccountModal/forms/ResetPassword.tsx","../../../../../packages/hooks-react/src/useCheckout.ts","../../../../../packages/theme/assets/icons/arrow_left.svg?react","../../../../../packages/ui-react/src/components/DialogBackButton/DialogBackButton.tsx","../../../../../packages/ui-react/src/components/RecaptchaField/RecaptchaField.tsx","../../../../../packages/ui-react/src/components/CheckoutForm/CheckoutForm.tsx","../../../../../packages/ui-react/src/components/NoPaymentRequired/NoPaymentRequired.tsx","../../../../../packages/ui-react/src/components/PaymentForm/PaymentForm.tsx","../../../../../packages/ui-react/src/containers/AdyenInitialPayment/AdyenInitialPayment.tsx","../../../../../packages/ui-react/src/hooks/useRecaptcha.ts","../../../../../packages/ui-react/src/containers/AccountModal/forms/Checkout.tsx","../../../../../packages/hooks-react/src/useOffers.ts","../../../../../packages/theme/assets/icons/check_circle.svg?react","../../../../../packages/ui-react/src/components/ChooseOfferForm/ChooseOfferForm.tsx","../../../../../packages/ui-react/src/containers/AccountModal/forms/ChooseOffer.tsx","../../../../../packages/ui-react/src/components/Select/Select.tsx","../../../../../packages/ui-react/src/components/form-fields/Dropdown/Dropdown.tsx","../../../../../packages/ui-react/src/components/form-fields/Checkbox/Checkbox.tsx","../../../../../packages/ui-react/src/components/form-fields/Radio/Radio.tsx","../../../../../packages/ui-react/src/components/form-fields/DateField/DateField.tsx","../../../../../packages/ui-react/src/components/PersonalDetailsForm/PersonalDetailsForm.tsx","../../../../../packages/ui-react/src/containers/AccountModal/forms/PersonalDetails.tsx","../../../../../packages/hooks-react/src/useSocialLoginUrls.ts","../../../../../packages/ui-react/src/components/CustomRegisterField/CustomRegisterField.tsx","../../../../../packages/ui-react/src/components/Link/Link.tsx","../../../../../packages/ui-react/src/components/RegistrationForm/RegistrationForm.tsx","../../../../../packages/ui-react/src/containers/AccountModal/forms/Registration.tsx","../../../../../packages/ui-react/src/components/LoginForm/LoginForm.tsx","../../../../../packages/ui-react/src/containers/AccountModal/forms/Login.tsx","../../../../../packages/ui-react/src/containers/AccountModal/AccountModal.tsx","../../../../../packages/testing/constants.ts","../../../../../packages/ui-react/src/components/DevConfigSelector/DevConfigSelector.tsx","../../../../../packages/hooks-react/src/useBootstrapApp.ts","../../../../../packages/ui-react/src/utils/theming.ts","../../../../../packages/ui-react/src/components/ConfirmationDialog/ConfirmationDialog.tsx","../../../../../packages/ui-react/src/components/RootErrorPage/RootErrorPage.tsx","../../../../../packages/ui-react/src/components/MarkdownComponent/MarkdownComponent.tsx","../../../../../packages/ui-react/src/pages/About/About.tsx","../../../../../packages/hooks-react/src/usePlaylist.ts","../../../../../packages/hooks-react/src/usePlaylists.ts","../../../../../packages/hooks-react/src/useTranslationKey.ts","../../../../../packages/theme/assets/icons/chevron_left.svg?react","../../../../../packages/theme/assets/icons/chevron_right.svg?react","../../../../../packages/ui-react/src/utils/matchMedia.ts","../../../../../packages/ui-react/src/hooks/useBreakpoint.ts","../../../../../packages/theme/assets/icons/lock.svg?react","../../../../../packages/theme/assets/icons/today.svg?react","../../../../../packages/ui-react/src/components/Image/Image.tsx","../../../../../packages/ui-react/src/components/Card/Card.tsx","../../../../../packages/ui-react/src/components/Shelf/Shelf.tsx","../../../../../packages/ui-react/src/components/InfiniteScrollLoader/InfiniteScrollLoader.tsx","../../../../../packages/ui-react/src/components/Animation/Fade/Fade.tsx","../../../../../packages/ui-react/src/hooks/useScrolledDown.ts","../../../../../packages/ui-react/src/components/TruncatedText/TruncatedText.tsx","../../../../../packages/hooks-react/src/useEntitlement.ts","../../../../../packages/theme/assets/icons/play.svg?react","../../../../../packages/ui-react/src/containers/StartWatchingButton/StartWatchingButton.tsx","../../../../../packages/ui-react/src/components/HeroShelf/HeroShelfMetadata.tsx","../../../../../packages/ui-react/src/components/HeroShelf/HeroShelfBackground.tsx","../../../../../packages/ui-react/src/components/HeroShelf/HeroShelfPagination.tsx","../../../../../packages/ui-react/src/components/HeroShelf/HeroSwipeSlider.tsx","../../../../../packages/ui-react/src/components/HeroShelf/HeroShelf.tsx","../../../../../packages/ui-react/src/containers/ShelfList/ShelfList.tsx","../../../../../packages/ui-react/src/pages/Home/Home.tsx","../../../../../packages/common/src/stores/UIStore.ts","../../../../../packages/hooks-react/src/useFirstRender.ts","../../../../../packages/hooks-react/src/useDebounce.ts","../../../../../packages/ui-react/src/hooks/useSearchQueryUpdater.ts","../../../../../packages/hooks-react/src/useSearch.ts","../../../../../packages/ui-react/src/components/LayoutGrid/LayoutGrid.tsx","../../../../../packages/ui-react/src/components/CardGrid/CardGrid.tsx","../../../../../packages/ui-react/src/pages/Search/Search.tsx","../../../../../packages/theme/assets/icons/account_circle.svg?react","../../../../../packages/theme/assets/icons/balance_wallet.svg?react","../../../../../packages/theme/assets/icons/exit.svg?react","../../../../../packages/theme/assets/icons/favorite.svg?react","../../../../../packages/ui-react/src/components/Alert/Alert.tsx","../../../../../packages/ui-react/src/components/Form/FormSection.tsx","../../../../../packages/ui-react/src/components/Form/Form.tsx","../../../../../packages/ui-react/src/components/Account/Account.tsx","../../../../../packages/ui-react/src/components/Favorites/Favorites.tsx","../../../../../packages/hooks-react/src/useSubscriptionChange.ts","../../../../../packages/theme/assets/icons/external_link.svg?react","../../../../../packages/ui-react/src/components/OfferSwitch/OfferSwitch.tsx","../../../../../packages/ui-react/src/components/Payment/Payment.tsx","../../../../../packages/ui-react/src/containers/PaymentContainer/PaymentContainer.tsx","../../../../../packages/ui-react/src/pages/User/User.tsx","../../../../../packages/common/src/utils/metadata.ts","../../../../../packages/hooks-react/src/useMedia.ts","../../../../../packages/theme/assets/icons/play_trailer.svg?react","../../../../../packages/ui-react/src/components/Filter/Filter.tsx","../../../../../packages/ui-react/src/components/Hero/Hero.tsx","../../../../../packages/ui-react/src/components/Hero/HeroTitle.tsx","../../../../../packages/ui-react/src/components/CollapsibleText/CollapsibleText.tsx","../../../../../packages/ui-react/src/components/Hero/HeroDescription.tsx","../../../../../packages/ui-react/src/components/VideoDetails/VideoDetails.tsx","../../../../../packages/ui-react/src/components/VideoDetailsInline/VideoDetailsInline.tsx","../../../../../packages/ui-react/src/components/VideoListItem/VideoListItem.tsx","../../../../../packages/ui-react/src/components/VideoList/VideoList.tsx","../../../../../packages/ui-react/src/components/VideoLayout/VideoLayout.tsx","../../../../../packages/hooks-react/src/useWatchHistoryListener.ts","../../../../../packages/hooks-react/src/useWatchHistory.ts","../../../../../packages/hooks-react/src/usePlaylistItemCallback.ts","../../../../../packages/hooks-react/src/useAds.ts","../../../../../packages/hooks-react/src/useContentProtection.ts","../../../../../packages/hooks-react/src/useProtectedMedia.ts","../../../../../packages/common/src/utils/sources.ts","../../../../../packages/hooks-react/src/useMediaSources.ts","../../../../../packages/ui-react/src/components/Player/Player.tsx","../../../../../packages/ui-react/src/components/PlayerError/PlayerError.tsx","../../../../../packages/ui-react/src/containers/PlayerContainer/PlayerContainer.tsx","../../../../../packages/ui-react/src/containers/InlinePlayer/InlinePlayer.tsx","../../../../../packages/ui-react/src/containers/Cinema/Cinema.tsx","../../../../../packages/ui-react/src/containers/TrailerModal/TrailerModal.tsx","../../../../../packages/theme/assets/icons/check.svg?react","../../../../../packages/theme/assets/icons/share.svg?react","../../../../../packages/ui-react/src/utils/clipboard.ts","../../../../../packages/ui-react/src/components/ShareButton/ShareButton.tsx","../../../../../packages/theme/assets/icons/favorite_border.svg?react","../../../../../packages/ui-react/src/containers/FavoriteButton/FavoriteButton.tsx","../../../../../packages/ui-react/src/pages/Loading/Loading.tsx","../../../../../packages/ui-react/src/components/VideoMetaData/VideoMetaData.tsx","../../../../../packages/common/src/utils/datetime.ts","../../../../../packages/ui-react/src/pages/LegacySeries/utils.ts","../../../../../packages/ui-react/src/pages/LegacySeries/LegacySeries.tsx","../../../../../packages/common/src/utils/ScreenMap.ts","../../../../../packages/ui-react/src/pages/ScreenRouting/mediaScreens/MediaStaticPage/MediaStaticPage.tsx","../../../../../packages/common/src/utils/structuredData.ts","../../../../../packages/ui-react/src/pages/ScreenRouting/mediaScreens/MediaMovie/MediaMovie.tsx","../../../../../packages/common/src/utils/series.ts","../../../../../packages/hooks-react/src/series/useSeries.ts","../../../../../packages/hooks-react/src/series/useEpisodes.ts","../../../../../packages/hooks-react/src/series/useSeriesLookup.ts","../../../../../packages/hooks-react/src/series/useNextEpisode.ts","../../../../../packages/hooks-react/src/series/useFirstEpisode.ts","../../../../../packages/ui-react/src/pages/ScreenRouting/mediaScreens/MediaSeries/MediaSeries.tsx","../../../../../packages/ui-react/src/pages/ScreenRouting/mediaScreens/MediaLiveChannel/MediaLiveChannel.tsx","../../../../../packages/ui-react/src/pages/ScreenRouting/mediaScreens/MediaEpisode/MediaEpisode.tsx","../../../../../packages/hooks-react/src/useLiveEvent.ts","../../../../../packages/ui-react/src/components/Tag/Tag.tsx","../../../../../packages/ui-react/src/components/StatusIcon/StatusIcon.tsx","../../../../../packages/ui-react/src/pages/ScreenRouting/mediaScreens/MediaEvent/MediaEvent.tsx","../../../../../packages/ui-react/src/pages/ScreenRouting/MediaScreenRouter.tsx","../../../../../packages/ui-react/src/pages/ScreenRouting/playlistScreens/PlaylistGrid/PlaylistGrid.tsx","../../../../../packages/common/src/utils/epg.ts","../../../../../packages/hooks-react/src/useLiveChannels.ts","../../../../../packages/hooks-react/src/useLiveProgram.ts","../../../../../packages/hooks-react/src/usePlanByEpg.ts","../../../../../packages/ui-react/src/components/EpgChannel/EpgChannelItem.tsx","../../../../../packages/ui-react/src/components/EpgProgramItem/EpgProgramItem.tsx","../../../../../packages/ui-react/src/components/EpgTimeline/EpgTimeline.tsx","../../../../../packages/ui-react/src/components/Epg/Epg.tsx","../../../../../packages/ui-react/src/pages/ScreenRouting/playlistScreens/PlaylistLiveChannels/PlaylistLiveChannels.tsx","../../../../../packages/ui-react/src/pages/ScreenRouting/PlaylistScreenRouter.tsx","../../../../../packages/ui-react/src/components/Header/Header.tsx","../../../../../packages/ui-react/src/components/Footer/Footer.tsx","../../../../../packages/theme/assets/icons/menu.svg?react","../../../../../packages/ui-react/src/components/Header/HeaderMenu.tsx","../../../../../packages/ui-react/src/components/Header/HeaderNavigation.tsx","../../../../../packages/ui-react/src/components/Logo/Logo.tsx","../../../../../packages/ui-react/src/components/Header/HeaderBrand.tsx","../../../../../packages/ui-react/src/components/Header/HeaderActions.tsx","../../../../../packages/ui-react/src/components/Header/HeaderSkipLink.tsx","../../../../../packages/ui-react/src/components/Sidebar/Sidebar.tsx","../../../../../packages/ui-react/src/components/MenuButton/MenuButton.tsx","../../../../../packages/ui-react/src/components/UserMenuNav/UserMenuNav.tsx","../../../../../packages/ui-react/src/containers/SidebarContainer/SidebarContainer.tsx","../../../../../packages/ui-react/src/containers/SiteMetadata/SiteMetadata.tsx","../../../../../packages/theme/assets/icons/search.svg?react","../../../../../packages/theme/assets/icons/cancel.svg?react","../../../../../packages/ui-react/src/components/SearchBar/SearchBar.tsx","../../../../../packages/ui-react/src/components/Header/HeaderActionButton.tsx","../../../../../packages/ui-react/src/containers/HeaderSearch/HeaderSearch.tsx","../../../../../packages/theme/assets/icons/language.svg?react","../../../../../packages/ui-react/src/components/Panel/Panel.tsx","../../../../../packages/ui-react/src/components/DetectOutsideClick/DetectOutsideClick.tsx","../../../../../packages/ui-react/src/components/Popover/Popover.tsx","../../../../../packages/ui-react/src/components/LanguageMenu/LanguageMenu.tsx","../../../../../packages/ui-react/src/containers/HeaderLanguageSwitcher/HeaderLanguageSwitcher.tsx","../../../../../packages/ui-react/src/components/UserMenu/UserMenu.tsx","../../../../../packages/ui-react/src/containers/HeaderUserMenu/HeaderUserMenu.tsx","../../../../../packages/ui-react/src/containers/Layout/Layout.tsx","../../../src/hooks/useNotifications.ts","../../../src/containers/RoutesContainer/RoutesContainer.tsx","../../../src/containers/AppRoutes/AppRoutes.tsx","../../../../../packages/ui-react/src/pages/ScreenRouting/mediaScreens/MediaHub/MediaHub.tsx","../../../src/screenMapping.ts","../../../src/hooks/useTrackConfigKeyChange.ts","../../../src/containers/Root/Root.tsx","../../../src/App.tsx","../../../src/utils/accessibility.ts","../../../src/index.tsx"],"sourcesContent":["// src/client/build/register.ts\nvar autoUpdateMode = \"true\";\nvar selfDestroying = \"false\";\nvar auto = autoUpdateMode === \"true\";\nvar autoDestroy = selfDestroying === \"true\";\nfunction registerSW(options = {}) {\n  const {\n    immediate = false,\n    onNeedRefresh,\n    onOfflineReady,\n    onRegistered,\n    onRegisteredSW,\n    onRegisterError\n  } = options;\n  let wb;\n  let registerPromise;\n  let sendSkipWaitingMessage;\n  const updateServiceWorker = async (_reloadPage = true) => {\n    await registerPromise;\n    if (!auto) {\n      await sendSkipWaitingMessage?.();\n    }\n  };\n  async function register() {\n    if (\"serviceWorker\" in navigator) {\n      wb = await import(\"workbox-window\").then(({ Workbox }) => {\n        return new Workbox(\"/sw.js\", { scope: \"/\", type: \"classic\" });\n      }).catch((e) => {\n        onRegisterError?.(e);\n        return void 0;\n      });\n      if (!wb)\n        return;\n      sendSkipWaitingMessage = async () => {\n        await wb?.messageSkipWaiting();\n      };\n      if (!autoDestroy) {\n        if (auto) {\n          wb.addEventListener(\"activated\", (event) => {\n            if (event.isUpdate || event.isExternal)\n              window.location.reload();\n          });\n          wb.addEventListener(\"installed\", (event) => {\n            if (!event.isUpdate) {\n              onOfflineReady?.();\n            }\n          });\n        } else {\n          let onNeedRefreshCalled = false;\n          const showSkipWaitingPrompt = () => {\n            onNeedRefreshCalled = true;\n            wb?.addEventListener(\"controlling\", (event) => {\n              if (event.isUpdate)\n                window.location.reload();\n            });\n            onNeedRefresh?.();\n          };\n          wb.addEventListener(\"installed\", (event) => {\n            if (typeof event.isUpdate === \"undefined\") {\n              if (typeof event.isExternal !== \"undefined\") {\n                if (event.isExternal)\n                  showSkipWaitingPrompt();\n                else\n                  !onNeedRefreshCalled && onOfflineReady?.();\n              } else {\n                if (event.isExternal)\n                  window.location.reload();\n                else\n                  !onNeedRefreshCalled && onOfflineReady?.();\n              }\n            } else if (!event.isUpdate) {\n              onOfflineReady?.();\n            }\n          });\n          wb.addEventListener(\"waiting\", showSkipWaitingPrompt);\n          wb.addEventListener(\"externalwaiting\", showSkipWaitingPrompt);\n        }\n      }\n      wb.register({ immediate }).then((r) => {\n        if (onRegisteredSW)\n          onRegisteredSW(\"/sw.js\", r);\n        else\n          onRegistered?.(r);\n      }).catch((e) => {\n        onRegisterError?.(e);\n      });\n    }\n  }\n  registerPromise = register();\n  return updateServiceWorker;\n}\nexport {\n  registerSW\n};\n","export type Env = {\r\n  APP_VERSION: string;\r\n  APP_API_BASE_URL: string;\r\n  APP_API_ACCESS_BRIDGE_URL: string;\r\n  APP_PLAYER_ID: string;\r\n  APP_FOOTER_TEXT: string;\r\n  APP_DEFAULT_LANGUAGE: string;\r\n  APP_PUBLIC_URL: string;\r\n\r\n  APP_DEFAULT_CONFIG_SOURCE?: string;\r\n  APP_PLAYER_LICENSE_KEY?: string;\r\n\r\n  APP_BODY_FONT?: string;\r\n  APP_BODY_ALT_FONT?: string;\r\n};\r\n\r\nconst env: Env = {\r\n  APP_VERSION: '',\r\n  APP_API_BASE_URL: 'https://cdn.jwplayer.com',\r\n  APP_API_ACCESS_BRIDGE_URL: '',\r\n  APP_PLAYER_ID: 'M4qoGvUk',\r\n  APP_FOOTER_TEXT: '',\r\n  APP_DEFAULT_LANGUAGE: 'en',\r\n  APP_PUBLIC_URL: '',\r\n};\r\n\r\nexport const configureEnv = (options: Partial<Env>) => {\r\n  env.APP_VERSION = options.APP_VERSION || env.APP_VERSION;\r\n  env.APP_API_BASE_URL = options.APP_API_BASE_URL || env.APP_API_BASE_URL;\r\n  env.APP_API_ACCESS_BRIDGE_URL = options.APP_API_ACCESS_BRIDGE_URL || env.APP_API_ACCESS_BRIDGE_URL;\r\n  env.APP_PLAYER_ID = options.APP_PLAYER_ID || env.APP_PLAYER_ID;\r\n  env.APP_FOOTER_TEXT = options.APP_FOOTER_TEXT || env.APP_FOOTER_TEXT;\r\n  env.APP_DEFAULT_LANGUAGE = options.APP_DEFAULT_LANGUAGE || env.APP_DEFAULT_LANGUAGE;\r\n  env.APP_PUBLIC_URL = options.APP_PUBLIC_URL || env.APP_PUBLIC_URL;\r\n\r\n  env.APP_DEFAULT_CONFIG_SOURCE ||= options.APP_DEFAULT_CONFIG_SOURCE;\r\n  env.APP_PLAYER_LICENSE_KEY ||= options.APP_PLAYER_LICENSE_KEY;\r\n\r\n  env.APP_BODY_FONT = options.APP_BODY_FONT || env.APP_BODY_FONT;\r\n  env.APP_BODY_ALT_FONT = options.APP_BODY_ALT_FONT || env.APP_BODY_ALT_FONT;\r\n};\r\n\r\nexport default env;\r\n","export enum PersonalShelf {\r\n  ContinueWatching = 'continue_watching',\r\n  Favorites = 'favorites',\r\n}\r\n\r\nexport const PersonalShelves = [PersonalShelf.Favorites, PersonalShelf.ContinueWatching];\r\n\r\nexport const INTEGRATION = {\r\n  JWP: 'JWP',\r\n  CLEENG: 'CLEENG',\r\n} as const;\r\n\r\nexport const ACCESS_MODEL = {\r\n  AVOD: 'AVOD',\r\n  AUTHVOD: 'AUTHVOD',\r\n  SVOD: 'SVOD',\r\n} as const;\r\n\r\nexport const VideoProgressMinMax = {\r\n  Min: 0.05,\r\n  Max: 0.95,\r\n};\r\n\r\nexport const PLAYLIST_LIMIT = 25;\r\n\r\nexport const ADYEN_TEST_CLIENT_KEY = 'test_I4OFGUUCEVB5TI222AS3N2Y2LY6PJM3K';\r\n\r\nexport const ADYEN_LIVE_CLIENT_KEY = 'live_BQDOFBYTGZB3XKF62GBYSLPUJ4YW2TPL';\r\n\r\n// how often the live channel schedule is refetched in ms\r\nexport const LIVE_CHANNELS_REFETCH_INTERVAL = 15 * 60_000;\r\n\r\n// Some predefined media types of JW\r\nexport const MEDIA_CONTENT_TYPE = {\r\n  // Series page with seasons / episodes\r\n  series: 'series',\r\n  // Separate episode page\r\n  episode: 'episode',\r\n  // Live channel (24x7)\r\n  liveChannel: 'livechannel',\r\n  // Temporary live stream that starts at a specific time\r\n  liveEvent: 'liveevent',\r\n  // Static page with markdown\r\n  page: 'page',\r\n  // Page with shelves list\r\n  hub: 'hub',\r\n} as const;\r\n\r\n// Some predefined playlist types of JW\r\nexport const PLAYLIST_CONTENT_TYPE = {\r\n  // Page with a list of live channels\r\n  live: 'live',\r\n} as const;\r\n\r\n// Some predefined shelf types of JW\r\nexport const SHELF_LAYOUT_TYPE = {\r\n  // Fullwidth hero, only available as the first shelf (index === 0)\r\n  hero: 'hero',\r\n  // Larger cards\r\n  featured: 'featured',\r\n  // By default: standard size cards (default)\r\n} as const;\r\n\r\n// OTT shared player\r\nexport const OTT_GLOBAL_PLAYER_ID = 'M4qoGvUk';\r\n\r\nexport const CONFIG_QUERY_KEY = 'app-config';\r\n\r\nexport const CONFIG_FILE_STORAGE_KEY = 'config-file-override';\r\n\r\nexport const CACHE_TIME = 60 * 1000 * 20; // 20 minutes\r\n\r\nexport const STALE_TIME = 60 * 1000 * 20;\r\n\r\nexport const CARD_ASPECT_RATIOS = ['1:1', '2:1', '2:3', '4:3', '5:3', '16:9', '9:13', '9:16'] as const;\r\n\r\nexport const MAX_WATCHLIST_ITEMS_COUNT = 48; // Default value\r\n\r\nexport const DEFAULT_FEATURES = {\r\n  canUpdateEmail: false,\r\n  canSupportEmptyFullName: false,\r\n  canChangePasswordWithOldPassword: false,\r\n  canRenewSubscription: false,\r\n  canExportAccountData: false,\r\n  canDeleteAccount: false,\r\n  canUpdatePaymentMethod: false,\r\n  canShowReceipts: false,\r\n  hasSocialURLs: false,\r\n  hasNotifications: false,\r\n  watchListSizeLimit: MAX_WATCHLIST_ITEMS_COUNT,\r\n};\r\n\r\nexport const EPG_TYPE = {\r\n  jwp: 'jwp',\r\n  viewNexa: 'viewnexa',\r\n} as const;\r\n\r\nexport const APP_CONFIG_ITEM_TYPE = {\r\n  playlist: 'playlist',\r\n  continue_watching: 'continue_watching',\r\n  favorites: 'favorites',\r\n  content_list: 'content_list',\r\n  media: 'media',\r\n} as const;\r\n","import { Container, injectable, type interfaces, inject } from 'inversify';\r\n\r\nexport const container = new Container({ defaultScope: 'Singleton', skipBaseClassChecks: true });\r\n\r\nexport { injectable, inject };\r\n\r\nexport function getModule<T>(constructorFunction: interfaces.ServiceIdentifier<T>, required: false): T | undefined;\r\nexport function getModule<T>(constructorFunction: interfaces.ServiceIdentifier<T>, required: true): T;\r\nexport function getModule<T>(constructorFunction: interfaces.ServiceIdentifier<T>): T;\r\nexport function getModule<T>(constructorFunction: interfaces.ServiceIdentifier<T>, required = true): T | undefined {\r\n  const module = container.getAll(constructorFunction)[0];\r\n\r\n  if (required && !module) throw new Error(`Service / Controller '${String(constructorFunction)}' not found`);\r\n\r\n  return module;\r\n}\r\n\r\nexport function getAllModules<T>(constructorFunction: interfaces.ServiceIdentifier<T>): T[] {\r\n  return container.getAll(constructorFunction);\r\n}\r\n\r\nexport function getNamedModule<T>(constructorFunction: interfaces.ServiceIdentifier<T>, name: string | null, required: false): T | undefined;\r\nexport function getNamedModule<T>(constructorFunction: interfaces.ServiceIdentifier<T>, name: string | null, required: true): T;\r\nexport function getNamedModule<T>(constructorFunction: interfaces.ServiceIdentifier<T>, name: string | null): T;\r\nexport function getNamedModule<T>(constructorFunction: interfaces.ServiceIdentifier<T>, name: string | null, required = true): T | undefined {\r\n  if (!name) {\r\n    return;\r\n  }\r\n\r\n  let module;\r\n\r\n  try {\r\n    module = container.getAllNamed(constructorFunction, name)[0];\r\n\r\n    return module;\r\n  } catch (err: unknown) {\r\n    if (err instanceof Error && err.message.includes('No matching bindings found')) {\r\n      if (required) {\r\n        throw new Error(`Service not found '${String(constructorFunction)}' with name '${name}'`);\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    // log service can't be used here\r\n    console.error('Error caught while initializing service', err);\r\n  }\r\n}\r\n\r\nexport function assertModuleMethod<T>(method: T, message: string): asserts method is NonNullable<T> {\r\n  if (!method) throw new Error(message);\r\n}\r\n\r\nexport function assertFeature(isEnabled: boolean, featureName: string): asserts isEnabled is true {\r\n  if (!isEnabled) throw new Error(`${featureName} feature is not enabled`);\r\n}\r\n","export const INTEGRATION_TYPE = Symbol('INTEGRATION_TYPE');\r\n\r\nexport const DETERMINE_INTEGRATION_TYPE = Symbol('DETERMINE_INTEGRATION_TYPE');\r\n\r\nexport const GET_CUSTOMER_IP = Symbol('GET_CUSTOMER_IP');\r\n\r\nexport const API_ACCESS_BRIDGE_URL = Symbol('API_ACCESS_BRIDGE_URL');\r\n\r\nexport const BROADCAST_CHANNEL = Symbol('BROADCAST_CHANNEL');\r\n","import type { Playlist, PlaylistItem } from '../../types/playlist';\r\n\r\nexport function debounce<T extends (...args: any[]) => void>(callback: T, wait = 200) {\r\n  let timeout: NodeJS.Timeout | undefined;\r\n  function debounced(...args: unknown[]) {\r\n    if (timeout) clearTimeout(timeout);\r\n    timeout = setTimeout(() => callback(...args), wait);\r\n  }\r\n\r\n  debounced.cancel = () => clearTimeout(timeout);\r\n  return debounced;\r\n}\r\n\r\nexport function throttle<T extends (...args: any[]) => unknown>(func: T, limit: number) {\r\n  let lastFunc: NodeJS.Timeout | undefined;\r\n  let lastRan: number | undefined;\r\n\r\n  function throttled(this: ThisParameterType<T>, ...args: Parameters<T>): void {\r\n    const timeSinceLastRan = lastRan ? Date.now() - lastRan : limit;\r\n\r\n    if (timeSinceLastRan >= limit) {\r\n      func.apply(this, args);\r\n      lastRan = Date.now();\r\n    } else if (!lastFunc) {\r\n      lastFunc = setTimeout(() => {\r\n        if (lastRan) {\r\n          const timeSinceLastRan = Date.now() - lastRan;\r\n          if (timeSinceLastRan >= limit) {\r\n            func.apply(this, args);\r\n            lastRan = Date.now();\r\n          }\r\n        }\r\n        lastFunc = undefined;\r\n      }, limit - timeSinceLastRan);\r\n    }\r\n  }\r\n\r\n  throttled.cancel = () => clearTimeout(lastFunc);\r\n  return throttled;\r\n}\r\n\r\nexport const unicodeToChar = (text: string) => {\r\n  return text.replace(/\\\\u[\\dA-F]{4}/gi, (match) => {\r\n    return String.fromCharCode(parseInt(match.replace(/\\\\u/g, ''), 16));\r\n  });\r\n};\r\n\r\n/**\r\n * Parse hex color and return the RGB colors\r\n * @param color\r\n * @return {{r: number, b: number, g: number}|undefined}\r\n */\r\nexport function hexToRgb(color: string) {\r\n  if (color.indexOf('#') === 0) {\r\n    color = color.slice(1);\r\n  }\r\n\r\n  // convert 3-digit hex to 6-digits.\r\n  if (color.length === 3) {\r\n    color = color[0] + color[0] + color[1] + color[1] + color[2] + color[2];\r\n  }\r\n\r\n  if (color.length !== 6) {\r\n    return undefined;\r\n  }\r\n\r\n  return {\r\n    r: parseInt(color.slice(0, 2), 16),\r\n    g: parseInt(color.slice(2, 4), 16),\r\n    b: parseInt(color.slice(4, 6), 16),\r\n  };\r\n}\r\n\r\n/**\r\n * Get the contrast color based on the given color\r\n * @param {string} color Hex or RGBA color string\r\n * @link {https://stackoverflow.com/a/35970186/1790728}\r\n * @return {string}\r\n */\r\nexport function calculateContrastColor(color: string): string {\r\n  const rgb = hexToRgb(color);\r\n\r\n  if (!rgb) {\r\n    return '';\r\n  }\r\n\r\n  // http://stackoverflow.com/a/3943023/112731\r\n  return rgb.r * 0.299 + rgb.g * 0.587 + rgb.b * 0.114 > 186 ? '#000000' : '#FFFFFF';\r\n}\r\n\r\n// Build is either Development or Production\r\n// Mode can be dev, jwdev, demo, test, prod, etc.\r\nexport const IS_DEVELOPMENT_BUILD = __dev__;\r\n// Demo mode is used to run our firebase demo instance\r\nexport const IS_DEMO_MODE = __mode__ === 'demo';\r\n// Test mode is used for e2e and unit tests\r\nexport const IS_TEST_MODE = __mode__ === 'test';\r\n\r\n// Preview mode is used for previewing Pull Requests on GitHub\r\nexport const IS_PREVIEW_MODE = __mode__ === 'preview';\r\n// Production mode\r\nexport const IS_PROD_MODE = __mode__ === 'prod';\r\n\r\nexport const isContentType = (item: PlaylistItem | Playlist, contentType: string) => item.contentType?.toLowerCase() === contentType.toLowerCase();\r\n\r\nexport const isTruthyCustomParamValue = (value: unknown): boolean => ['true', '1', 'yes', 'on'].includes(String(value)?.toLowerCase());\r\n\r\nexport const isFalsyCustomParamValue = (value: unknown): boolean => ['false', '0', 'no', 'off'].includes(String(value)?.toLowerCase());\r\n\r\nexport function testId(value: string | undefined) {\r\n  return IS_DEVELOPMENT_BUILD || IS_TEST_MODE || IS_PREVIEW_MODE ? value : undefined;\r\n}\r\n\r\ntype Truthy<T> = T extends false | '' | 0 | null | undefined ? never : T;\r\nexport const isTruthy = <T>(value: T | true): value is Truthy<T> => Boolean(value);\r\n","import type { PlaylistItem } from '../../types/playlist';\r\nimport { MEDIA_CONTENT_TYPE } from '../constants';\r\n\r\nimport { isContentType } from './common';\r\n\r\nexport enum EventState {\r\n  PRE_LIVE = 'PRE_LIVE',\r\n  LIVE_UNPUBLISHED = 'LIVE_UNPUBLISHED',\r\n  LIVE_PUBLISHED = 'LIVE_PUBLISHED',\r\n  INSTANT_VOD = 'INSTANT_VOD',\r\n  VOD_PUBLIC = 'VOD_PUBLIC',\r\n}\r\n\r\nexport const enum MediaStatus {\r\n  LIVE = 'LIVE',\r\n  VOD = 'VOD',\r\n  SCHEDULED = 'SCHEDULED',\r\n}\r\n\r\nexport const isLiveEvent = (playlistItem?: PlaylistItem) => {\r\n  return !!playlistItem && isContentType(playlistItem, MEDIA_CONTENT_TYPE.liveEvent);\r\n};\r\n\r\nexport const isScheduledOrLiveMedia = (playlistItem: PlaylistItem) => {\r\n  return playlistItem.mediaStatus === MediaStatus.SCHEDULED || playlistItem.mediaStatus === MediaStatus.LIVE;\r\n};\r\n\r\nexport const getMediaStatusFromEventState = (playlistItem: PlaylistItem) => {\r\n  const eventState = playlistItem['VCH.EventState'];\r\n  const { scheduledStart, scheduledEnd } = playlistItem;\r\n\r\n  const now = new Date();\r\n  const started = eventState === EventState.LIVE_PUBLISHED || (scheduledStart && scheduledStart < now);\r\n  const live = started && scheduledEnd && scheduledEnd > now;\r\n\r\n  if (live) {\r\n    return MediaStatus.LIVE;\r\n  }\r\n\r\n  if (!eventState) {\r\n    return MediaStatus.VOD;\r\n  }\r\n\r\n  switch (eventState) {\r\n    case EventState.PRE_LIVE:\r\n    case EventState.LIVE_UNPUBLISHED:\r\n      return MediaStatus.SCHEDULED;\r\n    case EventState.LIVE_PUBLISHED:\r\n      return MediaStatus.LIVE;\r\n    case EventState.INSTANT_VOD:\r\n    case EventState.VOD_PUBLIC:\r\n      return MediaStatus.VOD;\r\n  }\r\n};\r\n\r\nexport const isPlayable = (playlistItem: PlaylistItem) => {\r\n  return playlistItem.mediaStatus === MediaStatus.LIVE || playlistItem.mediaStatus === MediaStatus.VOD;\r\n};\r\n","export const PATH_HOME = '/';\r\n\r\nexport const PATH_MEDIA = '/m/:id/*';\r\nexport const PATH_PLAYLIST = '/p/:id/*';\r\nexport const PATH_CONTENT_LIST = '/n/:id/*';\r\nexport const PATH_LEGACY_SERIES = '/s/:id/*';\r\n\r\nexport const PATH_SEARCH = '/q/*';\r\nexport const PATH_ABOUT = '/o/about';\r\n\r\nexport const PATH_USER_BASE = '/u';\r\nexport const PATH_USER = `${PATH_USER_BASE}/*`;\r\n\r\nexport const RELATIVE_PATH_USER_ACCOUNT = 'my-account';\r\nexport const RELATIVE_PATH_USER_FAVORITES = 'favorites';\r\nexport const RELATIVE_PATH_USER_PAYMENTS = 'payments';\r\n\r\nexport const PATH_USER_ACCOUNT = `${PATH_USER_BASE}/${RELATIVE_PATH_USER_ACCOUNT}`;\r\nexport const PATH_USER_FAVORITES = `${PATH_USER_BASE}/${RELATIVE_PATH_USER_FAVORITES}`;\r\nexport const PATH_USER_PAYMENTS = `${PATH_USER_BASE}/${RELATIVE_PATH_USER_PAYMENTS}`;\r\n","export enum LogLevel {\r\n  // detailed information for diagnosing problems, typically only useful during development\r\n  DEBUG,\r\n  // general information about the application's operation, such as startup or shutdown messages\r\n  INFO,\r\n  // indications of potential problems or unusual situations that are not immediately harmful\r\n  WARN,\r\n  // errors that affect the functionality of the application but allow it to continue running\r\n  ERROR,\r\n  // severe errors that lead to the application's termination\r\n  FATAL,\r\n  // no logging will be performed. Used to disable logging completely\r\n  SILENT,\r\n}\r\n","import type { LogLevel } from './LogLevel';\r\n\r\nexport default abstract class LogTransporter {\r\n  abstract log(level: LogLevel, scope: string, message: string, extra?: Record<string, unknown>, error?: Error): void;\r\n}\r\n","import { getAllModules } from './modules/container';\r\nimport { LogLevel } from './services/logging/LogLevel';\r\nimport LogTransporter from './services/logging/LogTransporter';\r\n\r\nexport type LogParams = { error?: unknown; [key: string]: unknown };\r\n\r\nconst wrapError = (error: unknown) => {\r\n  return error instanceof Error ? error : new Error(String(error));\r\n};\r\n\r\nexport const makeLogFn =\r\n  (logLevel: LogLevel) =>\r\n  (scope: string, message: string, { error, ...extra }: LogParams = {}) => {\r\n    const transporters = getAllModules(LogTransporter);\r\n\r\n    // call log on all transporters, the transporters should decide to handle the call or not\r\n    transporters.forEach((transporter) => {\r\n      transporter.log(logLevel, scope, message, extra, error ? wrapError(error) : undefined);\r\n    });\r\n  };\r\n\r\nexport const logDebug = makeLogFn(LogLevel.DEBUG);\r\nexport const logInfo = makeLogFn(LogLevel.INFO);\r\nexport const logWarn = makeLogFn(LogLevel.WARN);\r\nexport const logError = makeLogFn(LogLevel.ERROR);\r\nexport const logFatal = makeLogFn(LogLevel.FATAL);\r\n","import type { PlaylistItem } from '../../types/playlist';\r\nimport { MEDIA_CONTENT_TYPE } from '../constants';\r\n\r\nimport { isContentType } from './common';\r\n\r\ntype RequiredProperties<T, P extends keyof T> = T & Required<Pick<T, P>>;\r\n\r\ntype DeprecatedPlaylistItem = {\r\n  seriesPlayListId?: string;\r\n  seriesPlaylistId?: string;\r\n};\r\n\r\n// For the deprecated series flow we store seriesId in custom params\r\nexport const getSeriesPlaylistIdFromCustomParams = (item: (PlaylistItem & DeprecatedPlaylistItem) | undefined) =>\r\n  item ? item.seriesPlayListId || item.seriesPlaylistId || item.seriesId : undefined;\r\n\r\n// For the deprecated flow we store seriesId in the media custom params\r\nexport const isLegacySeriesFlow = (item: PlaylistItem) => {\r\n  return typeof getSeriesPlaylistIdFromCustomParams(item) !== 'undefined';\r\n};\r\n\r\n// For the new series flow we use contentType custom param to define media item to be series\r\n// In this case media item and series item have the same id\r\nexport const isSeriesContentType = (item: PlaylistItem) => isContentType(item, MEDIA_CONTENT_TYPE.series);\r\n\r\nexport const isSeries = (item: PlaylistItem) => isLegacySeriesFlow(item) || isSeriesContentType(item);\r\n\r\nexport const isEpisode = (item: PlaylistItem) => {\r\n  return typeof item?.episodeNumber !== 'undefined' || isContentType(item, MEDIA_CONTENT_TYPE.episode);\r\n};\r\n\r\nexport const getLegacySeriesPlaylistIdFromEpisodeTags = (item: PlaylistItem | undefined) => {\r\n  if (!item || !isEpisode(item)) {\r\n    return;\r\n  }\r\n\r\n  const tags = item.tags ? item.tags.split(',') : [];\r\n  const seriesIdTag = tags.find(function (tag) {\r\n    return /seriesid_([\\w\\d]+)/i.test(tag);\r\n  });\r\n\r\n  if (seriesIdTag) {\r\n    return seriesIdTag.split('_')[1];\r\n  }\r\n\r\n  return;\r\n};\r\n\r\nexport const isLiveChannel = (item: PlaylistItem): item is RequiredProperties<PlaylistItem, 'contentType'> =>\r\n  isContentType(item, MEDIA_CONTENT_TYPE.liveChannel);\r\n","import type { AppMenuType } from '@jwp/ott-common/types/config';\r\n\r\nimport type { PlaylistItem } from '../../types/playlist';\r\nimport { PATH_MEDIA, PATH_PLAYLIST, PATH_CONTENT_LIST } from '../paths';\r\nimport { logWarn } from '../logger';\r\nimport { APP_CONFIG_ITEM_TYPE } from '../constants';\r\n\r\nimport { getLegacySeriesPlaylistIdFromEpisodeTags, getSeriesPlaylistIdFromCustomParams } from './media';\r\n\r\nexport type QueryParamsArg = { [key: string]: string | number | string[] | undefined | null };\r\n\r\n/**\r\n * Creates a new URL from an url string (preserving the search params) and an object to add and remove query params\r\n *\r\n * @example\r\n * createURL('/m/123456?play=1', { foo: 'bar' }) === '/m/123456?play=6&foo=bar'\r\n * createURL('/m/123456?play=1', { play: null }) === '/m/123456'\r\n *\r\n * // works with absolute URLs\r\n * createURL('https://jwplayer.com/m/123456?play=1', { play: null }) === 'https://jwplayer.com/m/123456'\r\n */\r\nexport const createURL = (url: string, queryParams: QueryParamsArg) => {\r\n  const [baseUrl, urlQueryString = ''] = url.split('?');\r\n  const urlSearchParams = new URLSearchParams(urlQueryString);\r\n\r\n  Object.entries(queryParams).forEach(([key, value]) => {\r\n    if (value === null || value === undefined) {\r\n      return urlSearchParams.delete(key);\r\n    }\r\n\r\n    const formattedValue = Array.isArray(value) ? value.join(',') : value;\r\n\r\n    urlSearchParams.set(key, String(formattedValue));\r\n  });\r\n\r\n  const queryString = urlSearchParams.toString();\r\n\r\n  return `${baseUrl}${queryString ? `?${queryString}` : ''}`;\r\n};\r\n\r\ntype ExtractRouteParams<T extends string> = T extends `${infer _Start}:${infer Param}/${infer Rest}`\r\n  ? { [K in Param | keyof ExtractRouteParams<Rest>]: string }\r\n  : T extends `${infer _Start}:${infer Param}`\r\n  ? { [K in Param]: string }\r\n  : object;\r\n\r\ntype PathParams<T extends string> = T extends `${infer _Start}*` ? ExtractRouteParams<T> & Record<string, string | undefined> : ExtractRouteParams<T>;\r\n\r\n// Creates a route path from a path string and params object\r\nexport const createPath = <Path extends string>(originalPath: Path, pathParams?: PathParams<Path>, queryParams?: QueryParamsArg): string => {\r\n  const path = originalPath\r\n    .split('/')\r\n    .map((segment) => {\r\n      if (segment === '*') {\r\n        // Wild card for optional segments: add all params that are not already in the path\r\n        if (!pathParams) return segment;\r\n\r\n        return Object.entries(pathParams)\r\n          .filter(([key]) => !originalPath.includes(key))\r\n          .map(([_, value]) => value)\r\n          .join('/');\r\n      }\r\n      if (!segment.startsWith(':') || !pathParams) return segment;\r\n\r\n      // Check if param is optional, and show a warning if it's not optional and missing\r\n      // Then remove all special characters to get the actual param name\r\n      const isOptional = segment.endsWith('?');\r\n      const paramName = segment.replace(':', '').replace('?', '');\r\n      const paramValue = pathParams[paramName as keyof typeof pathParams];\r\n\r\n      if (!paramValue) {\r\n        if (!isOptional) {\r\n          logWarn('urlFormatting', `Missing param in path creation`, {\r\n            path: originalPath,\r\n            paramName,\r\n          });\r\n        }\r\n\r\n        return '';\r\n      }\r\n\r\n      return paramValue;\r\n    })\r\n    .join('/');\r\n\r\n  // Optionally add the query params\r\n  return queryParams ? createURL(path, queryParams) : path;\r\n};\r\n\r\nexport const slugify = (text: string, whitespaceChar: string = '-') =>\r\n  text\r\n    .toString()\r\n    .toLowerCase()\r\n    .replace(/\\s+/g, '-')\r\n    .replace(/[^\\w-]+/g, '')\r\n    .replace(/--+/g, '-')\r\n    .replace(/^-+/, '')\r\n    .replace(/-+$/, '')\r\n    .replace(/-/g, whitespaceChar);\r\n\r\nexport const mediaURL = ({\r\n  id,\r\n  title,\r\n  playlistId,\r\n  play = false,\r\n  episodeId,\r\n}: {\r\n  id: string;\r\n  title?: string;\r\n  playlistId?: string | null;\r\n  play?: boolean;\r\n  episodeId?: string;\r\n}) => {\r\n  return createPath(\r\n    PATH_MEDIA,\r\n    { id, title: title ? slugify(title) : undefined },\r\n    {\r\n      r: playlistId,\r\n      play: play ? '1' : null,\r\n      e: episodeId,\r\n    },\r\n  );\r\n};\r\n\r\nexport const playlistURL = (id: string, title?: string) => {\r\n  return createPath(PATH_PLAYLIST, { id, title: title ? slugify(title) : undefined });\r\n};\r\n\r\nexport const contentListURL = (id: string, title?: string) => {\r\n  return createPath(PATH_CONTENT_LIST, { id, title: title ? slugify(title) : undefined });\r\n};\r\n\r\nexport const determinePath = ({ type, contentId, label }: { type: AppMenuType | undefined; contentId: string; label?: string }) => {\r\n  switch (type) {\r\n    case APP_CONFIG_ITEM_TYPE.content_list:\r\n      return contentListURL(contentId, label);\r\n    case APP_CONFIG_ITEM_TYPE.media:\r\n      return mediaURL({ id: contentId, title: label });\r\n    case APP_CONFIG_ITEM_TYPE.playlist:\r\n      return playlistURL(contentId, label);\r\n    default:\r\n      return '';\r\n  }\r\n};\r\n\r\nexport const liveChannelsURL = (playlistId: string, channelId?: string, play = false) => {\r\n  return createPath(\r\n    PATH_PLAYLIST,\r\n    { id: playlistId },\r\n    {\r\n      channel: channelId,\r\n      play: play ? '1' : null,\r\n    },\r\n  );\r\n};\r\n\r\n// Legacy URLs\r\nexport const legacySeriesURL = ({\r\n  seriesId,\r\n  episodeId,\r\n  play,\r\n  playlistId,\r\n}: {\r\n  seriesId: string;\r\n  episodeId?: string;\r\n  play?: boolean;\r\n  playlistId?: string | null;\r\n}) => createURL(`/s/${seriesId}`, { r: playlistId, e: episodeId, play: play ? '1' : null });\r\n\r\nexport const buildLegacySeriesUrlFromMediaItem = (media: PlaylistItem, play: boolean, playlistId: string | null) => {\r\n  const legacyPlaylistIdFromTags = getLegacySeriesPlaylistIdFromEpisodeTags(media);\r\n  const legacyPlaylistIdFromCustomParams = getSeriesPlaylistIdFromCustomParams(media);\r\n\r\n  return legacySeriesURL({\r\n    // Use the id grabbed from either custom params for series or tags for an episode\r\n    seriesId: legacyPlaylistIdFromCustomParams || legacyPlaylistIdFromTags || '',\r\n    play,\r\n    playlistId,\r\n    // Add episode id only if series id can be retrieved from tags\r\n    episodeId: legacyPlaylistIdFromTags && media.mediaid,\r\n  });\r\n};\r\n","export class ApiError extends Error {\r\n  code: number;\r\n  message: string;\r\n\r\n  constructor(message = '', code: number) {\r\n    super(message);\r\n    this.name = 'ApiError';\r\n    this.message = message;\r\n    this.code = code;\r\n  }\r\n}\r\n\r\n/**\r\n * Get data\r\n * @param response\r\n */\r\nexport const getDataOrThrow = async (response: Response) => {\r\n  const data = await response.json();\r\n\r\n  if (!response.ok) {\r\n    const message = `Request '${response.url}' failed with ${response.status}`;\r\n    const apiMessage = data && typeof data === 'object' && 'message' in data && typeof data.message === 'string' ? data.message : undefined;\r\n\r\n    throw new ApiError(apiMessage || message, response.status || 500);\r\n  }\r\n\r\n  return data;\r\n};\r\n","import { ACCESS_MODEL } from '../constants';\r\nimport type { AccessModel } from '../../types/config';\r\nimport type { MediaOffer } from '../../types/media';\r\nimport type { PlaylistItem } from '../../types/playlist';\r\n\r\nimport { isFalsyCustomParamValue, isTruthyCustomParamValue } from './common';\r\n\r\n/**\r\n * The appearance of the lock icon, depending on the access model\r\n *\r\n * @param accessModel Platform AccessModel, excluding TVOD, which can only be applied per item\r\n * @param isLoggedIn\r\n * @param hasSubscription\r\n * @param playlistItem Used to define if the item is 'free' or has mediaOffers\r\n * @returns\r\n */\r\nexport const isLocked = (accessModel: AccessModel, isLoggedIn: boolean, hasSubscription: boolean, playlistItem: PlaylistItem): boolean => {\r\n  const isItemFree = isFalsyCustomParamValue(playlistItem?.requiresSubscription) || isTruthyCustomParamValue(playlistItem?.free);\r\n  const mediaOffers = playlistItem?.mediaOffers;\r\n\r\n  if (isItemFree) return false;\r\n  if (accessModel === ACCESS_MODEL.AVOD && !mediaOffers) return false;\r\n  if (accessModel === ACCESS_MODEL.AUTHVOD && isLoggedIn && !mediaOffers) return false;\r\n  if (accessModel === ACCESS_MODEL.SVOD && hasSubscription && !mediaOffers?.some((offer) => offer.premier)) return false;\r\n\r\n  return true;\r\n};\r\n\r\n/**\r\n * Filters MediaOffers from offers string\r\n *\r\n * @param offerIds String of comma separated key/value pairs, i.e. \"cleeng:S916977979_NL, !cleeng:S91633379_NL, other_vendor:xyz123\"\r\n * Key is vendor, value is the offerId.\r\n * Vendor keys starting with an exclamation mark represent a 'Premier Access' offer (TVOD only)\r\n *\r\n * @returns An array of MediaOffer { offerId, premier }\r\n */\r\nexport const filterMediaOffers = (vendorPrefix: string, offerIds?: string): MediaOffer[] | null => {\r\n  if (!offerIds) return null;\r\n\r\n  return offerIds\r\n    .replace(/\\s/g, '')\r\n    .split(',')\r\n    .reduce<MediaOffer[]>(\r\n      (offers, offerId) =>\r\n        offerId.indexOf(`${vendorPrefix}:`) === 0 || offerId.indexOf(`!${vendorPrefix}:`) === 0\r\n          ? [...offers, { offerId: offerId.slice(offerId.indexOf(':') + 1), premier: offerId[0] === '!' }]\r\n          : offers,\r\n      [],\r\n    );\r\n};\r\n","import type { StateCreator } from 'zustand';\r\nimport { create } from 'zustand';\r\nimport { devtools, subscribeWithSelector } from 'zustand/middleware';\r\n\r\nimport { IS_DEVELOPMENT_BUILD, IS_TEST_MODE } from '../utils/common';\r\n\r\nexport const createStore = <T>(name: string, storeFn: StateCreator<T>) => {\r\n  const store = subscribeWithSelector(storeFn);\r\n\r\n  // https://github.com/pmndrs/zustand/issues/852#issuecomment-1059783350\r\n  if (IS_DEVELOPMENT_BUILD && !IS_TEST_MODE) {\r\n    return create(\r\n      devtools(store, {\r\n        name,\r\n        anonymousActionType: `${name}/Action`,\r\n      }),\r\n    );\r\n  }\r\n\r\n  return create(store);\r\n};\r\n","import { ACCESS_MODEL, OTT_GLOBAL_PLAYER_ID } from '../constants';\r\nimport type { AccessModel, Config } from '../../types/config';\r\nimport type { Settings } from '../../types/settings';\r\nimport type { LanguageDefinition } from '../../types/i18n';\r\n\r\nimport { createStore } from './utils';\r\n\r\ntype ConfigState = {\r\n  loaded: boolean;\r\n  config: Config;\r\n  accessModel: AccessModel;\r\n  settings: Settings;\r\n  integrationType: string | null;\r\n  supportedLanguages: LanguageDefinition[];\r\n};\r\n\r\nexport const useConfigStore = createStore<ConfigState>('ConfigStore', () => ({\r\n  loaded: false,\r\n  config: {\r\n    id: '',\r\n    siteName: '',\r\n    description: '',\r\n    player: '',\r\n    siteId: '',\r\n    assets: {},\r\n    content: [],\r\n    menu: [],\r\n    integrations: {\r\n      cleeng: {\r\n        useSandbox: true,\r\n      },\r\n      jwp: {\r\n        clientId: null,\r\n        assetId: null,\r\n        useSandbox: true,\r\n      },\r\n    },\r\n    styling: {},\r\n  },\r\n  settings: {\r\n    additionalAllowedConfigSources: [],\r\n    playerId: OTT_GLOBAL_PLAYER_ID,\r\n  },\r\n  supportedLanguages: [],\r\n  accessModel: ACCESS_MODEL.AVOD,\r\n  integrationType: null,\r\n}));\r\n","import { isValid, parseISO } from 'date-fns';\r\nimport { injectable } from 'inversify';\r\n\r\nimport { getMediaStatusFromEventState } from '../utils/liveEvent';\r\nimport { createURL } from '../utils/urlFormatting';\r\nimport { getDataOrThrow } from '../utils/api';\r\nimport { filterMediaOffers } from '../utils/entitlements';\r\nimport { useConfigStore as ConfigStore } from '../stores/ConfigStore';\r\nimport type { GetPlaylistParams, Playlist, PlaylistItem } from '../../types/playlist';\r\nimport type { ContentList, GetContentSearchParams } from '../../types/content-list';\r\nimport type { AdSchedule } from '../../types/ad-schedule';\r\nimport type { EpisodeInSeries, EpisodesRes, EpisodesWithPagination, GetSeriesParams, Series } from '../../types/series';\r\nimport env from '../env';\r\nimport { logError } from '../logger';\r\n\r\n// change the values below to change the property used to look up the alternate image\r\nenum ImageProperty {\r\n  CARD = 'card',\r\n  BACKGROUND = 'background',\r\n  CHANNEL_LOGO = 'channel_logo',\r\n}\r\n\r\nconst PAGE_LIMIT = 20;\r\n\r\n@injectable()\r\nexport default class ApiService {\r\n  /**\r\n   * We use playlistLabel prop to define the label used for all media items inside.\r\n   * That way we can change the behavior of the same media items being in different playlists\r\n   */\r\n  protected generateAlternateImageURL = ({ mediaId, label, playlistLabel }: { mediaId: string; label: string; playlistLabel?: string }) => {\r\n    const pathname = `/v2/media/${mediaId}/images/${playlistLabel || label}.webp`;\r\n    const url = createURL(`${env.APP_API_BASE_URL}${pathname}`, { poster_fallback: 1, fallback: playlistLabel ? label : null });\r\n\r\n    return url;\r\n  };\r\n\r\n  protected parseDate = (item: PlaylistItem, prop: string) => {\r\n    const date = item[prop] as string | undefined;\r\n\r\n    if (date && !isValid(new Date(date))) {\r\n      logError('ApiService', `Invalid \"${prop}\" date provided for the \"${item.title}\" media item`, { error: new Error('Invalid date') });\r\n      return undefined;\r\n    }\r\n\r\n    return date ? parseISO(date) : undefined;\r\n  };\r\n\r\n  protected getTranslatedFields = (item: PlaylistItem, language?: string) => {\r\n    if (!language) {\r\n      return item;\r\n    }\r\n\r\n    const defaultLanguage = env.APP_DEFAULT_LANGUAGE;\r\n    const transformedItem = { ...item };\r\n\r\n    if (language !== defaultLanguage) {\r\n      for (const [key, _] of Object.entries(transformedItem)) {\r\n        if (item[`${key}-${language}`]) {\r\n          transformedItem[key] = item[`${key}-${language}`];\r\n        }\r\n      }\r\n    }\r\n\r\n    return transformedItem;\r\n  };\r\n\r\n  /**\r\n   * Transform incoming content lists\r\n   */\r\n  protected transformContentList = (contentList: ContentList, language: string): Playlist => {\r\n    const { list, ...rest } = contentList;\r\n\r\n    const playlist: Playlist = { ...rest, playlist: [] };\r\n\r\n    playlist.playlist = list.map((item) => {\r\n      const { custom_params, media_id, description, tags, ...rest } = item;\r\n\r\n      const playlistItem: PlaylistItem = {\r\n        feedid: contentList.id,\r\n        mediaid: media_id,\r\n        tags: tags.join(','),\r\n        description: description || '',\r\n        sources: [],\r\n        images: [],\r\n        image: '',\r\n        link: '',\r\n        pubdate: 0,\r\n        ...rest,\r\n        ...custom_params,\r\n      };\r\n\r\n      return this.transformMediaItem({ item: playlistItem, playlist, language });\r\n    });\r\n\r\n    return playlist;\r\n  };\r\n\r\n  /**\r\n   * Transform incoming playlists\r\n   */\r\n  protected transformPlaylist = (playlist: Playlist, relatedMediaId?: string, language?: string) => {\r\n    playlist.playlist = playlist.playlist.map((item) => this.transformMediaItem({ item, playlist, language }));\r\n\r\n    // remove the related media item (when this is a recommendations playlist)\r\n    if (relatedMediaId) {\r\n      playlist.playlist = playlist.playlist.filter((item) => item.mediaid !== relatedMediaId);\r\n    }\r\n\r\n    return playlist;\r\n  };\r\n\r\n  /**\r\n   * Transform incoming media items\r\n   * - Parses productId into MediaOffer[] for all cleeng offers\r\n   */\r\n  transformMediaItem = ({ item, playlist, language }: { item: PlaylistItem; playlist?: Playlist; language?: string }) => {\r\n    const config = ConfigStore.getState().config;\r\n    const offerKeys = Object.keys(config?.integrations)[0];\r\n    const playlistLabel = playlist?.imageLabel;\r\n    const mediaId = item.mediaid;\r\n    const translatedFields = this.getTranslatedFields(item, language);\r\n\r\n    const transformedMediaItem = {\r\n      ...item,\r\n      ...translatedFields,\r\n      cardImage: this.generateAlternateImageURL({ mediaId, label: ImageProperty.CARD, playlistLabel }),\r\n      channelLogoImage: this.generateAlternateImageURL({ mediaId, label: ImageProperty.CHANNEL_LOGO, playlistLabel }),\r\n      backgroundImage: this.generateAlternateImageURL({ mediaId, label: ImageProperty.BACKGROUND }),\r\n      mediaOffers: item.productIds ? filterMediaOffers(offerKeys, item.productIds) : undefined,\r\n      scheduledStart: this.parseDate(item, 'VCH.ScheduledStart'),\r\n      scheduledEnd: this.parseDate(item, 'VCH.ScheduledEnd'),\r\n    };\r\n\r\n    // add the media status to the media item after the transformation because the live media status depends on the scheduledStart and scheduledEnd\r\n    transformedMediaItem.mediaStatus = getMediaStatusFromEventState(transformedMediaItem);\r\n\r\n    return transformedMediaItem;\r\n  };\r\n\r\n  private transformEpisodes = (episodesRes: EpisodesRes, language?: string, seasonNumber?: number) => {\r\n    const { episodes, page, page_limit, total } = episodesRes;\r\n\r\n    // Adding images and keys for media items\r\n    return {\r\n      episodes: episodes\r\n        .filter((el) => el.media_item)\r\n        .map((el) => ({\r\n          ...this.transformMediaItem({ item: el.media_item as PlaylistItem, language }),\r\n          seasonNumber: seasonNumber?.toString() || el.season_number?.toString() || '',\r\n          episodeNumber: String(el.episode_number),\r\n        })),\r\n      pagination: { page, page_limit, total },\r\n    };\r\n  };\r\n\r\n  /**\r\n   * Get watchlist by playlistId\r\n   */\r\n  getMediaByWatchlist = async ({\r\n    playlistId,\r\n    mediaIds,\r\n    token,\r\n    language,\r\n  }: {\r\n    playlistId: string;\r\n    mediaIds: string[];\r\n    token?: string;\r\n    language?: string;\r\n  }): Promise<PlaylistItem[] | undefined> => {\r\n    if (!mediaIds?.length) {\r\n      return [];\r\n    }\r\n\r\n    const pathname = `/apps/watchlists/${playlistId}`;\r\n    const url = createURL(`${env.APP_API_BASE_URL}${pathname}`, { token, media_ids: mediaIds });\r\n    const response = await fetch(url);\r\n    const data = (await getDataOrThrow(response)) as Playlist;\r\n\r\n    if (!data) throw new Error(`The data was not found using the watchlist ${playlistId}`);\r\n\r\n    return (data.playlist || []).map((item) => this.transformMediaItem({ item, language }));\r\n  };\r\n\r\n  /**\r\n   * Get media by id\r\n   */\r\n  getMediaById = async ({\r\n    id,\r\n    token,\r\n    drmPolicyId,\r\n    language,\r\n  }: {\r\n    id: string;\r\n    token?: string;\r\n    drmPolicyId?: string;\r\n    language?: string;\r\n  }): Promise<PlaylistItem | undefined> => {\r\n    const pathname = drmPolicyId ? `/v2/media/${id}/drm/${drmPolicyId}` : `/v2/media/${id}`;\r\n    const url = createURL(`${env.APP_API_BASE_URL}${pathname}`, { token });\r\n    const response = await fetch(url);\r\n    const data = (await getDataOrThrow(response)) as Playlist;\r\n    const mediaItem = data.playlist[0];\r\n\r\n    if (!mediaItem) throw new Error('MediaItem not found');\r\n\r\n    return this.transformMediaItem({ item: mediaItem, language });\r\n  };\r\n\r\n  /**\r\n   * Get media by id with passport\r\n   */\r\n  getMediaByIdWithPassport = async ({\r\n    id,\r\n    siteId,\r\n    planId,\r\n    passport,\r\n    language,\r\n  }: {\r\n    id: string;\r\n    siteId: string;\r\n    planId: string;\r\n    passport: string;\r\n    language?: string;\r\n  }): Promise<PlaylistItem | undefined> => {\r\n    const pathname = `/v2/sites/${siteId}/media/${id}/playback.json`;\r\n    const url = createURL(`${env.APP_API_BASE_URL}${pathname}`, { passport, plan_id: planId });\r\n    const response = await fetch(url);\r\n    const data = (await getDataOrThrow(response)) as Playlist;\r\n    const mediaItem = data.playlist[0];\r\n\r\n    if (!mediaItem) throw new Error('MediaItem not found');\r\n\r\n    return this.transformMediaItem({ item: mediaItem, language });\r\n  };\r\n\r\n  /**\r\n   * Get series by id\r\n   * @param {string} id\r\n   * @param params\r\n   */\r\n  getSeries = async (id: string, params: GetSeriesParams = {}): Promise<Series | undefined> => {\r\n    if (!id) {\r\n      throw new Error('Series ID is required');\r\n    }\r\n\r\n    const pathname = `/apps/series/${id}`;\r\n    const url = createURL(`${env.APP_API_BASE_URL}${pathname}`, params);\r\n    const response = await fetch(url);\r\n\r\n    return (await getDataOrThrow(response)) as Series;\r\n  };\r\n\r\n  /**\r\n   * Get all series for the given media_ids\r\n   */\r\n  getSeriesByMediaIds = async (mediaIds: string[]): Promise<Record<string, EpisodeInSeries[]> | undefined> => {\r\n    const pathname = `/apps/series`;\r\n    const url = `${env.APP_API_BASE_URL}${pathname}?media_ids=${mediaIds.join(',')}`;\r\n    const response = await fetch(url);\r\n\r\n    return (await getDataOrThrow(response)) as Record<string, EpisodeInSeries[]>;\r\n  };\r\n\r\n  /**\r\n   * Get all episodes of the selected series (when no particular season is selected or when episodes are attached to series)\r\n   */\r\n  getEpisodes = async ({\r\n    seriesId,\r\n    pageOffset,\r\n    pageLimit = PAGE_LIMIT,\r\n    afterId,\r\n    language,\r\n  }: {\r\n    seriesId: string | undefined;\r\n    pageOffset?: number;\r\n    pageLimit?: number;\r\n    afterId?: string;\r\n    language?: string;\r\n  }): Promise<EpisodesWithPagination> => {\r\n    if (!seriesId) {\r\n      throw new Error('Series ID is required');\r\n    }\r\n\r\n    const pathname = `/apps/series/${seriesId}/episodes`;\r\n    const url = createURL(`${env.APP_API_BASE_URL}${pathname}`, {\r\n      page_offset: pageOffset,\r\n      page_limit: pageLimit,\r\n      after_id: afterId,\r\n    });\r\n\r\n    const response = await fetch(url);\r\n    const episodesResponse = (await getDataOrThrow(response)) as EpisodesRes;\r\n\r\n    return this.transformEpisodes(episodesResponse, language);\r\n  };\r\n\r\n  /**\r\n   * Get season of the selected series\r\n   */\r\n  getSeasonWithEpisodes = async ({\r\n    seriesId,\r\n    seasonNumber,\r\n    pageOffset,\r\n    pageLimit = PAGE_LIMIT,\r\n    language,\r\n  }: {\r\n    seriesId: string | undefined;\r\n    language: string;\r\n    seasonNumber: number;\r\n    pageOffset?: number;\r\n    pageLimit?: number;\r\n  }): Promise<EpisodesWithPagination> => {\r\n    if (!seriesId) {\r\n      throw new Error('Series ID is required');\r\n    }\r\n\r\n    const pathname = `/apps/series/${seriesId}/seasons/${seasonNumber}/episodes`;\r\n    const url = createURL(`${env.APP_API_BASE_URL}${pathname}`, { page_offset: pageOffset, page_limit: pageLimit });\r\n\r\n    const response = await fetch(url);\r\n    const episodesRes = (await getDataOrThrow(response)) as EpisodesRes;\r\n\r\n    return this.transformEpisodes(episodesRes, language, seasonNumber);\r\n  };\r\n\r\n  getAdSchedule = async (id: string | undefined | null): Promise<AdSchedule | undefined> => {\r\n    if (!id) {\r\n      throw new Error('Ad Schedule ID is required');\r\n    }\r\n\r\n    const url = env.APP_API_BASE_URL + `/v2/advertising/schedules/${id}.json`;\r\n    const response = await fetch(url, { credentials: 'omit' });\r\n\r\n    return (await getDataOrThrow(response)) as AdSchedule;\r\n  };\r\n\r\n  /**\r\n   * Get playlist by id\r\n   */\r\n  getPlaylistById = async (id?: string, params: GetPlaylistParams = {}, language: string = env.APP_DEFAULT_LANGUAGE): Promise<Playlist | undefined> => {\r\n    if (!id) {\r\n      return undefined;\r\n    }\r\n\r\n    const pathname = `/v2/playlists/${id}`;\r\n    const url = createURL(`${env.APP_API_BASE_URL}${pathname}`, params);\r\n    const response = await fetch(url);\r\n    const data = (await getDataOrThrow(response)) as Playlist;\r\n\r\n    return this.transformPlaylist(data, params.related_media_id, language);\r\n  };\r\n\r\n  getContentList = async ({ id, siteId, language }: { id: string | undefined; siteId: string; language: string }): Promise<Playlist | undefined> => {\r\n    if (!id || !siteId) {\r\n      throw new Error('List ID and Site ID are required');\r\n    }\r\n\r\n    const pathname = `/v2/sites/${siteId}/content_lists/${id}`;\r\n    const url = createURL(`${env.APP_API_BASE_URL}${pathname}`, {});\r\n    const response = await fetch(url);\r\n    const data = (await getDataOrThrow(response)) as ContentList;\r\n\r\n    return this.transformContentList(data, language);\r\n  };\r\n\r\n  getContentSearch = async ({ siteId, params }: { siteId: string; params: GetContentSearchParams }) => {\r\n    const pathname = `/v2/sites/${siteId}/app_content/media/search`;\r\n\r\n    const url = createURL(`${env.APP_API_BASE_URL}${pathname}`, {\r\n      search_query: params.searchTerm,\r\n    });\r\n\r\n    const response = await fetch(url);\r\n    const data = (await getDataOrThrow(response)) as Playlist;\r\n\r\n    return this.transformPlaylist(data);\r\n  };\r\n}\r\n","export default abstract class StorageService {\r\n  abstract initialize(prefix: string): void;\r\n\r\n  abstract getItem<T>(key: string, parse: boolean, usePrefix?: boolean): Promise<T | null>;\r\n\r\n  abstract setItem(key: string, value: string, usePrefix?: boolean): Promise<void>;\r\n\r\n  abstract removeItem(key: string): Promise<void>;\r\n\r\n  abstract base64Decode(input: string): string;\r\n\r\n  abstract base64Encode(input: string): string;\r\n}\r\n","import type { AccessModel, Config } from '../../../types/config';\r\nimport type {\r\n  ChangePassword,\r\n  ChangePasswordWithOldPassword,\r\n  DeleteAccount,\r\n  ExportAccountData,\r\n  GetCaptureStatus,\r\n  GetCustomerConsents,\r\n  GetPublisherConsents,\r\n  Login,\r\n  NotificationsData,\r\n  Register,\r\n  ResetPassword,\r\n  GetSocialURLs,\r\n  UpdateCaptureAnswers,\r\n  UpdateCustomerConsents,\r\n  Logout,\r\n  GetAuthData,\r\n  UpdateCustomer,\r\n  UpdateWatchHistory,\r\n  UpdateFavorites,\r\n  GetWatchHistory,\r\n  GetFavorites,\r\n  GetUser,\r\n} from '../../../types/account';\r\n\r\nexport type AccountServiceFeatures = {\r\n  readonly canUpdateEmail: boolean;\r\n  readonly canSupportEmptyFullName: boolean;\r\n  readonly canChangePasswordWithOldPassword: boolean;\r\n  readonly canRenewSubscription: boolean;\r\n  readonly canExportAccountData: boolean;\r\n  readonly canDeleteAccount: boolean;\r\n  readonly canUpdatePaymentMethod: boolean;\r\n  readonly canShowReceipts: boolean;\r\n  readonly hasSocialURLs: boolean;\r\n  readonly hasNotifications: boolean;\r\n  readonly watchListSizeLimit: number;\r\n};\r\n\r\nexport default abstract class AccountService {\r\n  readonly features: AccountServiceFeatures;\r\n\r\n  abstract accessModel: AccessModel;\r\n  abstract svodOfferIds: string[];\r\n  abstract sandbox: boolean;\r\n\r\n  protected constructor(features: AccountServiceFeatures) {\r\n    this.features = features;\r\n  }\r\n\r\n  abstract initialize: (config: Config, url: string, logoutCallback: () => Promise<void>) => Promise<void>;\r\n\r\n  abstract getAuthData: GetAuthData;\r\n\r\n  abstract login: Login;\r\n\r\n  abstract register: Register;\r\n\r\n  abstract logout: Logout;\r\n\r\n  abstract getUser: GetUser;\r\n\r\n  abstract getPublisherConsents: GetPublisherConsents;\r\n\r\n  abstract getCustomerConsents: GetCustomerConsents;\r\n\r\n  abstract updateCustomerConsents: UpdateCustomerConsents;\r\n\r\n  abstract getCaptureStatus: GetCaptureStatus;\r\n\r\n  abstract updateCaptureAnswers: UpdateCaptureAnswers;\r\n\r\n  abstract resetPassword: ResetPassword;\r\n\r\n  abstract changePasswordWithResetToken: ChangePassword;\r\n\r\n  abstract changePasswordWithOldPassword: ChangePasswordWithOldPassword;\r\n\r\n  abstract updateCustomer: UpdateCustomer;\r\n\r\n  abstract updateWatchHistory: UpdateWatchHistory;\r\n\r\n  abstract updateFavorites: UpdateFavorites;\r\n\r\n  abstract getWatchHistory: GetWatchHistory;\r\n\r\n  abstract getFavorites: GetFavorites;\r\n\r\n  abstract subscribeToNotifications: NotificationsData;\r\n\r\n  abstract getSocialUrls?: GetSocialURLs;\r\n\r\n  abstract exportAccountData?: ExportAccountData;\r\n\r\n  abstract deleteAccount?: DeleteAccount;\r\n}\r\n","import { inject, injectable } from 'inversify';\r\nimport { array, number, object, string } from 'yup';\r\n\r\nimport type { PlaylistItem } from '../../types/playlist';\r\nimport type { SerializedWatchHistoryItem, WatchHistoryItem } from '../../types/watchHistory';\r\nimport type { Customer } from '../../types/account';\r\nimport { getNamedModule } from '../modules/container';\r\nimport { INTEGRATION_TYPE } from '../modules/types';\r\nimport { MAX_WATCHLIST_ITEMS_COUNT } from '../constants';\r\nimport { logError } from '../logger';\r\n\r\nimport ApiService from './ApiService';\r\nimport StorageService from './StorageService';\r\nimport AccountService from './integrations/AccountService';\r\n\r\nconst schema = array(\r\n  object().shape({\r\n    mediaid: string(),\r\n    progress: number(),\r\n  }),\r\n);\r\n\r\n@injectable()\r\nexport default class WatchHistoryService {\r\n  protected PERSIST_KEY_WATCH_HISTORY = 'history';\r\n\r\n  protected readonly apiService;\r\n  protected readonly storageService;\r\n  protected readonly accountService;\r\n\r\n  constructor(\r\n    @inject(INTEGRATION_TYPE) integrationType: string,\r\n    @inject(ApiService) apiService: ApiService,\r\n    @inject(StorageService) storageService: StorageService,\r\n  ) {\r\n    this.apiService = apiService;\r\n    this.storageService = storageService;\r\n    this.accountService = getNamedModule(AccountService, integrationType);\r\n  }\r\n\r\n  // Retrieve watch history media items info using a provided watch list\r\n  protected getWatchHistoryItems = async (continueWatchingList: string, ids: string[], language?: string): Promise<Record<string, PlaylistItem>> => {\r\n    const watchHistoryItems = await this.apiService.getMediaByWatchlist({ playlistId: continueWatchingList, mediaIds: ids, language });\r\n    const watchHistoryItemsDict = Object.fromEntries((watchHistoryItems || []).map((item) => [item.mediaid, item]));\r\n\r\n    return watchHistoryItemsDict;\r\n  };\r\n\r\n  // We store separate episodes in the watch history and to show series card in the Continue Watching shelf we need to get their parent media items\r\n  protected getWatchHistorySeriesItems = async (\r\n    continueWatchingList: string,\r\n    ids: string[],\r\n    language?: string,\r\n  ): Promise<Record<string, PlaylistItem | undefined>> => {\r\n    const mediaWithSeries = await this.apiService.getSeriesByMediaIds(ids);\r\n    const seriesIds = Object.keys(mediaWithSeries || {})\r\n      .map((key) => mediaWithSeries?.[key]?.[0]?.series_id)\r\n      .filter(Boolean) as string[];\r\n    const uniqueSerieIds = [...new Set(seriesIds)];\r\n    const seriesItems = await this.apiService.getMediaByWatchlist({ playlistId: continueWatchingList, mediaIds: uniqueSerieIds, language });\r\n    const seriesItemsDict = Object.keys(mediaWithSeries || {}).reduce((acc, key) => {\r\n      const seriesItemId = mediaWithSeries?.[key]?.[0]?.series_id;\r\n      if (seriesItemId) {\r\n        acc[key] = seriesItems?.find((el) => el.mediaid === seriesItemId);\r\n      }\r\n      return acc;\r\n    }, {} as Record<string, PlaylistItem | undefined>);\r\n\r\n    return seriesItemsDict;\r\n  };\r\n\r\n  protected validateWatchHistory(history: unknown) {\r\n    if (history && schema.validateSync(history)) {\r\n      return history as SerializedWatchHistoryItem[];\r\n    }\r\n\r\n    return [];\r\n  }\r\n\r\n  protected async getWatchHistoryFromAccount(user: Customer) {\r\n    const history = await this.accountService.getWatchHistory({ user });\r\n\r\n    return this.validateWatchHistory(history);\r\n  }\r\n\r\n  protected async getWatchHistoryFromStorage() {\r\n    const history = await this.storageService.getItem(this.PERSIST_KEY_WATCH_HISTORY, true);\r\n\r\n    return this.validateWatchHistory(history);\r\n  }\r\n\r\n  getWatchHistory = async (user: Customer | null, continueWatchingList: string, language?: string) => {\r\n    const savedItems = user ? await this.getWatchHistoryFromAccount(user) : await this.getWatchHistoryFromStorage();\r\n\r\n    // When item is an episode of the new flow -> show the card as a series one, but keep episode to redirect in a right way\r\n    const ids = savedItems.map(({ mediaid }) => mediaid);\r\n\r\n    if (!ids.length) {\r\n      return [];\r\n    }\r\n\r\n    try {\r\n      const watchHistoryItems = await this.getWatchHistoryItems(continueWatchingList, ids, language);\r\n      const seriesItems = await this.getWatchHistorySeriesItems(continueWatchingList, ids, language);\r\n\r\n      return savedItems\r\n        .map((item) => {\r\n          const parentSeries = seriesItems?.[item.mediaid];\r\n          const historyItem = watchHistoryItems[item.mediaid];\r\n\r\n          if (historyItem) {\r\n            return this.createWatchHistoryItem(parentSeries || historyItem, item.mediaid, parentSeries?.mediaid, item.progress);\r\n          }\r\n        })\r\n        .filter((item): item is WatchHistoryItem => Boolean(item));\r\n    } catch (error: unknown) {\r\n      logError('WatchHistoryService', 'Failed to get watch history items', { error });\r\n    }\r\n\r\n    return [];\r\n  };\r\n\r\n  serializeWatchHistory = (watchHistory: WatchHistoryItem[]): SerializedWatchHistoryItem[] =>\r\n    watchHistory.map(({ mediaid, progress }) => ({\r\n      mediaid,\r\n      progress,\r\n    }));\r\n\r\n  persistWatchHistory = async (watchHistory: WatchHistoryItem[], user: Customer | null) => {\r\n    if (user) {\r\n      await this.accountService?.updateWatchHistory({\r\n        history: this.serializeWatchHistory(watchHistory),\r\n        user,\r\n      });\r\n    } else {\r\n      await this.storageService.setItem(this.PERSIST_KEY_WATCH_HISTORY, JSON.stringify(this.serializeWatchHistory(watchHistory)));\r\n    }\r\n  };\r\n\r\n  /** Use mediaid of originally watched movie / episode.\r\n   * A playlistItem can be either a series item (to show series card) or media item\r\n   * */\r\n  createWatchHistoryItem = (item: PlaylistItem, mediaid: string, seriesId: string | undefined, videoProgress: number): WatchHistoryItem => {\r\n    return {\r\n      mediaid,\r\n      seriesId,\r\n      title: item.title,\r\n      tags: item.tags,\r\n      duration: item.duration,\r\n      progress: videoProgress,\r\n      playlistItem: item,\r\n    } as WatchHistoryItem;\r\n  };\r\n\r\n  getMaxWatchHistoryCount = () => {\r\n    return this.accountService?.features?.watchListSizeLimit || MAX_WATCHLIST_ITEMS_COUNT;\r\n  };\r\n\r\n  /**\r\n   *  If we already have an element with continue watching state, we:\r\n   *    1. Update the progress\r\n   *    2. Move the element to the continue watching list start\r\n   *  Otherwise:\r\n   *    1. Move the element to the continue watching list start\r\n   *    2. If there are many elements in continue watching state we remove the oldest one\r\n   */\r\n  saveItem = async (item: PlaylistItem, seriesItem: PlaylistItem | undefined, videoProgress: number | null, watchHistory: WatchHistoryItem[]) => {\r\n    if (!videoProgress) return;\r\n\r\n    const watchHistoryItem = this.createWatchHistoryItem(seriesItem || item, item.mediaid, seriesItem?.mediaid, videoProgress);\r\n    // filter out the existing watch history item, so we can add it to the beginning of the list\r\n    const updatedHistory = watchHistory.filter(({ mediaid, seriesId }) => {\r\n      return mediaid !== watchHistoryItem.mediaid && (!seriesId || seriesId !== watchHistoryItem.seriesId);\r\n    });\r\n\r\n    updatedHistory.unshift(watchHistoryItem);\r\n    updatedHistory.splice(this.getMaxWatchHistoryCount());\r\n\r\n    return updatedHistory;\r\n  };\r\n}\r\n","import { injectable } from 'inversify';\r\n\r\nimport type { GetMediaParams } from '../../types/media';\r\nimport type { GetTokenResponse } from '../../types/entitlement';\r\n\r\n@injectable()\r\nexport default class GenericEntitlementService {\r\n  protected getToken = async <T>(url: string, body: unknown = {}, jwt?: string): Promise<T> => {\r\n    const response = await fetch(url, {\r\n      method: 'POST',\r\n      headers: {\r\n        Authorization: jwt ? `Bearer ${jwt}` : '',\r\n      },\r\n      body: JSON.stringify(body),\r\n    });\r\n\r\n    return (await response.json()) as T;\r\n  };\r\n\r\n  getMediaToken = async (host: string, id: string, jwt?: string, params?: GetMediaParams, drmPolicyId?: string) => {\r\n    const data = await this.getToken<GetTokenResponse>(`${host}/media/${id}/sign${drmPolicyId ? `/drm/${drmPolicyId}` : ''}`, params, jwt);\r\n\r\n    if (!data.entitled) throw new Error('Unauthorized');\r\n\r\n    return data.token;\r\n  };\r\n}\r\n","import { inject, injectable } from 'inversify';\r\n\r\nimport StorageService from '../../StorageService';\r\n\r\nimport type { JWPError } from './types';\r\n\r\nconst INPLAYER_TOKEN_KEY = 'inplayer_token';\r\nconst INPLAYER_IOT_KEY = 'inplayer_iot';\r\n\r\nconst CONTENT_TYPES = {\r\n  json: 'application/json',\r\n  form: 'application/x-www-form-urlencoded',\r\n};\r\n\r\ntype RequestOptions = {\r\n  withAuthentication?: boolean;\r\n  keepalive?: boolean;\r\n  contentType?: keyof typeof CONTENT_TYPES;\r\n  responseType?: 'json' | 'blob';\r\n  includeFullResponse?: boolean;\r\n};\r\n\r\n@injectable()\r\nexport default class JWPAPIService {\r\n  protected readonly storageService: StorageService;\r\n\r\n  protected useSandboxEnv = true;\r\n\r\n  constructor(@inject(StorageService) storageService: StorageService) {\r\n    this.storageService = storageService;\r\n  }\r\n\r\n  setup = (useSandboxEnv: boolean) => {\r\n    this.useSandboxEnv = useSandboxEnv;\r\n  };\r\n\r\n  private getBaseUrl = () => (this.useSandboxEnv ? 'https://staging-sims.jwplayer.com' : 'https://sims.jwplayer.com');\r\n\r\n  setToken = (token: string, refreshToken = '', expires: number) => {\r\n    return this.storageService.setItem(INPLAYER_TOKEN_KEY, JSON.stringify({ token, refreshToken, expires }), false);\r\n  };\r\n\r\n  getToken = async () => {\r\n    const tokenObject = await this.storageService.getItem(INPLAYER_TOKEN_KEY, true, false);\r\n\r\n    if (tokenObject) {\r\n      return tokenObject as { token: string; refreshToken: string; expires: number };\r\n    }\r\n\r\n    return { token: '', refreshToken: '', expires: 0 };\r\n  };\r\n\r\n  removeToken = async () => {\r\n    await Promise.all([this.storageService.removeItem(INPLAYER_TOKEN_KEY), this.storageService.removeItem(INPLAYER_IOT_KEY)]);\r\n  };\r\n\r\n  isAuthenticated = async () => {\r\n    const tokenObject = await this.getToken();\r\n\r\n    return !!tokenObject.token && tokenObject.expires > Date.now() / 1000;\r\n  };\r\n\r\n  private performRequest = async (\r\n    path: string = '/',\r\n    method = 'GET',\r\n    body?: Record<string, unknown>,\r\n    { contentType = 'form', responseType = 'json', withAuthentication = false, keepalive, includeFullResponse = false }: RequestOptions = {},\r\n    searchParams?: Record<string, string | number>,\r\n  ) => {\r\n    const headers: Record<string, string> = {\r\n      'Content-Type': CONTENT_TYPES[contentType],\r\n    };\r\n\r\n    if (withAuthentication) {\r\n      const tokenObject = await this.getToken();\r\n\r\n      if (tokenObject.token) {\r\n        headers.Authorization = `Bearer ${tokenObject.token}`;\r\n      }\r\n    }\r\n\r\n    const formData = new URLSearchParams();\r\n\r\n    if (body) {\r\n      Object.entries(body).forEach(([key, value]) => {\r\n        if (value || value === 0) {\r\n          if (typeof value === 'object') {\r\n            Object.entries(value as Record<string, string | number>).forEach(([innerKey, innerValue]) => {\r\n              formData.append(`${key}[${innerKey}]`, innerValue.toString());\r\n            });\r\n          } else {\r\n            formData.append(key, value.toString());\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    const endpoint = `${path.startsWith('http') ? path : `${this.getBaseUrl()}${path}`}${\r\n      searchParams ? `?${new URLSearchParams(searchParams as Record<string, string>).toString()}` : ''\r\n    }`;\r\n\r\n    const resp = await fetch(endpoint, {\r\n      headers,\r\n      keepalive,\r\n      method,\r\n      body: body && formData.toString(),\r\n    });\r\n\r\n    const resParsed = await resp[responseType]?.();\r\n\r\n    if (!resp.ok) {\r\n      throw { response: { data: resParsed } };\r\n    }\r\n\r\n    if (includeFullResponse) {\r\n      return { ...resp, data: resParsed };\r\n    }\r\n\r\n    return resParsed;\r\n  };\r\n\r\n  get = <T>(path: string, options?: RequestOptions, searchParams?: Record<string, string | number>) =>\r\n    this.performRequest(path, 'GET', undefined, options, searchParams) as Promise<T>;\r\n\r\n  patch = <T>(path: string, body?: Record<string, unknown>, options?: RequestOptions) => this.performRequest(path, 'PATCH', body, options) as Promise<T>;\r\n\r\n  put = <T>(path: string, body?: Record<string, unknown>, options?: RequestOptions) => this.performRequest(path, 'PUT', body, options) as Promise<T>;\r\n\r\n  post = <T>(path: string, body?: Record<string, unknown>, options?: RequestOptions) => this.performRequest(path, 'POST', body, options) as Promise<T>;\r\n\r\n  remove = <T>(path: string, options?: RequestOptions, body?: Record<string, unknown>) => this.performRequest(path, 'DELETE', body, options) as Promise<T>;\r\n\r\n  static isCommonError = (error: unknown): error is JWPError => {\r\n    return (\r\n      typeof error === 'object' &&\r\n      error !== null &&\r\n      'response' in error &&\r\n      typeof (error as JWPError).response?.data?.code === 'number' &&\r\n      typeof (error as JWPError).response?.data?.message === 'string'\r\n    );\r\n  };\r\n}\r\n","import { inject, injectable } from 'inversify';\r\n\r\nimport type { GetEntitledPlans } from '../../types/checkout';\r\nimport type { PlansResponse } from '../../types/plans';\r\n\r\nimport type { SignedMediaResponse } from './integrations/jwp/types';\r\nimport JWPAPIService from './integrations/jwp/JWPAPIService';\r\n\r\n@injectable()\r\nexport default class JWPEntitlementService {\r\n  protected readonly apiService;\r\n\r\n  constructor(@inject(JWPAPIService) apiService: JWPAPIService) {\r\n    this.apiService = apiService;\r\n  }\r\n\r\n  getJWPMediaToken = async (configId: string = '', mediaId: string) => {\r\n    try {\r\n      const data = await this.apiService.get<SignedMediaResponse>(\r\n        '/v2/items/jw-media/token',\r\n        {\r\n          withAuthentication: true,\r\n        },\r\n        {\r\n          app_config_id: configId,\r\n          media_id: mediaId,\r\n        },\r\n      );\r\n\r\n      return data.token;\r\n    } catch {\r\n      throw new Error('Unauthorized');\r\n    }\r\n  };\r\n\r\n  getEntitledPlans: GetEntitledPlans = async ({ siteId }) => {\r\n    try {\r\n      const data = await this.apiService.get<PlansResponse>(`/v3/sites/${siteId}/entitlements`, {\r\n        withAuthentication: await this.apiService.isAuthenticated(),\r\n      });\r\n      return data;\r\n    } catch {\r\n      throw new Error('Failed to fetch entitled plans');\r\n    }\r\n  };\r\n}\r\n","import { inject, injectable } from 'inversify';\r\nimport { array, object, string } from 'yup';\r\n\r\nimport type { Favorite, SerializedFavorite } from '../../types/favorite';\r\nimport type { PlaylistItem } from '../../types/playlist';\r\nimport type { Customer } from '../../types/account';\r\nimport { getNamedModule } from '../modules/container';\r\nimport { INTEGRATION_TYPE } from '../modules/types';\r\nimport { MAX_WATCHLIST_ITEMS_COUNT } from '../constants';\r\nimport { logError } from '../logger';\r\n\r\nimport ApiService from './ApiService';\r\nimport StorageService from './StorageService';\r\nimport AccountService from './integrations/AccountService';\r\n\r\nconst schema = array(\r\n  object().shape({\r\n    mediaid: string(),\r\n  }),\r\n);\r\n\r\n@injectable()\r\nexport default class FavoriteService {\r\n  private PERSIST_KEY_FAVORITES = 'favorites';\r\n\r\n  protected readonly apiService;\r\n  protected readonly storageService;\r\n  protected readonly accountService;\r\n\r\n  constructor(\r\n    @inject(INTEGRATION_TYPE) integrationType: string,\r\n    @inject(ApiService) apiService: ApiService,\r\n    @inject(StorageService) storageService: StorageService,\r\n  ) {\r\n    this.apiService = apiService;\r\n    this.storageService = storageService;\r\n    this.accountService = getNamedModule(AccountService, integrationType, false);\r\n  }\r\n\r\n  protected validateFavorites(favorites: unknown) {\r\n    if (favorites && schema.validateSync(favorites)) {\r\n      return favorites as SerializedFavorite[];\r\n    }\r\n\r\n    return [];\r\n  }\r\n\r\n  protected async getFavoritesFromAccount(user: Customer) {\r\n    const favorites = await this.accountService?.getFavorites({ user });\r\n\r\n    return this.validateFavorites(favorites);\r\n  }\r\n\r\n  protected async getFavoritesFromStorage() {\r\n    const favorites = await this.storageService.getItem(this.PERSIST_KEY_FAVORITES, true);\r\n\r\n    return this.validateFavorites(favorites);\r\n  }\r\n\r\n  getFavorites = async (user: Customer | null, favoritesList: string, language?: string) => {\r\n    const savedItems = user ? await this.getFavoritesFromAccount(user) : await this.getFavoritesFromStorage();\r\n    const mediaIds = savedItems.map(({ mediaid }) => mediaid);\r\n\r\n    if (!mediaIds) {\r\n      return [];\r\n    }\r\n\r\n    try {\r\n      const playlistItems = await this.apiService.getMediaByWatchlist({ playlistId: favoritesList, mediaIds, language });\r\n\r\n      return (playlistItems || []).map((item) => this.createFavorite(item));\r\n    } catch (error: unknown) {\r\n      logError('FavoriteService', 'Failed to get favorites', { error });\r\n    }\r\n\r\n    return [];\r\n  };\r\n\r\n  serializeFavorites = (favorites: Favorite[]): SerializedFavorite[] => {\r\n    return favorites.map(({ mediaid }) => ({ mediaid }));\r\n  };\r\n\r\n  persistFavorites = async (favorites: Favorite[], user: Customer | null) => {\r\n    if (user) {\r\n      return this.accountService?.updateFavorites({\r\n        favorites: this.serializeFavorites(favorites),\r\n        user,\r\n      });\r\n    } else {\r\n      await this.storageService.setItem(this.PERSIST_KEY_FAVORITES, JSON.stringify(this.serializeFavorites(favorites)));\r\n    }\r\n  };\r\n\r\n  getMaxFavoritesCount = () => {\r\n    return this.accountService?.features?.watchListSizeLimit || MAX_WATCHLIST_ITEMS_COUNT;\r\n  };\r\n\r\n  createFavorite = (item: PlaylistItem): Favorite => {\r\n    return {\r\n      mediaid: item.mediaid,\r\n      title: item.title,\r\n      tags: item.tags,\r\n      duration: item.duration,\r\n      playlistItem: item,\r\n    } as Favorite;\r\n  };\r\n}\r\n","import { array, boolean, mixed, number, object, type SchemaOf, string, StringSchema } from 'yup';\r\n\r\nimport type { Cleeng, Config, Content, Features, JWP, Menu, Styling } from '../../types/config';\r\n\r\nconst contentSchema: SchemaOf<Content> = object({\r\n  contentId: string().notRequired(),\r\n  title: string().notRequired(),\r\n  featured: boolean().notRequired(),\r\n  backgroundColor: string().nullable().notRequired(),\r\n  type: mixed().oneOf(['playlist', 'continue_watching', 'favorites', 'content_list']),\r\n  custom: object().notRequired(),\r\n}).defined();\r\n\r\nconst menuSchema: SchemaOf<Menu> = object().shape({\r\n  label: string().defined(),\r\n  contentId: string().defined(),\r\n  filterTags: string().notRequired(),\r\n  type: mixed().oneOf(['playlist', 'content_list', 'media']).notRequired(),\r\n  custom: object().notRequired(),\r\n});\r\n\r\nconst featuresSchema: SchemaOf<Features> = object({\r\n  recommendationsPlaylist: string().nullable(),\r\n  searchPlaylist: string().nullable(),\r\n  continueWatchingList: string().nullable(),\r\n  favoritesList: string().nullable(),\r\n});\r\n\r\nconst cleengSchema: SchemaOf<Cleeng> = object({\r\n  id: string().nullable(),\r\n  monthlyOffer: string().nullable(),\r\n  yearlyOffer: string().nullable(),\r\n  useSandbox: boolean().default(true),\r\n});\r\n\r\nconst jwpSchema: SchemaOf<JWP> = object({\r\n  clientId: string().nullable(),\r\n  assetId: number().nullable(),\r\n  useSandbox: boolean().default(true),\r\n});\r\n\r\nconst stylingSchema: SchemaOf<Styling> = object({\r\n  backgroundColor: string().nullable(),\r\n  highlightColor: string().nullable(),\r\n  headerBackground: string().nullable(),\r\n  footerText: string().nullable(),\r\n});\r\n\r\nexport const configSchema: SchemaOf<Config> = object({\r\n  id: string().notRequired(),\r\n  siteName: string().notRequired(),\r\n  description: string().defined(),\r\n  analyticsToken: string().nullable(),\r\n  adSchedule: string().nullable(),\r\n  adDeliveryMethod: mixed().oneOf(['csai', 'ssai']).notRequired(),\r\n  adConfig: string().nullable(),\r\n  siteId: string().defined(),\r\n  assets: object({\r\n    banner: string().notRequired().nullable(),\r\n  }).notRequired(),\r\n  content: array().of(contentSchema),\r\n  menu: array().of(menuSchema),\r\n  styling: stylingSchema.notRequired(),\r\n  features: featuresSchema.notRequired(),\r\n  integrations: object({\r\n    cleeng: cleengSchema.notRequired(),\r\n    jwp: jwpSchema.notRequired(),\r\n  }).notRequired(),\r\n  adScheduleUrls: object({\r\n    json: string().notRequired().nullable(),\r\n    xml: string().notRequired().nullable(),\r\n  }).notRequired(),\r\n  custom: object().notRequired(),\r\n  contentSigningService: object().shape({\r\n    // see {@link https://github.com/jquense/yup/issues/1367}\r\n    host: string().required() as StringSchema<string>,\r\n    drmPolicyId: string().notRequired(),\r\n  }),\r\n  contentProtection: object()\r\n    .shape({\r\n      accessModel: string().oneOf(['free', 'freeauth', 'authvod', 'svod']).notRequired(),\r\n      drm: object({\r\n        defaultPolicyId: string(),\r\n      }).notRequired(),\r\n    })\r\n    .notRequired(),\r\n}).defined();\r\n","type Payload = {\r\n  title: string;\r\n  description: string;\r\n  helpLink: string;\r\n};\r\n\r\nexport class AppError extends Error {\r\n  payload: Payload;\r\n\r\n  constructor(message: string, payload: Payload) {\r\n    super(message);\r\n    this.name = 'AppError';\r\n    this.payload = payload;\r\n  }\r\n}\r\n","import i18next from 'i18next';\r\nimport { injectable } from 'inversify';\r\nimport { getI18n } from 'react-i18next';\r\n\r\nimport { configSchema } from '../utils/configSchema';\r\nimport { AppError } from '../utils/error';\r\nimport type { Config } from '../../types/config';\r\nimport env from '../env';\r\n\r\n/**\r\n * Set config setup changes in both config.service.ts and config.d.ts\r\n * */\r\n\r\n@injectable()\r\nexport default class ConfigService {\r\n  protected CONFIG_HOST = env.APP_API_BASE_URL;\r\n  // Explicitly set default config here as a local variable,\r\n  // otherwise if it's a module level const, the merge below causes changes to nested properties\r\n  protected DEFAULT_CONFIG: Config = {\r\n    id: '',\r\n    siteName: '',\r\n    description: '',\r\n    siteId: '',\r\n    assets: {\r\n      banner: '/images/logo.png',\r\n    },\r\n    content: [],\r\n    menu: [],\r\n    integrations: {},\r\n    styling: {\r\n      footerText: '',\r\n    },\r\n    features: {},\r\n  };\r\n\r\n  protected enrichConfig = (config: Config): Config => {\r\n    const { content, siteName } = config;\r\n    const updatedContent = content.map((content) => Object.assign({ featured: false }, content));\r\n\r\n    return { ...config, siteName: siteName || i18next.t('common:default_site_name'), content: updatedContent };\r\n  };\r\n\r\n  getDefaultConfig = (): Config => {\r\n    return this.DEFAULT_CONFIG;\r\n  };\r\n\r\n  validateConfig = (config?: Config): Promise<Config> => {\r\n    return configSchema.validate(config, {\r\n      strict: true,\r\n    }) as Promise<Config>;\r\n  };\r\n\r\n  formatSourceLocation = (source?: string) => {\r\n    if (!source) {\r\n      return undefined;\r\n    }\r\n\r\n    if (source.match(/^[a-z,\\d]{8}$/)) {\r\n      return `${this.CONFIG_HOST}/apps/configs/${source}.json`;\r\n    }\r\n\r\n    return source;\r\n  };\r\n\r\n  loadConfig = async (configLocation: string | undefined) => {\r\n    const i18n = getI18n();\r\n\r\n    const errorPayload = {\r\n      title: i18n.t('error:config_invalid'),\r\n      description: i18n.t('error:check_your_config'),\r\n      helpLink: 'https://github.com/jwplayer/ott-web-app/blob/develop/docs/configuration.md',\r\n    };\r\n\r\n    if (!configLocation) {\r\n      throw new AppError('No config location found', errorPayload);\r\n    }\r\n\r\n    const response = await fetch(configLocation, {\r\n      headers: {\r\n        Accept: 'application/json',\r\n      },\r\n      method: 'GET',\r\n    }).catch(() => {\r\n      throw new AppError('Failed to load the config', errorPayload);\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new AppError('Failed to load the config', errorPayload);\r\n    }\r\n\r\n    const data = (await response.json()) as Config;\r\n\r\n    if (!data) {\r\n      throw new Error('No config found');\r\n    }\r\n\r\n    return this.enrichConfig(data);\r\n  };\r\n}\r\n","import { inject, injectable } from 'inversify';\r\nimport ini from 'ini';\r\nimport { getI18n } from 'react-i18next';\r\n\r\nimport { CONFIG_FILE_STORAGE_KEY, CONFIG_QUERY_KEY, OTT_GLOBAL_PLAYER_ID } from '../constants';\r\nimport { AppError } from '../utils/error';\r\nimport type { Settings } from '../../types/settings';\r\nimport env from '../env';\r\nimport { logDebug, logWarn } from '../logger';\r\n\r\nimport StorageService from './StorageService';\r\n\r\n@injectable()\r\nexport default class SettingsService {\r\n  protected readonly storageService;\r\n\r\n  constructor(@inject(StorageService) storageService: StorageService) {\r\n    this.storageService = storageService;\r\n  }\r\n\r\n  async getConfigSource(settings: Settings | undefined, url: string) {\r\n    if (!settings) {\r\n      return '';\r\n    }\r\n\r\n    const urlParams = new URLSearchParams(url.split('?')[1]);\r\n    const configKey = urlParams.get(CONFIG_QUERY_KEY);\r\n\r\n    // Skip all the fancy logic below if there aren't any other options besides the default anyhow\r\n    if (!settings.UNSAFE_allowAnyConfigSource && (settings.additionalAllowedConfigSources?.length || 0) <= 0) {\r\n      return settings.defaultConfigSource;\r\n    }\r\n\r\n    if (configKey !== null) {\r\n      // If the query param exists but the value is empty, clear the storage and allow fallback to the default config\r\n      if (!configKey) {\r\n        await this.storageService.removeItem(CONFIG_FILE_STORAGE_KEY);\r\n        return settings.defaultConfigSource;\r\n      }\r\n\r\n      // If it's valid, store it and return it\r\n      if (this.isValidConfigSource(configKey, settings)) {\r\n        await this.storageService.setItem(CONFIG_FILE_STORAGE_KEY, configKey);\r\n        return configKey;\r\n      }\r\n\r\n      logWarn('SettingsService', `Invalid app-config query param: ${configKey}`);\r\n    }\r\n    // Yes this falls through from above to look up the stored value if the query string is invalid and that's OK\r\n\r\n    const storedSource = await this.storageService.getItem(CONFIG_FILE_STORAGE_KEY, false);\r\n\r\n    // Make sure the stored value is still valid before returning it\r\n    if (storedSource && typeof storedSource === 'string') {\r\n      if (this.isValidConfigSource(storedSource, settings)) {\r\n        return storedSource;\r\n      }\r\n\r\n      logWarn('SettingsService', 'Invalid stored config: ' + storedSource);\r\n      await this.storageService.removeItem(CONFIG_FILE_STORAGE_KEY);\r\n    }\r\n\r\n    return settings.defaultConfigSource;\r\n  }\r\n\r\n  isValidConfigSource = (source: string, settings: Settings) => {\r\n    // Dynamic values are valid as long as they are defined\r\n    if (settings?.UNSAFE_allowAnyConfigSource) {\r\n      return !!source;\r\n    }\r\n\r\n    return (\r\n      settings?.defaultConfigSource === source || (settings?.additionalAllowedConfigSources && settings?.additionalAllowedConfigSources.indexOf(source) >= 0)\r\n    );\r\n  };\r\n\r\n  initialize = async () => {\r\n    const settings = await fetch('/.webapp.ini')\r\n      .then((result) => result.text())\r\n      .then((iniString) => ini.parse(iniString) as Settings)\r\n      .catch((error) => {\r\n        logDebug('SettingsService', 'Failed to fetch or parse the ini settings', { error });\r\n        // It's possible to not use the ini settings files, so an error doesn't have to be fatal\r\n        return {} as Settings;\r\n      });\r\n\r\n    const i18n = getI18n();\r\n\r\n    // @TODO: use `i18next.t()`?\r\n    // t('error:settings_invalid')\r\n    // t('error:check_your_settings')\r\n    const errorPayload = {\r\n      title: i18n.t('error:settings_invalid'),\r\n      description: i18n.t('error:check_your_settings'),\r\n      helpLink: 'https://github.com/jwplayer/ott-web-app/blob/develop/docs/initialization-file.md',\r\n    };\r\n\r\n    if (!settings) {\r\n      throw new AppError('Unable to load .webapp.ini', errorPayload);\r\n    }\r\n\r\n    // The ini file values will be used if provided, even if compile-time values are set\r\n    settings.defaultConfigSource ||= env.APP_DEFAULT_CONFIG_SOURCE;\r\n    settings.playerId ||= env.APP_PLAYER_ID || OTT_GLOBAL_PLAYER_ID;\r\n    settings.playerLicenseKey ||= env.APP_PLAYER_LICENSE_KEY;\r\n    settings.apiAccessBridgeUrl ||= env.APP_API_ACCESS_BRIDGE_URL;\r\n\r\n    // The player key should be set if using the global ott player\r\n    if (settings.playerId === OTT_GLOBAL_PLAYER_ID && !settings.playerLicenseKey) {\r\n      logWarn('SettingsService', 'Using Global OTT Player without setting player key. Some features, such as analytics, may not work correctly.');\r\n    }\r\n\r\n    // This will result in an unusable app\r\n    if (\r\n      !settings.defaultConfigSource &&\r\n      (!settings.additionalAllowedConfigSources || settings.additionalAllowedConfigSources?.length === 0) &&\r\n      !settings.UNSAFE_allowAnyConfigSource\r\n    ) {\r\n      throw new AppError('No usable config sources', errorPayload);\r\n    }\r\n\r\n    return settings;\r\n  };\r\n}\r\n","import type { Plan } from '../../types/plans';\r\nimport type { CustomFormField, Customer, CustomerConsent } from '../../types/account';\r\nimport type { Offer } from '../../types/checkout';\r\nimport type { PaymentDetail, Subscription, Transaction } from '../../types/subscription';\r\n\r\nimport { createStore } from './utils';\r\n\r\ntype AccountStore = {\r\n  loading: boolean;\r\n  user: Customer | null;\r\n  subscription: Subscription | null;\r\n  transactions: Transaction[] | null;\r\n  entitledPlan: Plan | null;\r\n  activePayment: PaymentDetail | null;\r\n  customerConsents: CustomerConsent[] | null;\r\n  publisherConsents: CustomFormField[] | null;\r\n  publisherConsentsLoading: boolean;\r\n  pendingOffer: Offer | null;\r\n  setLoading: (loading: boolean) => void;\r\n  getAccountInfo: () => { customerId: string; customer: Customer; customerConsents: CustomerConsent[] | null };\r\n};\r\n\r\nexport const useAccountStore = createStore<AccountStore>('AccountStore', (set, get) => ({\r\n  loading: false,\r\n  user: null,\r\n  subscription: null,\r\n  transactions: null,\r\n  entitledPlan: null,\r\n  activePayment: null,\r\n  customerConsents: null,\r\n  publisherConsents: null,\r\n  publisherConsentsLoading: false,\r\n  pendingOffer: null,\r\n  setLoading: (loading: boolean) => set({ loading }),\r\n  getAccountInfo: () => {\r\n    const user = get().user;\r\n    const customerConsents = get().customerConsents;\r\n\r\n    if (!user?.id) throw new Error('user not logged in');\r\n\r\n    return { customerId: user?.id, customer: user, customerConsents };\r\n  },\r\n}));\r\n","import { PersonalShelf, VideoProgressMinMax } from '../constants';\r\nimport type { WatchHistoryItem } from '../../types/watchHistory';\r\nimport type { Playlist, PlaylistItem } from '../../types/playlist';\r\n\r\nimport { createStore } from './utils';\r\n\r\ntype WatchHistoryState = {\r\n  watchHistory: WatchHistoryItem[];\r\n  playlistItemsLoaded: boolean;\r\n  continueWatchingPlaylistId: string;\r\n  getItem: (item: PlaylistItem) => WatchHistoryItem | undefined;\r\n  getPlaylist: () => Playlist;\r\n  getDictionaryWithEpisodes: () => { [key: string]: number };\r\n  getDictionaryWithSeries: () => { [key: string]: number };\r\n};\r\n\r\nexport const useWatchHistoryStore = createStore<WatchHistoryState>('WatchHistoryStore', (_, get) => ({\r\n  watchHistory: [],\r\n  playlistItemsLoaded: false,\r\n  continueWatchingPlaylistId: PersonalShelf.ContinueWatching,\r\n  getItem: (item: PlaylistItem) =>\r\n    get().watchHistory.find(({ mediaid, progress }) => {\r\n      return mediaid === item.mediaid && progress > VideoProgressMinMax.Min && progress < VideoProgressMinMax.Max;\r\n    }),\r\n  getPlaylist: () =>\r\n    ({\r\n      feedid: get().continueWatchingPlaylistId || PersonalShelf.ContinueWatching,\r\n      title: 'Continue watching',\r\n      playlist: get()\r\n        .watchHistory.filter(({ playlistItem, progress }) => !!playlistItem && progress > VideoProgressMinMax.Min && progress < VideoProgressMinMax.Max)\r\n        .map(({ playlistItem }) => playlistItem),\r\n    } as Playlist),\r\n  getDictionaryWithEpisodes: () =>\r\n    get().watchHistory.reduce((dict: { [key: string]: number }, item) => {\r\n      const key = item.mediaid;\r\n\r\n      dict[key] = item.progress;\r\n\r\n      return dict;\r\n    }, {}),\r\n  getDictionaryWithSeries: () =>\r\n    get().watchHistory.reduce((dict: { [key: string]: number }, item) => {\r\n      const key = item.seriesId || item.mediaid;\r\n\r\n      dict[key] = item.progress;\r\n\r\n      return dict;\r\n    }, {}),\r\n}));\r\n","import { injectable } from 'inversify';\r\n\r\nimport WatchHistoryService from '../services/WatchHistoryService';\r\nimport type { PlaylistItem } from '../../types/playlist';\r\nimport type { WatchHistoryItem } from '../../types/watchHistory';\r\nimport { useAccountStore } from '../stores/AccountStore';\r\nimport { useConfigStore } from '../stores/ConfigStore';\r\nimport { useWatchHistoryStore } from '../stores/WatchHistoryStore';\r\n\r\n@injectable()\r\nexport default class WatchHistoryController {\r\n  private readonly watchHistoryService: WatchHistoryService;\r\n\r\n  constructor(watchHistoryService: WatchHistoryService) {\r\n    this.watchHistoryService = watchHistoryService;\r\n  }\r\n\r\n  initialize = async (language: string) => {\r\n    await this.restoreWatchHistory(language);\r\n  };\r\n\r\n  restoreWatchHistory = async (language?: string) => {\r\n    const { user } = useAccountStore.getState();\r\n    const continueWatchingList = useConfigStore.getState().config.features?.continueWatchingList;\r\n\r\n    if (!continueWatchingList) {\r\n      return;\r\n    }\r\n\r\n    const watchHistory = await this.watchHistoryService.getWatchHistory(user, continueWatchingList, language);\r\n\r\n    useWatchHistoryStore.setState({\r\n      watchHistory: watchHistory.filter((item): item is WatchHistoryItem => !!item?.mediaid),\r\n      playlistItemsLoaded: true,\r\n      continueWatchingPlaylistId: continueWatchingList,\r\n    });\r\n  };\r\n\r\n  persistWatchHistory = async () => {\r\n    const { watchHistory } = useWatchHistoryStore.getState();\r\n    const { user } = useAccountStore.getState();\r\n\r\n    await this.watchHistoryService.persistWatchHistory(watchHistory, user);\r\n  };\r\n\r\n  /**\r\n   *  If we already have an element with continue watching state, we:\r\n   *    1. Update the progress\r\n   *    2. Move the element to the continue watching list start\r\n   *  Otherwise:\r\n   *    1. Move the element to the continue watching list start\r\n   *    2. If there are many elements in continue watching state we remove the oldest one\r\n   */\r\n  saveItem = async (item: PlaylistItem, seriesItem: PlaylistItem | undefined, videoProgress: number | null) => {\r\n    const { watchHistory } = useWatchHistoryStore.getState();\r\n\r\n    if (!videoProgress) return;\r\n\r\n    const updatedHistory = await this.watchHistoryService.saveItem(item, seriesItem, videoProgress, watchHistory);\r\n\r\n    if (updatedHistory) {\r\n      useWatchHistoryStore.setState({ watchHistory: updatedHistory });\r\n      await this.persistWatchHistory();\r\n    }\r\n  };\r\n}\r\n","import type {\r\n  AddAdyenPaymentDetails,\r\n  CreateOrder,\r\n  DeletePaymentMethod,\r\n  FinalizeAdyenPaymentDetails,\r\n  GetAdyenPaymentSession,\r\n  GetDirectPostCardPayment,\r\n  GetEntitlements,\r\n  GetFinalizeAdyenPayment,\r\n  GetInitialAdyenPayment,\r\n  GetOffer,\r\n  GetOffers,\r\n  GetOrder,\r\n  GetPaymentMethods,\r\n  GetSubscriptionSwitch,\r\n  GetSubscriptionSwitches,\r\n  PaymentWithoutDetails,\r\n  PaymentWithPayPal,\r\n  SwitchSubscription,\r\n  UpdateOrder,\r\n  UpdatePaymentWithPayPal,\r\n} from '../../../types/checkout';\r\n\r\nexport default abstract class CheckoutService {\r\n  abstract getOffers: GetOffers;\r\n\r\n  abstract createOrder: CreateOrder;\r\n\r\n  abstract updateOrder: UpdateOrder;\r\n\r\n  abstract getPaymentMethods: GetPaymentMethods;\r\n\r\n  abstract paymentWithoutDetails: PaymentWithoutDetails;\r\n\r\n  abstract paymentWithPayPal: PaymentWithPayPal;\r\n\r\n  abstract getEntitlements: GetEntitlements;\r\n\r\n  abstract directPostCardPayment: GetDirectPostCardPayment;\r\n\r\n  abstract getOffer?: GetOffer;\r\n\r\n  abstract getOrder?: GetOrder;\r\n\r\n  abstract switchSubscription?: SwitchSubscription;\r\n\r\n  abstract getSubscriptionSwitches?: GetSubscriptionSwitches;\r\n\r\n  abstract getSubscriptionSwitch?: GetSubscriptionSwitch;\r\n\r\n  abstract createAdyenPaymentSession?: GetAdyenPaymentSession;\r\n\r\n  abstract initialAdyenPayment?: GetInitialAdyenPayment;\r\n\r\n  abstract finalizeAdyenPayment?: GetFinalizeAdyenPayment;\r\n\r\n  abstract updatePaymentMethodWithPayPal?: UpdatePaymentWithPayPal;\r\n\r\n  abstract deletePaymentMethod?: DeletePaymentMethod;\r\n\r\n  abstract addAdyenPaymentDetails?: AddAdyenPaymentDetails;\r\n\r\n  abstract finalizeAdyenPaymentDetails?: FinalizeAdyenPaymentDetails;\r\n}\r\n","import type {\r\n  ChangeSubscription,\r\n  FetchReceipt,\r\n  GetActivePayment,\r\n  GetActiveSubscription,\r\n  GetAllTransactions,\r\n  GetPaymentDetails,\r\n  GetSubscriptions,\r\n  GetTransactions,\r\n  UpdateCardDetails,\r\n  UpdateSubscription,\r\n} from '../../../types/subscription';\r\n\r\nexport default abstract class SubscriptionService {\r\n  abstract getActiveSubscription: GetActiveSubscription;\r\n\r\n  abstract getAllTransactions: GetAllTransactions;\r\n\r\n  abstract getActivePayment: GetActivePayment;\r\n\r\n  abstract getSubscriptions: GetSubscriptions;\r\n\r\n  abstract updateSubscription: UpdateSubscription;\r\n\r\n  abstract fetchReceipt: FetchReceipt;\r\n\r\n  abstract changeSubscription?: ChangeSubscription;\r\n\r\n  abstract updateCardDetails?: UpdateCardDetails;\r\n\r\n  abstract getPaymentDetails?: GetPaymentDetails;\r\n\r\n  abstract getTransactions?: GetTransactions;\r\n}\r\n","import type { Offer, Order, PaymentMethod } from '../../types/checkout';\r\nimport type { MediaOffer } from '../../types/media';\r\n\r\nimport { createStore } from './utils';\r\n\r\ntype CheckoutStore = {\r\n  requestedMediaOffers: MediaOffer[];\r\n  mediaOffers: Offer[];\r\n  subscriptionOffers: Offer[];\r\n  switchSubscriptionOffers: Offer[];\r\n  selectedOffer: Offer | null;\r\n  defaultOfferId: string | null;\r\n  order: Order | null;\r\n  paymentMethods: PaymentMethod[] | null;\r\n  setRequestedMediaOffers: (requestedMediaOffers: MediaOffer[]) => void;\r\n  setOrder: (order: Order | null) => void;\r\n  setPaymentMethods: (paymentMethods: PaymentMethod[] | null) => void;\r\n};\r\n\r\nexport const useCheckoutStore = createStore<CheckoutStore>('CheckoutStore', (set) => ({\r\n  requestedMediaOffers: [],\r\n  mediaOffers: [],\r\n  subscriptionOffers: [],\r\n  switchSubscriptionOffers: [],\r\n  selectedOffer: null,\r\n  defaultOfferId: null,\r\n  order: null,\r\n  paymentMethods: null,\r\n  setRequestedMediaOffers: (requestedMediaOffers) => set({ requestedMediaOffers }),\r\n  setOrder: (order) => set({ order }),\r\n  setPaymentMethods: (paymentMethods) => set({ paymentMethods }),\r\n}));\r\n","type FormValidationErrors = Record<string, string[]>;\r\n\r\nexport class FormValidationError extends Error {\r\n  public errors: FormValidationErrors;\r\n\r\n  constructor(errors: FormValidationErrors) {\r\n    super(Object.values(errors).flat().join(';'));\r\n\r\n    this.errors = errors;\r\n  }\r\n}\r\n","import type { Subscription } from '../../types/subscription';\r\n\r\nexport const determineSwitchDirection = (subscription: Subscription | null) => {\r\n  const currentPeriod = subscription?.period;\r\n\r\n  if (currentPeriod === 'month') return 'upgrade';\r\n  if (currentPeriod === 'year') return 'downgrade';\r\n\r\n  return 'upgrade'; // Default to 'upgrade' if the period is not 'month' or 'year'\r\n};\r\n","import type { PaymentMethod } from '@jwp/ott-common/types/checkout';\r\n\r\nexport const findDefaultCardMethodId = (paymentMethods: PaymentMethod[] | null) => paymentMethods?.find((el) => el.methodName === 'card')?.id?.toString() || '';\r\n","import { inject, injectable } from 'inversify';\r\nimport i18next from 'i18next';\r\n\r\nimport type {\r\n  AddAdyenPaymentDetailsResponse,\r\n  AdyenPaymentSession,\r\n  CardPaymentData,\r\n  CreateOrderArgs,\r\n  FinalizeAdyenPayment,\r\n  FinalizeAdyenPaymentDetailsResponse,\r\n  GetEntitlements,\r\n  GetOffers,\r\n  InitialAdyenPayment,\r\n  Offer,\r\n  Order,\r\n  Payment,\r\n  PaymentMethod,\r\n} from '../../types/checkout';\r\nimport CheckoutService from '../services/integrations/CheckoutService';\r\nimport SubscriptionService from '../services/integrations/SubscriptionService';\r\nimport type { IntegrationType } from '../../types/config';\r\nimport { assertModuleMethod, getNamedModule } from '../modules/container';\r\nimport { GET_CUSTOMER_IP, INTEGRATION_TYPE } from '../modules/types';\r\nimport type { GetCustomerIP } from '../../types/get-customer-ip';\r\nimport AccountService from '../services/integrations/AccountService';\r\nimport { useCheckoutStore } from '../stores/CheckoutStore';\r\nimport { useAccountStore } from '../stores/AccountStore';\r\nimport { FormValidationError } from '../errors/FormValidationError';\r\nimport { determineSwitchDirection } from '../utils/subscription';\r\nimport { findDefaultCardMethodId } from '../utils/payments';\r\n\r\n@injectable()\r\nexport default class CheckoutController {\r\n  private readonly accountService: AccountService;\r\n  private readonly checkoutService: CheckoutService;\r\n  private readonly subscriptionService: SubscriptionService;\r\n  private readonly getCustomerIP: GetCustomerIP;\r\n\r\n  constructor(@inject(INTEGRATION_TYPE) integrationType: IntegrationType, @inject(GET_CUSTOMER_IP) getCustomerIP: GetCustomerIP) {\r\n    this.getCustomerIP = getCustomerIP;\r\n    this.accountService = getNamedModule(AccountService, integrationType);\r\n    this.checkoutService = getNamedModule(CheckoutService, integrationType);\r\n    this.subscriptionService = getNamedModule(SubscriptionService, integrationType);\r\n  }\r\n\r\n  initialiseOffers = async () => {\r\n    const requestedMediaOffers = useCheckoutStore.getState().requestedMediaOffers;\r\n    const mediaOffers = requestedMediaOffers ? await this.getOffers({ offerIds: requestedMediaOffers.map(({ offerId }) => offerId) }) : [];\r\n    useCheckoutStore.setState({ mediaOffers });\r\n\r\n    if (!useCheckoutStore.getState().subscriptionOffers.length && this.accountService.svodOfferIds) {\r\n      const subscriptionOffers = await this.getOffers({ offerIds: this.accountService.svodOfferIds });\r\n      useCheckoutStore.setState({ subscriptionOffers });\r\n    }\r\n\r\n    if (!useCheckoutStore.getState().switchSubscriptionOffers.length) {\r\n      const subscriptionSwitches = await this.getSubscriptionSwitches();\r\n      const switchSubscriptionOffers = subscriptionSwitches ? await this.getOffers({ offerIds: subscriptionSwitches }) : [];\r\n      useCheckoutStore.setState({ switchSubscriptionOffers });\r\n    }\r\n  };\r\n\r\n  getSubscriptionOfferIds = () => this.accountService.svodOfferIds;\r\n\r\n  chooseOffer = async (selectedOffer: Offer) => {\r\n    useCheckoutStore.setState({ selectedOffer });\r\n  };\r\n\r\n  initialiseOrder = async (offer: Offer): Promise<void> => {\r\n    const { getAccountInfo } = useAccountStore.getState();\r\n    const { customer } = getAccountInfo();\r\n\r\n    const paymentMethods = await this.getPaymentMethods();\r\n    const paymentMethodId = parseInt(findDefaultCardMethodId(paymentMethods));\r\n\r\n    const createOrderArgs: CreateOrderArgs = {\r\n      offer,\r\n      customerId: customer.id,\r\n      country: customer?.country || '',\r\n      paymentMethodId,\r\n    };\r\n\r\n    const response = await this.checkoutService.createOrder(createOrderArgs);\r\n\r\n    if (response?.errors?.length > 0) {\r\n      useCheckoutStore.getState().setOrder(null);\r\n\r\n      throw new Error(response?.errors[0]);\r\n    }\r\n\r\n    useCheckoutStore.getState().setOrder(response.responseData?.order);\r\n  };\r\n\r\n  updateOrder = async (order: Order, paymentMethodId?: number, couponCode?: string | null): Promise<void> => {\r\n    try {\r\n      const response = await this.checkoutService.updateOrder({ order, paymentMethodId, couponCode });\r\n\r\n      if (response.responseData.order) {\r\n        useCheckoutStore.getState().setOrder(response.responseData?.order);\r\n      }\r\n    } catch (error: unknown) {\r\n      if (error instanceof Error) {\r\n        if (error.message === 'Order not found') {\r\n          useCheckoutStore.getState().setOrder(null);\r\n        } else if (error.message === 'Invalid coupon code') {\r\n          throw new FormValidationError({ couponCode: [i18next.t('account:checkout.coupon_not_valid')] });\r\n        } else if (error.message === 'Invalid coupon code for this offer') {\r\n          throw new FormValidationError({ couponCode: [i18next.t('account:checkout.coupon_not_valid_for_offer')] });\r\n        }\r\n      }\r\n\r\n      throw new FormValidationError({ form: [i18next.t('error:unknown_error')] });\r\n    }\r\n  };\r\n\r\n  getPaymentMethods = async (): Promise<PaymentMethod[]> => {\r\n    const { paymentMethods } = useCheckoutStore.getState();\r\n\r\n    if (paymentMethods) return paymentMethods; // already fetched payment methods\r\n\r\n    const response = await this.checkoutService.getPaymentMethods();\r\n\r\n    if (response.errors.length > 0) throw new Error(response.errors[0]);\r\n\r\n    useCheckoutStore.getState().setPaymentMethods(response.responseData?.paymentMethods);\r\n\r\n    return response.responseData?.paymentMethods;\r\n  };\r\n\r\n  //\r\n  paymentWithoutDetails = async ({ captchaValue }: { captchaValue?: string } = {}): Promise<Payment> => {\r\n    const { order } = useCheckoutStore.getState();\r\n\r\n    if (!order) throw new Error('No order created');\r\n\r\n    const response = await this.checkoutService.paymentWithoutDetails({ orderId: order.id, captchaValue });\r\n\r\n    if (response.errors.length > 0) throw new Error(response.errors[0]);\r\n    if (response.responseData.rejectedReason) throw new Error(response.responseData.rejectedReason);\r\n\r\n    return response.responseData;\r\n  };\r\n\r\n  directPostCardPayment = async ({ cardPaymentPayload, referrer, returnUrl }: { cardPaymentPayload: CardPaymentData; referrer: string; returnUrl: string }) => {\r\n    const { order } = useCheckoutStore.getState();\r\n\r\n    if (!order) throw new Error('No order created');\r\n\r\n    return await this.checkoutService.directPostCardPayment(cardPaymentPayload, order, referrer, returnUrl);\r\n  };\r\n\r\n  createAdyenPaymentSession = async (returnUrl: string, isInitialPayment: boolean = true): Promise<AdyenPaymentSession> => {\r\n    const { order } = useCheckoutStore.getState();\r\n    const orderId = order?.id;\r\n\r\n    if (isInitialPayment && !orderId) throw new Error('There is no order to pay for');\r\n\r\n    assertModuleMethod(this.checkoutService.createAdyenPaymentSession, 'createAdyenPaymentSession is not available in checkout service');\r\n\r\n    const response = await this.checkoutService.createAdyenPaymentSession({\r\n      orderId: orderId,\r\n      returnUrl: returnUrl,\r\n    });\r\n\r\n    if (response.errors.length > 0) {\r\n      throw new Error(response.errors[0]);\r\n    }\r\n\r\n    return response.responseData;\r\n  };\r\n\r\n  initialAdyenPayment = async (paymentMethod: AdyenPaymentMethod, returnUrl: string, captchaValue?: string): Promise<InitialAdyenPayment> => {\r\n    const { order } = useCheckoutStore.getState();\r\n\r\n    if (!order) throw new Error('No order created');\r\n\r\n    assertModuleMethod(this.checkoutService.initialAdyenPayment, 'initialAdyenPayment is not available in checkout service');\r\n\r\n    const response = await this.checkoutService.initialAdyenPayment({\r\n      orderId: order.id,\r\n      returnUrl: returnUrl,\r\n      paymentMethod,\r\n      customerIP: await this.getCustomerIP(),\r\n      captchaValue,\r\n    });\r\n\r\n    if (response.errors.length > 0) throw new Error(response.errors[0]);\r\n\r\n    return response.responseData;\r\n  };\r\n\r\n  finalizeAdyenPayment = async (details: unknown, orderId?: number, paymentData?: string): Promise<FinalizeAdyenPayment> => {\r\n    if (!orderId) throw new Error('No order created');\r\n\r\n    assertModuleMethod(this.checkoutService.finalizeAdyenPayment, 'finalizeAdyenPayment is not available in checkout service');\r\n\r\n    const response = await this.checkoutService.finalizeAdyenPayment({\r\n      orderId,\r\n      details,\r\n      paymentData,\r\n    });\r\n\r\n    if (response.errors.length > 0) {\r\n      throw new Error(response.errors[0]);\r\n    }\r\n\r\n    return response.responseData;\r\n  };\r\n\r\n  paypalPayment = async ({\r\n    successUrl,\r\n    waitingUrl,\r\n    cancelUrl,\r\n    errorUrl,\r\n    couponCode = '',\r\n    captchaValue,\r\n  }: {\r\n    successUrl: string;\r\n    waitingUrl: string;\r\n    cancelUrl: string;\r\n    errorUrl: string;\r\n    couponCode: string;\r\n    captchaValue?: string;\r\n  }): Promise<{ redirectUrl: string }> => {\r\n    const { order } = useCheckoutStore.getState();\r\n\r\n    if (!order) throw new Error('No order created');\r\n\r\n    const response = await this.checkoutService.paymentWithPayPal({\r\n      order: order,\r\n      successUrl,\r\n      waitingUrl,\r\n      cancelUrl,\r\n      errorUrl,\r\n      couponCode,\r\n      captchaValue,\r\n    });\r\n\r\n    if (response.errors.length > 0) throw new Error(response.errors[0]);\r\n\r\n    return {\r\n      redirectUrl: response.responseData.redirectUrl,\r\n    };\r\n  };\r\n\r\n  getSubscriptionSwitches = async (): Promise<string[] | null> => {\r\n    const { getAccountInfo } = useAccountStore.getState();\r\n\r\n    const { customerId } = getAccountInfo();\r\n    const { subscription } = useAccountStore.getState();\r\n\r\n    if (!subscription || !this.checkoutService.getSubscriptionSwitches) return null;\r\n\r\n    assertModuleMethod(this.checkoutService.getOffer, 'getOffer is not available in checkout service');\r\n\r\n    const response = await this.checkoutService.getSubscriptionSwitches({\r\n      customerId: customerId,\r\n      offerId: subscription.offerId,\r\n    });\r\n\r\n    if (!response.responseData.available.length) return null;\r\n\r\n    return response.responseData.available.map(({ toOfferId }) => toOfferId);\r\n  };\r\n\r\n  switchSubscription = async () => {\r\n    const selectedOffer = useCheckoutStore.getState().selectedOffer;\r\n    const subscription = useAccountStore.getState().subscription;\r\n    const { getAccountInfo } = useAccountStore.getState();\r\n    const { customerId } = getAccountInfo();\r\n\r\n    if (!selectedOffer || !subscription) throw new Error('No offer selected');\r\n\r\n    assertModuleMethod(this.checkoutService.switchSubscription, 'switchSubscription is not available in checkout service');\r\n\r\n    const switchDirection: 'upgrade' | 'downgrade' = determineSwitchDirection(subscription);\r\n\r\n    const switchSubscriptionPayload = {\r\n      toOfferId: selectedOffer.offerId,\r\n      customerId: customerId,\r\n      offerId: subscription.offerId,\r\n      switchDirection: switchDirection,\r\n    };\r\n\r\n    await this.checkoutService.switchSubscription(switchSubscriptionPayload);\r\n  };\r\n\r\n  changeSubscription = async ({ accessFeeId, subscriptionId }: { accessFeeId: string; subscriptionId: string }) => {\r\n    assertModuleMethod(this.subscriptionService.changeSubscription, 'changeSubscription is not available in subscription service');\r\n\r\n    const { responseData } = await this.subscriptionService.changeSubscription({\r\n      accessFeeId,\r\n      subscriptionId,\r\n    });\r\n\r\n    return responseData;\r\n  };\r\n\r\n  updatePayPalPaymentMethod = async (\r\n    successUrl: string,\r\n    waitingUrl: string,\r\n    cancelUrl: string,\r\n    errorUrl: string,\r\n    paymentMethodId: number,\r\n    currentPaymentId?: number,\r\n  ) => {\r\n    assertModuleMethod(this.checkoutService.updatePaymentMethodWithPayPal, 'updatePaymentMethodWithPayPal is not available in checkout service');\r\n    assertModuleMethod(this.checkoutService.deletePaymentMethod, 'deletePaymentMethod is not available in checkout service');\r\n\r\n    const response = await this.checkoutService.updatePaymentMethodWithPayPal({\r\n      paymentMethodId,\r\n      successUrl,\r\n      waitingUrl,\r\n      cancelUrl,\r\n      errorUrl,\r\n    });\r\n\r\n    if (response.errors.length > 0) throw new Error(response.errors[0]);\r\n\r\n    if (currentPaymentId) {\r\n      await this.checkoutService.deletePaymentMethod({ paymentDetailsId: currentPaymentId });\r\n    }\r\n\r\n    return response.responseData;\r\n  };\r\n\r\n  addAdyenPaymentDetails = async (paymentMethod: AdyenPaymentMethod, paymentMethodId: number, returnUrl: string): Promise<AddAdyenPaymentDetailsResponse> => {\r\n    assertModuleMethod(this.checkoutService.addAdyenPaymentDetails, 'addAdyenPaymentDetails is not available in checkout service');\r\n\r\n    const response = await this.checkoutService.addAdyenPaymentDetails({\r\n      paymentMethodId,\r\n      returnUrl,\r\n      paymentMethod,\r\n      customerIP: await this.getCustomerIP(),\r\n    });\r\n\r\n    if (response.errors.length > 0) throw new Error(response.errors[0]);\r\n\r\n    return response.responseData;\r\n  };\r\n\r\n  finalizeAdyenPaymentDetails = async (details: unknown, paymentMethodId: number, paymentData?: string): Promise<FinalizeAdyenPaymentDetailsResponse> => {\r\n    assertModuleMethod(this.checkoutService.finalizeAdyenPaymentDetails, 'finalizeAdyenPaymentDetails is not available in checkout service');\r\n\r\n    const response = await this.checkoutService.finalizeAdyenPaymentDetails({\r\n      paymentMethodId,\r\n      details,\r\n      paymentData,\r\n    });\r\n\r\n    if (response.errors.length > 0) throw new Error(response.errors[0]);\r\n\r\n    return response.responseData;\r\n  };\r\n\r\n  getOffers: GetOffers = (payload) => {\r\n    return this.checkoutService.getOffers(payload);\r\n  };\r\n\r\n  getEntitlements: GetEntitlements = (payload) => {\r\n    return this.checkoutService.getEntitlements(payload);\r\n  };\r\n}\r\n","import { PersonalShelf } from '../constants';\r\nimport type { Favorite } from '../../types/favorite';\r\nimport type { Playlist, PlaylistItem } from '../../types/playlist';\r\n\r\nimport { createStore } from './utils';\r\n\r\ntype FavoritesState = {\r\n  favorites: Favorite[];\r\n  warning: string | null;\r\n  favoritesPlaylistId: string;\r\n  hasItem: (item: PlaylistItem) => boolean;\r\n  getPlaylist: () => Playlist;\r\n  setWarning: (warning: string) => void;\r\n  clearWarning: () => void;\r\n};\r\n\r\nexport const useFavoritesStore = createStore<FavoritesState>('FavoritesState', (set, get) => ({\r\n  favorites: [],\r\n  warning: null,\r\n  favoritesPlaylistId: PersonalShelf.Favorites,\r\n  setWarning: (message: string | null) => set({ warning: message }),\r\n  clearWarning: () => set({ warning: null }),\r\n  hasItem: (item: PlaylistItem) => get().favorites.some((favoriteItem) => favoriteItem.mediaid === item.mediaid),\r\n  getPlaylist: () =>\r\n    ({\r\n      feedid: get().favoritesPlaylistId || PersonalShelf.Favorites,\r\n      title: 'Favorites',\r\n      playlist: get().favorites.map(({ playlistItem }) => playlistItem),\r\n    } as Playlist),\r\n}));\r\n","import i18next from 'i18next';\r\nimport { injectable } from 'inversify';\r\n\r\nimport FavoriteService from '../services/FavoriteService';\r\nimport type { PlaylistItem } from '../../types/playlist';\r\nimport { useAccountStore } from '../stores/AccountStore';\r\nimport { useFavoritesStore } from '../stores/FavoritesStore';\r\nimport { useConfigStore } from '../stores/ConfigStore';\r\n\r\n@injectable()\r\nexport default class FavoritesController {\r\n  private readonly favoritesService: FavoriteService;\r\n\r\n  constructor(favoritesService: FavoriteService) {\r\n    this.favoritesService = favoritesService;\r\n  }\r\n\r\n  initialize = async (language: string) => {\r\n    await this.restoreFavorites(language);\r\n  };\r\n\r\n  restoreFavorites = async (language?: string) => {\r\n    const { user } = useAccountStore.getState();\r\n    const favoritesList = useConfigStore.getState().config.features?.favoritesList;\r\n\r\n    if (!favoritesList) {\r\n      return;\r\n    }\r\n\r\n    const favorites = await this.favoritesService.getFavorites(user, favoritesList, language);\r\n\r\n    useFavoritesStore.setState({ favorites, favoritesPlaylistId: favoritesList });\r\n  };\r\n\r\n  persistFavorites = async () => {\r\n    const { favorites } = useFavoritesStore.getState();\r\n    const { user } = useAccountStore.getState();\r\n\r\n    await this.favoritesService.persistFavorites(favorites, user);\r\n  };\r\n\r\n  saveItem = async (item: PlaylistItem) => {\r\n    const { favorites } = useFavoritesStore.getState();\r\n\r\n    if (!favorites.some(({ mediaid }) => mediaid === item.mediaid)) {\r\n      const items = [this.favoritesService.createFavorite(item)].concat(favorites);\r\n      useFavoritesStore.setState({ favorites: items });\r\n      await this.persistFavorites();\r\n    }\r\n  };\r\n\r\n  removeItem = async (item: PlaylistItem) => {\r\n    const { favorites } = useFavoritesStore.getState();\r\n\r\n    const items = favorites.filter(({ mediaid }) => mediaid !== item.mediaid);\r\n    useFavoritesStore.setState({ favorites: items });\r\n\r\n    await this.persistFavorites();\r\n  };\r\n\r\n  toggleFavorite = async (item: PlaylistItem | undefined) => {\r\n    const { favorites, hasItem, setWarning } = useFavoritesStore.getState();\r\n\r\n    if (!item) {\r\n      return;\r\n    }\r\n\r\n    const isFavorite = hasItem(item);\r\n\r\n    if (isFavorite) {\r\n      await this.removeItem(item);\r\n\r\n      return;\r\n    }\r\n\r\n    // If we exceed the max available number of favorites, we show a warning\r\n    if (favorites.length > this.favoritesService.getMaxFavoritesCount()) {\r\n      setWarning(i18next.t('video:favorites_warning', { maxCount: this.favoritesService.getMaxFavoritesCount() }));\r\n      return;\r\n    }\r\n\r\n    await this.saveItem(item);\r\n  };\r\n\r\n  clear = async () => {\r\n    useFavoritesStore.setState({ favorites: [] });\r\n\r\n    await this.persistFavorites();\r\n  };\r\n}\r\n","import { inject, injectable } from 'inversify';\r\n\r\nimport type { AccessTokens } from '../../types/access';\r\nimport { logError } from '../logger';\r\nimport { API_ACCESS_BRIDGE_URL } from '../modules/types';\r\n\r\n@injectable()\r\nexport default class AccessService {\r\n  private readonly apiAccessBridgeUrl;\r\n\r\n  constructor(@inject(API_ACCESS_BRIDGE_URL) apiAccessBridgeUrl: string) {\r\n    this.apiAccessBridgeUrl = apiAccessBridgeUrl;\r\n  }\r\n\r\n  generateAccessTokens = async (siteId: string, jwt?: string): Promise<AccessTokens | null> => {\r\n    const url = `${this.apiAccessBridgeUrl}/v2/sites/${siteId}/access/generate`;\r\n    const response = await fetch(url, {\r\n      method: 'PUT',\r\n      headers: {\r\n        Authorization: jwt ? `Bearer ${jwt}` : '',\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      logError('AccessService', 'Failed to generateAccessTokens', {\r\n        status: response.status,\r\n        error: response.json(),\r\n      });\r\n\r\n      return null;\r\n    }\r\n\r\n    return (await response.json()) as AccessTokens;\r\n  };\r\n\r\n  refreshAccessTokens = async (siteId: string, refresh_token: string): Promise<AccessTokens | null> => {\r\n    const url = `${this.apiAccessBridgeUrl}/v2/sites/${siteId}/access/refresh`;\r\n    const response = await fetch(url, {\r\n      method: 'PUT',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({\r\n        refresh_token,\r\n      }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      logError('AccessService', 'Failed to refreshAccessTokens', {\r\n        status: response.status,\r\n        error: response.json(),\r\n      });\r\n\r\n      return null;\r\n    }\r\n\r\n    return (await response.json()) as AccessTokens;\r\n  };\r\n}\r\n","import { createStore } from './utils';\r\n\r\ntype AccessStore = {\r\n  passport: string | null;\r\n};\r\n\r\nexport const useAccessStore = createStore<AccessStore>('AccessStore', () => ({\r\n  passport: null,\r\n}));\r\n","import { inject, injectable } from 'inversify';\r\n\r\nimport type { IntegrationType } from '../../types/config';\r\nimport type { AccessTokens } from '../../types/access';\r\nimport ApiService from '../services/ApiService';\r\nimport AccessService from '../services/AccessService';\r\nimport AccountService from '../services/integrations/AccountService';\r\nimport StorageService from '../services/StorageService';\r\nimport { useConfigStore } from '../stores/ConfigStore';\r\nimport { INTEGRATION_TYPE } from '../modules/types';\r\nimport { getNamedModule } from '../modules/container';\r\nimport { useAccountStore } from '../stores/AccountStore';\r\nimport { ApiError } from '../utils/api';\r\nimport { useAccessStore } from '../stores/AccessStore';\r\n\r\nconst ACCESS_TOKENS = 'access_tokens';\r\n\r\n@injectable()\r\nexport default class AccessController {\r\n  private readonly apiService: ApiService;\r\n  private readonly accessService: AccessService;\r\n  private readonly accountService: AccountService;\r\n  private readonly storageService: StorageService;\r\n\r\n  private siteId: string = '';\r\n\r\n  constructor(\r\n    @inject(INTEGRATION_TYPE) integrationType: IntegrationType,\r\n    @inject(ApiService) apiService: ApiService,\r\n    @inject(StorageService) storageService: StorageService,\r\n    @inject(AccessService) accessService: AccessService,\r\n  ) {\r\n    this.apiService = apiService;\r\n    this.accessService = accessService;\r\n    this.storageService = storageService;\r\n    this.accountService = getNamedModule(AccountService, integrationType);\r\n  }\r\n\r\n  initialize = async () => {\r\n    const { config, accessModel } = useConfigStore.getState();\r\n    this.siteId = config.siteId;\r\n\r\n    // For the AVOD access model, signing and DRM are not supported, so access tokens generation is skipped\r\n    if (accessModel === 'AVOD') {\r\n      return;\r\n    }\r\n\r\n    // Not awaiting to avoid blocking the loading process,\r\n    // as the initial access tokens can be stored asynchronously without affecting the app's performance\r\n    void this.generateOrRefreshAccessTokens();\r\n  };\r\n\r\n  /**\r\n   * Retrieves media by its ID using a passport token.\r\n   * If no access tokens exist, it attempts to generate them, if the passport token is expired, it attempts to refresh them.\r\n   * If an access token retrieval fails or the user is not entitled to the content, an error is thrown.\r\n   */\r\n  getMediaById = async (mediaId: string) => {\r\n    const { entitledPlan } = useAccountStore.getState();\r\n\r\n    if (!this.siteId || !entitledPlan) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const accessTokens = await this.generateOrRefreshAccessTokens();\r\n      if (!accessTokens?.passport) {\r\n        throw new Error('Failed to get / generate access tokens and retrieve media.');\r\n      }\r\n      return await this.apiService.getMediaByIdWithPassport({ id: mediaId, siteId: this.siteId, planId: entitledPlan.id, passport: accessTokens.passport });\r\n    } catch (error: unknown) {\r\n      if (error instanceof ApiError && error.code === 403) {\r\n        // If the passport is invalid or expired, refresh the access tokens and try to get the media again.\r\n        const accessTokens = await this.refreshAccessTokens();\r\n        if (accessTokens?.passport) {\r\n          return await this.apiService.getMediaByIdWithPassport({ id: mediaId, siteId: this.siteId, planId: entitledPlan.id, passport: accessTokens.passport });\r\n        }\r\n\r\n        throw new Error('Failed to refresh access tokens and retrieve media.');\r\n      }\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Generates or refreshes access tokens based on their current validity.\r\n   * If existing tokens are expired, they are refreshed; if no tokens exist, they are generated.\r\n   * If the existing tokens are valid, it retrieves them.\r\n   */\r\n  generateOrRefreshAccessTokens = async (): Promise<AccessTokens | null> => {\r\n    const existingAccessTokens = await this.getAccessTokens();\r\n    const shouldRefresh = existingAccessTokens && Date.now() > existingAccessTokens.expires;\r\n\r\n    if (!existingAccessTokens) {\r\n      await this.generateAccessTokens();\r\n    }\r\n\r\n    if (shouldRefresh) {\r\n      return await this.refreshAccessTokens();\r\n    }\r\n\r\n    return existingAccessTokens;\r\n  };\r\n\r\n  /**\r\n   * Generates access tokens based on the viewer auth data.\r\n   * If the viewer is not authenticated it generates only access for free plans (if they are defined).\r\n   * Stores the access tokens in local storage.\r\n   */\r\n  generateAccessTokens = async (): Promise<AccessTokens | null> => {\r\n    if (!this.siteId) {\r\n      return null;\r\n    }\r\n\r\n    const auth = await this.accountService.getAuthData();\r\n\r\n    const accessTokens = await this.accessService.generateAccessTokens(this.siteId, auth?.jwt);\r\n    if (accessTokens) {\r\n      await this.setAccessTokens(accessTokens);\r\n      return accessTokens;\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  /**\r\n   * Refreshes the access tokens using the refresh token if they exist.\r\n   * If no tokens are found, it cannot refresh and returns null.\r\n   * Updates the localstorage with the newly generated access tokens.\r\n   */\r\n  refreshAccessTokens = async (): Promise<AccessTokens | null> => {\r\n    const existingAccessTokens = await this.getAccessTokens();\r\n    // there is no access tokens stored, nothing to refresh\r\n    if (!existingAccessTokens) {\r\n      return null;\r\n    }\r\n\r\n    const accessTokens = await this.accessService.refreshAccessTokens(this.siteId, existingAccessTokens.refresh_token);\r\n    if (accessTokens) {\r\n      await this.setAccessTokens(accessTokens);\r\n      return accessTokens;\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  /**\r\n   * Stores the access tokens in local storage, adding an expiration timestamp of 1 hour (passport validity).\r\n   * The expiration timestamp helps determine when the passport token should be refreshed.\r\n   */\r\n  setAccessTokens = async (accessTokens: AccessTokens) => {\r\n    useAccessStore.setState({ passport: accessTokens.passport });\r\n    // Since the actual valid time for a passport token is 1 hour, set the expires to one hour from now.\r\n    // The expires field here is used as a helper to manage the passport's validity and refresh process.\r\n    const expires = new Date(Date.now() + 3600 * 1000).getTime();\r\n    return await this.storageService.setItem(ACCESS_TOKENS, JSON.stringify({ ...accessTokens, expires }), true);\r\n  };\r\n\r\n  /**\r\n   * Retrieves the access tokens from local storage (if any) along with their expiration timestamp.\r\n   */\r\n  getAccessTokens = async (): Promise<(AccessTokens & { expires: number }) | null> => {\r\n    const accessTokens = await this.storageService.getItem<AccessTokens & { expires: number }>(ACCESS_TOKENS, true, true);\r\n    if (accessTokens) {\r\n      useAccessStore.setState({ passport: accessTokens.passport });\r\n    }\r\n\r\n    return accessTokens;\r\n  };\r\n\r\n  /**\r\n   * Removes the access tokens from local storage (if any).\r\n   */\r\n  removeAccessTokens = async () => {\r\n    useAccessStore.setState({ passport: null });\r\n    return await this.storageService.removeItem(ACCESS_TOKENS);\r\n  };\r\n}\r\n","import i18next from 'i18next';\r\nimport { inject, injectable } from 'inversify';\r\n\r\nimport { DEFAULT_FEATURES } from '../constants';\r\nimport type { IntegrationType } from '../../types/config';\r\nimport CheckoutService from '../services/integrations/CheckoutService';\r\nimport AccountService, { type AccountServiceFeatures } from '../services/integrations/AccountService';\r\nimport SubscriptionService from '../services/integrations/SubscriptionService';\r\nimport JWPEntitlementService from '../services/JWPEntitlementService';\r\nimport type { Offer } from '../../types/checkout';\r\nimport type { Plan } from '../../types/plans';\r\nimport type {\r\n  Capture,\r\n  Customer,\r\n  CustomerConsent,\r\n  EmailConfirmPasswordInput,\r\n  FirstLastNameInput,\r\n  GetCaptureStatusResponse,\r\n  SubscribeToNotificationsPayload,\r\n} from '../../types/account';\r\nimport { assertFeature, assertModuleMethod, getModule, getNamedModule } from '../modules/container';\r\nimport { INTEGRATION_TYPE } from '../modules/types';\r\nimport type { ServiceResponse } from '../../types/service';\r\nimport { useAccountStore } from '../stores/AccountStore';\r\nimport { useConfigStore } from '../stores/ConfigStore';\r\nimport { FormValidationError } from '../errors/FormValidationError';\r\nimport { logError } from '../logger';\r\n\r\nimport WatchHistoryController from './WatchHistoryController';\r\nimport FavoritesController from './FavoritesController';\r\nimport AccessController from './AccessController';\r\n\r\n@injectable()\r\nexport default class AccountController {\r\n  private readonly checkoutService: CheckoutService;\r\n  private readonly accountService: AccountService;\r\n  private readonly subscriptionService: SubscriptionService;\r\n  private readonly entitlementService: JWPEntitlementService;\r\n  private readonly accessController: AccessController;\r\n  private readonly favoritesController: FavoritesController;\r\n  private readonly watchHistoryController: WatchHistoryController;\r\n  private readonly features: AccountServiceFeatures;\r\n\r\n  // temporary callback for refreshing the query cache until we've updated to react-query v4 or v5\r\n  private refreshEntitlements: (() => Promise<void>) | undefined;\r\n\r\n  constructor(\r\n    @inject(INTEGRATION_TYPE) integrationType: IntegrationType,\r\n    accessController: AccessController,\r\n    favoritesController: FavoritesController,\r\n    watchHistoryController: WatchHistoryController,\r\n  ) {\r\n    this.checkoutService = getNamedModule(CheckoutService, integrationType);\r\n    this.accountService = getNamedModule(AccountService, integrationType);\r\n    this.subscriptionService = getNamedModule(SubscriptionService, integrationType);\r\n    this.entitlementService = getModule(JWPEntitlementService);\r\n\r\n    // @TODO: Controllers shouldn't be depending on other controllers, but we've agreed to keep this as is for now\r\n    this.accessController = accessController;\r\n    this.favoritesController = favoritesController;\r\n    this.watchHistoryController = watchHistoryController;\r\n\r\n    this.features = integrationType ? this.accountService.features : DEFAULT_FEATURES;\r\n  }\r\n\r\n  loadUserData = async () => {\r\n    try {\r\n      const authData = await this.accountService.getAuthData();\r\n\r\n      if (authData) {\r\n        await this.getAccount();\r\n      }\r\n    } catch (error: unknown) {\r\n      logError('AccountController', 'Failed to get user', { error });\r\n\r\n      // clear the session when the token was invalid\r\n      // don't clear the session when the error is unknown (network hiccup or something similar)\r\n      if (error instanceof Error && error.message.includes('Invalid JWT token')) {\r\n        await this.logout();\r\n      }\r\n    }\r\n  };\r\n\r\n  initialize = async (url: string, refreshEntitlements?: () => Promise<void>) => {\r\n    this.refreshEntitlements = refreshEntitlements;\r\n\r\n    useAccountStore.setState({ loading: true });\r\n    const config = useConfigStore.getState().config;\r\n\r\n    await this.accountService.initialize(config, url, this.logout);\r\n\r\n    // set the accessModel before restoring the user session\r\n    useConfigStore.setState({ accessModel: this.accountService.accessModel });\r\n\r\n    await this.loadUserData();\r\n    await this.getEntitledPlans();\r\n\r\n    useAccountStore.setState({ loading: false });\r\n  };\r\n\r\n  getSandbox() {\r\n    return this.accountService.sandbox;\r\n  }\r\n\r\n  updateUser = async (values: FirstLastNameInput | EmailConfirmPasswordInput): Promise<ServiceResponse<Customer>> => {\r\n    useAccountStore.setState({ loading: true });\r\n\r\n    const { user } = useAccountStore.getState();\r\n    const { canUpdateEmail, canSupportEmptyFullName } = this.getFeatures();\r\n\r\n    if (Object.prototype.hasOwnProperty.call(values, 'email') && !canUpdateEmail) {\r\n      throw new Error('Email update not supported');\r\n    }\r\n\r\n    if (!user) {\r\n      throw new Error('User not logged in');\r\n    }\r\n\r\n    const errors = this.validateInputLength(values as FirstLastNameInput);\r\n    if (errors.length) {\r\n      return {\r\n        errors,\r\n        responseData: {} as Customer,\r\n      };\r\n    }\r\n\r\n    let payload = values;\r\n    // this is needed as a fallback when the name is empty (cannot be empty on JWP integration)\r\n    if (!canSupportEmptyFullName) {\r\n      payload = { ...values, email: user.email };\r\n    }\r\n\r\n    const updatedUser = await this.accountService.updateCustomer({ ...payload, id: user.id.toString() });\r\n\r\n    if (!updatedUser) {\r\n      throw new Error('Unknown error');\r\n    }\r\n\r\n    useAccountStore.setState({ user: updatedUser });\r\n\r\n    return { errors: [], responseData: updatedUser };\r\n  };\r\n\r\n  getAccount = async () => {\r\n    const { config } = useConfigStore.getState();\r\n\r\n    try {\r\n      const response = await this.accountService.getUser({ config });\r\n\r\n      if (response) {\r\n        await this.afterLogin(response.user, response.customerConsents);\r\n      }\r\n\r\n      useAccountStore.setState({ loading: false });\r\n    } catch (error: unknown) {\r\n      useAccountStore.setState({\r\n        user: null,\r\n        subscription: null,\r\n        transactions: null,\r\n        activePayment: null,\r\n        customerConsents: null,\r\n        publisherConsents: null,\r\n        loading: false,\r\n      });\r\n    }\r\n  };\r\n\r\n  login = async (email: string, password: string, referrer: string) => {\r\n    useAccountStore.setState({ loading: true });\r\n\r\n    try {\r\n      const response = await this.accountService.login({ email, password, referrer });\r\n\r\n      if (response) {\r\n        await this.accessController?.generateAccessTokens();\r\n        await this.afterLogin(response.user, response.customerConsents);\r\n        return;\r\n      }\r\n    } catch (error: unknown) {\r\n      if (error instanceof Error && error.message.toLowerCase().includes('invalid param email')) {\r\n        throw new FormValidationError({ email: [i18next.t('account:login.wrong_email')] });\r\n      }\r\n    } finally {\r\n      useAccountStore.setState({ loading: false });\r\n    }\r\n\r\n    // consider any unknown response as a wrong combinations error (we could specify this even more)\r\n    throw new FormValidationError({ form: [i18next.t('account:login.wrong_combination')] });\r\n  };\r\n\r\n  logout = async () => {\r\n    await this.accountService?.logout();\r\n    await this.accessController?.removeAccessTokens();\r\n    await this.clearLoginState();\r\n\r\n    // let the application know to refresh all entitlements\r\n    await this.refreshEntitlements?.();\r\n  };\r\n\r\n  register = async (email: string, password: string, referrer: string, consentsValues: CustomerConsent[], captchaValue?: string) => {\r\n    try {\r\n      const response = await this.accountService.register({ email, password, consents: consentsValues, referrer, captchaValue });\r\n\r\n      if (response) {\r\n        const { user, customerConsents } = response;\r\n        await this.afterLogin(user, customerConsents, true);\r\n\r\n        return;\r\n      }\r\n    } catch (error: unknown) {\r\n      if (error instanceof Error) {\r\n        const errorMessage = error.message.toLowerCase();\r\n\r\n        if (errorMessage.includes('customer already exists') || errorMessage.includes('account already exists')) {\r\n          throw new FormValidationError({ form: [i18next.t('account:registration.user_exists')] });\r\n        } else if (errorMessage.includes('please enter a valid e-mail address')) {\r\n          throw new FormValidationError({ email: [i18next.t('account:registration.field_is_not_valid_email')] });\r\n        } else if (errorMessage.includes('invalid param password')) {\r\n          throw new FormValidationError({ password: [i18next.t('account:registration.invalid_password')] });\r\n        }\r\n      }\r\n    }\r\n\r\n    // in case the endpoint fails\r\n    throw new FormValidationError({ form: [i18next.t('account:registration.failed_to_create')] });\r\n  };\r\n\r\n  updateConsents = async (customerConsents: CustomerConsent[]): Promise<ServiceResponse<CustomerConsent[]>> => {\r\n    const { getAccountInfo } = useAccountStore.getState();\r\n    const { customer } = getAccountInfo();\r\n\r\n    useAccountStore.setState({ loading: true });\r\n\r\n    try {\r\n      const updatedConsents = await this.accountService?.updateCustomerConsents({\r\n        customer,\r\n        consents: customerConsents,\r\n      });\r\n\r\n      if (updatedConsents) {\r\n        useAccountStore.setState({ customerConsents: updatedConsents });\r\n        return {\r\n          responseData: updatedConsents,\r\n          errors: [],\r\n        };\r\n      }\r\n      return {\r\n        responseData: [],\r\n        errors: [],\r\n      };\r\n    } finally {\r\n      useAccountStore.setState({ loading: false });\r\n    }\r\n  };\r\n\r\n  // TODO: Decide if it's worth keeping this or just leave combined with getUser\r\n  // noinspection JSUnusedGlobalSymbols\r\n  getCustomerConsents = async () => {\r\n    const { getAccountInfo } = useAccountStore.getState();\r\n    const { customer } = getAccountInfo();\r\n\r\n    const consents = await this.accountService.getCustomerConsents({ customer });\r\n\r\n    if (consents) {\r\n      useAccountStore.setState({ customerConsents: consents });\r\n    }\r\n\r\n    return consents;\r\n  };\r\n\r\n  getPublisherConsents = async () => {\r\n    const { config } = useConfigStore.getState();\r\n\r\n    useAccountStore.setState({ publisherConsentsLoading: true });\r\n    const consents = await this.accountService.getPublisherConsents(config);\r\n\r\n    useAccountStore.setState({ publisherConsents: consents, publisherConsentsLoading: false });\r\n  };\r\n\r\n  getCaptureStatus = async (): Promise<GetCaptureStatusResponse> => {\r\n    const { getAccountInfo } = useAccountStore.getState();\r\n    const { customer } = getAccountInfo();\r\n\r\n    return this.accountService.getCaptureStatus({ customer });\r\n  };\r\n\r\n  updateCaptureAnswers = async (capture: Capture): Promise<Capture> => {\r\n    const { getAccountInfo } = useAccountStore.getState();\r\n    const { customer, customerConsents } = getAccountInfo();\r\n\r\n    const updatedCustomer = await this.accountService.updateCaptureAnswers({ customer, ...capture });\r\n\r\n    useAccountStore.setState({\r\n      user: updatedCustomer,\r\n      customerConsents,\r\n    });\r\n\r\n    return updatedCustomer;\r\n  };\r\n\r\n  resetPassword = async (email: string, resetUrl: string) => {\r\n    await this.accountService.resetPassword({\r\n      customerEmail: email,\r\n      resetUrl,\r\n    });\r\n  };\r\n\r\n  changePasswordWithOldPassword = async (oldPassword: string, newPassword: string, newPasswordConfirmation: string) => {\r\n    await this.accountService.changePasswordWithOldPassword({\r\n      oldPassword,\r\n      newPassword,\r\n      newPasswordConfirmation,\r\n    });\r\n  };\r\n\r\n  changePasswordWithToken = async (customerEmail: string, newPassword: string, resetPasswordToken: string, newPasswordConfirmation: string) => {\r\n    await this.accountService.changePasswordWithResetToken({\r\n      customerEmail,\r\n      newPassword,\r\n      resetPasswordToken,\r\n      newPasswordConfirmation,\r\n    });\r\n  };\r\n\r\n  updateSubscription = async (status: 'active' | 'cancelled'): Promise<unknown> => {\r\n    const { getAccountInfo } = useAccountStore.getState();\r\n\r\n    const { customerId } = getAccountInfo();\r\n\r\n    const { subscription } = useAccountStore.getState();\r\n    if (!subscription) throw new Error('user has no active subscription');\r\n\r\n    const response = await this.subscriptionService?.updateSubscription({\r\n      customerId,\r\n      offerId: subscription.offerId,\r\n      status,\r\n      unsubscribeUrl: subscription.unsubscribeUrl,\r\n    });\r\n\r\n    if (response.errors.length > 0) throw new Error(response.errors[0]);\r\n\r\n    await this.reloadSubscriptions({ retry: 10 });\r\n\r\n    return response?.responseData;\r\n  };\r\n\r\n  updateCardDetails = async ({\r\n    cardName,\r\n    cardNumber,\r\n    cvc,\r\n    expMonth,\r\n    expYear,\r\n    currency,\r\n  }: {\r\n    cardName: string;\r\n    cardNumber: string;\r\n    cvc: number;\r\n    expMonth: number;\r\n    expYear: number;\r\n    currency: string;\r\n  }) => {\r\n    const { getAccountInfo } = useAccountStore.getState();\r\n\r\n    const { customerId } = getAccountInfo();\r\n\r\n    assertModuleMethod(this.subscriptionService.updateCardDetails, 'updateCardDetails is not available in subscription service');\r\n\r\n    const response = await this.subscriptionService.updateCardDetails({\r\n      cardName,\r\n      cardNumber,\r\n      cvc,\r\n      expMonth,\r\n      expYear,\r\n      currency,\r\n    });\r\n    const activePayment = (await this.subscriptionService.getActivePayment({ customerId })) || null;\r\n\r\n    useAccountStore.setState({\r\n      loading: false,\r\n      activePayment,\r\n    });\r\n    return response;\r\n  };\r\n\r\n  checkEntitlements = async (offerId?: string): Promise<unknown> => {\r\n    if (!offerId) {\r\n      return false;\r\n    }\r\n\r\n    const { responseData } = await this.checkoutService.getEntitlements({ offerId });\r\n    return !!responseData?.accessGranted;\r\n  };\r\n\r\n  // This currently supports only one plan, as the current usage for the media metadata requires only one plan_id provided.\r\n  // TODO: Support for multiple plans should be added. Revisit this logic once the dependency on plan_id is changed.\r\n  getEntitledPlans = async (): Promise<Plan | null> => {\r\n    const { config, settings } = useConfigStore.getState();\r\n    const siteId = config.siteId;\r\n    const isAccessBridgeEnabled = !!settings?.apiAccessBridgeUrl;\r\n\r\n    // This should be only used when access bridge is defined, regardless of the integration type.\r\n    if (!isAccessBridgeEnabled) {\r\n      return null;\r\n    }\r\n\r\n    const response = await this.entitlementService.getEntitledPlans({ siteId });\r\n    if (response?.plans?.length) {\r\n      // Find the SVOD plan or fallback to the first available plan\r\n      const entitledPlan = response.plans.find((plan) => plan.metadata.access_model === 'svod') || response.plans[0];\r\n      useAccountStore.setState({ entitledPlan });\r\n      return entitledPlan;\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  reloadSubscriptions = async (\r\n    { delay, retry }: { delay?: number; retry?: number } = {\r\n      delay: 0,\r\n      retry: 0,\r\n    },\r\n  ): Promise<unknown> => {\r\n    useAccountStore.setState({ loading: true });\r\n\r\n    const { getAccountInfo } = useAccountStore.getState();\r\n    const { customerId } = getAccountInfo();\r\n    const { accessModel } = useConfigStore.getState();\r\n\r\n    // The subscription data takes a few seconds to load after it's purchased,\r\n    // so here's a delay mechanism to give it time to process\r\n    if (delay && delay > 0) {\r\n      return new Promise((resolve: (value?: unknown) => void) => {\r\n        setTimeout(() => {\r\n          this.reloadSubscriptions({ retry }).finally(resolve);\r\n        }, delay);\r\n      });\r\n    }\r\n\r\n    // For non-SVOD platforms, there could be TVOD items, so we only reload entitlements\r\n    if (accessModel !== 'SVOD') {\r\n      await this.refreshEntitlements?.();\r\n\r\n      return useAccountStore.setState({ loading: false });\r\n    }\r\n\r\n    const [activeSubscription, transactions, activePayment] = await Promise.all([\r\n      this.subscriptionService.getActiveSubscription({ customerId }),\r\n      this.subscriptionService.getAllTransactions({ customerId }),\r\n      this.subscriptionService.getActivePayment({ customerId }),\r\n    ]);\r\n\r\n    let pendingOffer: Offer | null = null;\r\n\r\n    if (!activeSubscription && !!retry && retry > 0) {\r\n      const retryDelay = 1500; // Any initial delay has already occurred, so we can set this to a fixed value\r\n\r\n      return await this.reloadSubscriptions({ delay: retryDelay, retry: retry - 1 });\r\n    }\r\n\r\n    // resolve and fetch the pending offer after upgrade/downgrade\r\n    try {\r\n      if (activeSubscription?.pendingSwitchId) {\r\n        assertModuleMethod(this.checkoutService.getOffer, 'getOffer is not available in checkout service');\r\n        assertModuleMethod(this.checkoutService.getSubscriptionSwitch, 'getSubscriptionSwitch is not available in checkout service');\r\n\r\n        const switchOffer = await this.checkoutService.getSubscriptionSwitch({ switchId: activeSubscription.pendingSwitchId });\r\n        const offerResponse = await this.checkoutService.getOffer({ offerId: switchOffer.responseData.toOfferId });\r\n\r\n        pendingOffer = offerResponse.responseData;\r\n      }\r\n    } catch (error: unknown) {\r\n      logError('AccountController', 'Failed to fetch the pending offer', { error });\r\n    }\r\n\r\n    // let the app know to refresh the entitlements\r\n    await this.refreshEntitlements?.();\r\n\r\n    useAccountStore.setState({\r\n      subscription: activeSubscription,\r\n      loading: false,\r\n      pendingOffer,\r\n      transactions,\r\n      activePayment,\r\n    });\r\n  };\r\n\r\n  exportAccountData = async () => {\r\n    const { canExportAccountData } = this.getFeatures();\r\n\r\n    assertModuleMethod(this.accountService.exportAccountData, 'exportAccountData is not available in account service');\r\n    assertFeature(canExportAccountData, 'Export account');\r\n\r\n    return this.accountService?.exportAccountData(undefined);\r\n  };\r\n\r\n  getSocialLoginUrls = (redirectUrl: string) => {\r\n    const { hasSocialURLs } = this.getFeatures();\r\n\r\n    assertModuleMethod(this.accountService.getSocialUrls, 'getSocialUrls is not available in account service');\r\n    assertFeature(hasSocialURLs, 'Social logins');\r\n\r\n    return this.accountService.getSocialUrls({ redirectUrl });\r\n  };\r\n\r\n  deleteAccountData = async (password: string) => {\r\n    const { canDeleteAccount } = this.getFeatures();\r\n\r\n    assertModuleMethod(this.accountService.deleteAccount, 'deleteAccount is not available in account service');\r\n    assertFeature(canDeleteAccount, 'Delete account');\r\n\r\n    try {\r\n      await this.accountService.deleteAccount({ password });\r\n    } catch (error: unknown) {\r\n      const message = error instanceof Error ? error.message.toLowerCase() : '';\r\n\r\n      if (message.includes('invalid credentials')) {\r\n        throw new FormValidationError({ form: [i18next.t('user:account.delete_account.invalid_credentials')] });\r\n      }\r\n\r\n      throw new FormValidationError({ form: [i18next.t('user:account.delete_account.error')] });\r\n    }\r\n  };\r\n\r\n  getReceipt = async (transactionId: string) => {\r\n    assertModuleMethod(this.subscriptionService.fetchReceipt, 'fetchReceipt is not available in subscription service');\r\n\r\n    const { responseData } = await this.subscriptionService.fetchReceipt({ transactionId });\r\n\r\n    return responseData;\r\n  };\r\n\r\n  getAuthData = async () => {\r\n    return this.accountService.getAuthData();\r\n  };\r\n\r\n  subscribeToNotifications = async ({ uuid, onMessage }: SubscribeToNotificationsPayload) => {\r\n    return this.accountService.subscribeToNotifications({ uuid, onMessage });\r\n  };\r\n\r\n  getFeatures() {\r\n    return this.features;\r\n  }\r\n\r\n  private async afterLogin(user: Customer, customerConsents: CustomerConsent[] | null, registration = false) {\r\n    useAccountStore.setState({\r\n      user,\r\n      customerConsents,\r\n    });\r\n\r\n    await Promise.allSettled([\r\n      this.reloadSubscriptions(),\r\n      this.getPublisherConsents(),\r\n      // after registration, transfer the personal shelves to the account\r\n      registration ? this.favoritesController.persistFavorites() : this.favoritesController.restoreFavorites(),\r\n      registration ? this.watchHistoryController.persistWatchHistory() : this.watchHistoryController.restoreWatchHistory(),\r\n    ]);\r\n\r\n    useAccountStore.setState({ loading: false });\r\n  }\r\n\r\n  private validateInputLength = (values: { firstName: string; lastName: string }) => {\r\n    const errors: string[] = [];\r\n    if (Number(values?.firstName?.length) > 50) {\r\n      errors.push(i18next.t('account:validation.first_name'));\r\n    }\r\n    if (Number(values?.lastName?.length) > 50) {\r\n      errors.push(i18next.t('account:validation.last_name'));\r\n    }\r\n\r\n    return errors;\r\n  };\r\n\r\n  private clearLoginState = async () => {\r\n    useAccountStore.setState({\r\n      user: null,\r\n      subscription: null,\r\n      transactions: null,\r\n      activePayment: null,\r\n      customerConsents: null,\r\n      publisherConsents: null,\r\n      loading: false,\r\n    });\r\n\r\n    await this.favoritesController.restoreFavorites();\r\n    await this.watchHistoryController.restoreWatchHistory();\r\n  };\r\n}\r\n","import merge from 'lodash.merge';\r\nimport { inject, injectable } from 'inversify';\r\n\r\nimport { PersonalShelf } from '../constants';\r\nimport SettingsService from '../services/SettingsService';\r\nimport ConfigService from '../services/ConfigService';\r\nimport { container, getModule } from '../modules/container';\r\nimport StorageService from '../services/StorageService';\r\nimport type { Config } from '../../types/config';\r\nimport type { CalculateIntegrationType } from '../../types/calculate-integration-type';\r\nimport { DETERMINE_INTEGRATION_TYPE } from '../modules/types';\r\nimport { useConfigStore } from '../stores/ConfigStore';\r\nimport { logDebug } from '../logger';\r\n\r\nimport WatchHistoryController from './WatchHistoryController';\r\nimport FavoritesController from './FavoritesController';\r\nimport AccountController from './AccountController';\r\nimport AccessController from './AccessController';\r\n\r\n@injectable()\r\nexport default class AppController {\r\n  private readonly configService: ConfigService;\r\n  private readonly settingsService: SettingsService;\r\n  private readonly storageService: StorageService;\r\n\r\n  constructor(\r\n    @inject(ConfigService) configService: ConfigService,\r\n    @inject(SettingsService) settingsService: SettingsService,\r\n    @inject(StorageService) storageService: StorageService,\r\n  ) {\r\n    this.configService = configService;\r\n    this.settingsService = settingsService;\r\n    this.storageService = storageService;\r\n  }\r\n\r\n  loadAndValidateConfig = async (configSource: string | undefined) => {\r\n    const configLocation = this.configService.formatSourceLocation(configSource);\r\n    const defaultConfig = this.configService.getDefaultConfig();\r\n\r\n    if (!configLocation) {\r\n      useConfigStore.setState({ config: defaultConfig });\r\n    }\r\n\r\n    let config = await this.configService.loadConfig(configLocation);\r\n\r\n    config.id = configSource;\r\n    config.assets = config.assets || {};\r\n\r\n    // make sure the banner always defaults to the JWP banner when not defined in the config\r\n    if (!config.assets.banner) {\r\n      config.assets.banner = defaultConfig.assets.banner;\r\n    }\r\n\r\n    // Store the logo right away and set css variables so the error page will be branded\r\n    useConfigStore.setState((state) => merge({}, state, { config: { assets: { banner: config.assets.banner } } }));\r\n\r\n    config = await this.configService.validateConfig(config);\r\n    config = merge({}, defaultConfig, config);\r\n\r\n    return config;\r\n  };\r\n\r\n  initializeApp = async (url: string, language: string, refreshEntitlements?: () => Promise<void>) => {\r\n    logDebug('AppController', 'Initializing app', { url });\r\n\r\n    const settings = await this.settingsService.initialize();\r\n    const configSource = await this.settingsService.getConfigSource(settings, url);\r\n    const config = await this.loadAndValidateConfig(configSource);\r\n    const integrationType = this.calculateIntegrationType(config);\r\n\r\n    // update the config store\r\n    useConfigStore.setState({ config, loaded: true, integrationType });\r\n\r\n    // we could add the configSource to the storage prefix, but this would cause a breaking change for end users\r\n    // (since 'window.configId' isn't used anymore, all platforms currently use the same prefix)\r\n    this.storageService.initialize('jwapp');\r\n\r\n    // update settings in the config store\r\n    useConfigStore.setState({ settings });\r\n\r\n    // when an integration is set, we initialize the AccountController\r\n    if (integrationType) {\r\n      await getModule(AccountController).initialize(url, refreshEntitlements);\r\n    }\r\n\r\n    // when the apiAccessBridgeUrl is set up in the .ini file, we initialize the AccessController\r\n    if (settings?.apiAccessBridgeUrl) {\r\n      await getModule(AccessController).initialize();\r\n    }\r\n\r\n    if (config.features?.continueWatchingList && config.content.some((el) => el.type === PersonalShelf.ContinueWatching)) {\r\n      await getModule(WatchHistoryController).initialize(language);\r\n    }\r\n\r\n    if (config.features?.favoritesList && config.content.some((el) => el.type === PersonalShelf.Favorites)) {\r\n      await getModule(FavoritesController).initialize(language);\r\n    }\r\n\r\n    return { config, settings, configSource };\r\n  };\r\n\r\n  calculateIntegrationType = (config: Config) => {\r\n    const registerIntegrationTypes = container.getAll<CalculateIntegrationType>(DETERMINE_INTEGRATION_TYPE);\r\n\r\n    const activatedIntegrationTypes = registerIntegrationTypes.reduce((previousValue, calculateIntegrationType) => {\r\n      const integrationType = calculateIntegrationType(config);\r\n\r\n      return integrationType ? [...previousValue, integrationType] : previousValue;\r\n    }, [] as string[]);\r\n\r\n    if (activatedIntegrationTypes.length > 1) {\r\n      throw new Error(`Failed to initialize app, more than 1 integrations are enabled: ${activatedIntegrationTypes.join(', ')}`);\r\n    }\r\n\r\n    return activatedIntegrationTypes[0] || null;\r\n  };\r\n\r\n  getIntegrationType = (): string | null => {\r\n    const configState = useConfigStore.getState();\r\n\r\n    if (!configState.loaded) throw new Error('A call to `AppController#getIntegrationType()` was made before loading the config');\r\n\r\n    return configState.integrationType;\r\n  };\r\n\r\n  getApiAccessBridgeUrl = (): string | undefined => {\r\n    const configState = useConfigStore.getState();\r\n\r\n    if (!configState.loaded) throw new Error('A call to `AppController#getApiAccessBridgeUrl()` was made before loading the config');\r\n    return configState.settings?.apiAccessBridgeUrl || undefined;\r\n  };\r\n}\r\n","import type { EpgProgram } from '../../types/epg';\r\nimport type { PlaylistItem } from '../../types/playlist';\r\n\r\nexport default abstract class EpgService {\r\n  /**\r\n   * Fetch the schedule data for the given PlaylistItem\r\n   */\r\n  abstract fetchSchedule: (item: PlaylistItem) => Promise<unknown>;\r\n\r\n  /**\r\n   * Validate the given data with the schema and transform it into an EpgProgram\r\n   */\r\n  abstract transformProgram: (data: unknown) => Promise<EpgProgram>;\r\n}\r\n","import { addDays, differenceInDays } from 'date-fns';\r\nimport { injectable } from 'inversify';\r\n\r\nimport EpgService from '../services/EpgService';\r\nimport { EPG_TYPE } from '../constants';\r\nimport { getNamedModule } from '../modules/container';\r\nimport type { PlaylistItem } from '../../types/playlist';\r\nimport type { EpgChannel, EpgProgram } from '../../types/epg';\r\nimport { logDebug, logError, logWarn } from '../logger';\r\n\r\nexport const isFulfilled = <T>(input: PromiseSettledResult<T>): input is PromiseFulfilledResult<T> => {\r\n  if (input.status === 'fulfilled') {\r\n    return true;\r\n  }\r\n\r\n  logError('EpgController', `An error occurred resolving a promise: `, { error: input.reason });\r\n  return false;\r\n};\r\n\r\n@injectable()\r\nexport default class EpgController {\r\n  /**\r\n   * Update the start and end time properties of the given programs with the current date.\r\n   * This can be used when having a static schedule or while developing\r\n   */\r\n  private generateDemoPrograms(programs: EpgProgram[]) {\r\n    const today = new Date();\r\n    const startDate = new Date(programs[0]?.startTime);\r\n\r\n    // this makes sure that the start of the day is correct. `startOfDay(startDate)` doesn't work since it can yield\r\n    // a different date depending on the timezone.\r\n    // for example, given a startTime of `2022-08-03T23:00:00Z` will parse to `2022-08-04T01:00:00+0200` in\r\n    // Europe/Amsterdam (GMT+2) which makes startOfDay return `2022-08-04T00:00:00+0200`.\r\n    const utcStartDate = new Date(Date.UTC(startDate.getUTCFullYear(), startDate.getUTCMonth(), startDate.getUTCDate()));\r\n    const daysDelta = differenceInDays(today, utcStartDate);\r\n\r\n    return programs.map((program, idx) => ({\r\n      ...program,\r\n      id: `${program.id}_${idx}`,\r\n      startTime: addDays(new Date(program.startTime), daysDelta).toJSON(),\r\n      endTime: addDays(new Date(program.endTime), daysDelta).toJSON(),\r\n    }));\r\n  }\r\n\r\n  /**\r\n   * Ensure the given data validates to the EpgProgram schema\r\n   */\r\n  parseSchedule = async (data: unknown, item: PlaylistItem) => {\r\n    const demo = !!item.scheduleDemo || false;\r\n\r\n    const epgService = this.getEpgService(item);\r\n\r\n    if (!Array.isArray(data)) return [];\r\n\r\n    const transformResults = await Promise.allSettled(\r\n      data.map((program) =>\r\n        epgService\r\n          ?.transformProgram(program)\r\n          // This quiets promise resolution errors in the console\r\n          .catch((error) => {\r\n            logDebug('EpgController', 'Failed to transform a program', { error, program });\r\n            return undefined;\r\n          }),\r\n      ),\r\n    );\r\n\r\n    const programs = transformResults\r\n      .filter(isFulfilled)\r\n      .map((result) => result.value)\r\n      .filter((program): program is EpgProgram => !!program);\r\n\r\n    return demo ? this.generateDemoPrograms(programs) : programs;\r\n  };\r\n\r\n  /**\r\n   * Fetch and parse the EPG schedule for the given PlaylistItem.\r\n   * When there is no program (empty schedule) or the request fails, it returns a static program.\r\n   */\r\n  getSchedule = async (item: PlaylistItem) => {\r\n    const epgService = this.getEpgService(item);\r\n\r\n    const schedule = await epgService?.fetchSchedule(item);\r\n    const programs = await this.parseSchedule(schedule, item);\r\n\r\n    const catchupHours = item.catchupHours && parseInt(item.catchupHours);\r\n\r\n    return {\r\n      id: item.mediaid,\r\n      title: item.title,\r\n      description: item.description,\r\n      catchupHours: catchupHours || 8,\r\n      channelLogoImage: item.channelLogoImage,\r\n      backgroundImage: item.backgroundImage,\r\n      programs,\r\n    } as EpgChannel;\r\n  };\r\n\r\n  getEpgService = (item: PlaylistItem) => {\r\n    const scheduleType = item?.scheduleType?.toLocaleLowerCase() || EPG_TYPE.jwp;\r\n    const service = getNamedModule(EpgService, scheduleType, false);\r\n\r\n    if (!service) {\r\n      logWarn('EpgController', `No epg service was added for the ${scheduleType} schedule type`);\r\n    }\r\n\r\n    return service;\r\n  };\r\n\r\n  /**\r\n   * Get all schedules for the given PlaylistItem's\r\n   */\r\n  getSchedules = async (items: PlaylistItem[]) => {\r\n    return Promise.all(items.map((item) => this.getSchedule(item)));\r\n  };\r\n}\r\n","import { object, string } from 'yup';\r\nimport { parse } from 'date-fns';\r\nimport { injectable } from 'inversify';\r\n\r\nimport EpgService from '../EpgService';\r\nimport type { PlaylistItem } from '../../../types/playlist';\r\nimport type { EpgProgram } from '../../../types/epg';\r\nimport { logError, logWarn } from '../../logger';\r\n\r\nconst viewNexaEpgProgramSchema = object().shape({\r\n  'episode-num': object().shape({\r\n    '#text': string().required(),\r\n  }),\r\n  title: object().shape({\r\n    '#text': string().required(),\r\n  }),\r\n  desc: object().shape({\r\n    '#text': string(),\r\n  }),\r\n  icon: object().shape({\r\n    src: string(),\r\n  }),\r\n  start: string().required(),\r\n  stop: string().required(),\r\n});\r\n\r\nconst parseData = (date: string): string => parse(date, 'yyyyMdHms xxxx', new Date()).toISOString();\r\n\r\n@injectable()\r\nexport default class ViewNexaEpgService extends EpgService {\r\n  transformProgram = async (data: unknown): Promise<EpgProgram> => {\r\n    const program = await viewNexaEpgProgramSchema.validate(data);\r\n\r\n    return {\r\n      id: program['episode-num']['#text'],\r\n      title: program['title']['#text'],\r\n      startTime: parseData(program['start']),\r\n      endTime: parseData(program['stop']),\r\n      description: program?.['desc']?.['#text'],\r\n      cardImage: program?.['icon']?.['src'],\r\n      backgroundImage: program?.['icon']?.['src'],\r\n    };\r\n  };\r\n\r\n  fetchSchedule = async (item: PlaylistItem) => {\r\n    const { XMLParser } = await import('fast-xml-parser');\r\n\r\n    const scheduleUrl = item.scheduleUrl;\r\n\r\n    if (!scheduleUrl) {\r\n      logWarn('ViewNexaEpgService', 'Tried requesting a schedule for an item with missing `scheduleUrl`', { item });\r\n      return undefined;\r\n    }\r\n\r\n    const xmlParserOptions = {\r\n      ignoreAttributes: false,\r\n      attributeNamePrefix: '',\r\n    };\r\n\r\n    try {\r\n      const data = await fetch(scheduleUrl).then((res) => res.text());\r\n      const parser = new XMLParser(xmlParserOptions);\r\n      const schedule = parser.parse(data);\r\n\r\n      return schedule?.tv?.programme || [];\r\n    } catch (error: unknown) {\r\n      if (error instanceof Error) {\r\n        logError('ViewNexaEpgService', `Fetch failed for View Nexa EPG schedule: '${scheduleUrl}'`, { error });\r\n      }\r\n    }\r\n  };\r\n}\r\n","import { array, object, string } from 'yup';\r\nimport { isValid } from 'date-fns';\r\nimport { injectable } from 'inversify';\r\n\r\nimport EpgService from '../EpgService';\r\nimport type { PlaylistItem } from '../../../types/playlist';\r\nimport type { EpgProgram } from '../../../types/epg';\r\nimport { getDataOrThrow } from '../../utils/api';\r\nimport { logError, logWarn } from '../../logger';\r\n\r\nconst AUTHENTICATION_HEADER = 'API-KEY';\r\n\r\nconst jwEpgProgramSchema = object().shape({\r\n  id: string().required(),\r\n  title: string().required(),\r\n  startTime: string()\r\n    .required()\r\n    .test((value) => (value ? isValid(new Date(value)) : false)),\r\n  endTime: string()\r\n    .required()\r\n    .test((value) => (value ? isValid(new Date(value)) : false)),\r\n  chapterPointCustomProperties: array().of(\r\n    object().shape({\r\n      key: string().required(),\r\n      value: string().test('required-but-empty', 'value is required', (value: unknown) => typeof value === 'string'),\r\n    }),\r\n  ),\r\n});\r\n\r\n@injectable()\r\nexport default class JWEpgService extends EpgService {\r\n  transformProgram = async (data: unknown): Promise<EpgProgram> => {\r\n    const program = await jwEpgProgramSchema.validate(data);\r\n    const image = program.chapterPointCustomProperties?.find((item) => item.key === 'image')?.value || undefined;\r\n\r\n    return {\r\n      id: program.id,\r\n      title: program.title,\r\n      startTime: program.startTime,\r\n      endTime: program.endTime,\r\n      cardImage: image,\r\n      backgroundImage: image,\r\n      description: program.chapterPointCustomProperties?.find((item) => item.key === 'description')?.value || undefined,\r\n    };\r\n  };\r\n\r\n  fetchSchedule = async (item: PlaylistItem) => {\r\n    if (!item.scheduleUrl) {\r\n      logWarn('JWEpgService', 'Tried requesting a schedule for an item with missing `scheduleUrl`', { item });\r\n      return undefined;\r\n    }\r\n\r\n    const headers = new Headers();\r\n\r\n    // add authentication token when `scheduleToken` is defined\r\n    if (item.scheduleToken) {\r\n      headers.set(AUTHENTICATION_HEADER, item.scheduleToken);\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(item.scheduleUrl, {\r\n        headers,\r\n      });\r\n\r\n      // await needed to ensure the error is caught here\r\n      return await getDataOrThrow(response);\r\n    } catch (error: unknown) {\r\n      if (error instanceof Error) {\r\n        logError('JWEpgService', `Fetch failed for EPG schedule: '${item.scheduleUrl}'`, { error });\r\n      }\r\n    }\r\n  };\r\n}\r\n","import type { interfaces } from 'inversify';\r\n\r\nimport AppController from '../../controllers/AppController';\r\n\r\n/**\r\n * Retrieves the access bridge URL from the AppController.\r\n * If the access bridge URL is defined in the application's .ini configuration file,\r\n * the function returns the URL. If the value is not defined, it returns `undefined`.\r\n */\r\nexport const getApiAccessBridgeUrl = (context: interfaces.Context) => {\r\n  return context.container.get(AppController).getApiAccessBridgeUrl();\r\n};\r\n","type QueueItem<T> = {\r\n  resolve: (data?: T) => void;\r\n  reject: (reason?: unknown) => void;\r\n};\r\n\r\n/**\r\n * A really simple promise queue implementation that can be used to enqueue a promise to be resolved later from within\r\n * the same context.\r\n *\r\n * For example, when a request needs to refresh an access token but multiple requests are called parallel (without\r\n * knowing from each other), a promise queue can be used to wait for the main process to be resolved.\r\n *\r\n * So the first request decides the access token needs to be refreshed and enqueues a request to the refresh endpoint.\r\n * The next request that is performed also sees that access token needs to be refreshed, but since the first request\r\n * already is performing the refresh, it is added to the promise queue and waits until the main promise is resolved\r\n * (or rejected).\r\n */\r\nexport class PromiseQueue<T = undefined> {\r\n  private queue: QueueItem<T>[] = [];\r\n\r\n  getLength() {\r\n    return this.queue.length;\r\n  }\r\n\r\n  /**\r\n   * Enqueues a promise and wait for the promise to be resolved (or rejected).\r\n   */\r\n  async enqueue() {\r\n    return new Promise<T | undefined>((resolve, reject) => {\r\n      this.queue.push({ resolve, reject });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Resolve all promises and clear the queue. Optionally pas in data confirming to the type.\r\n   */\r\n  async resolve(data?: T) {\r\n    const promises = this.queue.map(({ resolve }) => resolve(data));\r\n    this.queue = [];\r\n\r\n    // optionally wait for all promises\r\n    await Promise.allSettled(promises);\r\n  }\r\n\r\n  /**\r\n   * Reject all promises and clear the queue. Optionally pas in a reason.\r\n   */\r\n  async reject(reason?: unknown) {\r\n    const promises = this.queue.map(({ reject }) => reject(reason));\r\n    this.queue = [];\r\n\r\n    // optionally wait for all promises\r\n    await Promise.allSettled(promises);\r\n  }\r\n}\r\n","import { jwtDecode } from 'jwt-decode';\r\nimport { object, string } from 'yup';\r\nimport { inject, injectable, optional } from 'inversify';\r\n\r\nimport { IS_DEVELOPMENT_BUILD } from '../../../utils/common';\r\nimport { PromiseQueue } from '../../../utils/promiseQueue';\r\nimport type { AuthData } from '../../../../types/account';\r\nimport StorageService from '../../StorageService';\r\nimport { BROADCAST_CHANNEL, GET_CUSTOMER_IP } from '../../../modules/types';\r\nimport type { GetCustomerIP } from '../../../../types/get-customer-ip';\r\nimport { logDebug, logError } from '../../../logger';\r\nimport type { BroadcastChannel } from '../../../../types/broadcast-channel';\r\n\r\nimport type { GetLocalesResponse } from './types/account';\r\nimport type { Response } from './types/api';\r\n\r\nconst AUTH_PERSIST_KEY = 'auth';\r\n\r\ntype Tokens = {\r\n  accessToken: string;\r\n  refreshToken: string;\r\n};\r\n\r\ntype MessageAction = 'refreshing' | 'resolved' | 'rejected';\r\n\r\ntype MessageData = {\r\n  action: MessageAction;\r\n  tokens?: Tokens;\r\n};\r\n\r\ntype JWTPayload = {\r\n  exp?: number;\r\n};\r\n\r\ntype RequestOptions = {\r\n  authenticate?: boolean;\r\n  keepalive?: boolean;\r\n};\r\n\r\nconst tokensSchema = object().shape({\r\n  accessToken: string().required(),\r\n  refreshToken: string().required(),\r\n});\r\n\r\n/**\r\n * Validate the given input if it confirms to the tokenSchema\r\n */\r\nconst isValidTokens = (candidate: unknown): candidate is Tokens => {\r\n  return tokensSchema.isValidSync(candidate);\r\n};\r\n\r\n/**\r\n * Given an JWT, return token expiration in milliseconds. Returns -1 when the token is invalid.\r\n */\r\nconst getTokenExpiration = (token: string) => {\r\n  try {\r\n    const decodedToken: JWTPayload = jwtDecode(token);\r\n\r\n    if (typeof decodedToken.exp === 'number') {\r\n      return decodedToken.exp * 1000;\r\n    }\r\n  } catch (error: unknown) {\r\n    // failed to parse the JWT string\r\n  }\r\n\r\n  return -1;\r\n};\r\n\r\n/**\r\n * The AuthService is responsible for managing JWT access tokens and refresh tokens.\r\n *\r\n * Once an access token and refresh token is set, it will automatically refresh the access token when it is about to\r\n * expire.\r\n *\r\n * It uses a PromiseQueue to prevent multiple instances refreshing the same token which fails.\r\n *\r\n * The Broadcaster ensures that all potential browser tabs are notified about the updated token. This prevents\r\n * race-conditions when the user has multiple tabs open (but also very helpful while developing).\r\n */\r\n\r\n@injectable()\r\nexport default class CleengService {\r\n  protected readonly storageService;\r\n  protected readonly getCustomerIP;\r\n  protected readonly channel: BroadcastChannel<MessageData> | undefined;\r\n  protected readonly queue = new PromiseQueue();\r\n  protected isRefreshing = false;\r\n  protected expiration = -1;\r\n\r\n  sandbox = false;\r\n  tokens: Tokens | null = null;\r\n\r\n  constructor(\r\n    @inject(StorageService) storageService: StorageService,\r\n    @inject(GET_CUSTOMER_IP) getCustomerIP: GetCustomerIP,\r\n    @inject(BROADCAST_CHANNEL) @optional() channel?: BroadcastChannel<MessageData>,\r\n  ) {\r\n    this.storageService = storageService;\r\n    this.getCustomerIP = getCustomerIP;\r\n\r\n    this.channel = channel;\r\n    this.channel?.addEventListener('message', this.handleBroadcastMessage);\r\n  }\r\n\r\n  /**\r\n   * Persist the given token in the storage. Removes the token when the given token is `null`.\r\n   */\r\n  private async persistInStorage(tokens: Tokens | null) {\r\n    if (tokens) {\r\n      await this.storageService.setItem(AUTH_PERSIST_KEY, JSON.stringify(tokens));\r\n    } else {\r\n      await this.storageService.removeItem(AUTH_PERSIST_KEY);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * The `logoutCallback` is a delegate that can be set to handle what should happen when the token is expired or not\r\n   * valid anymore. Since this service shouldn't care about the UI or Zustand state, a controller can use this delegate\r\n   * to update the UI and clear the logged in state. Alternatively, this could dispatch an event, but a delegate is\r\n   * easier to align with the InPlayer integration.\r\n   */\r\n  private logoutCallback?: () => Promise<void>;\r\n\r\n  /**\r\n   * This function does the actual refresh of the access token by calling the `refreshToken` endpoint in the Cleeng\r\n   * service.\r\n   */\r\n  private getNewTokens: (tokens: Tokens) => Promise<Tokens | null> = async ({ refreshToken }) => {\r\n    try {\r\n      const { responseData: newTokens } = await this.post<Response<AuthData>>('/auths/refresh_token', JSON.stringify({ refreshToken }));\r\n\r\n      return {\r\n        accessToken: newTokens.jwt,\r\n        refreshToken: newTokens.refreshToken,\r\n      };\r\n    } catch (error: unknown) {\r\n      if (error instanceof Error) {\r\n        logDebug('CleengService', 'Failed to refresh accessToken', { error });\r\n\r\n        // only logout when the token is expired or invalid, this prevents logging out users when the request failed due to a\r\n        // network error or for aborted requests\r\n        if (error.message.includes('Refresh token is expired or does not exist') || error.message.includes('Missing or invalid parameter')) {\r\n          if (!this.logoutCallback) {\r\n            logDebug('CleengService', 'logoutCallback is not set');\r\n          }\r\n          await this.logoutCallback?.();\r\n        }\r\n      }\r\n\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * This function is called when a broadcast message is received from another browser tab (same origin)\r\n   */\r\n  private handleBroadcastMessage = async (data: MessageData) => {\r\n    this.isRefreshing = data.action === 'refreshing';\r\n\r\n    if (data.tokens) {\r\n      await this.setTokens(data.tokens);\r\n    }\r\n\r\n    if (data.action === 'resolved') {\r\n      await this.queue.resolve();\r\n    } else if (data.action === 'rejected') {\r\n      await this.queue.reject();\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Notify other browser tabs about a change in the auth state\r\n   */\r\n  private sendBroadcastMessage = (state: MessageAction, tokens?: Tokens) => {\r\n    if (!this.channel) return;\r\n\r\n    const message: MessageData = {\r\n      action: state,\r\n      tokens,\r\n    };\r\n\r\n    this.channel.postMessage(message);\r\n  };\r\n\r\n  private getBaseUrl = () => (this.sandbox ? 'https://mediastore-sandbox.cleeng.com' : 'https://mediastore.cleeng.com');\r\n\r\n  private performRequest = async (path: string = '/', method = 'GET', body?: string, options: RequestOptions = {}) => {\r\n    try {\r\n      const token = options.authenticate ? await this.getAccessTokenOrThrow() : undefined;\r\n\r\n      const resp = await fetch(`${this.getBaseUrl()}${path}`, {\r\n        headers: {\r\n          Accept: 'application/json',\r\n          'Content-Type': 'application/json',\r\n          Authorization: token ? `Bearer ${token}` : '',\r\n        },\r\n        keepalive: options.keepalive,\r\n        method,\r\n        body,\r\n      });\r\n\r\n      return await resp.json();\r\n    } catch (error: unknown) {\r\n      return {\r\n        errors: Array.of(error instanceof Error ? error.message : String(error)),\r\n      };\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Initialize the auth service and try to restore the session from the storage.\r\n   *\r\n   * When a valid session is found, it refreshes the access token when needed.\r\n   *\r\n   * For development builds, a small random delay is added to prevent all open tabs refreshing the same token when\r\n   * being fully refreshed.\r\n   */\r\n  initialize = async (sandbox: boolean, logoutCallback: () => Promise<void>) => {\r\n    this.sandbox = sandbox;\r\n    this.logoutCallback = logoutCallback;\r\n\r\n    await this.restoreTokensFromStorage();\r\n\r\n    // wait a random time to prevent refresh token race-conditions when multiple tabs are open\r\n    // this is only needed when dealing with a live reload environment\r\n    if (IS_DEVELOPMENT_BUILD) {\r\n      await new Promise((resolve) => setTimeout(resolve, Math.random() * 500));\r\n    }\r\n\r\n    await this.maybeRefreshAccessToken();\r\n  };\r\n\r\n  /**\r\n   * Set tokens and persist the tokens in the storage\r\n   */\r\n  setTokens = async (tokens: Tokens) => {\r\n    this.tokens = tokens;\r\n    this.expiration = getTokenExpiration(tokens.accessToken);\r\n\r\n    await this.persistInStorage(this.tokens);\r\n  };\r\n\r\n  /**\r\n   * Remove tokens and clear the storage\r\n   */\r\n  clearTokens = async () => {\r\n    this.tokens = null;\r\n\r\n    await this.persistInStorage(null);\r\n  };\r\n\r\n  /**\r\n   * Try to restore tokens from the storage and overwrite the current when they are newer.\r\n   */\r\n  restoreTokensFromStorage = async () => {\r\n    const tokensString = await this.storageService.getItem(AUTH_PERSIST_KEY, false);\r\n    let tokens;\r\n\r\n    if (typeof tokensString !== 'string') return;\r\n\r\n    try {\r\n      tokens = JSON.parse(tokensString);\r\n\r\n      if (!isValidTokens(tokens)) return;\r\n    } catch {\r\n      return;\r\n    }\r\n\r\n    const expires = getTokenExpiration(tokens.accessToken);\r\n\r\n    // verify if the token from storage is newer than the one we have in the current session\r\n    if (expires > this.expiration) {\r\n      this.tokens = tokens;\r\n      this.expiration = expires;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Returns true when the current access token is expired\r\n   */\r\n  accessTokenIsExpired = () => {\r\n    if (!this.tokens) return false;\r\n\r\n    return this.expiration > -1 && Date.now() - this.expiration > 0;\r\n  };\r\n\r\n  hasTokens = () => {\r\n    return !!this.tokens;\r\n  };\r\n\r\n  /**\r\n   * Don't use this method directly, but use the `maybeRefreshAccessToken` method instead.\r\n   * This function will fetch new tokens and updates the isRefreshing state. It also resolves or rejects the promise\r\n   * queue.\r\n   */\r\n  private refreshTokens = async (tokens: Tokens) => {\r\n    this.sendBroadcastMessage('refreshing');\r\n    this.isRefreshing = true;\r\n\r\n    try {\r\n      const newTokens = await this.getNewTokens(tokens);\r\n\r\n      if (newTokens) {\r\n        await this.setTokens(newTokens);\r\n        this.isRefreshing = false;\r\n        this.sendBroadcastMessage('resolved', newTokens);\r\n        await this.queue.resolve();\r\n\r\n        return;\r\n      }\r\n    } catch (error: unknown) {\r\n      logDebug('CleengService', 'Failed to refresh tokens', { error });\r\n    }\r\n\r\n    // if we are here, we didn't receive new tokens\r\n    await this.clearTokens();\r\n    this.isRefreshing = false;\r\n    this.sendBroadcastMessage('rejected');\r\n    await this.queue.reject();\r\n  };\r\n\r\n  /**\r\n   * Use this function ensure that the access token is not expired. If the current token is expired, it will request\r\n   * new tokens. When another session is already refreshing the tokens it will wait in queue instead and use the same\r\n   * results.\r\n   */\r\n  maybeRefreshAccessToken = async () => {\r\n    try {\r\n      // token is already refreshing, let's wait for it\r\n      if (this.isRefreshing) {\r\n        logDebug('CleengService', 'Token is already refreshing, waiting in queue...');\r\n        return await this.queue.enqueue();\r\n      }\r\n\r\n      // token is not expired or there is no session\r\n      if (!this.accessTokenIsExpired() || !this.tokens) {\r\n        return;\r\n      }\r\n\r\n      await this.refreshTokens(this.tokens);\r\n    } catch (error: unknown) {\r\n      logError('CleengService', 'Error caught while refreshing the access token', { error });\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Get access optional token\r\n   */\r\n  getAccessToken = async () => {\r\n    await this.maybeRefreshAccessToken();\r\n\r\n    // fallback to always \"syncing\" the tokens from storage in case the broadcast channel isn't supported\r\n    await this.restoreTokensFromStorage();\r\n\r\n    return this.tokens?.accessToken;\r\n  };\r\n\r\n  /**\r\n   * Get access token or throw an error\r\n   */\r\n  getAccessTokenOrThrow = async () => {\r\n    const accessToken = await this.getAccessToken();\r\n\r\n    if (!accessToken) {\r\n      throw new Error('Access token is missing');\r\n    }\r\n\r\n    return accessToken;\r\n  };\r\n\r\n  getLocales = async () => {\r\n    const customerIP = await this.getCustomerIP();\r\n\r\n    return this.get<GetLocalesResponse>(`/locales${customerIP ? '?customerIP=' + customerIP : ''}`);\r\n  };\r\n\r\n  get = <T>(path: string, options?: RequestOptions) => this.performRequest(path, 'GET', undefined, options) as Promise<T>;\r\n\r\n  patch = <T>(path: string, body?: string, options?: RequestOptions) => this.performRequest(path, 'PATCH', body, options) as Promise<T>;\r\n\r\n  put = <T>(path: string, body?: string, options?: RequestOptions) => this.performRequest(path, 'PUT', body, options) as Promise<T>;\r\n\r\n  post = <T>(path: string, body?: string, options?: RequestOptions) => this.performRequest(path, 'POST', body, options) as Promise<T>;\r\n\r\n  remove = <T>(path: string, options?: RequestOptions) => this.performRequest(path, 'DELETE', undefined, options) as Promise<T>;\r\n}\r\n","import type { CleengCustomer } from '../types/models';\r\nimport type { Customer } from '../../../../../types/account';\r\n\r\nexport const formatCustomer = (customer: CleengCustomer): Customer => {\r\n  return {\r\n    id: customer.id,\r\n    email: customer.email,\r\n    country: customer.country,\r\n    firstName: customer.firstName,\r\n    lastName: customer.lastName,\r\n    fullName: `${customer.firstName} ${customer.lastName}`,\r\n    // map `externalData` to `metadata` (NOTE; The Cleeng API returns parsed values)\r\n    metadata: customer.externalData || {},\r\n  };\r\n};\r\n","import type { PublisherConsent } from '../types/models';\r\nimport type { CustomFormField } from '../../../../../types/account';\r\n\r\nexport const formatPublisherConsent = (consent: PublisherConsent): CustomFormField => {\r\n  return {\r\n    type: 'checkbox',\r\n    name: consent.name,\r\n    label: consent.label,\r\n    defaultValue: '',\r\n    required: consent.required,\r\n    placeholder: consent.placeholder,\r\n    options: {},\r\n    enabledByDefault: false,\r\n    version: consent.version,\r\n  };\r\n};\r\n","import { jwtDecode } from 'jwt-decode';\r\nimport { inject, injectable } from 'inversify';\r\n\r\nimport type { AccessModel, Config } from '../../../../types/config';\r\nimport type {\r\n  AuthData,\r\n  ChangePassword,\r\n  ChangePasswordWithOldPassword,\r\n  GetCaptureStatus,\r\n  GetCaptureStatusResponse,\r\n  GetCustomerConsents,\r\n  GetPublisherConsents,\r\n  JwtDetails,\r\n  Login,\r\n  LoginPayload,\r\n  NotificationsData,\r\n  Register,\r\n  RegisterPayload,\r\n  ResetPassword,\r\n  UpdateCaptureAnswers,\r\n  UpdateCaptureAnswersPayload,\r\n  UpdateCustomer,\r\n  UpdateCustomerConsents,\r\n  UpdateCustomerConsentsPayload,\r\n  UpdateCustomerPayload,\r\n  UpdateFavorites,\r\n  UpdateWatchHistory,\r\n} from '../../../../types/account';\r\nimport AccountService from '../AccountService';\r\nimport { GET_CUSTOMER_IP } from '../../../modules/types';\r\nimport type { GetCustomerIP } from '../../../../types/get-customer-ip';\r\nimport { ACCESS_MODEL } from '../../../constants';\r\nimport type { ServiceResponse } from '../../../../types/service';\r\nimport type { SerializedWatchHistoryItem } from '../../../../types/watchHistory';\r\nimport type { SerializedFavorite } from '../../../../types/favorite';\r\n\r\nimport CleengService from './CleengService';\r\nimport type {\r\n  GetCustomerResponse,\r\n  GetCustomerConsentsResponse,\r\n  GetPublisherConsentsResponse,\r\n  UpdateConsentsResponse,\r\n  UpdateCustomerResponse,\r\n  AuthResponse,\r\n} from './types/account';\r\nimport { formatCustomer } from './formatters/customer';\r\nimport { formatPublisherConsent } from './formatters/consents';\r\nimport type { Response } from './types/api';\r\n\r\n@injectable()\r\nexport default class CleengAccountService extends AccountService {\r\n  protected readonly cleengService;\r\n  protected readonly getCustomerIP;\r\n  protected publisherId = '';\r\n\r\n  protected externalData: Record<string, unknown> = {};\r\n\r\n  accessModel: AccessModel = ACCESS_MODEL.AUTHVOD;\r\n  svodOfferIds: string[] = [];\r\n  sandbox = false;\r\n\r\n  constructor(@inject(CleengService) cleengService: CleengService, @inject(GET_CUSTOMER_IP) getCustomerIP: GetCustomerIP) {\r\n    super({\r\n      canUpdateEmail: true,\r\n      canSupportEmptyFullName: true,\r\n      canChangePasswordWithOldPassword: false,\r\n      canRenewSubscription: true,\r\n      canExportAccountData: false,\r\n      canDeleteAccount: false,\r\n      canUpdatePaymentMethod: true,\r\n      canShowReceipts: false,\r\n      hasSocialURLs: false,\r\n      hasNotifications: false,\r\n      // The 'externalData' attribute of Cleeng can contain max 4000 characters\r\n      watchListSizeLimit: 48,\r\n    });\r\n\r\n    this.cleengService = cleengService;\r\n    this.getCustomerIP = getCustomerIP;\r\n  }\r\n\r\n  private handleErrors = (errors: string[]) => {\r\n    if (errors.length > 0) {\r\n      throw new Error(errors[0]);\r\n    }\r\n  };\r\n\r\n  private getCustomerIdFromAuthData = (auth: AuthData) => {\r\n    const decodedToken: JwtDetails = jwtDecode(auth.jwt);\r\n    return decodedToken.customerId;\r\n  };\r\n\r\n  private getCustomer = async ({ customerId }: { customerId: string }) => {\r\n    const { responseData, errors } = await this.cleengService.get<GetCustomerResponse>(`/customers/${customerId}`, {\r\n      authenticate: true,\r\n    });\r\n\r\n    this.handleErrors(errors);\r\n    this.externalData = responseData.externalData || {};\r\n\r\n    return formatCustomer(responseData);\r\n  };\r\n\r\n  private getLocales = async () => {\r\n    return this.cleengService.getLocales();\r\n  };\r\n\r\n  initialize = async (config: Config, _url: string, logoutCallback: () => Promise<void>) => {\r\n    const cleengConfig = config?.integrations?.cleeng;\r\n\r\n    if (!cleengConfig?.id) {\r\n      throw new Error('Failed to initialize Cleeng integration. The publisherId is missing.');\r\n    }\r\n\r\n    // set accessModel and publisherId\r\n    this.publisherId = cleengConfig.id;\r\n    this.accessModel = cleengConfig.monthlyOffer || cleengConfig.yearlyOffer ? ACCESS_MODEL.SVOD : ACCESS_MODEL.AUTHVOD;\r\n    this.svodOfferIds = [cleengConfig?.monthlyOffer, cleengConfig?.yearlyOffer].filter(Boolean).map(String);\r\n\r\n    // initialize the Cleeng service\r\n    this.sandbox = !!cleengConfig.useSandbox;\r\n    await this.cleengService.initialize(this.sandbox, logoutCallback);\r\n  };\r\n\r\n  getAuthData = async () => {\r\n    if (this.cleengService.tokens) {\r\n      return {\r\n        jwt: this.cleengService.tokens.accessToken,\r\n        refreshToken: this.cleengService.tokens.refreshToken,\r\n      } as AuthData;\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  getCustomerConsents: GetCustomerConsents = async (payload) => {\r\n    const { customer } = payload;\r\n    const response = await this.cleengService.get<GetCustomerConsentsResponse>(`/customers/${customer?.id}/consents`, {\r\n      authenticate: true,\r\n    });\r\n    this.handleErrors(response.errors);\r\n\r\n    return response?.responseData?.consents || [];\r\n  };\r\n\r\n  updateCustomerConsents: UpdateCustomerConsents = async (payload) => {\r\n    const { customer } = payload;\r\n\r\n    const params: UpdateCustomerConsentsPayload = {\r\n      id: customer.id,\r\n      consents: payload.consents,\r\n    };\r\n\r\n    const response = await this.cleengService.put<UpdateConsentsResponse>(`/customers/${customer?.id}/consents`, JSON.stringify(params), {\r\n      authenticate: true,\r\n    });\r\n    this.handleErrors(response.errors);\r\n\r\n    return await this.getCustomerConsents(payload);\r\n  };\r\n\r\n  login: Login = async ({ email, password }) => {\r\n    const payload: LoginPayload = {\r\n      email,\r\n      password,\r\n      publisherId: this.publisherId,\r\n      customerIP: await this.getCustomerIP(),\r\n    };\r\n\r\n    const { responseData: auth, errors } = await this.cleengService.post<AuthResponse>('/auths', JSON.stringify(payload));\r\n    this.handleErrors(errors);\r\n\r\n    await this.cleengService.setTokens({ accessToken: auth.jwt, refreshToken: auth.refreshToken });\r\n\r\n    const { user, customerConsents } = await this.getUser();\r\n\r\n    return {\r\n      user,\r\n      auth,\r\n      customerConsents,\r\n    };\r\n  };\r\n\r\n  register: Register = async ({ email, password, consents, captchaValue }) => {\r\n    const localesResponse = await this.getLocales();\r\n\r\n    this.handleErrors(localesResponse.errors);\r\n\r\n    const payload: RegisterPayload = {\r\n      email,\r\n      password,\r\n      locale: localesResponse.responseData.locale,\r\n      country: localesResponse.responseData.country,\r\n      currency: localesResponse.responseData.currency,\r\n      publisherId: this.publisherId,\r\n      customerIP: await this.getCustomerIP(),\r\n      captchaValue,\r\n    };\r\n\r\n    const { responseData: auth, errors }: ServiceResponse<AuthData> = await this.cleengService.post('/customers', JSON.stringify(payload));\r\n    this.handleErrors(errors);\r\n\r\n    await this.cleengService.setTokens({ accessToken: auth.jwt, refreshToken: auth.refreshToken });\r\n\r\n    const { user } = await this.getUser();\r\n\r\n    const customerConsents = await this.updateCustomerConsents({ consents, customer: user }).catch(() => {\r\n      // error caught while updating the consents, but continue the registration process\r\n      return [];\r\n    });\r\n\r\n    return {\r\n      user,\r\n      auth,\r\n      customerConsents,\r\n    };\r\n  };\r\n\r\n  logout = async () => {\r\n    // clear the persisted access tokens\r\n    await this.cleengService.clearTokens();\r\n  };\r\n\r\n  getUser = async () => {\r\n    const authData = await this.getAuthData();\r\n\r\n    if (!authData) throw new Error('Not logged in');\r\n\r\n    const customerId = this.getCustomerIdFromAuthData(authData);\r\n    const user = await this.getCustomer({ customerId });\r\n    const consents = await this.getCustomerConsents({ customer: user });\r\n\r\n    return {\r\n      user,\r\n      customerConsents: consents,\r\n    };\r\n  };\r\n\r\n  getPublisherConsents: GetPublisherConsents = async () => {\r\n    const response = await this.cleengService.get<GetPublisherConsentsResponse>(`/publishers/${this.publisherId}/consents`);\r\n\r\n    this.handleErrors(response.errors);\r\n\r\n    return (response.responseData?.consents || []).map(formatPublisherConsent);\r\n  };\r\n\r\n  getCaptureStatus: GetCaptureStatus = async ({ customer }) => {\r\n    const response: ServiceResponse<GetCaptureStatusResponse> = await this.cleengService.get(`/customers/${customer?.id}/capture/status`, {\r\n      authenticate: true,\r\n    });\r\n\r\n    this.handleErrors(response.errors);\r\n\r\n    return response.responseData;\r\n  };\r\n\r\n  updateCaptureAnswers: UpdateCaptureAnswers = async ({ customer, ...payload }) => {\r\n    const params: UpdateCaptureAnswersPayload = {\r\n      customerId: customer.id,\r\n      ...payload,\r\n    };\r\n\r\n    const response = await this.cleengService.put<UpdateConsentsResponse>(`/customers/${customer.id}/capture`, JSON.stringify(params), {\r\n      authenticate: true,\r\n    });\r\n    this.handleErrors(response.errors);\r\n\r\n    return this.getCustomer({ customerId: customer.id });\r\n  };\r\n\r\n  resetPassword: ResetPassword = async (payload) => {\r\n    const response = await this.cleengService.put<Response<unknown>>(\r\n      '/customers/passwords',\r\n      JSON.stringify({\r\n        ...payload,\r\n        publisherId: this.publisherId,\r\n      }),\r\n    );\r\n\r\n    this.handleErrors(response.errors);\r\n  };\r\n\r\n  changePasswordWithResetToken: ChangePassword = async (payload) => {\r\n    const response = await this.cleengService.patch<Response<unknown>>(\r\n      '/customers/passwords',\r\n      JSON.stringify({\r\n        ...payload,\r\n        publisherId: this.publisherId,\r\n      }),\r\n    );\r\n\r\n    this.handleErrors(response.errors);\r\n  };\r\n\r\n  changePasswordWithOldPassword: ChangePasswordWithOldPassword = async () => {\r\n    // Cleeng doesn't support this feature\r\n  };\r\n\r\n  updateCustomer: UpdateCustomer = async (payload) => {\r\n    const { id, metadata, fullName, ...rest } = payload;\r\n    const params: UpdateCustomerPayload = {\r\n      id,\r\n      ...rest,\r\n    };\r\n\r\n    // enable keepalive to ensure data is persisted when closing the browser/tab\r\n    const { responseData, errors } = await this.cleengService.patch<UpdateCustomerResponse>(`/customers/${id}`, JSON.stringify(params), {\r\n      authenticate: true,\r\n      keepalive: true,\r\n    });\r\n\r\n    this.handleErrors(errors);\r\n    this.externalData = responseData.externalData || {};\r\n\r\n    return formatCustomer(responseData);\r\n  };\r\n\r\n  updateWatchHistory: UpdateWatchHistory = async ({ user, history }) => {\r\n    const payload = { id: user.id, externalData: { ...this.externalData, history } };\r\n    const { errors, responseData } = await this.cleengService.patch<UpdateCustomerResponse>(`/customers/${user.id}`, JSON.stringify(payload), {\r\n      authenticate: true,\r\n      keepalive: true,\r\n    });\r\n\r\n    this.handleErrors(errors);\r\n    this.externalData = responseData.externalData || {};\r\n  };\r\n\r\n  updateFavorites: UpdateFavorites = async ({ user, favorites }) => {\r\n    const payload = { id: user.id, externalData: { ...this.externalData, favorites } };\r\n    const { errors, responseData } = await this.cleengService.patch<UpdateCustomerResponse>(`/customers/${user.id}`, JSON.stringify(payload), {\r\n      authenticate: true,\r\n      keepalive: true,\r\n    });\r\n\r\n    this.handleErrors(errors);\r\n    this.externalData = responseData.externalData || {};\r\n  };\r\n\r\n  getWatchHistory = async () => {\r\n    return (this.externalData['history'] || []) as SerializedWatchHistoryItem[];\r\n  };\r\n\r\n  getFavorites = async () => {\r\n    return (this.externalData['favorites'] || []) as SerializedFavorite[];\r\n  };\r\n\r\n  subscribeToNotifications: NotificationsData = async () => {\r\n    return false;\r\n  };\r\n\r\n  getSocialUrls: undefined;\r\n\r\n  exportAccountData: undefined;\r\n\r\n  deleteAccount: undefined;\r\n}\r\n","import { inject, injectable } from 'inversify';\r\n\r\nimport type {\r\n  AddAdyenPaymentDetails,\r\n  CreateOrder,\r\n  CreateOrderPayload,\r\n  DeletePaymentMethod,\r\n  FinalizeAdyenPaymentDetails,\r\n  GetAdyenPaymentSession,\r\n  GetEntitlements,\r\n  GetFinalizeAdyenPayment,\r\n  GetInitialAdyenPayment,\r\n  GetOffer,\r\n  GetOffers,\r\n  GetOrder,\r\n  GetPaymentMethods,\r\n  GetSubscriptionSwitch,\r\n  GetSubscriptionSwitches,\r\n  PaymentWithoutDetails,\r\n  PaymentWithPayPal,\r\n  SwitchSubscription,\r\n  UpdateOrder,\r\n  UpdateOrderResponse,\r\n  UpdatePaymentWithPayPal,\r\n} from '../../../../types/checkout';\r\nimport CheckoutService from '../CheckoutService';\r\nimport { GET_CUSTOMER_IP } from '../../../modules/types';\r\nimport type { GetCustomerIP } from '../../../../types/get-customer-ip';\r\nimport type { ServiceResponse } from '../../../../types/service';\r\n\r\nimport CleengService from './CleengService';\r\n\r\n@injectable()\r\nexport default class CleengCheckoutService extends CheckoutService {\r\n  protected readonly cleengService: CleengService;\r\n  protected readonly getCustomerIP: GetCustomerIP;\r\n\r\n  constructor(@inject(CleengService) cleengService: CleengService, @inject(GET_CUSTOMER_IP) getCustomerIP: GetCustomerIP) {\r\n    super();\r\n    this.cleengService = cleengService;\r\n    this.getCustomerIP = getCustomerIP;\r\n  }\r\n\r\n  getOffers: GetOffers = async (payload) => {\r\n    return await Promise.all(\r\n      payload.offerIds.map(async (offerId) => {\r\n        const response = await this.getOffer({ offerId: String(offerId) });\r\n\r\n        if (response.errors.length > 0) {\r\n          throw new Error(response.errors[0]);\r\n        }\r\n\r\n        return response.responseData;\r\n      }),\r\n    );\r\n  };\r\n\r\n  getOffer: GetOffer = async (payload) => {\r\n    const customerIP = await this.getCustomerIP();\r\n\r\n    return this.cleengService.get(`/offers/${payload.offerId}${customerIP ? '?customerIP=' + customerIP : ''}`);\r\n  };\r\n\r\n  createOrder: CreateOrder = async (payload) => {\r\n    const locales = await this.cleengService.getLocales();\r\n\r\n    if (locales.errors.length > 0) throw new Error(locales.errors[0]);\r\n\r\n    const customerIP = locales.responseData.ipAddress;\r\n\r\n    const createOrderPayload: CreateOrderPayload = {\r\n      offerId: payload.offer.offerId,\r\n      customerId: payload.customerId,\r\n      country: payload.country,\r\n      currency: locales?.responseData?.currency || 'EUR',\r\n      customerIP,\r\n      paymentMethodId: payload.paymentMethodId,\r\n    };\r\n\r\n    return this.cleengService.post('/orders', JSON.stringify(createOrderPayload), { authenticate: true });\r\n  };\r\n\r\n  getOrder: GetOrder = async ({ orderId }) => {\r\n    return this.cleengService.get(`/orders/${orderId}`, { authenticate: true });\r\n  };\r\n\r\n  updateOrder: UpdateOrder = async ({ order, ...payload }) => {\r\n    const response = await this.cleengService.patch<ServiceResponse<UpdateOrderResponse>>(`/orders/${order.id}`, JSON.stringify(payload), {\r\n      authenticate: true,\r\n    });\r\n\r\n    if (response.errors.length) {\r\n      if (response.errors[0].includes(`Order with ${order.id} not found`)) {\r\n        throw new Error('Order not found');\r\n      }\r\n\r\n      if (response.errors[0].includes(`Coupon ${payload.couponCode} not found`)) {\r\n        throw new Error('Invalid coupon code');\r\n      }\r\n\r\n      if (response.errors[0].includes(`Coupon ${payload.couponCode} cannot be applied on this offer`)) {\r\n        throw new Error('Invalid coupon code for this offer');\r\n      }\r\n    }\r\n\r\n    return response;\r\n  };\r\n\r\n  getPaymentMethods: GetPaymentMethods = async () => {\r\n    return this.cleengService.get('/payment-methods', { authenticate: true });\r\n  };\r\n\r\n  paymentWithoutDetails: PaymentWithoutDetails = async (payload) => {\r\n    return this.cleengService.post('/payments', JSON.stringify(payload), { authenticate: true });\r\n  };\r\n\r\n  paymentWithPayPal: PaymentWithPayPal = async (payload) => {\r\n    const { order, successUrl, cancelUrl, errorUrl, captchaValue } = payload;\r\n\r\n    const paypalPayload = {\r\n      orderId: order.id,\r\n      successUrl,\r\n      cancelUrl,\r\n      errorUrl,\r\n      captchaValue,\r\n    };\r\n\r\n    return this.cleengService.post('/connectors/paypal/v1/tokens', JSON.stringify(paypalPayload), { authenticate: true });\r\n  };\r\n\r\n  getSubscriptionSwitches: GetSubscriptionSwitches = async (payload) => {\r\n    return this.cleengService.get(`/customers/${payload.customerId}/subscription_switches/${payload.offerId}/availability`, { authenticate: true });\r\n  };\r\n\r\n  getSubscriptionSwitch: GetSubscriptionSwitch = async (payload) => {\r\n    return this.cleengService.get(`/subscription_switches/${payload.switchId}`, { authenticate: true });\r\n  };\r\n\r\n  switchSubscription: SwitchSubscription = async (payload) => {\r\n    return this.cleengService.post(\r\n      `/customers/${payload.customerId}/subscription_switches/${payload.offerId}`,\r\n      JSON.stringify({ toOfferId: payload.toOfferId, switchDirection: payload.switchDirection }),\r\n      { authenticate: true },\r\n    );\r\n  };\r\n\r\n  getEntitlements: GetEntitlements = async (payload) => {\r\n    return this.cleengService.get(`/entitlements/${payload.offerId}`, { authenticate: true });\r\n  };\r\n\r\n  createAdyenPaymentSession: GetAdyenPaymentSession = async (payload) => {\r\n    return await this.cleengService.post('/connectors/adyen/sessions', JSON.stringify(payload), { authenticate: true });\r\n  };\r\n\r\n  initialAdyenPayment: GetInitialAdyenPayment = async (payload) =>\r\n    this.cleengService.post(\r\n      '/connectors/adyen/initial-payment',\r\n      JSON.stringify({ ...payload, attemptAuthentication: this.cleengService.sandbox ? 'always' : undefined }),\r\n      { authenticate: true },\r\n    );\r\n\r\n  finalizeAdyenPayment: GetFinalizeAdyenPayment = async (payload) =>\r\n    this.cleengService.post('/connectors/adyen/initial-payment/finalize', JSON.stringify(payload), { authenticate: true });\r\n\r\n  updatePaymentMethodWithPayPal: UpdatePaymentWithPayPal = async (payload) => {\r\n    return this.cleengService.post('/connectors/paypal/v1/payment_details/tokens', JSON.stringify(payload), { authenticate: true });\r\n  };\r\n\r\n  deletePaymentMethod: DeletePaymentMethod = async (payload) => {\r\n    return this.cleengService.remove(`/payment_details/${payload.paymentDetailsId}`, { authenticate: true });\r\n  };\r\n\r\n  addAdyenPaymentDetails: AddAdyenPaymentDetails = async (payload) =>\r\n    this.cleengService.post(\r\n      '/connectors/adyen/payment-details',\r\n      JSON.stringify({\r\n        ...payload,\r\n        attemptAuthentication: this.cleengService.sandbox ? 'always' : undefined,\r\n      }),\r\n      { authenticate: true },\r\n    );\r\n\r\n  finalizeAdyenPaymentDetails: FinalizeAdyenPaymentDetails = async (payload) =>\r\n    this.cleengService.post('/connectors/adyen/payment-details/finalize', JSON.stringify(payload), { authenticate: true });\r\n\r\n  directPostCardPayment = async () => false;\r\n}\r\n","import { inject, injectable } from 'inversify';\r\n\r\nimport { createURL } from '../../../utils/urlFormatting';\r\nimport type {\r\n  FetchReceipt,\r\n  GetActivePayment,\r\n  GetActiveSubscription,\r\n  GetAllTransactions,\r\n  GetPaymentDetails,\r\n  GetSubscriptions,\r\n  GetTransactions,\r\n  UpdateSubscription,\r\n} from '../../../../types/subscription';\r\nimport SubscriptionService from '../SubscriptionService';\r\n\r\nimport CleengService from './CleengService';\r\n\r\n@injectable()\r\nexport default class CleengSubscriptionService extends SubscriptionService {\r\n  protected readonly cleengService: CleengService;\r\n\r\n  constructor(@inject(CleengService) cleengService: CleengService) {\r\n    super();\r\n    this.cleengService = cleengService;\r\n  }\r\n\r\n  getActiveSubscription: GetActiveSubscription = async ({ customerId }) => {\r\n    const response = await this.getSubscriptions({ customerId });\r\n\r\n    if (response.errors.length > 0) return null;\r\n\r\n    return response.responseData.items.find((item) => item.status === 'active' || item.status === 'cancelled') || null;\r\n  };\r\n\r\n  getAllTransactions: GetAllTransactions = async ({ customerId }) => {\r\n    const response = await this.getTransactions({ customerId });\r\n\r\n    if (response.errors.length > 0) return null;\r\n\r\n    return response.responseData.items;\r\n  };\r\n\r\n  getActivePayment: GetActivePayment = async ({ customerId }) => {\r\n    const response = await this.getPaymentDetails({ customerId });\r\n\r\n    if (response.errors.length > 0) return null;\r\n\r\n    return response.responseData.paymentDetails.find((paymentDetails) => paymentDetails.active) || null;\r\n  };\r\n\r\n  getSubscriptions: GetSubscriptions = async (payload) => {\r\n    return this.cleengService.get(`/customers/${payload.customerId}/subscriptions`, { authenticate: true });\r\n  };\r\n\r\n  updateSubscription: UpdateSubscription = async (payload) => {\r\n    return this.cleengService.patch(`/customers/${payload.customerId}/subscriptions`, JSON.stringify(payload), { authenticate: true });\r\n  };\r\n\r\n  getPaymentDetails: GetPaymentDetails = async (payload) => {\r\n    return this.cleengService.get(`/customers/${payload.customerId}/payment_details`, { authenticate: true });\r\n  };\r\n\r\n  getTransactions: GetTransactions = async ({ customerId, limit, offset }) => {\r\n    return this.cleengService.get(createURL(`/customers/${customerId}/transactions`, { limit, offset }), { authenticate: true });\r\n  };\r\n\r\n  fetchReceipt: FetchReceipt = async ({ transactionId }) => {\r\n    return this.cleengService.get(`/receipt/${transactionId}`, { authenticate: true });\r\n  };\r\n\r\n  updateCardDetails: undefined;\r\n\r\n  changeSubscription: undefined;\r\n}\r\n","import type { CustomFormField, CustomerConsent } from '../../types/account';\r\nimport type { Config } from '../../types/config';\r\nimport type { GenericFormValues } from '../../types/form';\r\nimport type { Playlist, PlaylistItem } from '../../types/playlist';\r\nimport { CARD_ASPECT_RATIOS } from '../constants';\r\n\r\nexport type PosterAspectRatio = (typeof CARD_ASPECT_RATIOS)[number];\r\n\r\nconst getFiltersFromConfig = (config: Config, playlistId: string | undefined): string[] => {\r\n  const menuItem = config.menu.find((item) => item.contentId === playlistId);\r\n  const filters = menuItem?.filterTags?.split(',').filter(Boolean);\r\n\r\n  return filters || [];\r\n};\r\n\r\nconst filterPlaylist = (playlist: Playlist, filter: string) => {\r\n  if (filter === '') return playlist;\r\n\r\n  return {\r\n    ...playlist,\r\n    playlist: playlist.playlist.filter(({ tags }) => (tags ? tags.split(',').includes(filter) : false)),\r\n  };\r\n};\r\n\r\nconst chunk = <T>(input: T[], size: number) => {\r\n  return input?.reduce((arr: T[][], item, idx: number) => {\r\n    return idx % size === 0 ? [...arr, [item]] : [...arr.slice(0, -1), [...arr.slice(-1)[0], item]];\r\n  }, []);\r\n};\r\n\r\nconst findPlaylistImageForWidth = (playlistItem: PlaylistItem, width: number): string =>\r\n  playlistItem.images.find((img) => img.width === width)?.src || playlistItem.image;\r\n\r\nconst generatePlaylistPlaceholder = (playlistLength: number = 15): Playlist => ({\r\n  title: '',\r\n  playlist: new Array(playlistLength).fill({}).map(\r\n    (_value, index) =>\r\n      ({\r\n        description: '',\r\n        duration: 0,\r\n        feedid: '',\r\n        image: '',\r\n        images: [],\r\n        cardImage: '',\r\n        backgroundImage: '',\r\n        channelLogoImage: '',\r\n        link: '',\r\n        genre: '',\r\n        mediaid: `placeholder_${index}`,\r\n        pubdate: 0,\r\n        rating: '',\r\n        sources: [],\r\n        tags: '',\r\n        title: '',\r\n        tracks: [],\r\n      } as PlaylistItem),\r\n  ),\r\n});\r\n\r\nconst formatConsentValues = (publisherConsents: CustomFormField[] | null = [], customerConsents: CustomerConsent[] | null = []) => {\r\n  if (!publisherConsents || !customerConsents) {\r\n    return {};\r\n  }\r\n\r\n  const values = publisherConsents?.reduce((acc, publisherConsent) => {\r\n    const consent = customerConsents?.find((customerConsent) => customerConsent.name === publisherConsent.name);\r\n\r\n    if (consent) {\r\n      const value = publisherConsent.isCustomRegisterField ? consent.value ?? '' : consent.state === 'accepted';\r\n      acc[publisherConsent.name] = value;\r\n    }\r\n\r\n    return acc;\r\n  }, {} as Record<string, string | boolean>);\r\n\r\n  return values;\r\n};\r\n\r\nconst formatConsents = (publisherConsents: CustomFormField[] | null = [], customerConsents: CustomerConsent[] | null = []) => {\r\n  if (!publisherConsents || !customerConsents) {\r\n    return {};\r\n  }\r\n  const values: Record<string, boolean> = {};\r\n  publisherConsents?.forEach((publisherConsent) => {\r\n    if (customerConsents?.find((customerConsent) => customerConsent.name === publisherConsent.name && customerConsent.state === 'accepted')) {\r\n      values[publisherConsent.name] = true;\r\n    }\r\n  });\r\n\r\n  return values;\r\n};\r\n\r\nconst extractConsentValues = (consents?: CustomFormField[]) => {\r\n  const values: Record<string, string | boolean> = {};\r\n\r\n  if (!consents) {\r\n    return values;\r\n  }\r\n\r\n  consents?.forEach((consent) => {\r\n    values[consent.name] = consent.type === 'checkbox' ? consent.enabledByDefault === true : consent.defaultValue ?? '';\r\n  });\r\n\r\n  return values;\r\n};\r\n\r\nconst formatConsentsFromValues = (publisherConsents: CustomFormField[] | null, values?: GenericFormValues) => {\r\n  const consents: CustomerConsent[] = [];\r\n\r\n  if (!publisherConsents || !values) return consents;\r\n\r\n  publisherConsents.forEach((consent) => {\r\n    consents.push({\r\n      name: consent.name,\r\n      version: consent.version,\r\n      state: values[consent.name] ? 'accepted' : 'declined',\r\n      value: values[consent.name] ?? '',\r\n    });\r\n  });\r\n\r\n  return consents;\r\n};\r\n\r\nconst checkConsentsFromValues = (publisherConsents: CustomFormField[], consents: Record<string, string | boolean>) => {\r\n  const customerConsents: CustomerConsent[] = [];\r\n  const consentsErrors: string[] = [];\r\n\r\n  if (!publisherConsents || !consents) return { customerConsents, consentsErrors };\r\n\r\n  publisherConsents.forEach((consent) => {\r\n    if (consent.required && !consents[consent.name]) {\r\n      consentsErrors.push(consent.name);\r\n    }\r\n\r\n    customerConsents.push({\r\n      name: consent.name,\r\n      version: consent.version,\r\n      state: consents[consent.name] ? 'accepted' : 'declined',\r\n      value: consents[consent.name] ?? '',\r\n    });\r\n  });\r\n\r\n  return { customerConsents, consentsErrors };\r\n};\r\n\r\nconst isNotEmptyConsent = (consent: CustomerConsent) => consent.value !== '';\r\n\r\nconst formatConsentToRegisterField = ({ name, value = '' }: CustomerConsent, _: number, collection: CustomerConsent[]) => {\r\n  const val = (() => {\r\n    if (name === 'us_state') {\r\n      if (collection.find(({ name, value }) => name === 'country' && value === 'us')) {\r\n        return value === 'n/a' ? '' : value;\r\n      }\r\n\r\n      return 'n/a';\r\n    }\r\n\r\n    const isBoolean = value === true || value === false;\r\n\r\n    if (isBoolean && name !== 'terms') {\r\n      return value ? 'on' : 'off';\r\n    }\r\n\r\n    return value;\r\n  })();\r\n\r\n  return [name, val] as const;\r\n};\r\n\r\nconst formatConsentsToRegisterFields = (consents: CustomerConsent[]) =>\r\n  Object.fromEntries(consents.filter(isNotEmptyConsent).map(formatConsentToRegisterField));\r\n\r\nconst deepCopy = (obj: unknown) => {\r\n  if (Array.isArray(obj) || (typeof obj === 'object' && obj !== null)) {\r\n    return JSON.parse(JSON.stringify(obj));\r\n  }\r\n  return obj;\r\n};\r\n\r\nconst parseAspectRatio = (input: unknown) => {\r\n  if (typeof input === 'string' && (CARD_ASPECT_RATIOS as readonly string[]).includes(input)) return input as PosterAspectRatio;\r\n};\r\n\r\nconst parseTilesDelta = (posterAspect?: PosterAspectRatio) => {\r\n  if (!posterAspect) {\r\n    return 0;\r\n  }\r\n\r\n  const parts = posterAspect.split(':');\r\n\r\n  return parts.length === 2 ? Math.floor(parseInt(parts[1]) / parseInt(parts[0])) : 0;\r\n};\r\n\r\nexport {\r\n  getFiltersFromConfig,\r\n  filterPlaylist,\r\n  chunk,\r\n  findPlaylistImageForWidth,\r\n  generatePlaylistPlaceholder,\r\n  formatConsentValues,\r\n  formatConsents,\r\n  formatConsentsFromValues,\r\n  extractConsentValues,\r\n  checkConsentsFromValues,\r\n  deepCopy,\r\n  parseAspectRatio,\r\n  parseTilesDelta,\r\n  isNotEmptyConsent,\r\n  formatConsentToRegisterField,\r\n  formatConsentsToRegisterFields,\r\n};\r\n","import InPlayer, { Env } from '@inplayer-org/inplayer.js';\r\nimport i18next from 'i18next';\r\nimport { inject, injectable } from 'inversify';\r\n\r\nimport { formatConsentsToRegisterFields } from '../../../utils/collection';\r\nimport type {\r\n  AuthData,\r\n  ChangePassword,\r\n  ChangePasswordWithOldPassword,\r\n  CustomFormField,\r\n  Customer,\r\n  CustomerConsent,\r\n  CustomRegisterFieldVariant,\r\n  DeleteAccount,\r\n  ExportAccountData,\r\n  GetCaptureStatus,\r\n  GetCustomerConsents,\r\n  GetPublisherConsents,\r\n  Login,\r\n  NotificationsData,\r\n  Register,\r\n  ResetPassword,\r\n  GetSocialURLs,\r\n  UpdateCaptureAnswers,\r\n  UpdateCustomerArgs,\r\n  UpdateCustomerConsents,\r\n  UpdateFavorites,\r\n  UpdateWatchHistory,\r\n  UpdateCustomer,\r\n} from '../../../../types/account';\r\nimport type { AccessModel, Config } from '../../../../types/config';\r\nimport type { SerializedFavorite } from '../../../../types/favorite';\r\nimport type { SerializedWatchHistoryItem } from '../../../../types/watchHistory';\r\nimport AccountService from '../AccountService';\r\nimport StorageService from '../../StorageService';\r\nimport { ACCESS_MODEL } from '../../../constants';\r\n\r\nimport type {\r\n  JWPAuthData,\r\n  GetRegisterFieldsResponse,\r\n  RegisterField,\r\n  CreateAccount,\r\n  AccountData,\r\n  CommonResponse,\r\n  GetWatchHistoryResponse,\r\n  WatchHistory,\r\n  FavoritesData,\r\n  GetFavoritesResponse,\r\n  ListSocialURLs,\r\n} from './types';\r\nimport JWPAPIService from './JWPAPIService';\r\n\r\nenum InPlayerEnv {\r\n  Development = 'development',\r\n  Production = 'production',\r\n  Daily = 'daily',\r\n}\r\n\r\nconst JW_TERMS_URL = 'https://inplayer.com/legal/terms';\r\n\r\n@injectable()\r\nexport default class JWPAccountService extends AccountService {\r\n  protected readonly storageService;\r\n  protected readonly apiService;\r\n\r\n  protected clientId = '';\r\n\r\n  accessModel: AccessModel = ACCESS_MODEL.AUTHVOD;\r\n  assetId: number | null = null;\r\n  svodOfferIds: string[] = [];\r\n  sandbox = false;\r\n\r\n  constructor(@inject(StorageService) storageService: StorageService, @inject(JWPAPIService) apiService: JWPAPIService) {\r\n    super({\r\n      canUpdateEmail: false,\r\n      canSupportEmptyFullName: false,\r\n      canChangePasswordWithOldPassword: true,\r\n      canRenewSubscription: false,\r\n      canExportAccountData: true,\r\n      canUpdatePaymentMethod: false,\r\n      canShowReceipts: true,\r\n      canDeleteAccount: true,\r\n      hasNotifications: true,\r\n      hasSocialURLs: true,\r\n      // Limit of media_ids length passed to the /apps/watchlists endpoint\r\n      watchListSizeLimit: 48,\r\n    });\r\n\r\n    this.storageService = storageService;\r\n    this.apiService = apiService;\r\n  }\r\n\r\n  private parseJson = (value: string, fallback = {}) => {\r\n    try {\r\n      return JSON.parse(value);\r\n    } catch {\r\n      return fallback;\r\n    }\r\n  };\r\n\r\n  private formatFavorite = (favorite: FavoritesData): SerializedFavorite => {\r\n    return {\r\n      mediaid: favorite.media_id,\r\n    };\r\n  };\r\n\r\n  private formatHistoryItem = (history: WatchHistory): SerializedWatchHistoryItem => {\r\n    return {\r\n      mediaid: history.media_id,\r\n      progress: history.progress,\r\n    };\r\n  };\r\n\r\n  private formatAccount = (account: AccountData): Customer => {\r\n    const { id, uuid, email, full_name: fullName, metadata, created_at: createdAt } = account;\r\n    const regDate = new Date(createdAt * 1000).toLocaleString();\r\n\r\n    const firstName = metadata?.first_name as string;\r\n    const lastName = metadata?.surname as string;\r\n\r\n    return {\r\n      id: id.toString(),\r\n      uuid,\r\n      email,\r\n      fullName,\r\n      firstName,\r\n      lastName,\r\n      metadata,\r\n      regDate,\r\n      country: '',\r\n      lastUserIp: '',\r\n    };\r\n  };\r\n\r\n  private formatAuth(auth: JWPAuthData): AuthData {\r\n    const { access_token: jwt } = auth;\r\n    return {\r\n      jwt,\r\n      refreshToken: '',\r\n    };\r\n  }\r\n\r\n  initialize = async (config: Config, url: string, _logoutFn: () => Promise<void>) => {\r\n    const jwpConfig = config.integrations?.jwp;\r\n\r\n    if (!jwpConfig?.clientId) {\r\n      throw new Error('Failed to initialize JWP integration. The clientId is missing.');\r\n    }\r\n\r\n    // set environment\r\n    this.sandbox = !!jwpConfig.useSandbox;\r\n\r\n    const env: string = this.sandbox ? InPlayerEnv.Development : InPlayerEnv.Production;\r\n    InPlayer.setConfig(env as Env);\r\n\r\n    this.apiService.setup(this.sandbox);\r\n\r\n    // calculate access model\r\n    if (jwpConfig.clientId) {\r\n      this.clientId = jwpConfig.clientId;\r\n    }\r\n\r\n    if (jwpConfig.assetId) {\r\n      this.accessModel = ACCESS_MODEL.SVOD;\r\n      this.assetId = jwpConfig.assetId;\r\n      this.svodOfferIds = jwpConfig.assetId ? [String(jwpConfig.assetId)] : [];\r\n    }\r\n\r\n    // restore session from URL params\r\n    const queryParams = new URLSearchParams(url.split('#')[1]);\r\n    const token = queryParams.get('token');\r\n    const refreshToken = queryParams.get('refresh_token');\r\n    const expires = queryParams.get('expires');\r\n\r\n    if (!token || !refreshToken || !expires) {\r\n      return;\r\n    }\r\n\r\n    this.apiService.setToken(token, refreshToken, parseInt(expires));\r\n  };\r\n\r\n  getAuthData = async () => {\r\n    if (await this.apiService.isAuthenticated()) {\r\n      const credentials = await this.apiService.getToken();\r\n\r\n      return {\r\n        jwt: credentials.token,\r\n        refreshToken: credentials.refreshToken,\r\n      } as AuthData;\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  getPublisherConsents: GetPublisherConsents = async () => {\r\n    try {\r\n      const data = await this.apiService.get<GetRegisterFieldsResponse>(`/accounts/register-fields/${this.clientId}`);\r\n\r\n      const terms = data?.collection.find(({ name }) => name === 'terms');\r\n\r\n      const result = data?.collection\r\n        // we exclude these fields because we already have them by default\r\n        .filter((field) => !['email_confirmation', 'first_name', 'surname'].includes(field.name) && ![terms].includes(field))\r\n        .map(\r\n          (field): CustomFormField => ({\r\n            type: field.type as CustomRegisterFieldVariant,\r\n            isCustomRegisterField: true,\r\n            name: field.name,\r\n            label: field.label,\r\n            placeholder: field.placeholder,\r\n            required: field.required,\r\n            options: field.options,\r\n            defaultValue: '',\r\n            version: '1',\r\n            ...(field.type === 'checkbox'\r\n              ? {\r\n                  enabledByDefault: field.default_value === 'true',\r\n                }\r\n              : {\r\n                  defaultValue: field.default_value,\r\n                }),\r\n          }),\r\n        );\r\n\r\n      return terms ? [this.getTermsConsent(terms), ...result] : result;\r\n    } catch {\r\n      throw new Error('Failed to fetch publisher consents.');\r\n    }\r\n  };\r\n\r\n  getCustomerConsents: GetCustomerConsents = async (payload) => {\r\n    try {\r\n      if (!payload?.customer) {\r\n        return {\r\n          consents: [],\r\n        };\r\n      }\r\n\r\n      const { customer } = payload;\r\n\r\n      return this.parseJson(customer.metadata?.consents as string, []);\r\n    } catch {\r\n      throw new Error('Unable to fetch Customer consents.');\r\n    }\r\n  };\r\n\r\n  updateCustomerConsents: UpdateCustomerConsents = async (payload) => {\r\n    try {\r\n      const { customer, consents } = payload;\r\n\r\n      const existingAccountData = this.formatUpdateAccount(customer);\r\n\r\n      const params = {\r\n        ...existingAccountData,\r\n        metadata: {\r\n          ...existingAccountData.metadata,\r\n          ...formatConsentsToRegisterFields(consents),\r\n          consents: JSON.stringify(consents),\r\n        },\r\n      };\r\n\r\n      const data = await this.apiService.put<AccountData>('/accounts', params, { withAuthentication: true });\r\n\r\n      return this.parseJson(data?.metadata?.consents as string, []);\r\n    } catch {\r\n      throw new Error('Unable to update Customer consents');\r\n    }\r\n  };\r\n\r\n  updateCaptureAnswers: UpdateCaptureAnswers = async ({ customer, ...newAnswers }) => {\r\n    return this.updateCustomer({ ...customer, ...newAnswers });\r\n  };\r\n\r\n  changePasswordWithOldPassword: ChangePasswordWithOldPassword = async (payload) => {\r\n    const { oldPassword, newPassword, newPasswordConfirmation } = payload;\r\n\r\n    try {\r\n      await this.apiService.post<void>(\r\n        '/accounts/change-password',\r\n        {\r\n          old_password: oldPassword,\r\n          password: newPassword,\r\n          password_confirmation: newPasswordConfirmation,\r\n        },\r\n        { withAuthentication: true },\r\n      );\r\n    } catch (error: unknown) {\r\n      if (JWPAPIService.isCommonError(error)) {\r\n        throw new Error(error.response.data.message);\r\n      }\r\n      throw new Error('Failed to change password');\r\n    }\r\n  };\r\n\r\n  resetPassword: ResetPassword = async ({ customerEmail }) => {\r\n    try {\r\n      await this.apiService.post<CommonResponse>('/accounts/forgot-password', {\r\n        email: customerEmail,\r\n        merchant_uuid: this.clientId,\r\n        branding_id: 0,\r\n      });\r\n    } catch {\r\n      throw new Error('Failed to reset password.');\r\n    }\r\n  };\r\n\r\n  login: Login = async ({ email, password, referrer }) => {\r\n    try {\r\n      const data = await this.apiService.post<CreateAccount>('/v2/accounts/authenticate', {\r\n        client_id: this.clientId || '',\r\n        grant_type: 'password',\r\n        referrer,\r\n        username: email,\r\n        password,\r\n      });\r\n\r\n      this.apiService.setToken(data.access_token, '', data.expires);\r\n\r\n      const user = this.formatAccount(data.account);\r\n\r\n      return {\r\n        auth: this.formatAuth(data),\r\n        user,\r\n        customerConsents: this.parseJson(user?.metadata?.consents as string, []),\r\n      };\r\n    } catch {\r\n      throw new Error('Failed to authenticate user.');\r\n    }\r\n  };\r\n\r\n  register: Register = async ({ email, password, referrer, consents }) => {\r\n    try {\r\n      const data = await this.apiService.post<CreateAccount>('/accounts', {\r\n        full_name: email,\r\n        username: email,\r\n        password,\r\n        password_confirmation: password,\r\n        client_id: this.clientId || '',\r\n        type: 'consumer',\r\n        referrer,\r\n        grant_type: 'password',\r\n        metadata: {\r\n          first_name: ' ',\r\n          surname: ' ',\r\n          ...formatConsentsToRegisterFields(consents),\r\n          consents: JSON.stringify(consents),\r\n        },\r\n      });\r\n\r\n      this.apiService.setToken(data.access_token, '', data.expires);\r\n\r\n      const user = this.formatAccount(data.account);\r\n\r\n      return {\r\n        auth: this.formatAuth(data),\r\n        user,\r\n        customerConsents: this.parseJson(user?.metadata?.consents as string, []),\r\n      };\r\n    } catch (error: unknown) {\r\n      if (JWPAPIService.isCommonError(error)) {\r\n        throw new Error(error.response.data.message);\r\n      }\r\n      throw new Error('Failed to create account.');\r\n    }\r\n  };\r\n\r\n  logout = async () => {\r\n    try {\r\n      if (InPlayer.Notifications.isSubscribed()) {\r\n        InPlayer.Notifications.unsubscribe();\r\n      }\r\n\r\n      if (await this.apiService.isAuthenticated()) {\r\n        await this.apiService.get<undefined>('/accounts/logout', { withAuthentication: true });\r\n        await this.apiService.removeToken();\r\n      }\r\n    } catch {\r\n      throw new Error('Failed to sign out.');\r\n    }\r\n  };\r\n\r\n  getUser = async () => {\r\n    try {\r\n      const data = await this.apiService.get<AccountData>(`/accounts`, { withAuthentication: true });\r\n\r\n      const user = this.formatAccount(data);\r\n\r\n      return {\r\n        user,\r\n        customerConsents: this.parseJson(user?.metadata?.consents as string, []) as CustomerConsent[],\r\n      };\r\n    } catch {\r\n      throw new Error('Failed to fetch user data.');\r\n    }\r\n  };\r\n\r\n  updateCustomer: UpdateCustomer = async (customer) => {\r\n    try {\r\n      const data = await this.apiService.put<AccountData>('/accounts', this.formatUpdateAccount(customer), { withAuthentication: true });\r\n\r\n      return this.formatAccount(data);\r\n    } catch {\r\n      throw new Error('Failed to update user data.');\r\n    }\r\n  };\r\n\r\n  formatUpdateAccount = (customer: UpdateCustomerArgs) => {\r\n    const firstName = customer.firstName?.trim() || '';\r\n    const lastName = customer.lastName?.trim() || '';\r\n    const fullName = `${firstName} ${lastName}`.trim() || (customer.email as string);\r\n\r\n    const metadata: Record<string, string> = {\r\n      ...customer.metadata,\r\n      first_name: firstName,\r\n      surname: lastName,\r\n    };\r\n\r\n    const data = {\r\n      full_name: fullName,\r\n      metadata,\r\n    };\r\n\r\n    return data;\r\n  };\r\n\r\n  getCaptureStatus: GetCaptureStatus = async ({ customer: { firstName, lastName } }) => {\r\n    const firstNameTrimmed = firstName?.trim() || '';\r\n    const lastNameTrimmed = lastName?.trim() || '';\r\n\r\n    return {\r\n      isCaptureEnabled: true,\r\n      shouldCaptureBeDisplayed: !firstNameTrimmed || !lastNameTrimmed,\r\n      settings: [\r\n        {\r\n          answer: {\r\n            firstName: firstNameTrimmed || null,\r\n            lastName: lastNameTrimmed || null,\r\n          },\r\n          enabled: true,\r\n          key: 'firstNameLastName',\r\n          required: true,\r\n        },\r\n      ],\r\n    };\r\n  };\r\n\r\n  changePasswordWithResetToken: ChangePassword = async (payload) => {\r\n    const { resetPasswordToken = '', newPassword, newPasswordConfirmation = '' } = payload;\r\n    try {\r\n      await this.apiService.put<void>(`/accounts/forgot-password/${resetPasswordToken}`, {\r\n        password: newPassword,\r\n        password_confirmation: newPasswordConfirmation,\r\n        branding_id: 0,\r\n      });\r\n    } catch (error: unknown) {\r\n      if (JWPAPIService.isCommonError(error)) {\r\n        throw new Error(error.response.data.message);\r\n      }\r\n      throw new Error('Failed to change password.');\r\n    }\r\n  };\r\n\r\n  getTermsConsent = ({ label: termsUrl }: RegisterField): CustomFormField => {\r\n    const termsLink = `<a href=\"${termsUrl || JW_TERMS_URL}\" target=\"_blank\">${i18next.t('account:registration.terms_and_conditions')}</a>`;\r\n\r\n    // t('account:registration.terms_consent_jwplayer')\r\n    // t('account:registration.terms_consent')\r\n    return {\r\n      type: 'checkbox',\r\n      isCustomRegisterField: true,\r\n      required: true,\r\n      name: 'terms',\r\n      defaultValue: '',\r\n      label: termsUrl\r\n        ? i18next.t('account:registration.terms_consent', { termsLink })\r\n        : i18next.t('account:registration.terms_consent_jwplayer', { termsLink }),\r\n      enabledByDefault: false,\r\n      placeholder: '',\r\n      options: {},\r\n      version: '1',\r\n    };\r\n  };\r\n\r\n  updateWatchHistory: UpdateWatchHistory = async ({ history }) => {\r\n    const current = await this.getWatchHistory();\r\n    const savedHistory = current.map((e) => e.mediaid) || [];\r\n\r\n    await Promise.allSettled(\r\n      history.map(({ mediaid, progress }) => {\r\n        if (!savedHistory.includes(mediaid) || current.some((e) => e.mediaid == mediaid && e.progress != progress)) {\r\n          return this.apiService.patch<WatchHistory>(\r\n            '/v2/accounts/media/watch-history',\r\n            {\r\n              media_id: mediaid,\r\n              progress,\r\n            },\r\n            { withAuthentication: true },\r\n          );\r\n        }\r\n      }),\r\n    );\r\n  };\r\n\r\n  updateFavorites: UpdateFavorites = async ({ favorites }) => {\r\n    const current = await this.getFavorites();\r\n    const currentFavoriteIds = current.map((e) => e.mediaid) || [];\r\n    const payloadFavoriteIds = favorites.map((e) => e.mediaid);\r\n\r\n    // save new favorites\r\n    await Promise.allSettled(\r\n      payloadFavoriteIds.map((media_id) => {\r\n        return !currentFavoriteIds.includes(media_id)\r\n          ? this.apiService.post<FavoritesData>('/v2/accounts/media/favorites', { media_id }, { withAuthentication: true })\r\n          : Promise.resolve();\r\n      }),\r\n    );\r\n\r\n    // delete removed favorites\r\n    await Promise.allSettled(\r\n      currentFavoriteIds.map((mediaId) => {\r\n        return !payloadFavoriteIds.includes(mediaId)\r\n          ? this.apiService.remove<CommonResponse>(`/v2/accounts/media/favorites/${mediaId}`, { withAuthentication: true })\r\n          : Promise.resolve();\r\n      }),\r\n    );\r\n  };\r\n\r\n  getFavorites = async () => {\r\n    const favoritesData = await this.apiService.get<GetFavoritesResponse>('/v2/accounts/media/favorites', { withAuthentication: true });\r\n\r\n    return favoritesData?.collection?.map(this.formatFavorite) || [];\r\n  };\r\n\r\n  getWatchHistory = async () => {\r\n    const watchHistoryData = await this.apiService.get<GetWatchHistoryResponse>(\r\n      '/v2/accounts/media/watch-history',\r\n      {\r\n        withAuthentication: true,\r\n      },\r\n      {\r\n        filter: 'currently_watching',\r\n      },\r\n    );\r\n\r\n    return watchHistoryData?.collection?.map(this.formatHistoryItem) || [];\r\n  };\r\n\r\n  subscribeToNotifications: NotificationsData = async ({ uuid, onMessage }) => {\r\n    try {\r\n      if (!InPlayer.Notifications.isSubscribed()) {\r\n        InPlayer.subscribe(uuid, {\r\n          onMessage: onMessage,\r\n          onOpen: () => true,\r\n        });\r\n      }\r\n      return true;\r\n    } catch {\r\n      return false;\r\n    }\r\n  };\r\n\r\n  exportAccountData: ExportAccountData = async () => {\r\n    // password is sent as undefined because it is now optional on BE\r\n    try {\r\n      return await this.apiService.post<CommonResponse>('/accounts/export', { password: undefined, branding_id: 0 }, { withAuthentication: true });\r\n    } catch {\r\n      throw new Error('Failed to export account data');\r\n    }\r\n  };\r\n\r\n  deleteAccount: DeleteAccount = async ({ password }) => {\r\n    try {\r\n      return await this.apiService.remove<CommonResponse>('/accounts/erase', { withAuthentication: true }, { password, branding_id: 0 });\r\n    } catch (error: unknown) {\r\n      if (JWPAPIService.isCommonError(error)) {\r\n        throw new Error(error.response.data.message || 'Failed to delete account');\r\n      }\r\n\r\n      throw new Error('Failed to delete account');\r\n    }\r\n  };\r\n\r\n  getSocialUrls: GetSocialURLs = async ({ redirectUrl }) => {\r\n    const socialState = this.storageService.base64Encode(\r\n      JSON.stringify({\r\n        client_id: this.clientId || '',\r\n        redirect: redirectUrl,\r\n      }),\r\n    );\r\n\r\n    const socialResponse = await this.apiService.get<{ status: number; data: ListSocialURLs }>(\r\n      '/accounts/social',\r\n      {\r\n        includeFullResponse: true,\r\n      },\r\n      {\r\n        state: socialState,\r\n      },\r\n    );\r\n\r\n    if (socialResponse.status !== 200) {\r\n      throw new Error('Failed to fetch social urls');\r\n    }\r\n\r\n    return socialResponse.data.social_urls;\r\n  };\r\n}\r\n","import type { DurationAbbreviation } from '../../types/i18n';\r\n\r\nexport const formatDurationTag = (seconds: number, { minutesAbbreviation }: Pick<DurationAbbreviation, 'minutesAbbreviation'>) => {\r\n  if (!seconds) return '';\r\n\r\n  const minutes = Math.ceil(seconds / 60);\r\n\r\n  return `${minutes} ${minutesAbbreviation}`;\r\n};\r\n\r\n/**\r\n * @param duration Duration in seconds\r\n *\r\n * Calculates hours and minutes into a string\r\n * Hours are only shown if at least 1\r\n * Minutes get rounded\r\n *\r\n * @returns string, such as '2hrs 24min' or '31min'\r\n */\r\n\r\nexport const formatDuration = (duration: number, { hoursAbbreviation, minutesAbbreviation }: DurationAbbreviation) => {\r\n  if (!duration) return '';\r\n\r\n  const hours = Math.floor(duration / 3600);\r\n  const minutes = Math.round((duration - hours * 3600) / 60);\r\n\r\n  const hoursString = hours ? `${hours}${hoursAbbreviation}` : '';\r\n  const minutesString = minutes ? `${minutes}${minutesAbbreviation}` : '';\r\n\r\n  return [hoursString, minutesString].filter(Boolean).join(' ');\r\n};\r\n\r\nexport const formatPrice = (price: number, currency: string, country?: string) => {\r\n  return new Intl.NumberFormat(country || 'en-US', {\r\n    style: 'currency',\r\n    currency: currency,\r\n  }).format(price);\r\n};\r\n\r\nexport const formatSeriesMetaString = (seasonNumber?: string, episodeNumber?: string) => {\r\n  if (!seasonNumber && !episodeNumber) {\r\n    return '';\r\n  }\r\n\r\n  return seasonNumber && seasonNumber !== '0' ? `S${seasonNumber}:E${episodeNumber}` : `E${episodeNumber}`;\r\n};\r\n\r\nexport const formatVideoSchedule = (locale: string, scheduledStart?: Date, scheduledEnd?: Date) => {\r\n  if (!scheduledStart) {\r\n    return '';\r\n  }\r\n\r\n  if (!scheduledEnd) {\r\n    return formatLocalizedDateTime(scheduledStart, locale, ' • ');\r\n  }\r\n\r\n  return `${formatLocalizedDateTime(scheduledStart, locale, ' • ')} - ${formatLocalizedTime(scheduledEnd, locale)}`;\r\n};\r\n\r\nexport const formatLocalizedDate = (date: Date, locale: string) => {\r\n  return new Intl.DateTimeFormat(locale, { day: 'numeric', month: 'long', year: 'numeric' }).format(date);\r\n};\r\n\r\nexport const formatLocalizedTime = (date: Date, locale: string) => {\r\n  return new Intl.DateTimeFormat(locale, { hour: 'numeric', minute: 'numeric' }).format(date);\r\n};\r\n\r\nexport const formatLocalizedDateTime = (date: Date, locale: string, separator = ' ') => {\r\n  return `${formatLocalizedDate(date, locale)}${separator}${formatLocalizedTime(date, locale)}`;\r\n};\r\n","import type { Offer, Order } from '../../types/checkout';\r\n\r\nimport { formatPrice } from './formatting';\r\n\r\nexport const getOfferPrice = (offer: Offer) => formatPrice(offer.customerPriceInclTax, offer.customerCurrency, offer.customerCountry);\r\n\r\nexport const isSVODOffer = (offer: Offer | Order) => offer.offerId?.[0] === 'S';\r\n","import { inject, injectable } from 'inversify';\r\n\r\nimport { isSVODOffer } from '../../../utils/offers';\r\nimport type {\r\n  CardPaymentData,\r\n  CreateOrder,\r\n  CreateOrderArgs,\r\n  GetEntitlements,\r\n  GetEntitlementsResponse,\r\n  GetOffers,\r\n  GetPaymentMethods,\r\n  Offer,\r\n  Order,\r\n  Payment,\r\n  PaymentMethod,\r\n  PaymentWithAdyen,\r\n  PaymentWithoutDetails,\r\n  PaymentWithPayPal,\r\n  UpdateOrder,\r\n} from '../../../../types/checkout';\r\nimport CheckoutService from '../CheckoutService';\r\nimport type { ServiceResponse } from '../../../../types/service';\r\n\r\nimport type {\r\n  CommonResponse,\r\n  GetAccessFeesResponse,\r\n  AccessFee,\r\n  MerchantPaymentMethod,\r\n  GeneratePayPalParameters,\r\n  VoucherDiscountPrice,\r\n  GetItemAccessResponse,\r\n} from './types';\r\nimport JWPAPIService from './JWPAPIService';\r\n\r\n@injectable()\r\nexport default class JWPCheckoutService extends CheckoutService {\r\n  protected readonly cardPaymentProvider = 'stripe';\r\n\r\n  protected readonly apiService;\r\n\r\n  constructor(@inject(JWPAPIService) apiService: JWPAPIService) {\r\n    super();\r\n    this.apiService = apiService;\r\n  }\r\n\r\n  private formatPaymentMethod = (method: MerchantPaymentMethod, cardPaymentProvider: string): PaymentMethod => {\r\n    return {\r\n      id: method.id,\r\n      methodName: method.method_name.toLocaleLowerCase(),\r\n      provider: cardPaymentProvider,\r\n      logoUrl: '',\r\n    } as PaymentMethod;\r\n  };\r\n\r\n  private formatEntitlements = (expiresAt: number = 0, accessGranted: boolean = false): ServiceResponse<GetEntitlementsResponse> => {\r\n    return {\r\n      errors: [],\r\n      responseData: {\r\n        accessGranted,\r\n        expiresAt,\r\n      },\r\n    };\r\n  };\r\n\r\n  /**\r\n   * Format a (Cleeng like) offer id for the given access fee (pricing option). For JWP, we need the asset id and\r\n   * access fee id in some cases.\r\n   */\r\n  private formatOfferId(offer: AccessFee) {\r\n    const ppvOffers = ['ppv', 'ppv_custom'];\r\n\r\n    return ppvOffers.includes(offer.access_type.name) ? `C${offer.item_id}_${offer.id}` : `S${offer.item_id}_${offer.id}`;\r\n  }\r\n\r\n  /**\r\n   * Parse the given offer id and extract the asset id.\r\n   * The offer id might be the Cleeng format (`S<assetId>_<pricingOptionId>`) or the asset id as string.\r\n   */\r\n  private parseOfferId(offerId: string | number) {\r\n    if (typeof offerId === 'string') {\r\n      // offer id format `S<assetId>_<pricingOptionId>`\r\n      if (offerId.startsWith('C') || offerId.startsWith('S')) {\r\n        return parseInt(offerId.slice(1).split('_')[0]);\r\n      }\r\n\r\n      // offer id format `<assetId>`\r\n      return parseInt(offerId);\r\n    }\r\n\r\n    return offerId;\r\n  }\r\n\r\n  private formatOffer = (offer: AccessFee): Offer => {\r\n    return {\r\n      id: offer.id,\r\n      offerId: this.formatOfferId(offer),\r\n      offerCurrency: offer.currency,\r\n      customerPriceInclTax: offer.amount,\r\n      customerCurrency: offer.currency,\r\n      offerTitle: offer.description,\r\n      active: true,\r\n      period: offer.access_type.period === 'month' && offer.access_type.quantity === 12 ? 'year' : offer.access_type.period,\r\n      freePeriods: offer.trial_period ? 1 : 0,\r\n      planSwitchEnabled: offer.item.plan_switch_enabled ?? false,\r\n    } as Offer;\r\n  };\r\n\r\n  private formatOrder = (payload: CreateOrderArgs): Order => {\r\n    return {\r\n      id: payload.offer.id,\r\n      customerId: payload.customerId,\r\n      offerId: payload.offer.offerId,\r\n      totalPrice: payload.offer.customerPriceInclTax,\r\n      priceBreakdown: {\r\n        offerPrice: payload.offer.customerPriceInclTax,\r\n        // @TODO is this correct?\r\n        discountAmount: payload.offer.customerPriceInclTax,\r\n        discountedPrice: payload.offer.customerPriceInclTax,\r\n        paymentMethodFee: 0,\r\n        taxValue: 0,\r\n      },\r\n      taxRate: 0,\r\n      currency: payload.offer.offerCurrency || 'EUR',\r\n      requiredPaymentDetails: true,\r\n    } as Order;\r\n  };\r\n\r\n  createOrder: CreateOrder = async (payload) => {\r\n    return {\r\n      errors: [],\r\n      responseData: {\r\n        message: '',\r\n        order: this.formatOrder(payload),\r\n        success: true,\r\n      },\r\n    };\r\n  };\r\n\r\n  getOffers: GetOffers = async (payload) => {\r\n    const offers = await Promise.all(\r\n      payload.offerIds.map(async (offerId) => {\r\n        try {\r\n          const data = await this.apiService.get<GetAccessFeesResponse>(`/v2/items/${this.parseOfferId(offerId)}/access-fees`);\r\n\r\n          return data?.map((offer) => this.formatOffer(offer));\r\n        } catch {\r\n          throw new Error('Failed to get offers');\r\n        }\r\n      }),\r\n    );\r\n\r\n    return offers.flat();\r\n  };\r\n\r\n  getPaymentMethods: GetPaymentMethods = async () => {\r\n    try {\r\n      const data = await this.apiService.get<MerchantPaymentMethod[]>('/payments/methods', { withAuthentication: true });\r\n      const paymentMethods: PaymentMethod[] = [];\r\n      data.forEach((method: MerchantPaymentMethod) => {\r\n        if (['card', 'paypal'].includes(method.method_name.toLowerCase())) {\r\n          paymentMethods.push(this.formatPaymentMethod(method, this.cardPaymentProvider));\r\n        }\r\n      });\r\n      return {\r\n        errors: [],\r\n        responseData: {\r\n          message: '',\r\n          paymentMethods,\r\n          status: 1,\r\n        },\r\n      };\r\n    } catch {\r\n      throw new Error('Failed to get payment methods');\r\n    }\r\n  };\r\n\r\n  paymentWithPayPal: PaymentWithPayPal = async (payload) => {\r\n    try {\r\n      const data = await this.apiService.post<GeneratePayPalParameters>(\r\n        '/external-payments',\r\n        {\r\n          origin: payload.waitingUrl,\r\n          access_fee: payload.order.id,\r\n          payment_method: 2,\r\n          voucher_code: payload.couponCode,\r\n        },\r\n        { withAuthentication: true },\r\n      );\r\n\r\n      if (data?.id) {\r\n        return {\r\n          errors: ['Already have an active access'],\r\n          responseData: {\r\n            redirectUrl: payload.errorUrl,\r\n          },\r\n        };\r\n      }\r\n      return {\r\n        errors: [],\r\n        responseData: {\r\n          redirectUrl: data.endpoint,\r\n        },\r\n      };\r\n    } catch {\r\n      throw new Error('Failed to generate PayPal payment url');\r\n    }\r\n  };\r\n\r\n  iFrameCardPayment: PaymentWithAdyen = async () => {\r\n    return {\r\n      errors: [],\r\n      responseData: {} as Payment,\r\n    };\r\n  };\r\n\r\n  paymentWithoutDetails: PaymentWithoutDetails = async () => {\r\n    return {\r\n      errors: [],\r\n      responseData: {} as Payment,\r\n    };\r\n  };\r\n\r\n  updateOrder: UpdateOrder = async ({ order, couponCode }) => {\r\n    try {\r\n      const data = await this.apiService.post<VoucherDiscountPrice>(\r\n        '/vouchers/discount',\r\n        {\r\n          voucher_code: `${couponCode}`,\r\n          access_fee_id: order.id,\r\n        },\r\n        { withAuthentication: true },\r\n      );\r\n\r\n      const discountAmount = order.totalPrice - data.amount;\r\n      const updatedOrder: Order = {\r\n        ...order,\r\n        totalPrice: data.amount,\r\n        priceBreakdown: {\r\n          ...order.priceBreakdown,\r\n          discountAmount,\r\n          discountedPrice: discountAmount,\r\n        },\r\n        discount: {\r\n          applied: true,\r\n          type: 'coupon',\r\n          periods: data.discount_duration,\r\n        },\r\n      };\r\n\r\n      return {\r\n        errors: [],\r\n        responseData: {\r\n          message: 'successfully updated',\r\n          order: updatedOrder,\r\n          success: true,\r\n        },\r\n      };\r\n    } catch (error: unknown) {\r\n      if (JWPAPIService.isCommonError(error) && error.response.data.message === 'Voucher not found') {\r\n        throw new Error('Invalid coupon code');\r\n      }\r\n\r\n      throw new Error('An unknown error occurred');\r\n    }\r\n  };\r\n\r\n  getEntitlements: GetEntitlements = async ({ offerId }) => {\r\n    try {\r\n      const data = await this.apiService.get<GetItemAccessResponse>(`/items/${this.parseOfferId(offerId)}/access`, {\r\n        withAuthentication: true,\r\n      });\r\n\r\n      return this.formatEntitlements(data.expires_at, true);\r\n    } catch {\r\n      return this.formatEntitlements();\r\n    }\r\n  };\r\n\r\n  directPostCardPayment = async (cardPaymentPayload: CardPaymentData, order: Order, referrer: string, returnUrl: string) => {\r\n    const payload = {\r\n      number: cardPaymentPayload.cardNumber.replace(/\\s/g, ''),\r\n      card_name: cardPaymentPayload.cardholderName,\r\n      exp_month: cardPaymentPayload.cardExpMonth || '',\r\n      exp_year: cardPaymentPayload.cardExpYear || '',\r\n      cvv: cardPaymentPayload.cardCVC,\r\n      access_fee: order.id,\r\n      payment_method: 1,\r\n      voucher_code: cardPaymentPayload.couponCode,\r\n      referrer,\r\n      return_url: returnUrl,\r\n    };\r\n\r\n    try {\r\n      if (isSVODOffer(order)) {\r\n        await this.apiService.post<CommonResponse>('/subscriptions', payload, { withAuthentication: true });\r\n      } else {\r\n        await this.apiService.post<CommonResponse>('/payments', payload, { withAuthentication: true });\r\n      }\r\n\r\n      return true;\r\n    } catch {\r\n      throw new Error('Failed to make payment');\r\n    }\r\n  };\r\n\r\n  getSubscriptionSwitches = undefined;\r\n\r\n  getOrder = undefined;\r\n\r\n  switchSubscription = undefined;\r\n\r\n  getSubscriptionSwitch = undefined;\r\n\r\n  createAdyenPaymentSession = undefined;\r\n\r\n  initialAdyenPayment = undefined;\r\n\r\n  finalizeAdyenPayment = undefined;\r\n\r\n  updatePaymentMethodWithPayPal = undefined;\r\n\r\n  deletePaymentMethod = undefined;\r\n\r\n  addAdyenPaymentDetails = undefined;\r\n\r\n  finalizeAdyenPaymentDetails = undefined;\r\n\r\n  getOffer = undefined;\r\n}\r\n","import i18next from 'i18next';\r\nimport { inject, injectable, named } from 'inversify';\r\n\r\nimport type {\r\n  ChangeSubscription,\r\n  GetActivePayment,\r\n  GetActiveSubscription,\r\n  GetAllTransactions,\r\n  PaymentDetail,\r\n  Subscription,\r\n  Transaction,\r\n  UpdateCardDetails,\r\n  UpdateSubscription,\r\n} from '../../../../types/subscription';\r\nimport SubscriptionService from '../SubscriptionService';\r\nimport AccountService from '../AccountService';\r\n\r\nimport type {\r\n  GetItemAccessResponse,\r\n  GetSubscriptionsResponse,\r\n  GetPaymentHistoryResponse,\r\n  GetDefaultCardResponse,\r\n  CancelSubscriptionResponse,\r\n  ChangeSubscriptionPlanResponse,\r\n  SetDefaultCardResponse,\r\n  Card,\r\n  PaymentHistory,\r\n  JWPSubscription,\r\n} from './types';\r\nimport type JWPAccountService from './JWPAccountService';\r\nimport JWPAPIService from './JWPAPIService';\r\n\r\ninterface SubscriptionDetails extends JWPSubscription {\r\n  item_id?: number;\r\n  item_title?: string;\r\n  subscription_id?: string;\r\n  subscription_price?: number;\r\n  action_type?: 'recurrent' | 'canceled' | 'free-trial' | 'ended' | 'incomplete_expired';\r\n  next_rebill_date?: number;\r\n  charged_amount?: number;\r\n  payment_method_name?: string;\r\n  access_type?: {\r\n    period: string;\r\n  };\r\n  access_fee_id?: number;\r\n}\r\n\r\n@injectable()\r\nexport default class JWPSubscriptionService extends SubscriptionService {\r\n  protected readonly accountService: JWPAccountService;\r\n  protected readonly apiService: JWPAPIService;\r\n\r\n  constructor(@named('JWP') accountService: AccountService, @inject(JWPAPIService) apiService: JWPAPIService) {\r\n    super();\r\n\r\n    this.accountService = accountService as JWPAccountService;\r\n    this.apiService = apiService;\r\n  }\r\n\r\n  private formatCardDetails = (\r\n    card: Card & {\r\n      card_type: string;\r\n      account_id: number;\r\n      currency: string;\r\n    },\r\n  ): PaymentDetail => {\r\n    const { number, exp_month, exp_year, card_name, card_type, account_id, currency } = card;\r\n    const zeroFillExpMonth = `0${exp_month}`.slice(-2);\r\n\r\n    return {\r\n      id: 0,\r\n      paymentMethodId: 0,\r\n      paymentGateway: 'card',\r\n      paymentMethod: 'card',\r\n      customerId: account_id.toString(),\r\n      paymentMethodSpecificParams: {\r\n        holderName: card_name,\r\n        variant: card_type,\r\n        lastCardFourDigits: String(number),\r\n        cardExpirationDate: `${zeroFillExpMonth}/${exp_year}`,\r\n      },\r\n      active: true,\r\n      currency,\r\n    } as PaymentDetail;\r\n  };\r\n\r\n  private formatTransaction = (transaction: PaymentHistory): Transaction => {\r\n    const purchasedAmount = transaction?.charged_amount?.toString() || '0';\r\n\r\n    return {\r\n      transactionId: transaction.transaction_token || i18next.t('user:payment.access_granted'),\r\n      transactionDate: transaction.created_at,\r\n      trxToken: transaction.trx_token,\r\n      offerId: transaction.item_id?.toString() || i18next.t('user:payment.no_transaction'),\r\n      offerType: transaction.item_type || '',\r\n      offerTitle: transaction?.item_title || '',\r\n      offerPeriod: '',\r\n      transactionPriceExclTax: purchasedAmount,\r\n      transactionCurrency: transaction.currency_iso || 'EUR',\r\n      discountedOfferPrice: purchasedAmount,\r\n      offerCurrency: transaction.currency_iso || 'EUR',\r\n      offerPriceExclTax: purchasedAmount,\r\n      applicableTax: '0',\r\n      transactionPriceInclTax: purchasedAmount,\r\n      customerId: transaction.consumer_id?.toString(),\r\n      customerEmail: '',\r\n      customerLocale: '',\r\n      customerCountry: 'en',\r\n      customerIpCountry: '',\r\n      customerCurrency: '',\r\n      paymentMethod: transaction.payment_method_name || i18next.t('user:payment.access_granted'),\r\n    };\r\n  };\r\n\r\n  private formatActiveSubscription = (subscription: SubscriptionDetails, expiresAt: number) => {\r\n    let status = '';\r\n    switch (subscription.action_type) {\r\n      case 'free-trial':\r\n        status = 'active_trial';\r\n        break;\r\n      case 'recurrent':\r\n        status = 'active';\r\n        break;\r\n      case 'canceled':\r\n        status = 'cancelled';\r\n        break;\r\n      case 'incomplete_expired' || 'ended':\r\n        status = 'expired';\r\n        break;\r\n      default:\r\n        status = 'terminated';\r\n    }\r\n\r\n    return {\r\n      subscriptionId: subscription.subscription_id,\r\n      offerId: subscription.item_id?.toString(),\r\n      accessFeeId: `S${subscription.access_fee_id}`,\r\n      status,\r\n      expiresAt,\r\n      nextPaymentAt: subscription.next_rebill_date,\r\n      nextPaymentPrice: subscription.subscription_price,\r\n      nextPaymentCurrency: subscription.currency,\r\n      paymentGateway: 'stripe',\r\n      paymentMethod: subscription.payment_method_name,\r\n      offerTitle: subscription.item_title,\r\n      period: subscription.access_type?.period,\r\n      totalPrice: subscription.charged_amount,\r\n      unsubscribeUrl: subscription.unsubscribe_url,\r\n      pendingSwitchId: null,\r\n    } as Subscription;\r\n  };\r\n\r\n  private formatGrantedSubscription = (subscription: GetItemAccessResponse) => {\r\n    return {\r\n      subscriptionId: '',\r\n      offerId: subscription.item.id.toString(),\r\n      status: 'active',\r\n      expiresAt: subscription.expires_at,\r\n      nextPaymentAt: subscription.expires_at,\r\n      nextPaymentPrice: 0,\r\n      nextPaymentCurrency: 'EUR',\r\n      paymentGateway: 'none',\r\n      paymentMethod: i18next.t('user:payment.access_granted'),\r\n      offerTitle: subscription.item.title,\r\n      period: 'granted',\r\n      totalPrice: 0,\r\n      unsubscribeUrl: '',\r\n      pendingSwitchId: null,\r\n    } as Subscription;\r\n  };\r\n\r\n  getActiveSubscription: GetActiveSubscription = async () => {\r\n    const assetId = this.accountService.assetId;\r\n\r\n    if (assetId === null) throw new Error(\"Couldn't fetch active subscription, there is no assetId configured\");\r\n\r\n    try {\r\n      const hasAccess = await this.apiService.get<GetItemAccessResponse>(`/items/${assetId}/access`, {\r\n        withAuthentication: true,\r\n      });\r\n\r\n      if (hasAccess) {\r\n        const data = await this.apiService.get<GetSubscriptionsResponse>(\r\n          '/subscriptions',\r\n          {\r\n            withAuthentication: true,\r\n            contentType: 'json',\r\n          },\r\n          {\r\n            limit: 15,\r\n            page: 0,\r\n          },\r\n        );\r\n\r\n        const activeSubscription = data.collection.find((subscription: SubscriptionDetails) => subscription.item_id === assetId);\r\n\r\n        if (activeSubscription) {\r\n          return this.formatActiveSubscription(activeSubscription, hasAccess?.expires_at);\r\n        }\r\n\r\n        return this.formatGrantedSubscription(hasAccess);\r\n      }\r\n      return null;\r\n    } catch (error: unknown) {\r\n      if (JWPAPIService.isCommonError(error) && error.response.data.code === 402) {\r\n        return null;\r\n      }\r\n      throw new Error('Unable to fetch customer subscriptions.');\r\n    }\r\n  };\r\n\r\n  getAllTransactions: GetAllTransactions = async () => {\r\n    try {\r\n      const data = await this.apiService.get<GetPaymentHistoryResponse>('/v2/accounting/payment-history', {\r\n        withAuthentication: true,\r\n        contentType: 'json',\r\n      });\r\n\r\n      return data?.collection?.map((transaction) => this.formatTransaction(transaction));\r\n    } catch {\r\n      throw new Error('Failed to get transactions');\r\n    }\r\n  };\r\n\r\n  getActivePayment: GetActivePayment = async () => {\r\n    try {\r\n      const data = await this.apiService.get<GetDefaultCardResponse>('/v2/payments/cards/default', {\r\n        withAuthentication: true,\r\n        contentType: 'json',\r\n      });\r\n\r\n      const cards: PaymentDetail[] = [];\r\n      for (const currency in data?.cards) {\r\n        cards.push(\r\n          this.formatCardDetails({\r\n            ...data.cards?.[currency],\r\n            currency: currency,\r\n          }),\r\n        );\r\n      }\r\n      return cards.find((paymentDetails) => paymentDetails.active) || null;\r\n    } catch {\r\n      return null;\r\n    }\r\n  };\r\n\r\n  getSubscriptions = async () => {\r\n    return {\r\n      errors: [],\r\n      responseData: { items: [] },\r\n    };\r\n  };\r\n\r\n  updateSubscription: UpdateSubscription = async ({ offerId, unsubscribeUrl }) => {\r\n    if (!unsubscribeUrl) {\r\n      throw new Error('Missing unsubscribe url');\r\n    }\r\n    try {\r\n      await this.apiService.get<CancelSubscriptionResponse>(unsubscribeUrl, { withAuthentication: true, contentType: 'json' });\r\n      return {\r\n        errors: [],\r\n        responseData: { offerId: offerId, status: 'cancelled', expiresAt: 0 },\r\n      };\r\n    } catch {\r\n      throw new Error('Failed to update subscription');\r\n    }\r\n  };\r\n\r\n  changeSubscription: ChangeSubscription = async ({ accessFeeId, subscriptionId }) => {\r\n    try {\r\n      const data = await this.apiService.post<ChangeSubscriptionPlanResponse>(\r\n        '/v2/subscriptions/stripe:switch',\r\n        {\r\n          inplayer_token: subscriptionId,\r\n          access_fee_id: accessFeeId,\r\n        },\r\n        {\r\n          withAuthentication: true,\r\n        },\r\n      );\r\n      return {\r\n        errors: [],\r\n        responseData: { message: data.message },\r\n      };\r\n    } catch {\r\n      throw new Error('Failed to change subscription');\r\n    }\r\n  };\r\n\r\n  updateCardDetails: UpdateCardDetails = async ({ cardName, cardNumber, cvc, expMonth, expYear, currency }) => {\r\n    try {\r\n      const responseData = await this.apiService.put<SetDefaultCardResponse>(\r\n        '/v2/payments/cards/default',\r\n        {\r\n          number: cardNumber,\r\n          card_name: cardName,\r\n          cvv: cvc,\r\n          exp_month: expMonth,\r\n          exp_year: expYear,\r\n          currency_iso: currency,\r\n        },\r\n        { withAuthentication: true },\r\n      );\r\n\r\n      return { errors: [], responseData };\r\n    } catch {\r\n      throw new Error('Failed to update card details');\r\n    }\r\n  };\r\n\r\n  fetchReceipt = async ({ transactionId }: { transactionId: string }) => {\r\n    try {\r\n      const responseData = await this.apiService.get<Blob>(`/v2/accounting/transactions/${transactionId}/receipt`, {\r\n        withAuthentication: true,\r\n        contentType: 'json',\r\n        responseType: 'blob',\r\n      });\r\n\r\n      return { errors: [], responseData };\r\n    } catch {\r\n      throw new Error('Failed to get billing receipt');\r\n    }\r\n  };\r\n\r\n  getPaymentDetails = undefined;\r\n\r\n  getTransactions = undefined;\r\n}\r\n","import type { interfaces } from 'inversify';\r\n\r\nimport AppController from '../../controllers/AppController';\r\n\r\n/**\r\n * This function is used to get the integration type from the AppController and is mainly used for getting named\r\n * modules from the container registry.\r\n */\r\nexport const getIntegrationType = (context: interfaces.Context) => {\r\n  return context.container.get(AppController).getIntegrationType();\r\n};\r\n","import type { CalculateIntegrationType } from '../../../types/calculate-integration-type';\r\nimport { INTEGRATION } from '../../constants';\r\n\r\nexport const isCleengIntegrationType: CalculateIntegrationType = (config) => {\r\n  return config.integrations?.cleeng?.id ? INTEGRATION.CLEENG : null;\r\n};\r\n\r\nexport const isJwpIntegrationType: CalculateIntegrationType = (config) => {\r\n  return config.integrations?.jwp?.clientId ? INTEGRATION.JWP : null;\r\n};\r\n","import {\n  ApolloClient,\n  ApolloLink,\n  createHttpLink,\n  InMemoryCache,\n  split,\n} from '@apollo/client';\nimport { WebSocketLink } from '@apollo/client/link/ws';\nimport { getMainDefinition } from '@apollo/client/utilities';\n\n/**\n * Retrieves an ApolloClient by passing in the target GraphQL URL.\n *\n * Optionally a GraphQL Subscription WebSocket URL may be passed to create the ApolloClient with support for GraphQL Subscriptions.\n *\n * @param targetEndpoint The target GraphQL URL\n * @param subscriptionEndpoint The optional target GraphQL Subscription WebSocket URL\n * @returns\n */\nexport const getApolloClient = (\n  targetEndpoint: string,\n  subscriptionEndpoint?: string,\n): ApolloClient<unknown> => {\n  const httpLink = createHttpLink({\n    uri: targetEndpoint,\n  });\n\n  let wsLink: WebSocketLink | undefined;\n  let splitLink: ApolloLink | undefined;\n\n  if (subscriptionEndpoint !== undefined) {\n    wsLink = new WebSocketLink({\n      uri: subscriptionEndpoint,\n      options: {\n        reconnect: true,\n      },\n    });\n\n    /**\n     * Split link to switch between `httpLink` and `wsLink` depending on the type of the operation being invoked.\n     *\n     * The split function takes three parameters:\n     *  - A function that determines if the GQL operation is a subscription or not.\n     *  - The Link to use if the GQL operation is a subscription.\n     *  - The Link to use if the GQL operation is not a subscription.\n     */\n    splitLink = split(\n      ({ query }) => {\n        const definition = getMainDefinition(query);\n\n        return (\n          definition.kind === 'OperationDefinition' &&\n          definition.operation === 'subscription'\n        );\n      },\n      wsLink,\n      httpLink,\n    );\n  }\n\n  return new ApolloClient({\n    link: subscriptionEndpoint ? splitLink : httpLink,\n    cache: new InMemoryCache({ addTypename: false }),\n  });\n};\n","import { gql } from '@apollo/client';\nimport * as Apollo from '@apollo/client';\nexport type Maybe<T> = T | null;\nexport type InputMaybe<T> = Maybe<T>;\nexport type Exact<T extends { [key: string]: unknown }> = { [K in keyof T]: T[K] };\nexport type MakeOptional<T, K extends keyof T> = Omit<T, K> & { [SubKey in K]?: Maybe<T[SubKey]> };\nexport type MakeMaybe<T, K extends keyof T> = Omit<T, K> & { [SubKey in K]: Maybe<T[SubKey]> };\nexport type MakeEmpty<T extends { [key: string]: unknown }, K extends keyof T> = { [_ in K]?: never };\nexport type Incremental<T> = T | { [P in keyof T]?: P extends ' $fragmentName' | '__typename' ? T[P] : never };\nconst defaultOptions = {} as const;\n/** All built-in and custom scalars, mapped to their actual values */\nexport type Scalars = {\n  ID: { input: string; output: string; }\n  String: { input: string; output: string; }\n  Boolean: { input: boolean; output: boolean; }\n  Int: { input: number; output: number; }\n  Float: { input: number; output: number; }\n  Cursor: { input: any; output: any; }\n  Datetime: { input: any; output: any; }\n};\n\n/** A filter to be used against Boolean fields. All fields are combined with a logical ‘and.’ */\nexport type BooleanFilter = {\n  /** Not equal to the specified value, treating null like an ordinary value. */\n  distinctFrom?: InputMaybe<Scalars['Boolean']['input']>;\n  /** Equal to the specified value. */\n  equalTo?: InputMaybe<Scalars['Boolean']['input']>;\n  /** Greater than the specified value. */\n  greaterThan?: InputMaybe<Scalars['Boolean']['input']>;\n  /** Greater than or equal to the specified value. */\n  greaterThanOrEqualTo?: InputMaybe<Scalars['Boolean']['input']>;\n  /** Included in the specified list. */\n  in?: InputMaybe<Array<Scalars['Boolean']['input']>>;\n  /** Is null (if `true` is specified) or is not null (if `false` is specified). */\n  isNull?: InputMaybe<Scalars['Boolean']['input']>;\n  /** Less than the specified value. */\n  lessThan?: InputMaybe<Scalars['Boolean']['input']>;\n  /** Less than or equal to the specified value. */\n  lessThanOrEqualTo?: InputMaybe<Scalars['Boolean']['input']>;\n  /** Equal to the specified value, treating null like an ordinary value. */\n  notDistinctFrom?: InputMaybe<Scalars['Boolean']['input']>;\n  /** Not equal to the specified value. */\n  notEqualTo?: InputMaybe<Scalars['Boolean']['input']>;\n  /** Not included in the specified list. */\n  notIn?: InputMaybe<Array<Scalars['Boolean']['input']>>;\n};\n\n/** Definition of the channel entity. */\nexport type Channel = {\n  __typename?: 'Channel';\n  /** DASH stream URL of the channel. */\n  dashStreamUrl?: Maybe<Scalars['String']['output']>;\n  /** Description of the channel. */\n  description?: Maybe<Scalars['String']['output']>;\n  /** HLS stream URL of the channel. */\n  hlsStreamUrl?: Maybe<Scalars['String']['output']>;\n  id: Scalars['String']['output'];\n  /** Reads and enables pagination through a set of `ChannelImage`. */\n  images: ChannelImagesConnection;\n  /** Key identifier for DRM protected streams. */\n  keyId?: Maybe<Scalars['String']['output']>;\n  /** Reads and enables pagination through a set of `Playlist`. */\n  playlists: PlaylistsConnection;\n  /** Title of the channel. */\n  title?: Maybe<Scalars['String']['output']>;\n};\n\n\n/** Definition of the channel entity. */\nexport type ChannelImagesArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<ChannelImageCondition>;\n  filter?: InputMaybe<ChannelImageFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<ChannelImagesOrderBy>>;\n};\n\n\n/** Definition of the channel entity. */\nexport type ChannelPlaylistsArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<PlaylistCondition>;\n  filter?: InputMaybe<PlaylistFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<PlaylistsOrderBy>>;\n};\n\n/** A condition to be used against `Channel` object types. All fields are tested for equality and combined with a logical ‘and.’ */\nexport type ChannelCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `title` field. */\n  title?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `Channel` object types. All fields are combined with a logical ‘and.’ */\nexport type ChannelFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<ChannelFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<StringFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<ChannelFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<ChannelFilter>>;\n  /** Filter by the object’s `title` field. */\n  title?: InputMaybe<StringFilter>;\n};\n\n/** Asset image metadata. */\nexport type ChannelImage = {\n  __typename?: 'ChannelImage';\n  altText?: Maybe<Scalars['String']['output']>;\n  /** Reads a single `Channel` that is related to this `ChannelImage`. */\n  channel?: Maybe<Channel>;\n  channelId?: Maybe<Scalars['String']['output']>;\n  /** Height of the image in pixels. */\n  height?: Maybe<Scalars['Int']['output']>;\n  id: Scalars['Int']['output'];\n  /** URI to the image file. */\n  path?: Maybe<Scalars['String']['output']>;\n  /** Type of the image. */\n  type?: Maybe<Scalars['String']['output']>;\n  /** Width of the image in pixels. */\n  width?: Maybe<Scalars['Int']['output']>;\n};\n\n/**\n * A condition to be used against `ChannelImage` object types. All fields are\n * tested for equality and combined with a logical ‘and.’\n */\nexport type ChannelImageCondition = {\n  /** Checks for equality with the object’s `altText` field. */\n  altText?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `channelId` field. */\n  channelId?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n};\n\n/** A filter to be used against `ChannelImage` object types. All fields are combined with a logical ‘and.’ */\nexport type ChannelImageFilter = {\n  /** Filter by the object’s `altText` field. */\n  altText?: InputMaybe<StringFilter>;\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<ChannelImageFilter>>;\n  /** Filter by the object’s `channelId` field. */\n  channelId?: InputMaybe<StringFilter>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<ChannelImageFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<ChannelImageFilter>>;\n};\n\n/** A connection to a list of `ChannelImage` values. */\nexport type ChannelImagesConnection = {\n  __typename?: 'ChannelImagesConnection';\n  /** A list of edges which contains the `ChannelImage` and cursor to aid in pagination. */\n  edges: Array<ChannelImagesEdge>;\n  /** A list of `ChannelImage` objects. */\n  nodes: Array<ChannelImage>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `ChannelImage` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `ChannelImage` edge in the connection. */\nexport type ChannelImagesEdge = {\n  __typename?: 'ChannelImagesEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `ChannelImage` at the end of the edge. */\n  node: ChannelImage;\n};\n\n/** Methods to use when ordering `ChannelImage`. */\nexport enum ChannelImagesOrderBy {\n  AltTextAsc = 'ALT_TEXT_ASC',\n  AltTextDesc = 'ALT_TEXT_DESC',\n  ChannelIdAsc = 'CHANNEL_ID_ASC',\n  ChannelIdDesc = 'CHANNEL_ID_DESC',\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC'\n}\n\n/** A connection to a list of `Channel` values. */\nexport type ChannelsConnection = {\n  __typename?: 'ChannelsConnection';\n  /** A list of edges which contains the `Channel` and cursor to aid in pagination. */\n  edges: Array<ChannelsEdge>;\n  /** A list of `Channel` objects. */\n  nodes: Array<Channel>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `Channel` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `Channel` edge in the connection. */\nexport type ChannelsEdge = {\n  __typename?: 'ChannelsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `Channel` at the end of the edge. */\n  node: Channel;\n};\n\n/** Methods to use when ordering `Channel`. */\nexport enum ChannelsOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  TitleAsc = 'TITLE_ASC',\n  TitleDesc = 'TITLE_DESC'\n}\n\n/** Definition of the collection entity. */\nexport type Collection = {\n  __typename?: 'Collection';\n  /** Longer description. */\n  description?: Maybe<Scalars['String']['output']>;\n  id: Scalars['String']['output'];\n  /** Reads and enables pagination through a set of `CollectionImage`. */\n  images: CollectionImagesConnection;\n  /** Reads and enables pagination through a set of `CollectionItemsRelation`. */\n  items: CollectionItemsRelationsConnection;\n  /** Short description. */\n  synopsis?: Maybe<Scalars['String']['output']>;\n  /** Array of tags associated with the content. */\n  tags?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Title of the collection. */\n  title?: Maybe<Scalars['String']['output']>;\n};\n\n\n/** Definition of the collection entity. */\nexport type CollectionImagesArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<CollectionImageCondition>;\n  filter?: InputMaybe<CollectionImageFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<CollectionImagesOrderBy>>;\n};\n\n\n/** Definition of the collection entity. */\nexport type CollectionItemsArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<CollectionItemsRelationCondition>;\n  filter?: InputMaybe<CollectionItemsRelationFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<CollectionItemsRelationsOrderBy>>;\n};\n\n/**\n * A condition to be used against `Collection` object types. All fields are tested\n * for equality and combined with a logical ‘and.’\n */\nexport type CollectionCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `title` field. */\n  title?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `Collection` object types. All fields are combined with a logical ‘and.’ */\nexport type CollectionFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<CollectionFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<StringFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<CollectionFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<CollectionFilter>>;\n  /** Filter by the object’s `title` field. */\n  title?: InputMaybe<StringFilter>;\n};\n\n/** Asset image metadata. */\nexport type CollectionImage = {\n  __typename?: 'CollectionImage';\n  altText?: Maybe<Scalars['String']['output']>;\n  /** Reads a single `Collection` that is related to this `CollectionImage`. */\n  collection?: Maybe<Collection>;\n  collectionId?: Maybe<Scalars['String']['output']>;\n  /** Height of the image in pixels. */\n  height?: Maybe<Scalars['Int']['output']>;\n  id: Scalars['Int']['output'];\n  /** URI to the image file. */\n  path?: Maybe<Scalars['String']['output']>;\n  /** Type of the image. */\n  type?: Maybe<Scalars['String']['output']>;\n  /** Width of the image in pixels. */\n  width?: Maybe<Scalars['Int']['output']>;\n};\n\n/**\n * A condition to be used against `CollectionImage` object types. All fields are\n * tested for equality and combined with a logical ‘and.’\n */\nexport type CollectionImageCondition = {\n  /** Checks for equality with the object’s `altText` field. */\n  altText?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `collectionId` field. */\n  collectionId?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n};\n\n/** A filter to be used against `CollectionImage` object types. All fields are combined with a logical ‘and.’ */\nexport type CollectionImageFilter = {\n  /** Filter by the object’s `altText` field. */\n  altText?: InputMaybe<StringFilter>;\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<CollectionImageFilter>>;\n  /** Filter by the object’s `collectionId` field. */\n  collectionId?: InputMaybe<StringFilter>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<CollectionImageFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<CollectionImageFilter>>;\n};\n\n/** A connection to a list of `CollectionImage` values. */\nexport type CollectionImagesConnection = {\n  __typename?: 'CollectionImagesConnection';\n  /** A list of edges which contains the `CollectionImage` and cursor to aid in pagination. */\n  edges: Array<CollectionImagesEdge>;\n  /** A list of `CollectionImage` objects. */\n  nodes: Array<CollectionImage>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `CollectionImage` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `CollectionImage` edge in the connection. */\nexport type CollectionImagesEdge = {\n  __typename?: 'CollectionImagesEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `CollectionImage` at the end of the edge. */\n  node: CollectionImage;\n};\n\n/** Methods to use when ordering `CollectionImage`. */\nexport enum CollectionImagesOrderBy {\n  AltTextAsc = 'ALT_TEXT_ASC',\n  AltTextDesc = 'ALT_TEXT_DESC',\n  CollectionIdAsc = 'COLLECTION_ID_ASC',\n  CollectionIdDesc = 'COLLECTION_ID_DESC',\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC'\n}\n\nexport type CollectionItemsRelation = {\n  __typename?: 'CollectionItemsRelation';\n  /** Reads a single `Collection` that is related to this `CollectionItemsRelation`. */\n  collection?: Maybe<Collection>;\n  collectionId?: Maybe<Scalars['String']['output']>;\n  /** Reads a single `Episode` that is related to this `CollectionItemsRelation`. */\n  episode?: Maybe<Episode>;\n  episodeId?: Maybe<Scalars['String']['output']>;\n  id: Scalars['Int']['output'];\n  /** Reads a single `Movie` that is related to this `CollectionItemsRelation`. */\n  movie?: Maybe<Movie>;\n  movieId?: Maybe<Scalars['String']['output']>;\n  orderNo: Scalars['Int']['output'];\n  /** Type of the relation. */\n  relationType?: Maybe<Scalars['String']['output']>;\n  /** Reads a single `Season` that is related to this `CollectionItemsRelation`. */\n  season?: Maybe<Season>;\n  seasonId?: Maybe<Scalars['String']['output']>;\n  /** Reads a single `Tvshow` that is related to this `CollectionItemsRelation`. */\n  tvshow?: Maybe<Tvshow>;\n  tvshowId?: Maybe<Scalars['String']['output']>;\n};\n\n/**\n * A condition to be used against `CollectionItemsRelation` object types. All\n * fields are tested for equality and combined with a logical ‘and.’\n */\nexport type CollectionItemsRelationCondition = {\n  /** Checks for equality with the object’s `collectionId` field. */\n  collectionId?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `episodeId` field. */\n  episodeId?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `movieId` field. */\n  movieId?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `orderNo` field. */\n  orderNo?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `seasonId` field. */\n  seasonId?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `tvshowId` field. */\n  tvshowId?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `CollectionItemsRelation` object types. All fields are combined with a logical ‘and.’ */\nexport type CollectionItemsRelationFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<CollectionItemsRelationFilter>>;\n  /** Filter by the object’s `collectionId` field. */\n  collectionId?: InputMaybe<StringFilter>;\n  /** Filter by the object’s `episodeId` field. */\n  episodeId?: InputMaybe<StringFilter>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Filter by the object’s `movieId` field. */\n  movieId?: InputMaybe<StringFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<CollectionItemsRelationFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<CollectionItemsRelationFilter>>;\n  /** Filter by the object’s `orderNo` field. */\n  orderNo?: InputMaybe<IntFilter>;\n  /** Filter by the object’s `seasonId` field. */\n  seasonId?: InputMaybe<StringFilter>;\n  /** Filter by the object’s `tvshowId` field. */\n  tvshowId?: InputMaybe<StringFilter>;\n};\n\n/** A connection to a list of `CollectionItemsRelation` values. */\nexport type CollectionItemsRelationsConnection = {\n  __typename?: 'CollectionItemsRelationsConnection';\n  /** A list of edges which contains the `CollectionItemsRelation` and cursor to aid in pagination. */\n  edges: Array<CollectionItemsRelationsEdge>;\n  /** A list of `CollectionItemsRelation` objects. */\n  nodes: Array<CollectionItemsRelation>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `CollectionItemsRelation` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `CollectionItemsRelation` edge in the connection. */\nexport type CollectionItemsRelationsEdge = {\n  __typename?: 'CollectionItemsRelationsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `CollectionItemsRelation` at the end of the edge. */\n  node: CollectionItemsRelation;\n};\n\n/** Methods to use when ordering `CollectionItemsRelation`. */\nexport enum CollectionItemsRelationsOrderBy {\n  CollectionIdAsc = 'COLLECTION_ID_ASC',\n  CollectionIdDesc = 'COLLECTION_ID_DESC',\n  EpisodeIdAsc = 'EPISODE_ID_ASC',\n  EpisodeIdDesc = 'EPISODE_ID_DESC',\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  MovieIdAsc = 'MOVIE_ID_ASC',\n  MovieIdDesc = 'MOVIE_ID_DESC',\n  Natural = 'NATURAL',\n  OrderNoAsc = 'ORDER_NO_ASC',\n  OrderNoDesc = 'ORDER_NO_DESC',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  SeasonIdAsc = 'SEASON_ID_ASC',\n  SeasonIdDesc = 'SEASON_ID_DESC',\n  TvshowIdAsc = 'TVSHOW_ID_ASC',\n  TvshowIdDesc = 'TVSHOW_ID_DESC'\n}\n\n/** A connection to a list of `Collection` values. */\nexport type CollectionsConnection = {\n  __typename?: 'CollectionsConnection';\n  /** A list of edges which contains the `Collection` and cursor to aid in pagination. */\n  edges: Array<CollectionsEdge>;\n  /** A list of `Collection` objects. */\n  nodes: Array<Collection>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `Collection` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `Collection` edge in the connection. */\nexport type CollectionsEdge = {\n  __typename?: 'CollectionsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `Collection` at the end of the edge. */\n  node: Collection;\n};\n\n/** Methods to use when ordering `Collection`. */\nexport enum CollectionsOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  TitleAsc = 'TITLE_ASC',\n  TitleDesc = 'TITLE_DESC'\n}\n\n/** Definition of the TV show episode entity. */\nexport type Episode = {\n  __typename?: 'Episode';\n  /** Cast of the episode. */\n  cast?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Extended synopsis. */\n  description?: Maybe<Scalars['String']['output']>;\n  /** Reads and enables pagination through a set of `EpisodeGenresRelation`. */\n  genres: EpisodeGenresRelationsConnection;\n  id: Scalars['String']['output'];\n  /** Reads and enables pagination through a set of `EpisodeImage`. */\n  images: EpisodeImagesConnection;\n  /** Episode number */\n  index?: Maybe<Scalars['Int']['output']>;\n  /** Reads and enables pagination through a set of `EpisodeLicense`. */\n  licenses: EpisodeLicensesConnection;\n  /** Original title of the episode. */\n  originalTitle?: Maybe<Scalars['String']['output']>;\n  /** Array of production countries */\n  productionCountries?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Date of first release. */\n  released?: Maybe<Scalars['Datetime']['output']>;\n  /** Reads a single `Season` that is related to this `Episode`. */\n  season?: Maybe<Season>;\n  seasonId?: Maybe<Scalars['String']['output']>;\n  /** Name of the producing studio. */\n  studio?: Maybe<Scalars['String']['output']>;\n  /** Short description of the main plot elements. */\n  synopsis?: Maybe<Scalars['String']['output']>;\n  /** Array of tags associated with the content. */\n  tags?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Title of the episode. */\n  title?: Maybe<Scalars['String']['output']>;\n  /** Reads and enables pagination through a set of `EpisodeVideo`. */\n  videos: EpisodeVideosConnection;\n};\n\n\n/** Definition of the TV show episode entity. */\nexport type EpisodeGenresArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<EpisodeGenresRelationCondition>;\n  filter?: InputMaybe<EpisodeGenresRelationFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<EpisodeGenresRelationsOrderBy>>;\n};\n\n\n/** Definition of the TV show episode entity. */\nexport type EpisodeImagesArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<EpisodeImageCondition>;\n  filter?: InputMaybe<EpisodeImageFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<EpisodeImagesOrderBy>>;\n};\n\n\n/** Definition of the TV show episode entity. */\nexport type EpisodeLicensesArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<EpisodeLicenseCondition>;\n  filter?: InputMaybe<EpisodeLicenseFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<EpisodeLicensesOrderBy>>;\n};\n\n\n/** Definition of the TV show episode entity. */\nexport type EpisodeVideosArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<EpisodeVideoCondition>;\n  filter?: InputMaybe<EpisodeVideoFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<EpisodeVideosOrderBy>>;\n};\n\n/** A condition to be used against `Episode` object types. All fields are tested for equality and combined with a logical ‘and.’ */\nexport type EpisodeCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `seasonId` field. */\n  seasonId?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `title` field. */\n  title?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `Episode` object types. All fields are combined with a logical ‘and.’ */\nexport type EpisodeFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<EpisodeFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<StringFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<EpisodeFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<EpisodeFilter>>;\n  /** Filter by the object’s `seasonId` field. */\n  seasonId?: InputMaybe<StringFilter>;\n  /** Filter by the object’s `title` field. */\n  title?: InputMaybe<StringFilter>;\n};\n\nexport type EpisodeGenresRelation = {\n  __typename?: 'EpisodeGenresRelation';\n  /** Reads a single `Episode` that is related to this `EpisodeGenresRelation`. */\n  episode?: Maybe<Episode>;\n  episodeId?: Maybe<Scalars['String']['output']>;\n  id: Scalars['Int']['output'];\n  orderNo: Scalars['Int']['output'];\n  /** Reads a single `TvshowGenre` that is related to this `EpisodeGenresRelation`. */\n  tvshowGenre?: Maybe<TvshowGenre>;\n  tvshowGenreId?: Maybe<Scalars['String']['output']>;\n};\n\n/**\n * A condition to be used against `EpisodeGenresRelation` object types. All fields\n * are tested for equality and combined with a logical ‘and.’\n */\nexport type EpisodeGenresRelationCondition = {\n  /** Checks for equality with the object’s `episodeId` field. */\n  episodeId?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `orderNo` field. */\n  orderNo?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `tvshowGenreId` field. */\n  tvshowGenreId?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `EpisodeGenresRelation` object types. All fields are combined with a logical ‘and.’ */\nexport type EpisodeGenresRelationFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<EpisodeGenresRelationFilter>>;\n  /** Filter by the object’s `episodeId` field. */\n  episodeId?: InputMaybe<StringFilter>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<EpisodeGenresRelationFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<EpisodeGenresRelationFilter>>;\n  /** Filter by the object’s `orderNo` field. */\n  orderNo?: InputMaybe<IntFilter>;\n  /** Filter by the object’s `tvshowGenreId` field. */\n  tvshowGenreId?: InputMaybe<StringFilter>;\n};\n\n/** A connection to a list of `EpisodeGenresRelation` values. */\nexport type EpisodeGenresRelationsConnection = {\n  __typename?: 'EpisodeGenresRelationsConnection';\n  /** A list of edges which contains the `EpisodeGenresRelation` and cursor to aid in pagination. */\n  edges: Array<EpisodeGenresRelationsEdge>;\n  /** A list of `EpisodeGenresRelation` objects. */\n  nodes: Array<EpisodeGenresRelation>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `EpisodeGenresRelation` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `EpisodeGenresRelation` edge in the connection. */\nexport type EpisodeGenresRelationsEdge = {\n  __typename?: 'EpisodeGenresRelationsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `EpisodeGenresRelation` at the end of the edge. */\n  node: EpisodeGenresRelation;\n};\n\n/** Methods to use when ordering `EpisodeGenresRelation`. */\nexport enum EpisodeGenresRelationsOrderBy {\n  EpisodeIdAsc = 'EPISODE_ID_ASC',\n  EpisodeIdDesc = 'EPISODE_ID_DESC',\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  OrderNoAsc = 'ORDER_NO_ASC',\n  OrderNoDesc = 'ORDER_NO_DESC',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  TvshowGenreIdAsc = 'TVSHOW_GENRE_ID_ASC',\n  TvshowGenreIdDesc = 'TVSHOW_GENRE_ID_DESC'\n}\n\n/** Asset image metadata. */\nexport type EpisodeImage = {\n  __typename?: 'EpisodeImage';\n  altText?: Maybe<Scalars['String']['output']>;\n  /** Reads a single `Episode` that is related to this `EpisodeImage`. */\n  episode?: Maybe<Episode>;\n  episodeId?: Maybe<Scalars['String']['output']>;\n  /** Height of the image in pixels. */\n  height?: Maybe<Scalars['Int']['output']>;\n  id: Scalars['Int']['output'];\n  /** URI to the image file. */\n  path?: Maybe<Scalars['String']['output']>;\n  /** Type of the image. */\n  type?: Maybe<Scalars['String']['output']>;\n  /** Width of the image in pixels. */\n  width?: Maybe<Scalars['Int']['output']>;\n};\n\n/**\n * A condition to be used against `EpisodeImage` object types. All fields are\n * tested for equality and combined with a logical ‘and.’\n */\nexport type EpisodeImageCondition = {\n  /** Checks for equality with the object’s `altText` field. */\n  altText?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `episodeId` field. */\n  episodeId?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n};\n\n/** A filter to be used against `EpisodeImage` object types. All fields are combined with a logical ‘and.’ */\nexport type EpisodeImageFilter = {\n  /** Filter by the object’s `altText` field. */\n  altText?: InputMaybe<StringFilter>;\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<EpisodeImageFilter>>;\n  /** Filter by the object’s `episodeId` field. */\n  episodeId?: InputMaybe<StringFilter>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<EpisodeImageFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<EpisodeImageFilter>>;\n};\n\n/** A connection to a list of `EpisodeImage` values. */\nexport type EpisodeImagesConnection = {\n  __typename?: 'EpisodeImagesConnection';\n  /** A list of edges which contains the `EpisodeImage` and cursor to aid in pagination. */\n  edges: Array<EpisodeImagesEdge>;\n  /** A list of `EpisodeImage` objects. */\n  nodes: Array<EpisodeImage>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `EpisodeImage` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `EpisodeImage` edge in the connection. */\nexport type EpisodeImagesEdge = {\n  __typename?: 'EpisodeImagesEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `EpisodeImage` at the end of the edge. */\n  node: EpisodeImage;\n};\n\n/** Methods to use when ordering `EpisodeImage`. */\nexport enum EpisodeImagesOrderBy {\n  AltTextAsc = 'ALT_TEXT_ASC',\n  AltTextDesc = 'ALT_TEXT_DESC',\n  EpisodeIdAsc = 'EPISODE_ID_ASC',\n  EpisodeIdDesc = 'EPISODE_ID_DESC',\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC'\n}\n\n/** Content metadata license that defines the content availability regions and time frame. */\nexport type EpisodeLicense = {\n  __typename?: 'EpisodeLicense';\n  /** Array of countries where the license applies. */\n  countries?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Time when license becomes invalid. */\n  endTime?: Maybe<Scalars['Datetime']['output']>;\n  /** Reads a single `Episode` that is related to this `EpisodeLicense`. */\n  episode?: Maybe<Episode>;\n  episodeId?: Maybe<Scalars['String']['output']>;\n  id: Scalars['Int']['output'];\n  /** Time when license becomes valid. */\n  startTime?: Maybe<Scalars['Datetime']['output']>;\n};\n\n/**\n * A condition to be used against `EpisodeLicense` object types. All fields are\n * tested for equality and combined with a logical ‘and.’\n */\nexport type EpisodeLicenseCondition = {\n  /** Checks for equality with the object’s `episodeId` field. */\n  episodeId?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n};\n\n/** A filter to be used against `EpisodeLicense` object types. All fields are combined with a logical ‘and.’ */\nexport type EpisodeLicenseFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<EpisodeLicenseFilter>>;\n  /** Filter by the object’s `episodeId` field. */\n  episodeId?: InputMaybe<StringFilter>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<EpisodeLicenseFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<EpisodeLicenseFilter>>;\n};\n\n/** A connection to a list of `EpisodeLicense` values. */\nexport type EpisodeLicensesConnection = {\n  __typename?: 'EpisodeLicensesConnection';\n  /** A list of edges which contains the `EpisodeLicense` and cursor to aid in pagination. */\n  edges: Array<EpisodeLicensesEdge>;\n  /** A list of `EpisodeLicense` objects. */\n  nodes: Array<EpisodeLicense>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `EpisodeLicense` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `EpisodeLicense` edge in the connection. */\nexport type EpisodeLicensesEdge = {\n  __typename?: 'EpisodeLicensesEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `EpisodeLicense` at the end of the edge. */\n  node: EpisodeLicense;\n};\n\n/** Methods to use when ordering `EpisodeLicense`. */\nexport enum EpisodeLicensesOrderBy {\n  EpisodeIdAsc = 'EPISODE_ID_ASC',\n  EpisodeIdDesc = 'EPISODE_ID_DESC',\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC'\n}\n\n/** Video stream metadata. */\nexport type EpisodeVideo = {\n  __typename?: 'EpisodeVideo';\n  /** Array of audio languages available in the stream. */\n  audioLanguages?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Array of caption languages available in the stream. */\n  captionLanguages?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Reads and enables pagination through a set of `EpisodeVideoCuePoint`. */\n  cuePoints: EpisodeVideoCuePointsConnection;\n  /** URI to a DASH manifest. */\n  dashManifest?: Maybe<Scalars['String']['output']>;\n  /** Reads a single `Episode` that is related to this `EpisodeVideo`. */\n  episode?: Maybe<Episode>;\n  episodeId?: Maybe<Scalars['String']['output']>;\n  /** URI to an HLS manifest. */\n  hlsManifest?: Maybe<Scalars['String']['output']>;\n  id: Scalars['Int']['output'];\n  /** Indicates whether a stream is protected with DRM. */\n  isProtected?: Maybe<Scalars['Boolean']['output']>;\n  /** Length of the stream in seconds. */\n  lengthInSeconds?: Maybe<Scalars['Float']['output']>;\n  /** Output format of the stream. */\n  outputFormat?: Maybe<Scalars['String']['output']>;\n  /** Array of subtitle languages available in the stream. */\n  subtitleLanguages?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Title of the video stream */\n  title?: Maybe<Scalars['String']['output']>;\n  /** Type of the video stream. */\n  type?: Maybe<Scalars['String']['output']>;\n  /** Reads and enables pagination through a set of `EpisodeVideoStream`. */\n  videoStreams: EpisodeVideoStreamsConnection;\n};\n\n\n/** Video stream metadata. */\nexport type EpisodeVideoCuePointsArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<EpisodeVideoCuePointCondition>;\n  filter?: InputMaybe<EpisodeVideoCuePointFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<EpisodeVideoCuePointsOrderBy>>;\n};\n\n\n/** Video stream metadata. */\nexport type EpisodeVideoVideoStreamsArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<EpisodeVideoStreamCondition>;\n  filter?: InputMaybe<EpisodeVideoStreamFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<EpisodeVideoStreamsOrderBy>>;\n};\n\n/**\n * A condition to be used against `EpisodeVideo` object types. All fields are\n * tested for equality and combined with a logical ‘and.’\n */\nexport type EpisodeVideoCondition = {\n  /** Checks for equality with the object’s `episodeId` field. */\n  episodeId?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `type` field. */\n  type?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** Video cue point metadata */\nexport type EpisodeVideoCuePoint = {\n  __typename?: 'EpisodeVideoCuePoint';\n  /** Type of the cue point */\n  cuePointTypeKey: Scalars['String']['output'];\n  id: Scalars['Int']['output'];\n  /** Time in seconds at which the cue point is set within the video */\n  timeInSeconds: Scalars['Float']['output'];\n  /** Additional information associated with the cue point */\n  value?: Maybe<Scalars['String']['output']>;\n  /** Reads a single `EpisodeVideo` that is related to this `EpisodeVideoCuePoint`. */\n  video?: Maybe<EpisodeVideo>;\n  videoId?: Maybe<Scalars['Int']['output']>;\n};\n\n/**\n * A condition to be used against `EpisodeVideoCuePoint` object types. All fields\n * are tested for equality and combined with a logical ‘and.’\n */\nexport type EpisodeVideoCuePointCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `videoId` field. */\n  videoId?: InputMaybe<Scalars['Int']['input']>;\n};\n\n/** A filter to be used against `EpisodeVideoCuePoint` object types. All fields are combined with a logical ‘and.’ */\nexport type EpisodeVideoCuePointFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<EpisodeVideoCuePointFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<EpisodeVideoCuePointFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<EpisodeVideoCuePointFilter>>;\n  /** Filter by the object’s `videoId` field. */\n  videoId?: InputMaybe<IntFilter>;\n};\n\n/** A connection to a list of `EpisodeVideoCuePoint` values. */\nexport type EpisodeVideoCuePointsConnection = {\n  __typename?: 'EpisodeVideoCuePointsConnection';\n  /** A list of edges which contains the `EpisodeVideoCuePoint` and cursor to aid in pagination. */\n  edges: Array<EpisodeVideoCuePointsEdge>;\n  /** A list of `EpisodeVideoCuePoint` objects. */\n  nodes: Array<EpisodeVideoCuePoint>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `EpisodeVideoCuePoint` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `EpisodeVideoCuePoint` edge in the connection. */\nexport type EpisodeVideoCuePointsEdge = {\n  __typename?: 'EpisodeVideoCuePointsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `EpisodeVideoCuePoint` at the end of the edge. */\n  node: EpisodeVideoCuePoint;\n};\n\n/** Methods to use when ordering `EpisodeVideoCuePoint`. */\nexport enum EpisodeVideoCuePointsOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  VideoIdAsc = 'VIDEO_ID_ASC',\n  VideoIdDesc = 'VIDEO_ID_DESC'\n}\n\n/** A filter to be used against `EpisodeVideo` object types. All fields are combined with a logical ‘and.’ */\nexport type EpisodeVideoFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<EpisodeVideoFilter>>;\n  /** Filter by the object’s `episodeId` field. */\n  episodeId?: InputMaybe<StringFilter>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<EpisodeVideoFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<EpisodeVideoFilter>>;\n  /** Filter by the object’s `type` field. */\n  type?: InputMaybe<StringFilter>;\n};\n\n/** Video stream DRM metadata */\nexport type EpisodeVideoStream = {\n  __typename?: 'EpisodeVideoStream';\n  /** Bitrate in kilobits per second */\n  bitrateInKbps?: Maybe<Scalars['Int']['output']>;\n  /** Codecs */\n  codecs?: Maybe<Scalars['String']['output']>;\n  /** Display aspect ratio for video streams */\n  displayAspectRatio?: Maybe<Scalars['String']['output']>;\n  /** File path to the initialization segment */\n  file?: Maybe<Scalars['String']['output']>;\n  /** File Template */\n  fileTemplate?: Maybe<Scalars['String']['output']>;\n  /** Packaging format of the stream */\n  format?: Maybe<Scalars['String']['output']>;\n  /** Frame rate of the video stream */\n  frameRate?: Maybe<Scalars['Float']['output']>;\n  /** Height of the video stream */\n  height?: Maybe<Scalars['Int']['output']>;\n  id: Scalars['Int']['output'];\n  /** Initialization Vector of the stream */\n  iv?: Maybe<Scalars['String']['output']>;\n  /** DRM Key ID */\n  keyId?: Maybe<Scalars['String']['output']>;\n  /** Label indicating the type of stream (audio/video) */\n  label?: Maybe<Scalars['String']['output']>;\n  /** The language code for audio streams */\n  languageCode?: Maybe<Scalars['String']['output']>;\n  /** Language name for audio, subtitle, or caption streams */\n  languageName?: Maybe<Scalars['String']['output']>;\n  /** Pixel aspect ratio for video streams */\n  pixelAspectRatio?: Maybe<Scalars['String']['output']>;\n  /** Sampling rate for audio streams */\n  samplingRate?: Maybe<Scalars['Int']['output']>;\n  /** Stream type */\n  type?: Maybe<VideoStreamType>;\n  /** Reads a single `EpisodeVideo` that is related to this `EpisodeVideoStream`. */\n  video?: Maybe<EpisodeVideo>;\n  videoId?: Maybe<Scalars['Int']['output']>;\n  /** Width of the video stream */\n  width?: Maybe<Scalars['Int']['output']>;\n};\n\n/**\n * A condition to be used against `EpisodeVideoStream` object types. All fields are\n * tested for equality and combined with a logical ‘and.’\n */\nexport type EpisodeVideoStreamCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `type` field. */\n  type?: InputMaybe<VideoStreamType>;\n  /** Checks for equality with the object’s `videoId` field. */\n  videoId?: InputMaybe<Scalars['Int']['input']>;\n};\n\n/** A filter to be used against `EpisodeVideoStream` object types. All fields are combined with a logical ‘and.’ */\nexport type EpisodeVideoStreamFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<EpisodeVideoStreamFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<EpisodeVideoStreamFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<EpisodeVideoStreamFilter>>;\n  /** Filter by the object’s `type` field. */\n  type?: InputMaybe<VideoStreamTypeFilter>;\n  /** Filter by the object’s `videoId` field. */\n  videoId?: InputMaybe<IntFilter>;\n};\n\n/** A connection to a list of `EpisodeVideoStream` values. */\nexport type EpisodeVideoStreamsConnection = {\n  __typename?: 'EpisodeVideoStreamsConnection';\n  /** A list of edges which contains the `EpisodeVideoStream` and cursor to aid in pagination. */\n  edges: Array<EpisodeVideoStreamsEdge>;\n  /** A list of `EpisodeVideoStream` objects. */\n  nodes: Array<EpisodeVideoStream>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `EpisodeVideoStream` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `EpisodeVideoStream` edge in the connection. */\nexport type EpisodeVideoStreamsEdge = {\n  __typename?: 'EpisodeVideoStreamsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `EpisodeVideoStream` at the end of the edge. */\n  node: EpisodeVideoStream;\n};\n\n/** Methods to use when ordering `EpisodeVideoStream`. */\nexport enum EpisodeVideoStreamsOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  TypeAsc = 'TYPE_ASC',\n  TypeDesc = 'TYPE_DESC',\n  VideoIdAsc = 'VIDEO_ID_ASC',\n  VideoIdDesc = 'VIDEO_ID_DESC'\n}\n\n/** A connection to a list of `EpisodeVideo` values. */\nexport type EpisodeVideosConnection = {\n  __typename?: 'EpisodeVideosConnection';\n  /** A list of edges which contains the `EpisodeVideo` and cursor to aid in pagination. */\n  edges: Array<EpisodeVideosEdge>;\n  /** A list of `EpisodeVideo` objects. */\n  nodes: Array<EpisodeVideo>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `EpisodeVideo` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `EpisodeVideo` edge in the connection. */\nexport type EpisodeVideosEdge = {\n  __typename?: 'EpisodeVideosEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `EpisodeVideo` at the end of the edge. */\n  node: EpisodeVideo;\n};\n\n/** Methods to use when ordering `EpisodeVideo`. */\nexport enum EpisodeVideosOrderBy {\n  EpisodeIdAsc = 'EPISODE_ID_ASC',\n  EpisodeIdDesc = 'EPISODE_ID_DESC',\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  TypeAsc = 'TYPE_ASC',\n  TypeDesc = 'TYPE_DESC'\n}\n\n/** A connection to a list of `Episode` values. */\nexport type EpisodesConnection = {\n  __typename?: 'EpisodesConnection';\n  /** A list of edges which contains the `Episode` and cursor to aid in pagination. */\n  edges: Array<EpisodesEdge>;\n  /** A list of `Episode` objects. */\n  nodes: Array<Episode>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `Episode` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `Episode` edge in the connection. */\nexport type EpisodesEdge = {\n  __typename?: 'EpisodesEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `Episode` at the end of the edge. */\n  node: Episode;\n};\n\n/** Methods to use when ordering `Episode`. */\nexport enum EpisodesOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  SeasonIdAsc = 'SEASON_ID_ASC',\n  SeasonIdDesc = 'SEASON_ID_DESC',\n  TitleAsc = 'TITLE_ASC',\n  TitleDesc = 'TITLE_DESC'\n}\n\n/** Exposes all error codes and messages for errors that a service requests can throw. In some cases, messages that are actually thrown can be different, since they can include more details or a single code can used for different errors of the same type. */\nexport enum ErrorCodesEnum {\n  /** The assertion check for the identifier %s failed. */\n  AssertionFailed = 'ASSERTION_FAILED',\n  /** A database operation has failed because of a lock timeout. */\n  DatabaseLockTimeoutError = 'DATABASE_LOCK_TIMEOUT_ERROR',\n  /** An authorization database error has occurred. The user might not have enough permissions. */\n  DatabasePermissionsCheckFailed = 'DATABASE_PERMISSIONS_CHECK_FAILED',\n  /** An expected and handled database constraint error has occurred. The actual message will have more information. */\n  DatabaseValidationFailed = 'DATABASE_VALIDATION_FAILED',\n  /** This is a wrapper error for the original unhandled error of unsupported type. */\n  ErrorWrapper = 'ERROR_WRAPPER',\n  /** A GraphQL validation error has occurred. Please make sure that the GraphQL request is made with correct syntax or parameters. */\n  GraphqlValidationFailed = 'GRAPHQL_VALIDATION_FAILED',\n  /** An unhandled and unexpected error has occurred. Please contact the service support. */\n  InternalServerError = 'INTERNAL_SERVER_ERROR',\n  /** The %s does not have a valid license in your current country (%s) */\n  LicenseIsNotValid = 'LICENSE_IS_NOT_VALID',\n  /** The %s does not have a license. */\n  LicenseNotFound = 'LICENSE_NOT_FOUND',\n  /** The %s is missing required properties: %s. */\n  ObjectIsMissingProperties = 'OBJECT_IS_MISSING_PROPERTIES',\n  /** An application startup error has occurred. The actual message will have more information. */\n  StartupError = 'STARTUP_ERROR',\n  /** Unexpected null or undefined value received. */\n  UnexpectedNullUndefined = 'UNEXPECTED_NULL_UNDEFINED',\n  /** An unhandled database-related error has occurred. Please contact the service support. */\n  UnhandledDatabaseError = 'UNHANDLED_DATABASE_ERROR',\n  /** An unhandled error has occurred. Please contact the service support. */\n  UnhandledError = 'UNHANDLED_ERROR',\n  /** Attempt to create or update an element failed, as it would have resulted in a duplicate element. */\n  UniqueConstraintError = 'UNIQUE_CONSTRAINT_ERROR',\n  /** The %s is not an object. */\n  ValueIsNotObject = 'VALUE_IS_NOT_OBJECT'\n}\n\n/** A filter to be used against Int fields. All fields are combined with a logical ‘and.’ */\nexport type IntFilter = {\n  /** Not equal to the specified value, treating null like an ordinary value. */\n  distinctFrom?: InputMaybe<Scalars['Int']['input']>;\n  /** Equal to the specified value. */\n  equalTo?: InputMaybe<Scalars['Int']['input']>;\n  /** Greater than the specified value. */\n  greaterThan?: InputMaybe<Scalars['Int']['input']>;\n  /** Greater than or equal to the specified value. */\n  greaterThanOrEqualTo?: InputMaybe<Scalars['Int']['input']>;\n  /** Included in the specified list. */\n  in?: InputMaybe<Array<Scalars['Int']['input']>>;\n  /** Is null (if `true` is specified) or is not null (if `false` is specified). */\n  isNull?: InputMaybe<Scalars['Boolean']['input']>;\n  /** Less than the specified value. */\n  lessThan?: InputMaybe<Scalars['Int']['input']>;\n  /** Less than or equal to the specified value. */\n  lessThanOrEqualTo?: InputMaybe<Scalars['Int']['input']>;\n  /** Equal to the specified value, treating null like an ordinary value. */\n  notDistinctFrom?: InputMaybe<Scalars['Int']['input']>;\n  /** Not equal to the specified value. */\n  notEqualTo?: InputMaybe<Scalars['Int']['input']>;\n  /** Not included in the specified list. */\n  notIn?: InputMaybe<Array<Scalars['Int']['input']>>;\n};\n\nexport type Locale = {\n  __typename?: 'Locale';\n  isDefault: Scalars['Boolean']['output'];\n  locale: Scalars['String']['output'];\n};\n\n/** A condition to be used against `Locale` object types. All fields are tested for equality and combined with a logical ‘and.’ */\nexport type LocaleCondition = {\n  /** Checks for equality with the object’s `isDefault` field. */\n  isDefault?: InputMaybe<Scalars['Boolean']['input']>;\n  /** Checks for equality with the object’s `locale` field. */\n  locale?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `Locale` object types. All fields are combined with a logical ‘and.’ */\nexport type LocaleFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<LocaleFilter>>;\n  /** Filter by the object’s `isDefault` field. */\n  isDefault?: InputMaybe<BooleanFilter>;\n  /** Filter by the object’s `locale` field. */\n  locale?: InputMaybe<StringFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<LocaleFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<LocaleFilter>>;\n};\n\n/** A connection to a list of `Locale` values. */\nexport type LocalesConnection = {\n  __typename?: 'LocalesConnection';\n  /** A list of edges which contains the `Locale` and cursor to aid in pagination. */\n  edges: Array<LocalesEdge>;\n  /** A list of `Locale` objects. */\n  nodes: Array<Locale>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `Locale` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `Locale` edge in the connection. */\nexport type LocalesEdge = {\n  __typename?: 'LocalesEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `Locale` at the end of the edge. */\n  node: Locale;\n};\n\n/** Methods to use when ordering `Locale`. */\nexport enum LocalesOrderBy {\n  IsDefaultAsc = 'IS_DEFAULT_ASC',\n  IsDefaultDesc = 'IS_DEFAULT_DESC',\n  LocaleAsc = 'LOCALE_ASC',\n  LocaleDesc = 'LOCALE_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC'\n}\n\n/** Definition of the movie entity. */\nexport type Movie = {\n  __typename?: 'Movie';\n  /** Cast of the movie. */\n  cast?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Extended synopsis. */\n  description?: Maybe<Scalars['String']['output']>;\n  /** Reads and enables pagination through a set of `MovieGenresRelation`. */\n  genres: MovieGenresRelationsConnection;\n  id: Scalars['String']['output'];\n  /** Reads and enables pagination through a set of `MovieImage`. */\n  images: MovieImagesConnection;\n  /** Reads and enables pagination through a set of `MovieLicense`. */\n  licenses: MovieLicensesConnection;\n  /** Original title of the movie. */\n  originalTitle?: Maybe<Scalars['String']['output']>;\n  /** Array of production countries */\n  productionCountries?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Date of first release. */\n  released?: Maybe<Scalars['Datetime']['output']>;\n  /** Name of the producing studio. */\n  studio?: Maybe<Scalars['String']['output']>;\n  /** Short description of the main plot elements. */\n  synopsis?: Maybe<Scalars['String']['output']>;\n  /** Array of tags associated with the content. */\n  tags?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Title of the movie. */\n  title?: Maybe<Scalars['String']['output']>;\n  /** Reads and enables pagination through a set of `MovieVideo`. */\n  videos: MovieVideosConnection;\n};\n\n\n/** Definition of the movie entity. */\nexport type MovieGenresArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<MovieGenresRelationCondition>;\n  filter?: InputMaybe<MovieGenresRelationFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<MovieGenresRelationsOrderBy>>;\n};\n\n\n/** Definition of the movie entity. */\nexport type MovieImagesArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<MovieImageCondition>;\n  filter?: InputMaybe<MovieImageFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<MovieImagesOrderBy>>;\n};\n\n\n/** Definition of the movie entity. */\nexport type MovieLicensesArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<MovieLicenseCondition>;\n  filter?: InputMaybe<MovieLicenseFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<MovieLicensesOrderBy>>;\n};\n\n\n/** Definition of the movie entity. */\nexport type MovieVideosArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<MovieVideoCondition>;\n  filter?: InputMaybe<MovieVideoFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<MovieVideosOrderBy>>;\n};\n\n/** A condition to be used against `Movie` object types. All fields are tested for equality and combined with a logical ‘and.’ */\nexport type MovieCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `title` field. */\n  title?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `Movie` object types. All fields are combined with a logical ‘and.’ */\nexport type MovieFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<MovieFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<StringFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<MovieFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<MovieFilter>>;\n  /** Filter by the object’s `title` field. */\n  title?: InputMaybe<StringFilter>;\n};\n\n/** Definition of the movie genre entity. */\nexport type MovieGenre = {\n  __typename?: 'MovieGenre';\n  id: Scalars['String']['output'];\n  /** Global ordering number for the genre. */\n  orderNo?: Maybe<Scalars['Int']['output']>;\n  /** Title of the genre. */\n  title?: Maybe<Scalars['String']['output']>;\n};\n\n/**\n * A condition to be used against `MovieGenre` object types. All fields are tested\n * for equality and combined with a logical ‘and.’\n */\nexport type MovieGenreCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `orderNo` field. */\n  orderNo?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `title` field. */\n  title?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `MovieGenre` object types. All fields are combined with a logical ‘and.’ */\nexport type MovieGenreFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<MovieGenreFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<StringFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<MovieGenreFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<MovieGenreFilter>>;\n  /** Filter by the object’s `orderNo` field. */\n  orderNo?: InputMaybe<IntFilter>;\n  /** Filter by the object’s `title` field. */\n  title?: InputMaybe<StringFilter>;\n};\n\n/** A connection to a list of `MovieGenre` values. */\nexport type MovieGenresConnection = {\n  __typename?: 'MovieGenresConnection';\n  /** A list of edges which contains the `MovieGenre` and cursor to aid in pagination. */\n  edges: Array<MovieGenresEdge>;\n  /** A list of `MovieGenre` objects. */\n  nodes: Array<MovieGenre>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `MovieGenre` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `MovieGenre` edge in the connection. */\nexport type MovieGenresEdge = {\n  __typename?: 'MovieGenresEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `MovieGenre` at the end of the edge. */\n  node: MovieGenre;\n};\n\n/** Methods to use when ordering `MovieGenre`. */\nexport enum MovieGenresOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  OrderNoAsc = 'ORDER_NO_ASC',\n  OrderNoDesc = 'ORDER_NO_DESC',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  TitleAsc = 'TITLE_ASC',\n  TitleDesc = 'TITLE_DESC'\n}\n\nexport type MovieGenresRelation = {\n  __typename?: 'MovieGenresRelation';\n  id: Scalars['Int']['output'];\n  /** Reads a single `Movie` that is related to this `MovieGenresRelation`. */\n  movie?: Maybe<Movie>;\n  /** Reads a single `MovieGenre` that is related to this `MovieGenresRelation`. */\n  movieGenre?: Maybe<MovieGenre>;\n  movieGenreId?: Maybe<Scalars['String']['output']>;\n  movieId?: Maybe<Scalars['String']['output']>;\n  orderNo: Scalars['Int']['output'];\n};\n\n/**\n * A condition to be used against `MovieGenresRelation` object types. All fields\n * are tested for equality and combined with a logical ‘and.’\n */\nexport type MovieGenresRelationCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `movieGenreId` field. */\n  movieGenreId?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `movieId` field. */\n  movieId?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `orderNo` field. */\n  orderNo?: InputMaybe<Scalars['Int']['input']>;\n};\n\n/** A filter to be used against `MovieGenresRelation` object types. All fields are combined with a logical ‘and.’ */\nexport type MovieGenresRelationFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<MovieGenresRelationFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Filter by the object’s `movieGenreId` field. */\n  movieGenreId?: InputMaybe<StringFilter>;\n  /** Filter by the object’s `movieId` field. */\n  movieId?: InputMaybe<StringFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<MovieGenresRelationFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<MovieGenresRelationFilter>>;\n  /** Filter by the object’s `orderNo` field. */\n  orderNo?: InputMaybe<IntFilter>;\n};\n\n/** A connection to a list of `MovieGenresRelation` values. */\nexport type MovieGenresRelationsConnection = {\n  __typename?: 'MovieGenresRelationsConnection';\n  /** A list of edges which contains the `MovieGenresRelation` and cursor to aid in pagination. */\n  edges: Array<MovieGenresRelationsEdge>;\n  /** A list of `MovieGenresRelation` objects. */\n  nodes: Array<MovieGenresRelation>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `MovieGenresRelation` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `MovieGenresRelation` edge in the connection. */\nexport type MovieGenresRelationsEdge = {\n  __typename?: 'MovieGenresRelationsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `MovieGenresRelation` at the end of the edge. */\n  node: MovieGenresRelation;\n};\n\n/** Methods to use when ordering `MovieGenresRelation`. */\nexport enum MovieGenresRelationsOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  MovieGenreIdAsc = 'MOVIE_GENRE_ID_ASC',\n  MovieGenreIdDesc = 'MOVIE_GENRE_ID_DESC',\n  MovieIdAsc = 'MOVIE_ID_ASC',\n  MovieIdDesc = 'MOVIE_ID_DESC',\n  Natural = 'NATURAL',\n  OrderNoAsc = 'ORDER_NO_ASC',\n  OrderNoDesc = 'ORDER_NO_DESC',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC'\n}\n\n/** Asset image metadata. */\nexport type MovieImage = {\n  __typename?: 'MovieImage';\n  altText?: Maybe<Scalars['String']['output']>;\n  /** Height of the image in pixels. */\n  height?: Maybe<Scalars['Int']['output']>;\n  id: Scalars['Int']['output'];\n  /** Reads a single `Movie` that is related to this `MovieImage`. */\n  movie?: Maybe<Movie>;\n  movieId?: Maybe<Scalars['String']['output']>;\n  /** URI to the image file. */\n  path?: Maybe<Scalars['String']['output']>;\n  /** Type of the image. */\n  type?: Maybe<Scalars['String']['output']>;\n  /** Width of the image in pixels. */\n  width?: Maybe<Scalars['Int']['output']>;\n};\n\n/**\n * A condition to be used against `MovieImage` object types. All fields are tested\n * for equality and combined with a logical ‘and.’\n */\nexport type MovieImageCondition = {\n  /** Checks for equality with the object’s `altText` field. */\n  altText?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `movieId` field. */\n  movieId?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `MovieImage` object types. All fields are combined with a logical ‘and.’ */\nexport type MovieImageFilter = {\n  /** Filter by the object’s `altText` field. */\n  altText?: InputMaybe<StringFilter>;\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<MovieImageFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Filter by the object’s `movieId` field. */\n  movieId?: InputMaybe<StringFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<MovieImageFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<MovieImageFilter>>;\n};\n\n/** A connection to a list of `MovieImage` values. */\nexport type MovieImagesConnection = {\n  __typename?: 'MovieImagesConnection';\n  /** A list of edges which contains the `MovieImage` and cursor to aid in pagination. */\n  edges: Array<MovieImagesEdge>;\n  /** A list of `MovieImage` objects. */\n  nodes: Array<MovieImage>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `MovieImage` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `MovieImage` edge in the connection. */\nexport type MovieImagesEdge = {\n  __typename?: 'MovieImagesEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `MovieImage` at the end of the edge. */\n  node: MovieImage;\n};\n\n/** Methods to use when ordering `MovieImage`. */\nexport enum MovieImagesOrderBy {\n  AltTextAsc = 'ALT_TEXT_ASC',\n  AltTextDesc = 'ALT_TEXT_DESC',\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  MovieIdAsc = 'MOVIE_ID_ASC',\n  MovieIdDesc = 'MOVIE_ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC'\n}\n\n/** Content metadata license that defines the content availability regions and time frame. */\nexport type MovieLicense = {\n  __typename?: 'MovieLicense';\n  /** Array of countries where the license applies. */\n  countries?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Time when license becomes invalid. */\n  endTime?: Maybe<Scalars['Datetime']['output']>;\n  id: Scalars['Int']['output'];\n  /** Reads a single `Movie` that is related to this `MovieLicense`. */\n  movie?: Maybe<Movie>;\n  movieId?: Maybe<Scalars['String']['output']>;\n  /** Time when license becomes valid. */\n  startTime?: Maybe<Scalars['Datetime']['output']>;\n};\n\n/**\n * A condition to be used against `MovieLicense` object types. All fields are\n * tested for equality and combined with a logical ‘and.’\n */\nexport type MovieLicenseCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `movieId` field. */\n  movieId?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `MovieLicense` object types. All fields are combined with a logical ‘and.’ */\nexport type MovieLicenseFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<MovieLicenseFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Filter by the object’s `movieId` field. */\n  movieId?: InputMaybe<StringFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<MovieLicenseFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<MovieLicenseFilter>>;\n};\n\n/** A connection to a list of `MovieLicense` values. */\nexport type MovieLicensesConnection = {\n  __typename?: 'MovieLicensesConnection';\n  /** A list of edges which contains the `MovieLicense` and cursor to aid in pagination. */\n  edges: Array<MovieLicensesEdge>;\n  /** A list of `MovieLicense` objects. */\n  nodes: Array<MovieLicense>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `MovieLicense` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `MovieLicense` edge in the connection. */\nexport type MovieLicensesEdge = {\n  __typename?: 'MovieLicensesEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `MovieLicense` at the end of the edge. */\n  node: MovieLicense;\n};\n\n/** Methods to use when ordering `MovieLicense`. */\nexport enum MovieLicensesOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  MovieIdAsc = 'MOVIE_ID_ASC',\n  MovieIdDesc = 'MOVIE_ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC'\n}\n\n/** Video stream metadata. */\nexport type MovieVideo = {\n  __typename?: 'MovieVideo';\n  /** Array of audio languages available in the stream. */\n  audioLanguages?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Array of caption languages available in the stream. */\n  captionLanguages?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Reads and enables pagination through a set of `MovieVideoCuePoint`. */\n  cuePoints: MovieVideoCuePointsConnection;\n  /** URI to a DASH manifest. */\n  dashManifest?: Maybe<Scalars['String']['output']>;\n  /** URI to an HLS manifest. */\n  hlsManifest?: Maybe<Scalars['String']['output']>;\n  id: Scalars['Int']['output'];\n  /** Indicates whether a stream is protected with DRM. */\n  isProtected?: Maybe<Scalars['Boolean']['output']>;\n  /** Length of the stream in seconds. */\n  lengthInSeconds?: Maybe<Scalars['Float']['output']>;\n  /** Reads a single `Movie` that is related to this `MovieVideo`. */\n  movie?: Maybe<Movie>;\n  movieId?: Maybe<Scalars['String']['output']>;\n  /** Output format of the stream. */\n  outputFormat?: Maybe<Scalars['String']['output']>;\n  /** Array of subtitle languages available in the stream. */\n  subtitleLanguages?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Title of the video stream */\n  title?: Maybe<Scalars['String']['output']>;\n  /** Type of the video stream. */\n  type?: Maybe<Scalars['String']['output']>;\n  /** Reads and enables pagination through a set of `MovieVideoStream`. */\n  videoStreams: MovieVideoStreamsConnection;\n};\n\n\n/** Video stream metadata. */\nexport type MovieVideoCuePointsArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<MovieVideoCuePointCondition>;\n  filter?: InputMaybe<MovieVideoCuePointFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<MovieVideoCuePointsOrderBy>>;\n};\n\n\n/** Video stream metadata. */\nexport type MovieVideoVideoStreamsArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<MovieVideoStreamCondition>;\n  filter?: InputMaybe<MovieVideoStreamFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<MovieVideoStreamsOrderBy>>;\n};\n\n/**\n * A condition to be used against `MovieVideo` object types. All fields are tested\n * for equality and combined with a logical ‘and.’\n */\nexport type MovieVideoCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `movieId` field. */\n  movieId?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `type` field. */\n  type?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** Video cue point metadata */\nexport type MovieVideoCuePoint = {\n  __typename?: 'MovieVideoCuePoint';\n  /** Type of the cue point */\n  cuePointTypeKey: Scalars['String']['output'];\n  id: Scalars['Int']['output'];\n  /** Time in seconds at which the cue point is set within the video */\n  timeInSeconds: Scalars['Float']['output'];\n  /** Additional information associated with the cue point */\n  value?: Maybe<Scalars['String']['output']>;\n  /** Reads a single `MovieVideo` that is related to this `MovieVideoCuePoint`. */\n  video?: Maybe<MovieVideo>;\n  videoId?: Maybe<Scalars['Int']['output']>;\n};\n\n/**\n * A condition to be used against `MovieVideoCuePoint` object types. All fields are\n * tested for equality and combined with a logical ‘and.’\n */\nexport type MovieVideoCuePointCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `videoId` field. */\n  videoId?: InputMaybe<Scalars['Int']['input']>;\n};\n\n/** A filter to be used against `MovieVideoCuePoint` object types. All fields are combined with a logical ‘and.’ */\nexport type MovieVideoCuePointFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<MovieVideoCuePointFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<MovieVideoCuePointFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<MovieVideoCuePointFilter>>;\n  /** Filter by the object’s `videoId` field. */\n  videoId?: InputMaybe<IntFilter>;\n};\n\n/** A connection to a list of `MovieVideoCuePoint` values. */\nexport type MovieVideoCuePointsConnection = {\n  __typename?: 'MovieVideoCuePointsConnection';\n  /** A list of edges which contains the `MovieVideoCuePoint` and cursor to aid in pagination. */\n  edges: Array<MovieVideoCuePointsEdge>;\n  /** A list of `MovieVideoCuePoint` objects. */\n  nodes: Array<MovieVideoCuePoint>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `MovieVideoCuePoint` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `MovieVideoCuePoint` edge in the connection. */\nexport type MovieVideoCuePointsEdge = {\n  __typename?: 'MovieVideoCuePointsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `MovieVideoCuePoint` at the end of the edge. */\n  node: MovieVideoCuePoint;\n};\n\n/** Methods to use when ordering `MovieVideoCuePoint`. */\nexport enum MovieVideoCuePointsOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  VideoIdAsc = 'VIDEO_ID_ASC',\n  VideoIdDesc = 'VIDEO_ID_DESC'\n}\n\n/** A filter to be used against `MovieVideo` object types. All fields are combined with a logical ‘and.’ */\nexport type MovieVideoFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<MovieVideoFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Filter by the object’s `movieId` field. */\n  movieId?: InputMaybe<StringFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<MovieVideoFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<MovieVideoFilter>>;\n  /** Filter by the object’s `type` field. */\n  type?: InputMaybe<StringFilter>;\n};\n\n/** Video stream DRM metadata */\nexport type MovieVideoStream = {\n  __typename?: 'MovieVideoStream';\n  /** Bitrate in kilobits per second */\n  bitrateInKbps?: Maybe<Scalars['Int']['output']>;\n  /** Codecs */\n  codecs?: Maybe<Scalars['String']['output']>;\n  /** Display aspect ratio for video streams */\n  displayAspectRatio?: Maybe<Scalars['String']['output']>;\n  /** File path to the initialization segment */\n  file?: Maybe<Scalars['String']['output']>;\n  /** File Template */\n  fileTemplate?: Maybe<Scalars['String']['output']>;\n  /** Packaging format of the stream */\n  format?: Maybe<Scalars['String']['output']>;\n  /** Frame rate of the video stream */\n  frameRate?: Maybe<Scalars['Float']['output']>;\n  /** Height of the video stream */\n  height?: Maybe<Scalars['Int']['output']>;\n  id: Scalars['Int']['output'];\n  /** Initialization Vector of the stream */\n  iv?: Maybe<Scalars['String']['output']>;\n  /** DRM Key ID */\n  keyId?: Maybe<Scalars['String']['output']>;\n  /** Label indicating the type of stream (audio/video) */\n  label?: Maybe<Scalars['String']['output']>;\n  /** The language code for audio streams */\n  languageCode?: Maybe<Scalars['String']['output']>;\n  /** Language name for audio, subtitle, or caption streams */\n  languageName?: Maybe<Scalars['String']['output']>;\n  /** Pixel aspect ratio for video streams */\n  pixelAspectRatio?: Maybe<Scalars['String']['output']>;\n  /** Sampling rate for audio streams */\n  samplingRate?: Maybe<Scalars['Int']['output']>;\n  /** Stream type */\n  type?: Maybe<VideoStreamType>;\n  /** Reads a single `MovieVideo` that is related to this `MovieVideoStream`. */\n  video?: Maybe<MovieVideo>;\n  videoId?: Maybe<Scalars['Int']['output']>;\n  /** Width of the video stream */\n  width?: Maybe<Scalars['Int']['output']>;\n};\n\n/**\n * A condition to be used against `MovieVideoStream` object types. All fields are\n * tested for equality and combined with a logical ‘and.’\n */\nexport type MovieVideoStreamCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `type` field. */\n  type?: InputMaybe<VideoStreamType>;\n  /** Checks for equality with the object’s `videoId` field. */\n  videoId?: InputMaybe<Scalars['Int']['input']>;\n};\n\n/** A filter to be used against `MovieVideoStream` object types. All fields are combined with a logical ‘and.’ */\nexport type MovieVideoStreamFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<MovieVideoStreamFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<MovieVideoStreamFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<MovieVideoStreamFilter>>;\n  /** Filter by the object’s `type` field. */\n  type?: InputMaybe<VideoStreamTypeFilter>;\n  /** Filter by the object’s `videoId` field. */\n  videoId?: InputMaybe<IntFilter>;\n};\n\n/** A connection to a list of `MovieVideoStream` values. */\nexport type MovieVideoStreamsConnection = {\n  __typename?: 'MovieVideoStreamsConnection';\n  /** A list of edges which contains the `MovieVideoStream` and cursor to aid in pagination. */\n  edges: Array<MovieVideoStreamsEdge>;\n  /** A list of `MovieVideoStream` objects. */\n  nodes: Array<MovieVideoStream>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `MovieVideoStream` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `MovieVideoStream` edge in the connection. */\nexport type MovieVideoStreamsEdge = {\n  __typename?: 'MovieVideoStreamsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `MovieVideoStream` at the end of the edge. */\n  node: MovieVideoStream;\n};\n\n/** Methods to use when ordering `MovieVideoStream`. */\nexport enum MovieVideoStreamsOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  TypeAsc = 'TYPE_ASC',\n  TypeDesc = 'TYPE_DESC',\n  VideoIdAsc = 'VIDEO_ID_ASC',\n  VideoIdDesc = 'VIDEO_ID_DESC'\n}\n\n/** A connection to a list of `MovieVideo` values. */\nexport type MovieVideosConnection = {\n  __typename?: 'MovieVideosConnection';\n  /** A list of edges which contains the `MovieVideo` and cursor to aid in pagination. */\n  edges: Array<MovieVideosEdge>;\n  /** A list of `MovieVideo` objects. */\n  nodes: Array<MovieVideo>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `MovieVideo` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `MovieVideo` edge in the connection. */\nexport type MovieVideosEdge = {\n  __typename?: 'MovieVideosEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `MovieVideo` at the end of the edge. */\n  node: MovieVideo;\n};\n\n/** Methods to use when ordering `MovieVideo`. */\nexport enum MovieVideosOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  MovieIdAsc = 'MOVIE_ID_ASC',\n  MovieIdDesc = 'MOVIE_ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  TypeAsc = 'TYPE_ASC',\n  TypeDesc = 'TYPE_DESC'\n}\n\n/** A connection to a list of `Movie` values. */\nexport type MoviesConnection = {\n  __typename?: 'MoviesConnection';\n  /** A list of edges which contains the `Movie` and cursor to aid in pagination. */\n  edges: Array<MoviesEdge>;\n  /** A list of `Movie` objects. */\n  nodes: Array<Movie>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `Movie` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `Movie` edge in the connection. */\nexport type MoviesEdge = {\n  __typename?: 'MoviesEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `Movie` at the end of the edge. */\n  node: Movie;\n};\n\n/** Methods to use when ordering `Movie`. */\nexport enum MoviesOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  TitleAsc = 'TITLE_ASC',\n  TitleDesc = 'TITLE_DESC'\n}\n\n/** Information about pagination in a connection. */\nexport type PageInfo = {\n  __typename?: 'PageInfo';\n  /** When paginating forwards, the cursor to continue. */\n  endCursor?: Maybe<Scalars['Cursor']['output']>;\n  /** When paginating forwards, are there more items? */\n  hasNextPage: Scalars['Boolean']['output'];\n  /** When paginating backwards, are there more items? */\n  hasPreviousPage: Scalars['Boolean']['output'];\n  /** When paginating backwards, the cursor to continue. */\n  startCursor?: Maybe<Scalars['Cursor']['output']>;\n};\n\n/** Definition of the playlist entity. */\nexport type Playlist = {\n  __typename?: 'Playlist';\n  /** Reads a single `Channel` that is related to this `Playlist`. */\n  channel?: Maybe<Channel>;\n  /** The channel ID. */\n  channelId?: Maybe<Scalars['String']['output']>;\n  /** End date of the playlist. */\n  endDateTime: Scalars['Datetime']['output'];\n  id: Scalars['String']['output'];\n  /** Reads and enables pagination through a set of `Program`. */\n  programs: ProgramsConnection;\n  /** Start date of the playlist. */\n  startDateTime: Scalars['Datetime']['output'];\n};\n\n\n/** Definition of the playlist entity. */\nexport type PlaylistProgramsArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<ProgramCondition>;\n  filter?: InputMaybe<ProgramFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<ProgramsOrderBy>>;\n};\n\n/**\n * A condition to be used against `Playlist` object types. All fields are tested\n * for equality and combined with a logical ‘and.’\n */\nexport type PlaylistCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `Playlist` object types. All fields are combined with a logical ‘and.’ */\nexport type PlaylistFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<PlaylistFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<StringFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<PlaylistFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<PlaylistFilter>>;\n};\n\n/** A connection to a list of `Playlist` values. */\nexport type PlaylistsConnection = {\n  __typename?: 'PlaylistsConnection';\n  /** A list of edges which contains the `Playlist` and cursor to aid in pagination. */\n  edges: Array<PlaylistsEdge>;\n  /** A list of `Playlist` objects. */\n  nodes: Array<Playlist>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `Playlist` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `Playlist` edge in the connection. */\nexport type PlaylistsEdge = {\n  __typename?: 'PlaylistsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `Playlist` at the end of the edge. */\n  node: Playlist;\n};\n\n/** Methods to use when ordering `Playlist`. */\nexport enum PlaylistsOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  StartDateTimeAsc = 'START_DATE_TIME_ASC',\n  StartDateTimeDesc = 'START_DATE_TIME_DESC'\n}\n\n/** Definition of the program object. */\nexport type Program = {\n  __typename?: 'Program';\n  /** Reads a single `Episode` that is related to this `Program`. */\n  episode?: Maybe<Episode>;\n  /** The episode ID. */\n  episodeId?: Maybe<Scalars['String']['output']>;\n  id: Scalars['Int']['output'];\n  /** Reads and enables pagination through a set of `ProgramImage`. */\n  images: ProgramImagesConnection;\n  /** Reads a single `Movie` that is related to this `Program`. */\n  movie?: Maybe<Movie>;\n  /** The movie ID. */\n  movieId?: Maybe<Scalars['String']['output']>;\n  /** Reads a single `Playlist` that is related to this `Program`. */\n  playlist?: Maybe<Playlist>;\n  playlistId?: Maybe<Scalars['String']['output']>;\n  /** The sort index of the program. */\n  sortIndex?: Maybe<Scalars['Int']['output']>;\n  /** Title of the program. */\n  title?: Maybe<Scalars['String']['output']>;\n};\n\n\n/** Definition of the program object. */\nexport type ProgramImagesArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<ProgramImageCondition>;\n  filter?: InputMaybe<ProgramImageFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<ProgramImagesOrderBy>>;\n};\n\n/** A condition to be used against `Program` object types. All fields are tested for equality and combined with a logical ‘and.’ */\nexport type ProgramCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `playlistId` field. */\n  playlistId?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `title` field. */\n  title?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `Program` object types. All fields are combined with a logical ‘and.’ */\nexport type ProgramFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<ProgramFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<ProgramFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<ProgramFilter>>;\n  /** Filter by the object’s `playlistId` field. */\n  playlistId?: InputMaybe<StringFilter>;\n  /** Filter by the object’s `title` field. */\n  title?: InputMaybe<StringFilter>;\n};\n\n/** Asset image metadata. */\nexport type ProgramImage = {\n  __typename?: 'ProgramImage';\n  altText?: Maybe<Scalars['String']['output']>;\n  /** Height of the image in pixels. */\n  height?: Maybe<Scalars['Int']['output']>;\n  id: Scalars['Int']['output'];\n  /** URI to the image file. */\n  path?: Maybe<Scalars['String']['output']>;\n  /** Reads a single `Program` that is related to this `ProgramImage`. */\n  program?: Maybe<Program>;\n  programId?: Maybe<Scalars['Int']['output']>;\n  /** Type of the image. */\n  type?: Maybe<Scalars['String']['output']>;\n  /** Width of the image in pixels. */\n  width?: Maybe<Scalars['Int']['output']>;\n};\n\n/**\n * A condition to be used against `ProgramImage` object types. All fields are\n * tested for equality and combined with a logical ‘and.’\n */\nexport type ProgramImageCondition = {\n  /** Checks for equality with the object’s `altText` field. */\n  altText?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `programId` field. */\n  programId?: InputMaybe<Scalars['Int']['input']>;\n};\n\n/** A filter to be used against `ProgramImage` object types. All fields are combined with a logical ‘and.’ */\nexport type ProgramImageFilter = {\n  /** Filter by the object’s `altText` field. */\n  altText?: InputMaybe<StringFilter>;\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<ProgramImageFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<ProgramImageFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<ProgramImageFilter>>;\n  /** Filter by the object’s `programId` field. */\n  programId?: InputMaybe<IntFilter>;\n};\n\n/** A connection to a list of `ProgramImage` values. */\nexport type ProgramImagesConnection = {\n  __typename?: 'ProgramImagesConnection';\n  /** A list of edges which contains the `ProgramImage` and cursor to aid in pagination. */\n  edges: Array<ProgramImagesEdge>;\n  /** A list of `ProgramImage` objects. */\n  nodes: Array<ProgramImage>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `ProgramImage` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `ProgramImage` edge in the connection. */\nexport type ProgramImagesEdge = {\n  __typename?: 'ProgramImagesEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `ProgramImage` at the end of the edge. */\n  node: ProgramImage;\n};\n\n/** Methods to use when ordering `ProgramImage`. */\nexport enum ProgramImagesOrderBy {\n  AltTextAsc = 'ALT_TEXT_ASC',\n  AltTextDesc = 'ALT_TEXT_DESC',\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  ProgramIdAsc = 'PROGRAM_ID_ASC',\n  ProgramIdDesc = 'PROGRAM_ID_DESC'\n}\n\n/** A connection to a list of `Program` values. */\nexport type ProgramsConnection = {\n  __typename?: 'ProgramsConnection';\n  /** A list of edges which contains the `Program` and cursor to aid in pagination. */\n  edges: Array<ProgramsEdge>;\n  /** A list of `Program` objects. */\n  nodes: Array<Program>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `Program` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `Program` edge in the connection. */\nexport type ProgramsEdge = {\n  __typename?: 'ProgramsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `Program` at the end of the edge. */\n  node: Program;\n};\n\n/** Methods to use when ordering `Program`. */\nexport enum ProgramsOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PlaylistIdAsc = 'PLAYLIST_ID_ASC',\n  PlaylistIdDesc = 'PLAYLIST_ID_DESC',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  SortIndexAsc = 'SORT_INDEX_ASC',\n  SortIndexDesc = 'SORT_INDEX_DESC',\n  TitleAsc = 'TITLE_ASC',\n  TitleDesc = 'TITLE_DESC'\n}\n\n/** The root query type which gives access points into the data universe. */\nexport type Query = {\n  __typename?: 'Query';\n  channel?: Maybe<Channel>;\n  /** Reads and enables pagination through a set of `Channel`. */\n  channels?: Maybe<ChannelsConnection>;\n  collection?: Maybe<Collection>;\n  /** Reads and enables pagination through a set of `Collection`. */\n  collections?: Maybe<CollectionsConnection>;\n  episode?: Maybe<Episode>;\n  /** Reads and enables pagination through a set of `Episode`. */\n  episodes?: Maybe<EpisodesConnection>;\n  locale?: Maybe<Locale>;\n  /** Reads and enables pagination through a set of `Locale`. */\n  locales?: Maybe<LocalesConnection>;\n  movie?: Maybe<Movie>;\n  movieGenre?: Maybe<MovieGenre>;\n  /** Reads and enables pagination through a set of `MovieGenre`. */\n  movieGenres?: Maybe<MovieGenresConnection>;\n  /** Reads and enables pagination through a set of `Movie`. */\n  movies?: Maybe<MoviesConnection>;\n  playlist?: Maybe<Playlist>;\n  /** Reads and enables pagination through a set of `Playlist`. */\n  playlists?: Maybe<PlaylistsConnection>;\n  /**\n   * Exposes the root query type nested one level down. This is helpful for Relay 1\n   * which can only query top level fields if they are in a particular form.\n   */\n  query: Query;\n  season?: Maybe<Season>;\n  /** Reads and enables pagination through a set of `Season`. */\n  seasons?: Maybe<SeasonsConnection>;\n  tvshow?: Maybe<Tvshow>;\n  tvshowGenre?: Maybe<TvshowGenre>;\n  /** Reads and enables pagination through a set of `TvshowGenre`. */\n  tvshowGenres?: Maybe<TvshowGenresConnection>;\n  /** Reads and enables pagination through a set of `Tvshow`. */\n  tvshows?: Maybe<TvshowsConnection>;\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QueryChannelArgs = {\n  id: Scalars['String']['input'];\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QueryChannelsArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<ChannelCondition>;\n  filter?: InputMaybe<ChannelFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<ChannelsOrderBy>>;\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QueryCollectionArgs = {\n  id: Scalars['String']['input'];\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QueryCollectionsArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<CollectionCondition>;\n  filter?: InputMaybe<CollectionFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<CollectionsOrderBy>>;\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QueryEpisodeArgs = {\n  countryCode?: InputMaybe<Scalars['String']['input']>;\n  id: Scalars['String']['input'];\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QueryEpisodesArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<EpisodeCondition>;\n  filter?: InputMaybe<EpisodeFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<EpisodesOrderBy>>;\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QueryLocaleArgs = {\n  locale: Scalars['String']['input'];\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QueryLocalesArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<LocaleCondition>;\n  filter?: InputMaybe<LocaleFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<LocalesOrderBy>>;\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QueryMovieArgs = {\n  countryCode?: InputMaybe<Scalars['String']['input']>;\n  id: Scalars['String']['input'];\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QueryMovieGenreArgs = {\n  id: Scalars['String']['input'];\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QueryMovieGenresArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<MovieGenreCondition>;\n  filter?: InputMaybe<MovieGenreFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<MovieGenresOrderBy>>;\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QueryMoviesArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<MovieCondition>;\n  filter?: InputMaybe<MovieFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<MoviesOrderBy>>;\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QueryPlaylistArgs = {\n  id: Scalars['String']['input'];\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QueryPlaylistsArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<PlaylistCondition>;\n  filter?: InputMaybe<PlaylistFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<PlaylistsOrderBy>>;\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QuerySeasonArgs = {\n  id: Scalars['String']['input'];\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QuerySeasonsArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<SeasonCondition>;\n  filter?: InputMaybe<SeasonFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<SeasonsOrderBy>>;\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QueryTvshowArgs = {\n  id: Scalars['String']['input'];\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QueryTvshowGenreArgs = {\n  id: Scalars['String']['input'];\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QueryTvshowGenresArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<TvshowGenreCondition>;\n  filter?: InputMaybe<TvshowGenreFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<TvshowGenresOrderBy>>;\n};\n\n\n/** The root query type which gives access points into the data universe. */\nexport type QueryTvshowsArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<TvshowCondition>;\n  filter?: InputMaybe<TvshowFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<TvshowsOrderBy>>;\n};\n\n/** Definition of the TV show season entity. */\nexport type Season = {\n  __typename?: 'Season';\n  /** Cast of the season. */\n  cast?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Extended synopsis. */\n  description?: Maybe<Scalars['String']['output']>;\n  /** Reads and enables pagination through a set of `Episode`. */\n  episodes: EpisodesConnection;\n  /** Reads and enables pagination through a set of `SeasonGenresRelation`. */\n  genres: SeasonGenresRelationsConnection;\n  id: Scalars['String']['output'];\n  /** Reads and enables pagination through a set of `SeasonImage`. */\n  images: SeasonImagesConnection;\n  /** Season number */\n  index?: Maybe<Scalars['Int']['output']>;\n  /** Reads and enables pagination through a set of `SeasonLicense`. */\n  licenses: SeasonLicensesConnection;\n  /** Array of production countries */\n  productionCountries?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Date of first release. */\n  released?: Maybe<Scalars['Datetime']['output']>;\n  /** Name of the producing studio. */\n  studio?: Maybe<Scalars['String']['output']>;\n  /** Short description of the main plot elements. */\n  synopsis?: Maybe<Scalars['String']['output']>;\n  /** Array of tags associated with the content. */\n  tags?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Reads a single `Tvshow` that is related to this `Season`. */\n  tvshow?: Maybe<Tvshow>;\n  tvshowId?: Maybe<Scalars['String']['output']>;\n  /** Reads and enables pagination through a set of `SeasonVideo`. */\n  videos: SeasonVideosConnection;\n};\n\n\n/** Definition of the TV show season entity. */\nexport type SeasonEpisodesArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<EpisodeCondition>;\n  filter?: InputMaybe<EpisodeFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<EpisodesOrderBy>>;\n};\n\n\n/** Definition of the TV show season entity. */\nexport type SeasonGenresArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<SeasonGenresRelationCondition>;\n  filter?: InputMaybe<SeasonGenresRelationFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<SeasonGenresRelationsOrderBy>>;\n};\n\n\n/** Definition of the TV show season entity. */\nexport type SeasonImagesArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<SeasonImageCondition>;\n  filter?: InputMaybe<SeasonImageFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<SeasonImagesOrderBy>>;\n};\n\n\n/** Definition of the TV show season entity. */\nexport type SeasonLicensesArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<SeasonLicenseCondition>;\n  filter?: InputMaybe<SeasonLicenseFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<SeasonLicensesOrderBy>>;\n};\n\n\n/** Definition of the TV show season entity. */\nexport type SeasonVideosArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<SeasonVideoCondition>;\n  filter?: InputMaybe<SeasonVideoFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<SeasonVideosOrderBy>>;\n};\n\n/** A condition to be used against `Season` object types. All fields are tested for equality and combined with a logical ‘and.’ */\nexport type SeasonCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `tvshowId` field. */\n  tvshowId?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `Season` object types. All fields are combined with a logical ‘and.’ */\nexport type SeasonFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<SeasonFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<StringFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<SeasonFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<SeasonFilter>>;\n  /** Filter by the object’s `tvshowId` field. */\n  tvshowId?: InputMaybe<StringFilter>;\n};\n\nexport type SeasonGenresRelation = {\n  __typename?: 'SeasonGenresRelation';\n  id: Scalars['Int']['output'];\n  orderNo: Scalars['Int']['output'];\n  /** Reads a single `Season` that is related to this `SeasonGenresRelation`. */\n  season?: Maybe<Season>;\n  seasonId?: Maybe<Scalars['String']['output']>;\n  /** Reads a single `TvshowGenre` that is related to this `SeasonGenresRelation`. */\n  tvshowGenre?: Maybe<TvshowGenre>;\n  tvshowGenreId?: Maybe<Scalars['String']['output']>;\n};\n\n/**\n * A condition to be used against `SeasonGenresRelation` object types. All fields\n * are tested for equality and combined with a logical ‘and.’\n */\nexport type SeasonGenresRelationCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `orderNo` field. */\n  orderNo?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `seasonId` field. */\n  seasonId?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `tvshowGenreId` field. */\n  tvshowGenreId?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `SeasonGenresRelation` object types. All fields are combined with a logical ‘and.’ */\nexport type SeasonGenresRelationFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<SeasonGenresRelationFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<SeasonGenresRelationFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<SeasonGenresRelationFilter>>;\n  /** Filter by the object’s `orderNo` field. */\n  orderNo?: InputMaybe<IntFilter>;\n  /** Filter by the object’s `seasonId` field. */\n  seasonId?: InputMaybe<StringFilter>;\n  /** Filter by the object’s `tvshowGenreId` field. */\n  tvshowGenreId?: InputMaybe<StringFilter>;\n};\n\n/** A connection to a list of `SeasonGenresRelation` values. */\nexport type SeasonGenresRelationsConnection = {\n  __typename?: 'SeasonGenresRelationsConnection';\n  /** A list of edges which contains the `SeasonGenresRelation` and cursor to aid in pagination. */\n  edges: Array<SeasonGenresRelationsEdge>;\n  /** A list of `SeasonGenresRelation` objects. */\n  nodes: Array<SeasonGenresRelation>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `SeasonGenresRelation` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `SeasonGenresRelation` edge in the connection. */\nexport type SeasonGenresRelationsEdge = {\n  __typename?: 'SeasonGenresRelationsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `SeasonGenresRelation` at the end of the edge. */\n  node: SeasonGenresRelation;\n};\n\n/** Methods to use when ordering `SeasonGenresRelation`. */\nexport enum SeasonGenresRelationsOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  OrderNoAsc = 'ORDER_NO_ASC',\n  OrderNoDesc = 'ORDER_NO_DESC',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  SeasonIdAsc = 'SEASON_ID_ASC',\n  SeasonIdDesc = 'SEASON_ID_DESC',\n  TvshowGenreIdAsc = 'TVSHOW_GENRE_ID_ASC',\n  TvshowGenreIdDesc = 'TVSHOW_GENRE_ID_DESC'\n}\n\n/** Asset image metadata. */\nexport type SeasonImage = {\n  __typename?: 'SeasonImage';\n  altText?: Maybe<Scalars['String']['output']>;\n  /** Height of the image in pixels. */\n  height?: Maybe<Scalars['Int']['output']>;\n  id: Scalars['Int']['output'];\n  /** URI to the image file. */\n  path?: Maybe<Scalars['String']['output']>;\n  /** Reads a single `Season` that is related to this `SeasonImage`. */\n  season?: Maybe<Season>;\n  seasonId?: Maybe<Scalars['String']['output']>;\n  /** Type of the image. */\n  type?: Maybe<Scalars['String']['output']>;\n  /** Width of the image in pixels. */\n  width?: Maybe<Scalars['Int']['output']>;\n};\n\n/**\n * A condition to be used against `SeasonImage` object types. All fields are tested\n * for equality and combined with a logical ‘and.’\n */\nexport type SeasonImageCondition = {\n  /** Checks for equality with the object’s `altText` field. */\n  altText?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `seasonId` field. */\n  seasonId?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `SeasonImage` object types. All fields are combined with a logical ‘and.’ */\nexport type SeasonImageFilter = {\n  /** Filter by the object’s `altText` field. */\n  altText?: InputMaybe<StringFilter>;\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<SeasonImageFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<SeasonImageFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<SeasonImageFilter>>;\n  /** Filter by the object’s `seasonId` field. */\n  seasonId?: InputMaybe<StringFilter>;\n};\n\n/** A connection to a list of `SeasonImage` values. */\nexport type SeasonImagesConnection = {\n  __typename?: 'SeasonImagesConnection';\n  /** A list of edges which contains the `SeasonImage` and cursor to aid in pagination. */\n  edges: Array<SeasonImagesEdge>;\n  /** A list of `SeasonImage` objects. */\n  nodes: Array<SeasonImage>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `SeasonImage` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `SeasonImage` edge in the connection. */\nexport type SeasonImagesEdge = {\n  __typename?: 'SeasonImagesEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `SeasonImage` at the end of the edge. */\n  node: SeasonImage;\n};\n\n/** Methods to use when ordering `SeasonImage`. */\nexport enum SeasonImagesOrderBy {\n  AltTextAsc = 'ALT_TEXT_ASC',\n  AltTextDesc = 'ALT_TEXT_DESC',\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  SeasonIdAsc = 'SEASON_ID_ASC',\n  SeasonIdDesc = 'SEASON_ID_DESC'\n}\n\n/** Content metadata license that defines the content availability regions and time frame. */\nexport type SeasonLicense = {\n  __typename?: 'SeasonLicense';\n  /** Array of countries where the license applies. */\n  countries?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Time when license becomes invalid. */\n  endTime?: Maybe<Scalars['Datetime']['output']>;\n  id: Scalars['Int']['output'];\n  /** Reads a single `Season` that is related to this `SeasonLicense`. */\n  season?: Maybe<Season>;\n  seasonId?: Maybe<Scalars['String']['output']>;\n  /** Time when license becomes valid. */\n  startTime?: Maybe<Scalars['Datetime']['output']>;\n};\n\n/**\n * A condition to be used against `SeasonLicense` object types. All fields are\n * tested for equality and combined with a logical ‘and.’\n */\nexport type SeasonLicenseCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `seasonId` field. */\n  seasonId?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `SeasonLicense` object types. All fields are combined with a logical ‘and.’ */\nexport type SeasonLicenseFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<SeasonLicenseFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<SeasonLicenseFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<SeasonLicenseFilter>>;\n  /** Filter by the object’s `seasonId` field. */\n  seasonId?: InputMaybe<StringFilter>;\n};\n\n/** A connection to a list of `SeasonLicense` values. */\nexport type SeasonLicensesConnection = {\n  __typename?: 'SeasonLicensesConnection';\n  /** A list of edges which contains the `SeasonLicense` and cursor to aid in pagination. */\n  edges: Array<SeasonLicensesEdge>;\n  /** A list of `SeasonLicense` objects. */\n  nodes: Array<SeasonLicense>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `SeasonLicense` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `SeasonLicense` edge in the connection. */\nexport type SeasonLicensesEdge = {\n  __typename?: 'SeasonLicensesEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `SeasonLicense` at the end of the edge. */\n  node: SeasonLicense;\n};\n\n/** Methods to use when ordering `SeasonLicense`. */\nexport enum SeasonLicensesOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  SeasonIdAsc = 'SEASON_ID_ASC',\n  SeasonIdDesc = 'SEASON_ID_DESC'\n}\n\n/** Video stream metadata. */\nexport type SeasonVideo = {\n  __typename?: 'SeasonVideo';\n  /** Array of audio languages available in the stream. */\n  audioLanguages?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Array of caption languages available in the stream. */\n  captionLanguages?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Reads and enables pagination through a set of `SeasonVideoCuePoint`. */\n  cuePoints: SeasonVideoCuePointsConnection;\n  /** URI to a DASH manifest. */\n  dashManifest?: Maybe<Scalars['String']['output']>;\n  /** URI to an HLS manifest. */\n  hlsManifest?: Maybe<Scalars['String']['output']>;\n  id: Scalars['Int']['output'];\n  /** Indicates whether a stream is protected with DRM. */\n  isProtected?: Maybe<Scalars['Boolean']['output']>;\n  /** Length of the stream in seconds. */\n  lengthInSeconds?: Maybe<Scalars['Float']['output']>;\n  /** Output format of the stream. */\n  outputFormat?: Maybe<Scalars['String']['output']>;\n  /** Reads a single `Season` that is related to this `SeasonVideo`. */\n  season?: Maybe<Season>;\n  seasonId?: Maybe<Scalars['String']['output']>;\n  /** Array of subtitle languages available in the stream. */\n  subtitleLanguages?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Title of the video stream */\n  title?: Maybe<Scalars['String']['output']>;\n  /** Type of the video stream. */\n  type?: Maybe<Scalars['String']['output']>;\n  /** Reads and enables pagination through a set of `SeasonVideoStream`. */\n  videoStreams: SeasonVideoStreamsConnection;\n};\n\n\n/** Video stream metadata. */\nexport type SeasonVideoCuePointsArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<SeasonVideoCuePointCondition>;\n  filter?: InputMaybe<SeasonVideoCuePointFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<SeasonVideoCuePointsOrderBy>>;\n};\n\n\n/** Video stream metadata. */\nexport type SeasonVideoVideoStreamsArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<SeasonVideoStreamCondition>;\n  filter?: InputMaybe<SeasonVideoStreamFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<SeasonVideoStreamsOrderBy>>;\n};\n\n/**\n * A condition to be used against `SeasonVideo` object types. All fields are tested\n * for equality and combined with a logical ‘and.’\n */\nexport type SeasonVideoCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `seasonId` field. */\n  seasonId?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** Video cue point metadata */\nexport type SeasonVideoCuePoint = {\n  __typename?: 'SeasonVideoCuePoint';\n  /** Type of the cue point */\n  cuePointTypeKey: Scalars['String']['output'];\n  id: Scalars['Int']['output'];\n  /** Time in seconds at which the cue point is set within the video */\n  timeInSeconds: Scalars['Float']['output'];\n  /** Additional information associated with the cue point */\n  value?: Maybe<Scalars['String']['output']>;\n  /** Reads a single `SeasonVideo` that is related to this `SeasonVideoCuePoint`. */\n  video?: Maybe<SeasonVideo>;\n  videoId?: Maybe<Scalars['Int']['output']>;\n};\n\n/**\n * A condition to be used against `SeasonVideoCuePoint` object types. All fields\n * are tested for equality and combined with a logical ‘and.’\n */\nexport type SeasonVideoCuePointCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `videoId` field. */\n  videoId?: InputMaybe<Scalars['Int']['input']>;\n};\n\n/** A filter to be used against `SeasonVideoCuePoint` object types. All fields are combined with a logical ‘and.’ */\nexport type SeasonVideoCuePointFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<SeasonVideoCuePointFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<SeasonVideoCuePointFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<SeasonVideoCuePointFilter>>;\n  /** Filter by the object’s `videoId` field. */\n  videoId?: InputMaybe<IntFilter>;\n};\n\n/** A connection to a list of `SeasonVideoCuePoint` values. */\nexport type SeasonVideoCuePointsConnection = {\n  __typename?: 'SeasonVideoCuePointsConnection';\n  /** A list of edges which contains the `SeasonVideoCuePoint` and cursor to aid in pagination. */\n  edges: Array<SeasonVideoCuePointsEdge>;\n  /** A list of `SeasonVideoCuePoint` objects. */\n  nodes: Array<SeasonVideoCuePoint>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `SeasonVideoCuePoint` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `SeasonVideoCuePoint` edge in the connection. */\nexport type SeasonVideoCuePointsEdge = {\n  __typename?: 'SeasonVideoCuePointsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `SeasonVideoCuePoint` at the end of the edge. */\n  node: SeasonVideoCuePoint;\n};\n\n/** Methods to use when ordering `SeasonVideoCuePoint`. */\nexport enum SeasonVideoCuePointsOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  VideoIdAsc = 'VIDEO_ID_ASC',\n  VideoIdDesc = 'VIDEO_ID_DESC'\n}\n\n/** A filter to be used against `SeasonVideo` object types. All fields are combined with a logical ‘and.’ */\nexport type SeasonVideoFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<SeasonVideoFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<SeasonVideoFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<SeasonVideoFilter>>;\n  /** Filter by the object’s `seasonId` field. */\n  seasonId?: InputMaybe<StringFilter>;\n};\n\n/** Video stream DRM metadata */\nexport type SeasonVideoStream = {\n  __typename?: 'SeasonVideoStream';\n  /** Bitrate in kilobits per second */\n  bitrateInKbps?: Maybe<Scalars['Int']['output']>;\n  /** Codecs */\n  codecs?: Maybe<Scalars['String']['output']>;\n  /** Display aspect ratio for video streams */\n  displayAspectRatio?: Maybe<Scalars['String']['output']>;\n  /** File path to the initialization segment */\n  file?: Maybe<Scalars['String']['output']>;\n  /** File Template */\n  fileTemplate?: Maybe<Scalars['String']['output']>;\n  /** Packaging format of the stream */\n  format?: Maybe<Scalars['String']['output']>;\n  /** Frame rate of the video stream */\n  frameRate?: Maybe<Scalars['Float']['output']>;\n  /** Height of the video stream */\n  height?: Maybe<Scalars['Int']['output']>;\n  id: Scalars['Int']['output'];\n  /** Initialization Vector of the stream */\n  iv?: Maybe<Scalars['String']['output']>;\n  /** DRM Key ID */\n  keyId?: Maybe<Scalars['String']['output']>;\n  /** Label indicating the type of stream (audio/video) */\n  label?: Maybe<Scalars['String']['output']>;\n  /** The language code for audio streams */\n  languageCode?: Maybe<Scalars['String']['output']>;\n  /** Language name for audio, subtitle, or caption streams */\n  languageName?: Maybe<Scalars['String']['output']>;\n  /** Pixel aspect ratio for video streams */\n  pixelAspectRatio?: Maybe<Scalars['String']['output']>;\n  /** Sampling rate for audio streams */\n  samplingRate?: Maybe<Scalars['Int']['output']>;\n  /** Stream type */\n  type?: Maybe<VideoStreamType>;\n  /** Reads a single `SeasonVideo` that is related to this `SeasonVideoStream`. */\n  video?: Maybe<SeasonVideo>;\n  videoId?: Maybe<Scalars['Int']['output']>;\n  /** Width of the video stream */\n  width?: Maybe<Scalars['Int']['output']>;\n};\n\n/**\n * A condition to be used against `SeasonVideoStream` object types. All fields are\n * tested for equality and combined with a logical ‘and.’\n */\nexport type SeasonVideoStreamCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `type` field. */\n  type?: InputMaybe<VideoStreamType>;\n  /** Checks for equality with the object’s `videoId` field. */\n  videoId?: InputMaybe<Scalars['Int']['input']>;\n};\n\n/** A filter to be used against `SeasonVideoStream` object types. All fields are combined with a logical ‘and.’ */\nexport type SeasonVideoStreamFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<SeasonVideoStreamFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<SeasonVideoStreamFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<SeasonVideoStreamFilter>>;\n  /** Filter by the object’s `type` field. */\n  type?: InputMaybe<VideoStreamTypeFilter>;\n  /** Filter by the object’s `videoId` field. */\n  videoId?: InputMaybe<IntFilter>;\n};\n\n/** A connection to a list of `SeasonVideoStream` values. */\nexport type SeasonVideoStreamsConnection = {\n  __typename?: 'SeasonVideoStreamsConnection';\n  /** A list of edges which contains the `SeasonVideoStream` and cursor to aid in pagination. */\n  edges: Array<SeasonVideoStreamsEdge>;\n  /** A list of `SeasonVideoStream` objects. */\n  nodes: Array<SeasonVideoStream>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `SeasonVideoStream` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `SeasonVideoStream` edge in the connection. */\nexport type SeasonVideoStreamsEdge = {\n  __typename?: 'SeasonVideoStreamsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `SeasonVideoStream` at the end of the edge. */\n  node: SeasonVideoStream;\n};\n\n/** Methods to use when ordering `SeasonVideoStream`. */\nexport enum SeasonVideoStreamsOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  TypeAsc = 'TYPE_ASC',\n  TypeDesc = 'TYPE_DESC',\n  VideoIdAsc = 'VIDEO_ID_ASC',\n  VideoIdDesc = 'VIDEO_ID_DESC'\n}\n\n/** A connection to a list of `SeasonVideo` values. */\nexport type SeasonVideosConnection = {\n  __typename?: 'SeasonVideosConnection';\n  /** A list of edges which contains the `SeasonVideo` and cursor to aid in pagination. */\n  edges: Array<SeasonVideosEdge>;\n  /** A list of `SeasonVideo` objects. */\n  nodes: Array<SeasonVideo>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `SeasonVideo` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `SeasonVideo` edge in the connection. */\nexport type SeasonVideosEdge = {\n  __typename?: 'SeasonVideosEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `SeasonVideo` at the end of the edge. */\n  node: SeasonVideo;\n};\n\n/** Methods to use when ordering `SeasonVideo`. */\nexport enum SeasonVideosOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  SeasonIdAsc = 'SEASON_ID_ASC',\n  SeasonIdDesc = 'SEASON_ID_DESC'\n}\n\n/** A connection to a list of `Season` values. */\nexport type SeasonsConnection = {\n  __typename?: 'SeasonsConnection';\n  /** A list of edges which contains the `Season` and cursor to aid in pagination. */\n  edges: Array<SeasonsEdge>;\n  /** A list of `Season` objects. */\n  nodes: Array<Season>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `Season` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `Season` edge in the connection. */\nexport type SeasonsEdge = {\n  __typename?: 'SeasonsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `Season` at the end of the edge. */\n  node: Season;\n};\n\n/** Methods to use when ordering `Season`. */\nexport enum SeasonsOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  TvshowIdAsc = 'TVSHOW_ID_ASC',\n  TvshowIdDesc = 'TVSHOW_ID_DESC'\n}\n\n/** A filter to be used against String fields. All fields are combined with a logical ‘and.’ */\nexport type StringFilter = {\n  /** Not equal to the specified value, treating null like an ordinary value. */\n  distinctFrom?: InputMaybe<Scalars['String']['input']>;\n  /** Not equal to the specified value, treating null like an ordinary value (case-insensitive). */\n  distinctFromInsensitive?: InputMaybe<Scalars['String']['input']>;\n  /** Ends with the specified string (case-sensitive). */\n  endsWith?: InputMaybe<Scalars['String']['input']>;\n  /** Ends with the specified string (case-insensitive). */\n  endsWithInsensitive?: InputMaybe<Scalars['String']['input']>;\n  /** Equal to the specified value. */\n  equalTo?: InputMaybe<Scalars['String']['input']>;\n  /** Equal to the specified value (case-insensitive). */\n  equalToInsensitive?: InputMaybe<Scalars['String']['input']>;\n  /** Greater than the specified value. */\n  greaterThan?: InputMaybe<Scalars['String']['input']>;\n  /** Greater than the specified value (case-insensitive). */\n  greaterThanInsensitive?: InputMaybe<Scalars['String']['input']>;\n  /** Greater than or equal to the specified value. */\n  greaterThanOrEqualTo?: InputMaybe<Scalars['String']['input']>;\n  /** Greater than or equal to the specified value (case-insensitive). */\n  greaterThanOrEqualToInsensitive?: InputMaybe<Scalars['String']['input']>;\n  /** Included in the specified list. */\n  in?: InputMaybe<Array<Scalars['String']['input']>>;\n  /** Included in the specified list (case-insensitive). */\n  inInsensitive?: InputMaybe<Array<Scalars['String']['input']>>;\n  /** Contains the specified string (case-sensitive). */\n  includes?: InputMaybe<Scalars['String']['input']>;\n  /** Contains the specified string (case-insensitive). */\n  includesInsensitive?: InputMaybe<Scalars['String']['input']>;\n  /** Is null (if `true` is specified) or is not null (if `false` is specified). */\n  isNull?: InputMaybe<Scalars['Boolean']['input']>;\n  /** Less than the specified value. */\n  lessThan?: InputMaybe<Scalars['String']['input']>;\n  /** Less than the specified value (case-insensitive). */\n  lessThanInsensitive?: InputMaybe<Scalars['String']['input']>;\n  /** Less than or equal to the specified value. */\n  lessThanOrEqualTo?: InputMaybe<Scalars['String']['input']>;\n  /** Less than or equal to the specified value (case-insensitive). */\n  lessThanOrEqualToInsensitive?: InputMaybe<Scalars['String']['input']>;\n  /** Matches the specified pattern (case-sensitive). An underscore (_) matches any single character; a percent sign (%) matches any sequence of zero or more characters. */\n  like?: InputMaybe<Scalars['String']['input']>;\n  /** Matches the specified pattern (case-insensitive). An underscore (_) matches any single character; a percent sign (%) matches any sequence of zero or more characters. */\n  likeInsensitive?: InputMaybe<Scalars['String']['input']>;\n  /** Equal to the specified value, treating null like an ordinary value. */\n  notDistinctFrom?: InputMaybe<Scalars['String']['input']>;\n  /** Equal to the specified value, treating null like an ordinary value (case-insensitive). */\n  notDistinctFromInsensitive?: InputMaybe<Scalars['String']['input']>;\n  /** Does not end with the specified string (case-sensitive). */\n  notEndsWith?: InputMaybe<Scalars['String']['input']>;\n  /** Does not end with the specified string (case-insensitive). */\n  notEndsWithInsensitive?: InputMaybe<Scalars['String']['input']>;\n  /** Not equal to the specified value. */\n  notEqualTo?: InputMaybe<Scalars['String']['input']>;\n  /** Not equal to the specified value (case-insensitive). */\n  notEqualToInsensitive?: InputMaybe<Scalars['String']['input']>;\n  /** Not included in the specified list. */\n  notIn?: InputMaybe<Array<Scalars['String']['input']>>;\n  /** Not included in the specified list (case-insensitive). */\n  notInInsensitive?: InputMaybe<Array<Scalars['String']['input']>>;\n  /** Does not contain the specified string (case-sensitive). */\n  notIncludes?: InputMaybe<Scalars['String']['input']>;\n  /** Does not contain the specified string (case-insensitive). */\n  notIncludesInsensitive?: InputMaybe<Scalars['String']['input']>;\n  /** Does not match the specified pattern (case-sensitive). An underscore (_) matches any single character; a percent sign (%) matches any sequence of zero or more characters. */\n  notLike?: InputMaybe<Scalars['String']['input']>;\n  /** Does not match the specified pattern (case-insensitive). An underscore (_) matches any single character; a percent sign (%) matches any sequence of zero or more characters. */\n  notLikeInsensitive?: InputMaybe<Scalars['String']['input']>;\n  /** Does not start with the specified string (case-sensitive). */\n  notStartsWith?: InputMaybe<Scalars['String']['input']>;\n  /** Does not start with the specified string (case-insensitive). */\n  notStartsWithInsensitive?: InputMaybe<Scalars['String']['input']>;\n  /** Starts with the specified string (case-sensitive). */\n  startsWith?: InputMaybe<Scalars['String']['input']>;\n  /** Starts with the specified string (case-insensitive). */\n  startsWithInsensitive?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** Definition of the TV show entity. */\nexport type Tvshow = {\n  __typename?: 'Tvshow';\n  /** Cast of the TV show. */\n  cast?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Extended synopsis. */\n  description?: Maybe<Scalars['String']['output']>;\n  /** Reads and enables pagination through a set of `TvshowGenresRelation`. */\n  genres: TvshowGenresRelationsConnection;\n  id: Scalars['String']['output'];\n  /** Reads and enables pagination through a set of `TvshowImage`. */\n  images: TvshowImagesConnection;\n  /** Reads and enables pagination through a set of `TvshowLicense`. */\n  licenses: TvshowLicensesConnection;\n  /** Original title of the TV show. */\n  originalTitle?: Maybe<Scalars['String']['output']>;\n  /** Array of production countries */\n  productionCountries?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Date of first release. */\n  released?: Maybe<Scalars['Datetime']['output']>;\n  /** Reads and enables pagination through a set of `Season`. */\n  seasons: SeasonsConnection;\n  /** Name of the producing studio. */\n  studio?: Maybe<Scalars['String']['output']>;\n  /** Short description of the main plot elements. */\n  synopsis?: Maybe<Scalars['String']['output']>;\n  /** Array of tags associated with the content. */\n  tags?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Title of the TV show. */\n  title?: Maybe<Scalars['String']['output']>;\n  /** Reads and enables pagination through a set of `TvshowVideo`. */\n  videos: TvshowVideosConnection;\n};\n\n\n/** Definition of the TV show entity. */\nexport type TvshowGenresArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<TvshowGenresRelationCondition>;\n  filter?: InputMaybe<TvshowGenresRelationFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<TvshowGenresRelationsOrderBy>>;\n};\n\n\n/** Definition of the TV show entity. */\nexport type TvshowImagesArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<TvshowImageCondition>;\n  filter?: InputMaybe<TvshowImageFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<TvshowImagesOrderBy>>;\n};\n\n\n/** Definition of the TV show entity. */\nexport type TvshowLicensesArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<TvshowLicenseCondition>;\n  filter?: InputMaybe<TvshowLicenseFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<TvshowLicensesOrderBy>>;\n};\n\n\n/** Definition of the TV show entity. */\nexport type TvshowSeasonsArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<SeasonCondition>;\n  filter?: InputMaybe<SeasonFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<SeasonsOrderBy>>;\n};\n\n\n/** Definition of the TV show entity. */\nexport type TvshowVideosArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<TvshowVideoCondition>;\n  filter?: InputMaybe<TvshowVideoFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<TvshowVideosOrderBy>>;\n};\n\n/** A condition to be used against `Tvshow` object types. All fields are tested for equality and combined with a logical ‘and.’ */\nexport type TvshowCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `title` field. */\n  title?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `Tvshow` object types. All fields are combined with a logical ‘and.’ */\nexport type TvshowFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<TvshowFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<StringFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<TvshowFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<TvshowFilter>>;\n  /** Filter by the object’s `title` field. */\n  title?: InputMaybe<StringFilter>;\n};\n\n/** Definition of the TV show genre entity. */\nexport type TvshowGenre = {\n  __typename?: 'TvshowGenre';\n  id: Scalars['String']['output'];\n  /** Global ordering number for the genre. */\n  orderNo?: Maybe<Scalars['Int']['output']>;\n  /** Title of the genre. */\n  title?: Maybe<Scalars['String']['output']>;\n};\n\n/**\n * A condition to be used against `TvshowGenre` object types. All fields are tested\n * for equality and combined with a logical ‘and.’\n */\nexport type TvshowGenreCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `orderNo` field. */\n  orderNo?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `title` field. */\n  title?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `TvshowGenre` object types. All fields are combined with a logical ‘and.’ */\nexport type TvshowGenreFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<TvshowGenreFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<StringFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<TvshowGenreFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<TvshowGenreFilter>>;\n  /** Filter by the object’s `orderNo` field. */\n  orderNo?: InputMaybe<IntFilter>;\n  /** Filter by the object’s `title` field. */\n  title?: InputMaybe<StringFilter>;\n};\n\n/** A connection to a list of `TvshowGenre` values. */\nexport type TvshowGenresConnection = {\n  __typename?: 'TvshowGenresConnection';\n  /** A list of edges which contains the `TvshowGenre` and cursor to aid in pagination. */\n  edges: Array<TvshowGenresEdge>;\n  /** A list of `TvshowGenre` objects. */\n  nodes: Array<TvshowGenre>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `TvshowGenre` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `TvshowGenre` edge in the connection. */\nexport type TvshowGenresEdge = {\n  __typename?: 'TvshowGenresEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `TvshowGenre` at the end of the edge. */\n  node: TvshowGenre;\n};\n\n/** Methods to use when ordering `TvshowGenre`. */\nexport enum TvshowGenresOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  OrderNoAsc = 'ORDER_NO_ASC',\n  OrderNoDesc = 'ORDER_NO_DESC',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  TitleAsc = 'TITLE_ASC',\n  TitleDesc = 'TITLE_DESC'\n}\n\nexport type TvshowGenresRelation = {\n  __typename?: 'TvshowGenresRelation';\n  id: Scalars['Int']['output'];\n  orderNo: Scalars['Int']['output'];\n  /** Reads a single `Tvshow` that is related to this `TvshowGenresRelation`. */\n  tvshow?: Maybe<Tvshow>;\n  /** Reads a single `TvshowGenre` that is related to this `TvshowGenresRelation`. */\n  tvshowGenre?: Maybe<TvshowGenre>;\n  tvshowGenreId?: Maybe<Scalars['String']['output']>;\n  tvshowId?: Maybe<Scalars['String']['output']>;\n};\n\n/**\n * A condition to be used against `TvshowGenresRelation` object types. All fields\n * are tested for equality and combined with a logical ‘and.’\n */\nexport type TvshowGenresRelationCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `orderNo` field. */\n  orderNo?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `tvshowGenreId` field. */\n  tvshowGenreId?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `tvshowId` field. */\n  tvshowId?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `TvshowGenresRelation` object types. All fields are combined with a logical ‘and.’ */\nexport type TvshowGenresRelationFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<TvshowGenresRelationFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<TvshowGenresRelationFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<TvshowGenresRelationFilter>>;\n  /** Filter by the object’s `orderNo` field. */\n  orderNo?: InputMaybe<IntFilter>;\n  /** Filter by the object’s `tvshowGenreId` field. */\n  tvshowGenreId?: InputMaybe<StringFilter>;\n  /** Filter by the object’s `tvshowId` field. */\n  tvshowId?: InputMaybe<StringFilter>;\n};\n\n/** A connection to a list of `TvshowGenresRelation` values. */\nexport type TvshowGenresRelationsConnection = {\n  __typename?: 'TvshowGenresRelationsConnection';\n  /** A list of edges which contains the `TvshowGenresRelation` and cursor to aid in pagination. */\n  edges: Array<TvshowGenresRelationsEdge>;\n  /** A list of `TvshowGenresRelation` objects. */\n  nodes: Array<TvshowGenresRelation>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `TvshowGenresRelation` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `TvshowGenresRelation` edge in the connection. */\nexport type TvshowGenresRelationsEdge = {\n  __typename?: 'TvshowGenresRelationsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `TvshowGenresRelation` at the end of the edge. */\n  node: TvshowGenresRelation;\n};\n\n/** Methods to use when ordering `TvshowGenresRelation`. */\nexport enum TvshowGenresRelationsOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  OrderNoAsc = 'ORDER_NO_ASC',\n  OrderNoDesc = 'ORDER_NO_DESC',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  TvshowGenreIdAsc = 'TVSHOW_GENRE_ID_ASC',\n  TvshowGenreIdDesc = 'TVSHOW_GENRE_ID_DESC',\n  TvshowIdAsc = 'TVSHOW_ID_ASC',\n  TvshowIdDesc = 'TVSHOW_ID_DESC'\n}\n\n/** Asset image metadata. */\nexport type TvshowImage = {\n  __typename?: 'TvshowImage';\n  altText?: Maybe<Scalars['String']['output']>;\n  /** Height of the image in pixels. */\n  height?: Maybe<Scalars['Int']['output']>;\n  id: Scalars['Int']['output'];\n  /** URI to the image file. */\n  path?: Maybe<Scalars['String']['output']>;\n  /** Reads a single `Tvshow` that is related to this `TvshowImage`. */\n  tvshow?: Maybe<Tvshow>;\n  tvshowId?: Maybe<Scalars['String']['output']>;\n  /** Type of the image. */\n  type?: Maybe<Scalars['String']['output']>;\n  /** Width of the image in pixels. */\n  width?: Maybe<Scalars['Int']['output']>;\n};\n\n/**\n * A condition to be used against `TvshowImage` object types. All fields are tested\n * for equality and combined with a logical ‘and.’\n */\nexport type TvshowImageCondition = {\n  /** Checks for equality with the object’s `altText` field. */\n  altText?: InputMaybe<Scalars['String']['input']>;\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `tvshowId` field. */\n  tvshowId?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `TvshowImage` object types. All fields are combined with a logical ‘and.’ */\nexport type TvshowImageFilter = {\n  /** Filter by the object’s `altText` field. */\n  altText?: InputMaybe<StringFilter>;\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<TvshowImageFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<TvshowImageFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<TvshowImageFilter>>;\n  /** Filter by the object’s `tvshowId` field. */\n  tvshowId?: InputMaybe<StringFilter>;\n};\n\n/** A connection to a list of `TvshowImage` values. */\nexport type TvshowImagesConnection = {\n  __typename?: 'TvshowImagesConnection';\n  /** A list of edges which contains the `TvshowImage` and cursor to aid in pagination. */\n  edges: Array<TvshowImagesEdge>;\n  /** A list of `TvshowImage` objects. */\n  nodes: Array<TvshowImage>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `TvshowImage` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `TvshowImage` edge in the connection. */\nexport type TvshowImagesEdge = {\n  __typename?: 'TvshowImagesEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `TvshowImage` at the end of the edge. */\n  node: TvshowImage;\n};\n\n/** Methods to use when ordering `TvshowImage`. */\nexport enum TvshowImagesOrderBy {\n  AltTextAsc = 'ALT_TEXT_ASC',\n  AltTextDesc = 'ALT_TEXT_DESC',\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  TvshowIdAsc = 'TVSHOW_ID_ASC',\n  TvshowIdDesc = 'TVSHOW_ID_DESC'\n}\n\n/** Content metadata license that defines the content availability regions and time frame. */\nexport type TvshowLicense = {\n  __typename?: 'TvshowLicense';\n  /** Array of countries where the license applies. */\n  countries?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Time when license becomes invalid. */\n  endTime?: Maybe<Scalars['Datetime']['output']>;\n  id: Scalars['Int']['output'];\n  /** Time when license becomes valid. */\n  startTime?: Maybe<Scalars['Datetime']['output']>;\n  /** Reads a single `Tvshow` that is related to this `TvshowLicense`. */\n  tvshow?: Maybe<Tvshow>;\n  tvshowId?: Maybe<Scalars['String']['output']>;\n};\n\n/**\n * A condition to be used against `TvshowLicense` object types. All fields are\n * tested for equality and combined with a logical ‘and.’\n */\nexport type TvshowLicenseCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `tvshowId` field. */\n  tvshowId?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** A filter to be used against `TvshowLicense` object types. All fields are combined with a logical ‘and.’ */\nexport type TvshowLicenseFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<TvshowLicenseFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<TvshowLicenseFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<TvshowLicenseFilter>>;\n  /** Filter by the object’s `tvshowId` field. */\n  tvshowId?: InputMaybe<StringFilter>;\n};\n\n/** A connection to a list of `TvshowLicense` values. */\nexport type TvshowLicensesConnection = {\n  __typename?: 'TvshowLicensesConnection';\n  /** A list of edges which contains the `TvshowLicense` and cursor to aid in pagination. */\n  edges: Array<TvshowLicensesEdge>;\n  /** A list of `TvshowLicense` objects. */\n  nodes: Array<TvshowLicense>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `TvshowLicense` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `TvshowLicense` edge in the connection. */\nexport type TvshowLicensesEdge = {\n  __typename?: 'TvshowLicensesEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `TvshowLicense` at the end of the edge. */\n  node: TvshowLicense;\n};\n\n/** Methods to use when ordering `TvshowLicense`. */\nexport enum TvshowLicensesOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  TvshowIdAsc = 'TVSHOW_ID_ASC',\n  TvshowIdDesc = 'TVSHOW_ID_DESC'\n}\n\n/** Video stream metadata. */\nexport type TvshowVideo = {\n  __typename?: 'TvshowVideo';\n  /** Array of audio languages available in the stream. */\n  audioLanguages?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Array of caption languages available in the stream. */\n  captionLanguages?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Reads and enables pagination through a set of `TvshowVideoCuePoint`. */\n  cuePoints: TvshowVideoCuePointsConnection;\n  /** URI to a DASH manifest. */\n  dashManifest?: Maybe<Scalars['String']['output']>;\n  /** URI to an HLS manifest. */\n  hlsManifest?: Maybe<Scalars['String']['output']>;\n  id: Scalars['Int']['output'];\n  /** Indicates whether a stream is protected with DRM. */\n  isProtected?: Maybe<Scalars['Boolean']['output']>;\n  /** Length of the stream in seconds. */\n  lengthInSeconds?: Maybe<Scalars['Float']['output']>;\n  /** Output format of the stream. */\n  outputFormat?: Maybe<Scalars['String']['output']>;\n  /** Array of subtitle languages available in the stream. */\n  subtitleLanguages?: Maybe<Array<Maybe<Scalars['String']['output']>>>;\n  /** Title of the video stream */\n  title?: Maybe<Scalars['String']['output']>;\n  /** Reads a single `Tvshow` that is related to this `TvshowVideo`. */\n  tvshow?: Maybe<Tvshow>;\n  tvshowId?: Maybe<Scalars['String']['output']>;\n  /** Type of the video stream. */\n  type?: Maybe<Scalars['String']['output']>;\n  /** Reads and enables pagination through a set of `TvshowVideoStream`. */\n  videoStreams: TvshowVideoStreamsConnection;\n};\n\n\n/** Video stream metadata. */\nexport type TvshowVideoCuePointsArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<TvshowVideoCuePointCondition>;\n  filter?: InputMaybe<TvshowVideoCuePointFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<TvshowVideoCuePointsOrderBy>>;\n};\n\n\n/** Video stream metadata. */\nexport type TvshowVideoVideoStreamsArgs = {\n  after?: InputMaybe<Scalars['Cursor']['input']>;\n  before?: InputMaybe<Scalars['Cursor']['input']>;\n  condition?: InputMaybe<TvshowVideoStreamCondition>;\n  filter?: InputMaybe<TvshowVideoStreamFilter>;\n  first?: InputMaybe<Scalars['Int']['input']>;\n  last?: InputMaybe<Scalars['Int']['input']>;\n  offset?: InputMaybe<Scalars['Int']['input']>;\n  orderBy?: InputMaybe<Array<TvshowVideoStreamsOrderBy>>;\n};\n\n/**\n * A condition to be used against `TvshowVideo` object types. All fields are tested\n * for equality and combined with a logical ‘and.’\n */\nexport type TvshowVideoCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `tvshowId` field. */\n  tvshowId?: InputMaybe<Scalars['String']['input']>;\n};\n\n/** Video cue point metadata */\nexport type TvshowVideoCuePoint = {\n  __typename?: 'TvshowVideoCuePoint';\n  /** Type of the cue point */\n  cuePointTypeKey: Scalars['String']['output'];\n  id: Scalars['Int']['output'];\n  /** Time in seconds at which the cue point is set within the video */\n  timeInSeconds: Scalars['Float']['output'];\n  /** Additional information associated with the cue point */\n  value?: Maybe<Scalars['String']['output']>;\n  /** Reads a single `TvshowVideo` that is related to this `TvshowVideoCuePoint`. */\n  video?: Maybe<TvshowVideo>;\n  videoId?: Maybe<Scalars['Int']['output']>;\n};\n\n/**\n * A condition to be used against `TvshowVideoCuePoint` object types. All fields\n * are tested for equality and combined with a logical ‘and.’\n */\nexport type TvshowVideoCuePointCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `videoId` field. */\n  videoId?: InputMaybe<Scalars['Int']['input']>;\n};\n\n/** A filter to be used against `TvshowVideoCuePoint` object types. All fields are combined with a logical ‘and.’ */\nexport type TvshowVideoCuePointFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<TvshowVideoCuePointFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<TvshowVideoCuePointFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<TvshowVideoCuePointFilter>>;\n  /** Filter by the object’s `videoId` field. */\n  videoId?: InputMaybe<IntFilter>;\n};\n\n/** A connection to a list of `TvshowVideoCuePoint` values. */\nexport type TvshowVideoCuePointsConnection = {\n  __typename?: 'TvshowVideoCuePointsConnection';\n  /** A list of edges which contains the `TvshowVideoCuePoint` and cursor to aid in pagination. */\n  edges: Array<TvshowVideoCuePointsEdge>;\n  /** A list of `TvshowVideoCuePoint` objects. */\n  nodes: Array<TvshowVideoCuePoint>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `TvshowVideoCuePoint` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `TvshowVideoCuePoint` edge in the connection. */\nexport type TvshowVideoCuePointsEdge = {\n  __typename?: 'TvshowVideoCuePointsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `TvshowVideoCuePoint` at the end of the edge. */\n  node: TvshowVideoCuePoint;\n};\n\n/** Methods to use when ordering `TvshowVideoCuePoint`. */\nexport enum TvshowVideoCuePointsOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  VideoIdAsc = 'VIDEO_ID_ASC',\n  VideoIdDesc = 'VIDEO_ID_DESC'\n}\n\n/** A filter to be used against `TvshowVideo` object types. All fields are combined with a logical ‘and.’ */\nexport type TvshowVideoFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<TvshowVideoFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<TvshowVideoFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<TvshowVideoFilter>>;\n  /** Filter by the object’s `tvshowId` field. */\n  tvshowId?: InputMaybe<StringFilter>;\n};\n\n/** Video stream DRM metadata */\nexport type TvshowVideoStream = {\n  __typename?: 'TvshowVideoStream';\n  /** Bitrate in kilobits per second */\n  bitrateInKbps?: Maybe<Scalars['Int']['output']>;\n  /** Codecs */\n  codecs?: Maybe<Scalars['String']['output']>;\n  /** Display aspect ratio for video streams */\n  displayAspectRatio?: Maybe<Scalars['String']['output']>;\n  /** File path to the initialization segment */\n  file?: Maybe<Scalars['String']['output']>;\n  /** File Template */\n  fileTemplate?: Maybe<Scalars['String']['output']>;\n  /** Packaging format of the stream */\n  format?: Maybe<Scalars['String']['output']>;\n  /** Frame rate of the video stream */\n  frameRate?: Maybe<Scalars['Float']['output']>;\n  /** Height of the video stream */\n  height?: Maybe<Scalars['Int']['output']>;\n  id: Scalars['Int']['output'];\n  /** Initialization Vector of the stream */\n  iv?: Maybe<Scalars['String']['output']>;\n  /** DRM Key ID */\n  keyId?: Maybe<Scalars['String']['output']>;\n  /** Label indicating the type of stream (audio/video) */\n  label?: Maybe<Scalars['String']['output']>;\n  /** The language code for audio streams */\n  languageCode?: Maybe<Scalars['String']['output']>;\n  /** Language name for audio, subtitle, or caption streams */\n  languageName?: Maybe<Scalars['String']['output']>;\n  /** Pixel aspect ratio for video streams */\n  pixelAspectRatio?: Maybe<Scalars['String']['output']>;\n  /** Sampling rate for audio streams */\n  samplingRate?: Maybe<Scalars['Int']['output']>;\n  /** Stream type */\n  type?: Maybe<VideoStreamType>;\n  /** Reads a single `TvshowVideo` that is related to this `TvshowVideoStream`. */\n  video?: Maybe<TvshowVideo>;\n  videoId?: Maybe<Scalars['Int']['output']>;\n  /** Width of the video stream */\n  width?: Maybe<Scalars['Int']['output']>;\n};\n\n/**\n * A condition to be used against `TvshowVideoStream` object types. All fields are\n * tested for equality and combined with a logical ‘and.’\n */\nexport type TvshowVideoStreamCondition = {\n  /** Checks for equality with the object’s `id` field. */\n  id?: InputMaybe<Scalars['Int']['input']>;\n  /** Checks for equality with the object’s `type` field. */\n  type?: InputMaybe<VideoStreamType>;\n  /** Checks for equality with the object’s `videoId` field. */\n  videoId?: InputMaybe<Scalars['Int']['input']>;\n};\n\n/** A filter to be used against `TvshowVideoStream` object types. All fields are combined with a logical ‘and.’ */\nexport type TvshowVideoStreamFilter = {\n  /** Checks for all expressions in this list. */\n  and?: InputMaybe<Array<TvshowVideoStreamFilter>>;\n  /** Filter by the object’s `id` field. */\n  id?: InputMaybe<IntFilter>;\n  /** Negates the expression. */\n  not?: InputMaybe<TvshowVideoStreamFilter>;\n  /** Checks for any expressions in this list. */\n  or?: InputMaybe<Array<TvshowVideoStreamFilter>>;\n  /** Filter by the object’s `type` field. */\n  type?: InputMaybe<VideoStreamTypeFilter>;\n  /** Filter by the object’s `videoId` field. */\n  videoId?: InputMaybe<IntFilter>;\n};\n\n/** A connection to a list of `TvshowVideoStream` values. */\nexport type TvshowVideoStreamsConnection = {\n  __typename?: 'TvshowVideoStreamsConnection';\n  /** A list of edges which contains the `TvshowVideoStream` and cursor to aid in pagination. */\n  edges: Array<TvshowVideoStreamsEdge>;\n  /** A list of `TvshowVideoStream` objects. */\n  nodes: Array<TvshowVideoStream>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `TvshowVideoStream` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `TvshowVideoStream` edge in the connection. */\nexport type TvshowVideoStreamsEdge = {\n  __typename?: 'TvshowVideoStreamsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `TvshowVideoStream` at the end of the edge. */\n  node: TvshowVideoStream;\n};\n\n/** Methods to use when ordering `TvshowVideoStream`. */\nexport enum TvshowVideoStreamsOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  TypeAsc = 'TYPE_ASC',\n  TypeDesc = 'TYPE_DESC',\n  VideoIdAsc = 'VIDEO_ID_ASC',\n  VideoIdDesc = 'VIDEO_ID_DESC'\n}\n\n/** A connection to a list of `TvshowVideo` values. */\nexport type TvshowVideosConnection = {\n  __typename?: 'TvshowVideosConnection';\n  /** A list of edges which contains the `TvshowVideo` and cursor to aid in pagination. */\n  edges: Array<TvshowVideosEdge>;\n  /** A list of `TvshowVideo` objects. */\n  nodes: Array<TvshowVideo>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `TvshowVideo` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `TvshowVideo` edge in the connection. */\nexport type TvshowVideosEdge = {\n  __typename?: 'TvshowVideosEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `TvshowVideo` at the end of the edge. */\n  node: TvshowVideo;\n};\n\n/** Methods to use when ordering `TvshowVideo`. */\nexport enum TvshowVideosOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  TvshowIdAsc = 'TVSHOW_ID_ASC',\n  TvshowIdDesc = 'TVSHOW_ID_DESC'\n}\n\n/** A connection to a list of `Tvshow` values. */\nexport type TvshowsConnection = {\n  __typename?: 'TvshowsConnection';\n  /** A list of edges which contains the `Tvshow` and cursor to aid in pagination. */\n  edges: Array<TvshowsEdge>;\n  /** A list of `Tvshow` objects. */\n  nodes: Array<Tvshow>;\n  /** Information to aid in pagination. */\n  pageInfo: PageInfo;\n  /** The count of *all* `Tvshow` you could get from the connection. */\n  totalCount: Scalars['Int']['output'];\n};\n\n/** A `Tvshow` edge in the connection. */\nexport type TvshowsEdge = {\n  __typename?: 'TvshowsEdge';\n  /** A cursor for use in pagination. */\n  cursor?: Maybe<Scalars['Cursor']['output']>;\n  /** The `Tvshow` at the end of the edge. */\n  node: Tvshow;\n};\n\n/** Methods to use when ordering `Tvshow`. */\nexport enum TvshowsOrderBy {\n  IdAsc = 'ID_ASC',\n  IdDesc = 'ID_DESC',\n  Natural = 'NATURAL',\n  PrimaryKeyAsc = 'PRIMARY_KEY_ASC',\n  PrimaryKeyDesc = 'PRIMARY_KEY_DESC',\n  TitleAsc = 'TITLE_ASC',\n  TitleDesc = 'TITLE_DESC'\n}\n\nexport enum VideoStreamType {\n  /** Audio */\n  Audio = 'AUDIO',\n  /** Closed caption */\n  ClosedCaption = 'CLOSED_CAPTION',\n  /** Subtitle */\n  Subtitle = 'SUBTITLE',\n  /** Video */\n  Video = 'VIDEO'\n}\n\n/** A filter to be used against VideoStreamType fields. All fields are combined with a logical ‘and.’ */\nexport type VideoStreamTypeFilter = {\n  /** Not equal to the specified value, treating null like an ordinary value. */\n  distinctFrom?: InputMaybe<VideoStreamType>;\n  /** Equal to the specified value. */\n  equalTo?: InputMaybe<VideoStreamType>;\n  /** Greater than the specified value. */\n  greaterThan?: InputMaybe<VideoStreamType>;\n  /** Greater than or equal to the specified value. */\n  greaterThanOrEqualTo?: InputMaybe<VideoStreamType>;\n  /** Included in the specified list. */\n  in?: InputMaybe<Array<VideoStreamType>>;\n  /** Is null (if `true` is specified) or is not null (if `false` is specified). */\n  isNull?: InputMaybe<Scalars['Boolean']['input']>;\n  /** Less than the specified value. */\n  lessThan?: InputMaybe<VideoStreamType>;\n  /** Less than or equal to the specified value. */\n  lessThanOrEqualTo?: InputMaybe<VideoStreamType>;\n  /** Equal to the specified value, treating null like an ordinary value. */\n  notDistinctFrom?: InputMaybe<VideoStreamType>;\n  /** Not equal to the specified value. */\n  notEqualTo?: InputMaybe<VideoStreamType>;\n  /** Not included in the specified list. */\n  notIn?: InputMaybe<Array<VideoStreamType>>;\n};\n\nexport type KeywordSearchQueryVariables = Exact<{\n  keyword: Scalars['String']['input'];\n}>;\n\n\nexport type KeywordSearchQuery = { __typename?: 'Query', movies?: { __typename?: 'MoviesConnection', nodes: Array<{ __typename?: 'Movie', id: string, originalTitle?: string | null, studio?: string | null, released?: any | null, cast?: Array<string | null> | null, productionCountries?: Array<string | null> | null, tags?: Array<string | null> | null, title?: string | null, description?: string | null, synopsis?: string | null, genres: { __typename?: 'MovieGenresRelationsConnection', nodes: Array<{ __typename?: 'MovieGenresRelation', movieGenre?: { __typename?: 'MovieGenre', id: string, title?: string | null } | null }> }, images: { __typename?: 'MovieImagesConnection', nodes: Array<{ __typename?: 'MovieImage', id: number, type?: string | null, width?: number | null, height?: number | null, path?: string | null, altText?: string | null }> }, licenses: { __typename?: 'MovieLicensesConnection', nodes: Array<{ __typename?: 'MovieLicense', countries?: Array<string | null> | null, startTime?: any | null, endTime?: any | null }> }, videos: { __typename?: 'MovieVideosConnection', nodes: Array<{ __typename?: 'MovieVideo', id: number, type?: string | null, title?: string | null, dashManifest?: string | null, hlsManifest?: string | null, audioLanguages?: Array<string | null> | null, subtitleLanguages?: Array<string | null> | null, outputFormat?: string | null, lengthInSeconds?: number | null, captionLanguages?: Array<string | null> | null, isProtected?: boolean | null, cuePoints: { __typename?: 'MovieVideoCuePointsConnection', nodes: Array<{ __typename?: 'MovieVideoCuePoint', id: number, cuePointTypeKey: string, timeInSeconds: number, value?: string | null }> }, videoStreams: { __typename?: 'MovieVideoStreamsConnection', nodes: Array<{ __typename?: 'MovieVideoStream', label?: string | null, format?: string | null, frameRate?: number | null, languageCode?: string | null, bitrateInKbps?: number | null, displayAspectRatio?: string | null, pixelAspectRatio?: string | null, samplingRate?: number | null, fileTemplate?: string | null, id: number, iv?: string | null, keyId?: string | null, type?: VideoStreamType | null, codecs?: string | null, height?: number | null, width?: number | null }> } }> } }> } | null, episodes?: { __typename?: 'EpisodesConnection', nodes: Array<{ __typename?: 'Episode', id: string, index?: number | null, originalTitle?: string | null, studio?: string | null, released?: any | null, cast?: Array<string | null> | null, productionCountries?: Array<string | null> | null, tags?: Array<string | null> | null, title?: string | null, description?: string | null, synopsis?: string | null, genres: { __typename?: 'EpisodeGenresRelationsConnection', nodes: Array<{ __typename?: 'EpisodeGenresRelation', tvshowGenre?: { __typename?: 'TvshowGenre', id: string, title?: string | null } | null }> }, images: { __typename?: 'EpisodeImagesConnection', nodes: Array<{ __typename?: 'EpisodeImage', id: number, type?: string | null, width?: number | null, height?: number | null, path?: string | null, altText?: string | null }> }, licenses: { __typename?: 'EpisodeLicensesConnection', nodes: Array<{ __typename?: 'EpisodeLicense', countries?: Array<string | null> | null, startTime?: any | null, endTime?: any | null }> }, videos: { __typename?: 'EpisodeVideosConnection', nodes: Array<{ __typename?: 'EpisodeVideo', id: number, type?: string | null, title?: string | null, dashManifest?: string | null, hlsManifest?: string | null, audioLanguages?: Array<string | null> | null, subtitleLanguages?: Array<string | null> | null, outputFormat?: string | null, lengthInSeconds?: number | null, captionLanguages?: Array<string | null> | null, isProtected?: boolean | null, cuePoints: { __typename?: 'EpisodeVideoCuePointsConnection', nodes: Array<{ __typename?: 'EpisodeVideoCuePoint', id: number, cuePointTypeKey: string, timeInSeconds: number, value?: string | null }> }, videoStreams: { __typename?: 'EpisodeVideoStreamsConnection', nodes: Array<{ __typename?: 'EpisodeVideoStream', label?: string | null, format?: string | null, frameRate?: number | null, languageCode?: string | null, bitrateInKbps?: number | null, displayAspectRatio?: string | null, pixelAspectRatio?: string | null, samplingRate?: number | null, fileTemplate?: string | null, id: number, iv?: string | null, keyId?: string | null, type?: VideoStreamType | null, codecs?: string | null, height?: number | null, width?: number | null }> } }> } }> } | null, tvshows?: { __typename?: 'TvshowsConnection', nodes: Array<{ __typename?: 'Tvshow', id: string, originalTitle?: string | null, studio?: string | null, released?: any | null, cast?: Array<string | null> | null, productionCountries?: Array<string | null> | null, tags?: Array<string | null> | null, title?: string | null, description?: string | null, synopsis?: string | null, genres: { __typename?: 'TvshowGenresRelationsConnection', nodes: Array<{ __typename?: 'TvshowGenresRelation', tvshowGenre?: { __typename?: 'TvshowGenre', id: string, title?: string | null } | null }> }, images: { __typename?: 'TvshowImagesConnection', nodes: Array<{ __typename?: 'TvshowImage', id: number, type?: string | null, width?: number | null, height?: number | null, path?: string | null, altText?: string | null }> }, licenses: { __typename?: 'TvshowLicensesConnection', nodes: Array<{ __typename?: 'TvshowLicense', countries?: Array<string | null> | null, startTime?: any | null, endTime?: any | null }> }, videos: { __typename?: 'TvshowVideosConnection', nodes: Array<{ __typename?: 'TvshowVideo', id: number, type?: string | null, title?: string | null, dashManifest?: string | null, hlsManifest?: string | null, audioLanguages?: Array<string | null> | null, subtitleLanguages?: Array<string | null> | null, outputFormat?: string | null, lengthInSeconds?: number | null, captionLanguages?: Array<string | null> | null, isProtected?: boolean | null, cuePoints: { __typename?: 'TvshowVideoCuePointsConnection', nodes: Array<{ __typename?: 'TvshowVideoCuePoint', id: number, cuePointTypeKey: string, timeInSeconds: number, value?: string | null }> }, videoStreams: { __typename?: 'TvshowVideoStreamsConnection', nodes: Array<{ __typename?: 'TvshowVideoStream', label?: string | null, format?: string | null, frameRate?: number | null, languageCode?: string | null, bitrateInKbps?: number | null, displayAspectRatio?: string | null, pixelAspectRatio?: string | null, samplingRate?: number | null, fileTemplate?: string | null, id: number, iv?: string | null, keyId?: string | null, type?: VideoStreamType | null, codecs?: string | null, height?: number | null, width?: number | null }> } }> } }> } | null };\n\nexport type GetAllChannelsQueryVariables = Exact<{ [key: string]: never; }>;\n\n\nexport type GetAllChannelsQuery = { __typename?: 'Query', channels?: { __typename?: 'ChannelsConnection', nodes: Array<{ __typename?: 'Channel', id: string, title?: string | null, description?: string | null, dashStreamUrl?: string | null, hlsStreamUrl?: string | null, keyId?: string | null, playlists: { __typename?: 'PlaylistsConnection', nodes: Array<{ __typename?: 'Playlist', id: string, startDateTime: any, endDateTime: any, programs: { __typename?: 'ProgramsConnection', nodes: Array<{ __typename?: 'Program', id: number, sortIndex?: number | null, title?: string | null, movie?: { __typename?: 'Movie', title?: string | null } | null, episode?: { __typename?: 'Episode', title?: string | null } | null }> } }> } }> } | null };\n\nexport type GetItemQueryVariables = Exact<{\n  id: Scalars['String']['input'];\n}>;\n\n\nexport type GetItemQuery = { __typename?: 'Query', movie?: { __typename?: 'Movie', id: string, originalTitle?: string | null, studio?: string | null, released?: any | null, cast?: Array<string | null> | null, productionCountries?: Array<string | null> | null, tags?: Array<string | null> | null, title?: string | null, description?: string | null, synopsis?: string | null, genres: { __typename?: 'MovieGenresRelationsConnection', nodes: Array<{ __typename?: 'MovieGenresRelation', movieGenre?: { __typename?: 'MovieGenre', id: string, title?: string | null } | null }> }, images: { __typename?: 'MovieImagesConnection', nodes: Array<{ __typename?: 'MovieImage', id: number, type?: string | null, width?: number | null, height?: number | null, path?: string | null, altText?: string | null }> }, licenses: { __typename?: 'MovieLicensesConnection', nodes: Array<{ __typename?: 'MovieLicense', countries?: Array<string | null> | null, startTime?: any | null, endTime?: any | null }> }, videos: { __typename?: 'MovieVideosConnection', nodes: Array<{ __typename?: 'MovieVideo', id: number, type?: string | null, title?: string | null, dashManifest?: string | null, hlsManifest?: string | null, audioLanguages?: Array<string | null> | null, subtitleLanguages?: Array<string | null> | null, outputFormat?: string | null, lengthInSeconds?: number | null, captionLanguages?: Array<string | null> | null, isProtected?: boolean | null, cuePoints: { __typename?: 'MovieVideoCuePointsConnection', nodes: Array<{ __typename?: 'MovieVideoCuePoint', id: number, cuePointTypeKey: string, timeInSeconds: number, value?: string | null }> }, videoStreams: { __typename?: 'MovieVideoStreamsConnection', nodes: Array<{ __typename?: 'MovieVideoStream', label?: string | null, format?: string | null, frameRate?: number | null, languageCode?: string | null, bitrateInKbps?: number | null, displayAspectRatio?: string | null, pixelAspectRatio?: string | null, samplingRate?: number | null, fileTemplate?: string | null, id: number, iv?: string | null, keyId?: string | null, type?: VideoStreamType | null, codecs?: string | null, height?: number | null, width?: number | null }> } }> } } | null, tvshow?: { __typename?: 'Tvshow', id: string, originalTitle?: string | null, studio?: string | null, released?: any | null, cast?: Array<string | null> | null, productionCountries?: Array<string | null> | null, tags?: Array<string | null> | null, title?: string | null, description?: string | null, synopsis?: string | null, genres: { __typename?: 'TvshowGenresRelationsConnection', nodes: Array<{ __typename?: 'TvshowGenresRelation', tvshowGenre?: { __typename?: 'TvshowGenre', id: string, title?: string | null } | null }> }, images: { __typename?: 'TvshowImagesConnection', nodes: Array<{ __typename?: 'TvshowImage', id: number, type?: string | null, width?: number | null, height?: number | null, path?: string | null, altText?: string | null }> }, licenses: { __typename?: 'TvshowLicensesConnection', nodes: Array<{ __typename?: 'TvshowLicense', countries?: Array<string | null> | null, startTime?: any | null, endTime?: any | null }> }, videos: { __typename?: 'TvshowVideosConnection', nodes: Array<{ __typename?: 'TvshowVideo', id: number, type?: string | null, title?: string | null, dashManifest?: string | null, hlsManifest?: string | null, audioLanguages?: Array<string | null> | null, subtitleLanguages?: Array<string | null> | null, outputFormat?: string | null, lengthInSeconds?: number | null, captionLanguages?: Array<string | null> | null, isProtected?: boolean | null, cuePoints: { __typename?: 'TvshowVideoCuePointsConnection', nodes: Array<{ __typename?: 'TvshowVideoCuePoint', id: number, cuePointTypeKey: string, timeInSeconds: number, value?: string | null }> }, videoStreams: { __typename?: 'TvshowVideoStreamsConnection', nodes: Array<{ __typename?: 'TvshowVideoStream', label?: string | null, format?: string | null, frameRate?: number | null, languageCode?: string | null, bitrateInKbps?: number | null, displayAspectRatio?: string | null, pixelAspectRatio?: string | null, samplingRate?: number | null, fileTemplate?: string | null, id: number, iv?: string | null, keyId?: string | null, type?: VideoStreamType | null, codecs?: string | null, height?: number | null, width?: number | null }> } }> }, seasons: { __typename?: 'SeasonsConnection', nodes: Array<{ __typename?: 'Season', id: string, index?: number | null, synopsis?: string | null, episodes: { __typename?: 'EpisodesConnection', nodes: Array<{ __typename?: 'Episode', id: string, index?: number | null, originalTitle?: string | null, studio?: string | null, released?: any | null, cast?: Array<string | null> | null, productionCountries?: Array<string | null> | null, tags?: Array<string | null> | null, title?: string | null, description?: string | null, synopsis?: string | null, season?: { __typename?: 'Season', tvshowId?: string | null } | null, genres: { __typename?: 'EpisodeGenresRelationsConnection', nodes: Array<{ __typename?: 'EpisodeGenresRelation', tvshowGenre?: { __typename?: 'TvshowGenre', id: string, title?: string | null } | null }> }, images: { __typename?: 'EpisodeImagesConnection', nodes: Array<{ __typename?: 'EpisodeImage', id: number, type?: string | null, width?: number | null, height?: number | null, path?: string | null, altText?: string | null }> }, licenses: { __typename?: 'EpisodeLicensesConnection', nodes: Array<{ __typename?: 'EpisodeLicense', countries?: Array<string | null> | null, startTime?: any | null, endTime?: any | null }> }, videos: { __typename?: 'EpisodeVideosConnection', nodes: Array<{ __typename?: 'EpisodeVideo', id: number, type?: string | null, title?: string | null, dashManifest?: string | null, hlsManifest?: string | null, audioLanguages?: Array<string | null> | null, subtitleLanguages?: Array<string | null> | null, outputFormat?: string | null, lengthInSeconds?: number | null, captionLanguages?: Array<string | null> | null, isProtected?: boolean | null, cuePoints: { __typename?: 'EpisodeVideoCuePointsConnection', nodes: Array<{ __typename?: 'EpisodeVideoCuePoint', id: number, cuePointTypeKey: string, timeInSeconds: number, value?: string | null }> }, videoStreams: { __typename?: 'EpisodeVideoStreamsConnection', nodes: Array<{ __typename?: 'EpisodeVideoStream', label?: string | null, format?: string | null, frameRate?: number | null, languageCode?: string | null, bitrateInKbps?: number | null, displayAspectRatio?: string | null, pixelAspectRatio?: string | null, samplingRate?: number | null, fileTemplate?: string | null, id: number, iv?: string | null, keyId?: string | null, type?: VideoStreamType | null, codecs?: string | null, height?: number | null, width?: number | null }> } }> } }> } }> } } | null, season?: { __typename?: 'Season', id: string, index?: number | null, studio?: string | null, released?: any | null, cast?: Array<string | null> | null, productionCountries?: Array<string | null> | null, tags?: Array<string | null> | null, description?: string | null, synopsis?: string | null, genres: { __typename?: 'SeasonGenresRelationsConnection', nodes: Array<{ __typename?: 'SeasonGenresRelation', tvshowGenre?: { __typename?: 'TvshowGenre', id: string, title?: string | null } | null }> }, images: { __typename?: 'SeasonImagesConnection', nodes: Array<{ __typename?: 'SeasonImage', id: number, type?: string | null, width?: number | null, height?: number | null, path?: string | null, altText?: string | null }> }, licenses: { __typename?: 'SeasonLicensesConnection', nodes: Array<{ __typename?: 'SeasonLicense', countries?: Array<string | null> | null, startTime?: any | null, endTime?: any | null }> }, videos: { __typename?: 'SeasonVideosConnection', nodes: Array<{ __typename?: 'SeasonVideo', id: number, type?: string | null, title?: string | null, dashManifest?: string | null, hlsManifest?: string | null, audioLanguages?: Array<string | null> | null, subtitleLanguages?: Array<string | null> | null, outputFormat?: string | null, lengthInSeconds?: number | null, captionLanguages?: Array<string | null> | null, isProtected?: boolean | null, cuePoints: { __typename?: 'SeasonVideoCuePointsConnection', nodes: Array<{ __typename?: 'SeasonVideoCuePoint', id: number, cuePointTypeKey: string, timeInSeconds: number, value?: string | null }> }, videoStreams: { __typename?: 'SeasonVideoStreamsConnection', nodes: Array<{ __typename?: 'SeasonVideoStream', label?: string | null, format?: string | null, frameRate?: number | null, languageCode?: string | null, bitrateInKbps?: number | null, displayAspectRatio?: string | null, pixelAspectRatio?: string | null, samplingRate?: number | null, fileTemplate?: string | null, id: number, iv?: string | null, keyId?: string | null, type?: VideoStreamType | null, codecs?: string | null, height?: number | null, width?: number | null }> } }> } } | null, episode?: { __typename?: 'Episode', id: string, index?: number | null, originalTitle?: string | null, studio?: string | null, released?: any | null, cast?: Array<string | null> | null, productionCountries?: Array<string | null> | null, tags?: Array<string | null> | null, title?: string | null, description?: string | null, synopsis?: string | null, season?: { __typename?: 'Season', id: string, index?: number | null, tvshowId?: string | null } | null, genres: { __typename?: 'EpisodeGenresRelationsConnection', nodes: Array<{ __typename?: 'EpisodeGenresRelation', tvshowGenre?: { __typename?: 'TvshowGenre', id: string, title?: string | null } | null }> }, images: { __typename?: 'EpisodeImagesConnection', nodes: Array<{ __typename?: 'EpisodeImage', id: number, type?: string | null, width?: number | null, height?: number | null, path?: string | null, altText?: string | null }> }, licenses: { __typename?: 'EpisodeLicensesConnection', nodes: Array<{ __typename?: 'EpisodeLicense', countries?: Array<string | null> | null, startTime?: any | null, endTime?: any | null }> }, videos: { __typename?: 'EpisodeVideosConnection', nodes: Array<{ __typename?: 'EpisodeVideo', id: number, type?: string | null, title?: string | null, dashManifest?: string | null, hlsManifest?: string | null, audioLanguages?: Array<string | null> | null, subtitleLanguages?: Array<string | null> | null, outputFormat?: string | null, lengthInSeconds?: number | null, captionLanguages?: Array<string | null> | null, isProtected?: boolean | null, cuePoints: { __typename?: 'EpisodeVideoCuePointsConnection', nodes: Array<{ __typename?: 'EpisodeVideoCuePoint', id: number, cuePointTypeKey: string, timeInSeconds: number, value?: string | null }> }, videoStreams: { __typename?: 'EpisodeVideoStreamsConnection', nodes: Array<{ __typename?: 'EpisodeVideoStream', label?: string | null, format?: string | null, frameRate?: number | null, languageCode?: string | null, bitrateInKbps?: number | null, displayAspectRatio?: string | null, pixelAspectRatio?: string | null, samplingRate?: number | null, fileTemplate?: string | null, id: number, iv?: string | null, keyId?: string | null, type?: VideoStreamType | null, codecs?: string | null, height?: number | null, width?: number | null }> } }> } } | null, channel?: { __typename?: 'Channel', id: string, title?: string | null, hlsStreamUrl?: string | null, description?: string | null, dashStreamUrl?: string | null, images: { __typename?: 'ChannelImagesConnection', nodes: Array<{ __typename?: 'ChannelImage', id: number, path?: string | null, type?: string | null }> } } | null };\n\nexport type GetCollectionQueryVariables = Exact<{\n  id: Scalars['String']['input'];\n}>;\n\n\nexport type GetCollectionQuery = { __typename?: 'Query', collection?: { __typename?: 'Collection', id: string, title?: string | null, synopsis?: string | null, description?: string | null, items: { __typename?: 'CollectionItemsRelationsConnection', nodes: Array<{ __typename?: 'CollectionItemsRelation', id: number, relationType?: string | null, episodeId?: string | null, seasonId?: string | null, tvshowId?: string | null, movieId?: string | null, episode?: { __typename?: 'Episode', id: string, index?: number | null, synopsis?: string | null, cast?: Array<string | null> | null, released?: any | null, tags?: Array<string | null> | null, genres: { __typename?: 'EpisodeGenresRelationsConnection', nodes: Array<{ __typename?: 'EpisodeGenresRelation', tvshowGenre?: { __typename?: 'TvshowGenre', title?: string | null } | null }> }, images: { __typename?: 'EpisodeImagesConnection', nodes: Array<{ __typename?: 'EpisodeImage', id: number, type?: string | null, path?: string | null }> }, videos: { __typename?: 'EpisodeVideosConnection', nodes: Array<{ __typename?: 'EpisodeVideo', id: number, dashManifest?: string | null, hlsManifest?: string | null, cuePoints: { __typename?: 'EpisodeVideoCuePointsConnection', nodes: Array<{ __typename?: 'EpisodeVideoCuePoint', id: number, cuePointTypeKey: string, timeInSeconds: number, value?: string | null }> } }> } } | null, season?: { __typename?: 'Season', id: string, index?: number | null, studio?: string | null, released?: any | null, cast?: Array<string | null> | null, productionCountries?: Array<string | null> | null, tags?: Array<string | null> | null, description?: string | null, synopsis?: string | null, genres: { __typename?: 'SeasonGenresRelationsConnection', nodes: Array<{ __typename?: 'SeasonGenresRelation', tvshowGenre?: { __typename?: 'TvshowGenre', id: string, title?: string | null } | null }> }, images: { __typename?: 'SeasonImagesConnection', nodes: Array<{ __typename?: 'SeasonImage', id: number, type?: string | null, width?: number | null, height?: number | null, path?: string | null, altText?: string | null }> }, licenses: { __typename?: 'SeasonLicensesConnection', nodes: Array<{ __typename?: 'SeasonLicense', countries?: Array<string | null> | null, startTime?: any | null, endTime?: any | null }> }, videos: { __typename?: 'SeasonVideosConnection', nodes: Array<{ __typename?: 'SeasonVideo', id: number, type?: string | null, title?: string | null, dashManifest?: string | null, hlsManifest?: string | null, audioLanguages?: Array<string | null> | null, subtitleLanguages?: Array<string | null> | null, outputFormat?: string | null, lengthInSeconds?: number | null, captionLanguages?: Array<string | null> | null, isProtected?: boolean | null, cuePoints: { __typename?: 'SeasonVideoCuePointsConnection', nodes: Array<{ __typename?: 'SeasonVideoCuePoint', id: number, cuePointTypeKey: string, timeInSeconds: number, value?: string | null }> }, videoStreams: { __typename?: 'SeasonVideoStreamsConnection', nodes: Array<{ __typename?: 'SeasonVideoStream', label?: string | null, format?: string | null, frameRate?: number | null, languageCode?: string | null, bitrateInKbps?: number | null, displayAspectRatio?: string | null, pixelAspectRatio?: string | null, samplingRate?: number | null, fileTemplate?: string | null, id: number, iv?: string | null, keyId?: string | null, type?: VideoStreamType | null, codecs?: string | null, height?: number | null, width?: number | null }> } }> } } | null, tvshow?: { __typename?: 'Tvshow', id: string, originalTitle?: string | null, studio?: string | null, released?: any | null, cast?: Array<string | null> | null, productionCountries?: Array<string | null> | null, tags?: Array<string | null> | null, title?: string | null, description?: string | null, synopsis?: string | null, genres: { __typename?: 'TvshowGenresRelationsConnection', nodes: Array<{ __typename?: 'TvshowGenresRelation', tvshowGenre?: { __typename?: 'TvshowGenre', id: string, title?: string | null } | null }> }, images: { __typename?: 'TvshowImagesConnection', nodes: Array<{ __typename?: 'TvshowImage', id: number, type?: string | null, width?: number | null, height?: number | null, path?: string | null, altText?: string | null }> }, licenses: { __typename?: 'TvshowLicensesConnection', nodes: Array<{ __typename?: 'TvshowLicense', countries?: Array<string | null> | null, startTime?: any | null, endTime?: any | null }> }, videos: { __typename?: 'TvshowVideosConnection', nodes: Array<{ __typename?: 'TvshowVideo', id: number, type?: string | null, title?: string | null, dashManifest?: string | null, hlsManifest?: string | null, audioLanguages?: Array<string | null> | null, subtitleLanguages?: Array<string | null> | null, outputFormat?: string | null, lengthInSeconds?: number | null, captionLanguages?: Array<string | null> | null, isProtected?: boolean | null, cuePoints: { __typename?: 'TvshowVideoCuePointsConnection', nodes: Array<{ __typename?: 'TvshowVideoCuePoint', id: number, cuePointTypeKey: string, timeInSeconds: number, value?: string | null }> }, videoStreams: { __typename?: 'TvshowVideoStreamsConnection', nodes: Array<{ __typename?: 'TvshowVideoStream', label?: string | null, format?: string | null, frameRate?: number | null, languageCode?: string | null, bitrateInKbps?: number | null, displayAspectRatio?: string | null, pixelAspectRatio?: string | null, samplingRate?: number | null, fileTemplate?: string | null, id: number, iv?: string | null, keyId?: string | null, type?: VideoStreamType | null, codecs?: string | null, height?: number | null, width?: number | null }> } }> }, seasons: { __typename?: 'SeasonsConnection', nodes: Array<{ __typename?: 'Season', id: string, index?: number | null, synopsis?: string | null, episodes: { __typename?: 'EpisodesConnection', nodes: Array<{ __typename?: 'Episode', id: string, index?: number | null, title?: string | null, synopsis?: string | null }> } }> } } | null, movie?: { __typename?: 'Movie', id: string, originalTitle?: string | null, studio?: string | null, released?: any | null, cast?: Array<string | null> | null, productionCountries?: Array<string | null> | null, tags?: Array<string | null> | null, title?: string | null, description?: string | null, synopsis?: string | null, genres: { __typename?: 'MovieGenresRelationsConnection', nodes: Array<{ __typename?: 'MovieGenresRelation', movieGenre?: { __typename?: 'MovieGenre', id: string, title?: string | null } | null }> }, images: { __typename?: 'MovieImagesConnection', nodes: Array<{ __typename?: 'MovieImage', id: number, type?: string | null, width?: number | null, height?: number | null, path?: string | null, altText?: string | null }> }, licenses: { __typename?: 'MovieLicensesConnection', nodes: Array<{ __typename?: 'MovieLicense', countries?: Array<string | null> | null, startTime?: any | null, endTime?: any | null }> }, videos: { __typename?: 'MovieVideosConnection', nodes: Array<{ __typename?: 'MovieVideo', id: number, type?: string | null, title?: string | null, dashManifest?: string | null, hlsManifest?: string | null, audioLanguages?: Array<string | null> | null, subtitleLanguages?: Array<string | null> | null, outputFormat?: string | null, lengthInSeconds?: number | null, captionLanguages?: Array<string | null> | null, isProtected?: boolean | null, cuePoints: { __typename?: 'MovieVideoCuePointsConnection', nodes: Array<{ __typename?: 'MovieVideoCuePoint', id: number, cuePointTypeKey: string, timeInSeconds: number, value?: string | null }> }, videoStreams: { __typename?: 'MovieVideoStreamsConnection', nodes: Array<{ __typename?: 'MovieVideoStream', label?: string | null, format?: string | null, frameRate?: number | null, languageCode?: string | null, bitrateInKbps?: number | null, displayAspectRatio?: string | null, pixelAspectRatio?: string | null, samplingRate?: number | null, fileTemplate?: string | null, id: number, iv?: string | null, keyId?: string | null, type?: VideoStreamType | null, codecs?: string | null, height?: number | null, width?: number | null }> } }> } } | null }> } } | null };\n\nexport type GetItemsQueryVariables = Exact<{\n  ids?: InputMaybe<Array<Scalars['String']['input']> | Scalars['String']['input']>;\n}>;\n\n\nexport type GetItemsQuery = { __typename?: 'Query', movies?: { __typename?: 'MoviesConnection', nodes: Array<{ __typename?: 'Movie', id: string, originalTitle?: string | null, studio?: string | null, released?: any | null, cast?: Array<string | null> | null, productionCountries?: Array<string | null> | null, tags?: Array<string | null> | null, title?: string | null, description?: string | null, synopsis?: string | null, genres: { __typename?: 'MovieGenresRelationsConnection', nodes: Array<{ __typename?: 'MovieGenresRelation', movieGenre?: { __typename?: 'MovieGenre', id: string, title?: string | null } | null }> }, images: { __typename?: 'MovieImagesConnection', nodes: Array<{ __typename?: 'MovieImage', id: number, type?: string | null, width?: number | null, height?: number | null, path?: string | null, altText?: string | null }> }, licenses: { __typename?: 'MovieLicensesConnection', nodes: Array<{ __typename?: 'MovieLicense', countries?: Array<string | null> | null, startTime?: any | null, endTime?: any | null }> }, videos: { __typename?: 'MovieVideosConnection', nodes: Array<{ __typename?: 'MovieVideo', id: number, type?: string | null, title?: string | null, dashManifest?: string | null, hlsManifest?: string | null, audioLanguages?: Array<string | null> | null, subtitleLanguages?: Array<string | null> | null, outputFormat?: string | null, lengthInSeconds?: number | null, captionLanguages?: Array<string | null> | null, isProtected?: boolean | null, cuePoints: { __typename?: 'MovieVideoCuePointsConnection', nodes: Array<{ __typename?: 'MovieVideoCuePoint', id: number, cuePointTypeKey: string, timeInSeconds: number, value?: string | null }> }, videoStreams: { __typename?: 'MovieVideoStreamsConnection', nodes: Array<{ __typename?: 'MovieVideoStream', label?: string | null, format?: string | null, frameRate?: number | null, languageCode?: string | null, bitrateInKbps?: number | null, displayAspectRatio?: string | null, pixelAspectRatio?: string | null, samplingRate?: number | null, fileTemplate?: string | null, id: number, iv?: string | null, keyId?: string | null, type?: VideoStreamType | null, codecs?: string | null, height?: number | null, width?: number | null }> } }> } }> } | null, tvshows?: { __typename?: 'TvshowsConnection', nodes: Array<{ __typename?: 'Tvshow', id: string, originalTitle?: string | null, studio?: string | null, released?: any | null, cast?: Array<string | null> | null, productionCountries?: Array<string | null> | null, tags?: Array<string | null> | null, title?: string | null, description?: string | null, synopsis?: string | null, genres: { __typename?: 'TvshowGenresRelationsConnection', nodes: Array<{ __typename?: 'TvshowGenresRelation', tvshowGenre?: { __typename?: 'TvshowGenre', id: string, title?: string | null } | null }> }, images: { __typename?: 'TvshowImagesConnection', nodes: Array<{ __typename?: 'TvshowImage', id: number, type?: string | null, width?: number | null, height?: number | null, path?: string | null, altText?: string | null }> }, licenses: { __typename?: 'TvshowLicensesConnection', nodes: Array<{ __typename?: 'TvshowLicense', countries?: Array<string | null> | null, startTime?: any | null, endTime?: any | null }> }, videos: { __typename?: 'TvshowVideosConnection', nodes: Array<{ __typename?: 'TvshowVideo', id: number, type?: string | null, title?: string | null, dashManifest?: string | null, hlsManifest?: string | null, audioLanguages?: Array<string | null> | null, subtitleLanguages?: Array<string | null> | null, outputFormat?: string | null, lengthInSeconds?: number | null, captionLanguages?: Array<string | null> | null, isProtected?: boolean | null, cuePoints: { __typename?: 'TvshowVideoCuePointsConnection', nodes: Array<{ __typename?: 'TvshowVideoCuePoint', id: number, cuePointTypeKey: string, timeInSeconds: number, value?: string | null }> }, videoStreams: { __typename?: 'TvshowVideoStreamsConnection', nodes: Array<{ __typename?: 'TvshowVideoStream', label?: string | null, format?: string | null, frameRate?: number | null, languageCode?: string | null, bitrateInKbps?: number | null, displayAspectRatio?: string | null, pixelAspectRatio?: string | null, samplingRate?: number | null, fileTemplate?: string | null, id: number, iv?: string | null, keyId?: string | null, type?: VideoStreamType | null, codecs?: string | null, height?: number | null, width?: number | null }> } }> }, seasons: { __typename?: 'SeasonsConnection', nodes: Array<{ __typename?: 'Season', id: string, index?: number | null, synopsis?: string | null, episodes: { __typename?: 'EpisodesConnection', nodes: Array<{ __typename?: 'Episode', id: string, index?: number | null, originalTitle?: string | null, studio?: string | null, released?: any | null, cast?: Array<string | null> | null, productionCountries?: Array<string | null> | null, tags?: Array<string | null> | null, title?: string | null, description?: string | null, synopsis?: string | null, season?: { __typename?: 'Season', tvshowId?: string | null } | null, genres: { __typename?: 'EpisodeGenresRelationsConnection', nodes: Array<{ __typename?: 'EpisodeGenresRelation', tvshowGenre?: { __typename?: 'TvshowGenre', id: string, title?: string | null } | null }> }, images: { __typename?: 'EpisodeImagesConnection', nodes: Array<{ __typename?: 'EpisodeImage', id: number, type?: string | null, width?: number | null, height?: number | null, path?: string | null, altText?: string | null }> }, licenses: { __typename?: 'EpisodeLicensesConnection', nodes: Array<{ __typename?: 'EpisodeLicense', countries?: Array<string | null> | null, startTime?: any | null, endTime?: any | null }> }, videos: { __typename?: 'EpisodeVideosConnection', nodes: Array<{ __typename?: 'EpisodeVideo', id: number, type?: string | null, title?: string | null, dashManifest?: string | null, hlsManifest?: string | null, audioLanguages?: Array<string | null> | null, subtitleLanguages?: Array<string | null> | null, outputFormat?: string | null, lengthInSeconds?: number | null, captionLanguages?: Array<string | null> | null, isProtected?: boolean | null, cuePoints: { __typename?: 'EpisodeVideoCuePointsConnection', nodes: Array<{ __typename?: 'EpisodeVideoCuePoint', id: number, cuePointTypeKey: string, timeInSeconds: number, value?: string | null }> }, videoStreams: { __typename?: 'EpisodeVideoStreamsConnection', nodes: Array<{ __typename?: 'EpisodeVideoStream', label?: string | null, format?: string | null, frameRate?: number | null, languageCode?: string | null, bitrateInKbps?: number | null, displayAspectRatio?: string | null, pixelAspectRatio?: string | null, samplingRate?: number | null, fileTemplate?: string | null, id: number, iv?: string | null, keyId?: string | null, type?: VideoStreamType | null, codecs?: string | null, height?: number | null, width?: number | null }> } }> } }> } }> } }> } | null, seasons?: { __typename?: 'SeasonsConnection', nodes: Array<{ __typename?: 'Season', id: string, index?: number | null, studio?: string | null, released?: any | null, cast?: Array<string | null> | null, productionCountries?: Array<string | null> | null, tags?: Array<string | null> | null, description?: string | null, synopsis?: string | null, genres: { __typename?: 'SeasonGenresRelationsConnection', nodes: Array<{ __typename?: 'SeasonGenresRelation', tvshowGenre?: { __typename?: 'TvshowGenre', id: string, title?: string | null } | null }> }, images: { __typename?: 'SeasonImagesConnection', nodes: Array<{ __typename?: 'SeasonImage', id: number, type?: string | null, width?: number | null, height?: number | null, path?: string | null, altText?: string | null }> }, licenses: { __typename?: 'SeasonLicensesConnection', nodes: Array<{ __typename?: 'SeasonLicense', countries?: Array<string | null> | null, startTime?: any | null, endTime?: any | null }> }, videos: { __typename?: 'SeasonVideosConnection', nodes: Array<{ __typename?: 'SeasonVideo', id: number, type?: string | null, title?: string | null, dashManifest?: string | null, hlsManifest?: string | null, audioLanguages?: Array<string | null> | null, subtitleLanguages?: Array<string | null> | null, outputFormat?: string | null, lengthInSeconds?: number | null, captionLanguages?: Array<string | null> | null, isProtected?: boolean | null, cuePoints: { __typename?: 'SeasonVideoCuePointsConnection', nodes: Array<{ __typename?: 'SeasonVideoCuePoint', id: number, cuePointTypeKey: string, timeInSeconds: number, value?: string | null }> }, videoStreams: { __typename?: 'SeasonVideoStreamsConnection', nodes: Array<{ __typename?: 'SeasonVideoStream', label?: string | null, format?: string | null, frameRate?: number | null, languageCode?: string | null, bitrateInKbps?: number | null, displayAspectRatio?: string | null, pixelAspectRatio?: string | null, samplingRate?: number | null, fileTemplate?: string | null, id: number, iv?: string | null, keyId?: string | null, type?: VideoStreamType | null, codecs?: string | null, height?: number | null, width?: number | null }> } }> } }> } | null, episodes?: { __typename?: 'EpisodesConnection', nodes: Array<{ __typename?: 'Episode', id: string, index?: number | null, originalTitle?: string | null, studio?: string | null, released?: any | null, cast?: Array<string | null> | null, productionCountries?: Array<string | null> | null, tags?: Array<string | null> | null, title?: string | null, description?: string | null, synopsis?: string | null, season?: { __typename?: 'Season', id: string, index?: number | null, tvshowId?: string | null } | null, genres: { __typename?: 'EpisodeGenresRelationsConnection', nodes: Array<{ __typename?: 'EpisodeGenresRelation', tvshowGenre?: { __typename?: 'TvshowGenre', id: string, title?: string | null } | null }> }, images: { __typename?: 'EpisodeImagesConnection', nodes: Array<{ __typename?: 'EpisodeImage', id: number, type?: string | null, width?: number | null, height?: number | null, path?: string | null, altText?: string | null }> }, licenses: { __typename?: 'EpisodeLicensesConnection', nodes: Array<{ __typename?: 'EpisodeLicense', countries?: Array<string | null> | null, startTime?: any | null, endTime?: any | null }> }, videos: { __typename?: 'EpisodeVideosConnection', nodes: Array<{ __typename?: 'EpisodeVideo', id: number, type?: string | null, title?: string | null, dashManifest?: string | null, hlsManifest?: string | null, audioLanguages?: Array<string | null> | null, subtitleLanguages?: Array<string | null> | null, outputFormat?: string | null, lengthInSeconds?: number | null, captionLanguages?: Array<string | null> | null, isProtected?: boolean | null, cuePoints: { __typename?: 'EpisodeVideoCuePointsConnection', nodes: Array<{ __typename?: 'EpisodeVideoCuePoint', id: number, cuePointTypeKey: string, timeInSeconds: number, value?: string | null }> }, videoStreams: { __typename?: 'EpisodeVideoStreamsConnection', nodes: Array<{ __typename?: 'EpisodeVideoStream', label?: string | null, format?: string | null, frameRate?: number | null, languageCode?: string | null, bitrateInKbps?: number | null, displayAspectRatio?: string | null, pixelAspectRatio?: string | null, samplingRate?: number | null, fileTemplate?: string | null, id: number, iv?: string | null, keyId?: string | null, type?: VideoStreamType | null, codecs?: string | null, height?: number | null, width?: number | null }> } }> } }> } | null, channels?: { __typename?: 'ChannelsConnection', nodes: Array<{ __typename?: 'Channel', id: string, title?: string | null, hlsStreamUrl?: string | null, description?: string | null, dashStreamUrl?: string | null, images: { __typename?: 'ChannelImagesConnection', nodes: Array<{ __typename?: 'ChannelImage', id: number, path?: string | null, type?: string | null }> } }> } | null };\n\n\nexport const KeywordSearchDocument = gql`\n    query KeywordSearch($keyword: String!) {\n  movies(filter: {title: {includesInsensitive: $keyword}}) {\n    nodes {\n      id\n      originalTitle\n      studio\n      released\n      cast\n      productionCountries\n      tags\n      title\n      description\n      synopsis\n      genres {\n        nodes {\n          movieGenre {\n            id\n            title\n          }\n        }\n      }\n      images {\n        nodes {\n          id\n          type\n          width\n          height\n          path\n          altText\n        }\n      }\n      licenses {\n        nodes {\n          countries\n          startTime\n          endTime\n        }\n      }\n      videos {\n        nodes {\n          id\n          type\n          title\n          dashManifest\n          hlsManifest\n          audioLanguages\n          subtitleLanguages\n          outputFormat\n          lengthInSeconds\n          captionLanguages\n          isProtected\n          cuePoints {\n            nodes {\n              id\n              cuePointTypeKey\n              timeInSeconds\n              value\n            }\n          }\n          videoStreams {\n            nodes {\n              label\n              format\n              frameRate\n              languageCode\n              bitrateInKbps\n              displayAspectRatio\n              pixelAspectRatio\n              samplingRate\n              fileTemplate\n              bitrateInKbps\n              id\n              iv\n              keyId\n              type\n              fileTemplate\n              codecs\n              height\n              width\n              displayAspectRatio\n            }\n          }\n        }\n      }\n    }\n  }\n  episodes(filter: {title: {includesInsensitive: $keyword}}) {\n    nodes {\n      id\n      index\n      originalTitle\n      studio\n      released\n      cast\n      productionCountries\n      tags\n      title\n      description\n      synopsis\n      genres {\n        nodes {\n          tvshowGenre {\n            id\n            title\n          }\n        }\n      }\n      images {\n        nodes {\n          id\n          type\n          width\n          height\n          path\n          altText\n        }\n      }\n      licenses {\n        nodes {\n          countries\n          startTime\n          endTime\n        }\n      }\n      videos {\n        nodes {\n          id\n          type\n          title\n          dashManifest\n          hlsManifest\n          audioLanguages\n          subtitleLanguages\n          outputFormat\n          lengthInSeconds\n          captionLanguages\n          isProtected\n          cuePoints {\n            nodes {\n              id\n              cuePointTypeKey\n              timeInSeconds\n              value\n            }\n          }\n          videoStreams {\n            nodes {\n              label\n              format\n              frameRate\n              languageCode\n              bitrateInKbps\n              displayAspectRatio\n              pixelAspectRatio\n              samplingRate\n              fileTemplate\n              bitrateInKbps\n              id\n              iv\n              keyId\n              type\n              fileTemplate\n              codecs\n              height\n              width\n              displayAspectRatio\n            }\n          }\n        }\n      }\n    }\n  }\n  tvshows(filter: {title: {includesInsensitive: $keyword}}) {\n    nodes {\n      id\n      originalTitle\n      studio\n      released\n      cast\n      productionCountries\n      tags\n      title\n      description\n      synopsis\n      genres {\n        nodes {\n          tvshowGenre {\n            id\n            title\n          }\n        }\n      }\n      images {\n        nodes {\n          id\n          type\n          width\n          height\n          path\n          altText\n        }\n      }\n      licenses {\n        nodes {\n          countries\n          startTime\n          endTime\n        }\n      }\n      videos {\n        nodes {\n          id\n          type\n          title\n          dashManifest\n          hlsManifest\n          audioLanguages\n          subtitleLanguages\n          outputFormat\n          lengthInSeconds\n          captionLanguages\n          isProtected\n          cuePoints {\n            nodes {\n              id\n              cuePointTypeKey\n              timeInSeconds\n              value\n            }\n          }\n          videoStreams {\n            nodes {\n              label\n              format\n              frameRate\n              languageCode\n              bitrateInKbps\n              displayAspectRatio\n              pixelAspectRatio\n              samplingRate\n              fileTemplate\n              bitrateInKbps\n              id\n              iv\n              keyId\n              type\n              fileTemplate\n              codecs\n              height\n              width\n              displayAspectRatio\n            }\n          }\n        }\n      }\n    }\n  }\n}\n    `;\n\n/**\n * __useKeywordSearchQuery__\n *\n * To run a query within a React component, call `useKeywordSearchQuery` and pass it any options that fit your needs.\n * When your component renders, `useKeywordSearchQuery` returns an object from Apollo Client that contains loading, error, and data properties\n * you can use to render your UI.\n *\n * @param baseOptions options that will be passed into the query, supported options are listed on: https://www.apollographql.com/docs/react/api/react-hooks/#options;\n *\n * @example\n * const { data, loading, error } = useKeywordSearchQuery({\n *   variables: {\n *      keyword: // value for 'keyword'\n *   },\n * });\n */\nexport function useKeywordSearchQuery(baseOptions: Apollo.QueryHookOptions<KeywordSearchQuery, KeywordSearchQueryVariables> & ({ variables: KeywordSearchQueryVariables; skip?: boolean; } | { skip: boolean; }) ) {\n        const options = {...defaultOptions, ...baseOptions}\n        return Apollo.useQuery<KeywordSearchQuery, KeywordSearchQueryVariables>(KeywordSearchDocument, options);\n      }\nexport function useKeywordSearchLazyQuery(baseOptions?: Apollo.LazyQueryHookOptions<KeywordSearchQuery, KeywordSearchQueryVariables>) {\n          const options = {...defaultOptions, ...baseOptions}\n          return Apollo.useLazyQuery<KeywordSearchQuery, KeywordSearchQueryVariables>(KeywordSearchDocument, options);\n        }\nexport function useKeywordSearchSuspenseQuery(baseOptions?: Apollo.SkipToken | Apollo.SuspenseQueryHookOptions<KeywordSearchQuery, KeywordSearchQueryVariables>) {\n          const options = baseOptions === Apollo.skipToken ? baseOptions : {...defaultOptions, ...baseOptions}\n          return Apollo.useSuspenseQuery<KeywordSearchQuery, KeywordSearchQueryVariables>(KeywordSearchDocument, options);\n        }\nexport type KeywordSearchQueryHookResult = ReturnType<typeof useKeywordSearchQuery>;\nexport type KeywordSearchLazyQueryHookResult = ReturnType<typeof useKeywordSearchLazyQuery>;\nexport type KeywordSearchSuspenseQueryHookResult = ReturnType<typeof useKeywordSearchSuspenseQuery>;\nexport type KeywordSearchQueryResult = Apollo.QueryResult<KeywordSearchQuery, KeywordSearchQueryVariables>;\nexport const GetAllChannelsDocument = gql`\n    query GetAllChannels {\n  channels {\n    nodes {\n      id\n      title\n      description\n      dashStreamUrl\n      hlsStreamUrl\n      keyId\n      playlists {\n        nodes {\n          id\n          startDateTime\n          endDateTime\n          programs(orderBy: SORT_INDEX_ASC) {\n            nodes {\n              id\n              sortIndex\n              title\n              movie {\n                title\n              }\n              episode {\n                title\n              }\n              id\n            }\n          }\n        }\n      }\n    }\n  }\n}\n    `;\n\n/**\n * __useGetAllChannelsQuery__\n *\n * To run a query within a React component, call `useGetAllChannelsQuery` and pass it any options that fit your needs.\n * When your component renders, `useGetAllChannelsQuery` returns an object from Apollo Client that contains loading, error, and data properties\n * you can use to render your UI.\n *\n * @param baseOptions options that will be passed into the query, supported options are listed on: https://www.apollographql.com/docs/react/api/react-hooks/#options;\n *\n * @example\n * const { data, loading, error } = useGetAllChannelsQuery({\n *   variables: {\n *   },\n * });\n */\nexport function useGetAllChannelsQuery(baseOptions?: Apollo.QueryHookOptions<GetAllChannelsQuery, GetAllChannelsQueryVariables>) {\n        const options = {...defaultOptions, ...baseOptions}\n        return Apollo.useQuery<GetAllChannelsQuery, GetAllChannelsQueryVariables>(GetAllChannelsDocument, options);\n      }\nexport function useGetAllChannelsLazyQuery(baseOptions?: Apollo.LazyQueryHookOptions<GetAllChannelsQuery, GetAllChannelsQueryVariables>) {\n          const options = {...defaultOptions, ...baseOptions}\n          return Apollo.useLazyQuery<GetAllChannelsQuery, GetAllChannelsQueryVariables>(GetAllChannelsDocument, options);\n        }\nexport function useGetAllChannelsSuspenseQuery(baseOptions?: Apollo.SkipToken | Apollo.SuspenseQueryHookOptions<GetAllChannelsQuery, GetAllChannelsQueryVariables>) {\n          const options = baseOptions === Apollo.skipToken ? baseOptions : {...defaultOptions, ...baseOptions}\n          return Apollo.useSuspenseQuery<GetAllChannelsQuery, GetAllChannelsQueryVariables>(GetAllChannelsDocument, options);\n        }\nexport type GetAllChannelsQueryHookResult = ReturnType<typeof useGetAllChannelsQuery>;\nexport type GetAllChannelsLazyQueryHookResult = ReturnType<typeof useGetAllChannelsLazyQuery>;\nexport type GetAllChannelsSuspenseQueryHookResult = ReturnType<typeof useGetAllChannelsSuspenseQuery>;\nexport type GetAllChannelsQueryResult = Apollo.QueryResult<GetAllChannelsQuery, GetAllChannelsQueryVariables>;\nexport const GetItemDocument = gql`\n    query GetItem($id: String!) {\n  movie(id: $id) {\n    id\n    originalTitle\n    studio\n    released\n    cast\n    productionCountries\n    tags\n    title\n    description\n    synopsis\n    genres {\n      nodes {\n        movieGenre {\n          id\n          title\n        }\n      }\n    }\n    images {\n      nodes {\n        id\n        type\n        width\n        height\n        path\n        altText\n      }\n    }\n    licenses {\n      nodes {\n        countries\n        startTime\n        endTime\n      }\n    }\n    videos {\n      nodes {\n        id\n        type\n        title\n        dashManifest\n        hlsManifest\n        audioLanguages\n        subtitleLanguages\n        outputFormat\n        lengthInSeconds\n        captionLanguages\n        isProtected\n        cuePoints {\n          nodes {\n            id\n            cuePointTypeKey\n            timeInSeconds\n            value\n          }\n        }\n        videoStreams {\n          nodes {\n            label\n            format\n            frameRate\n            languageCode\n            bitrateInKbps\n            displayAspectRatio\n            pixelAspectRatio\n            samplingRate\n            fileTemplate\n            bitrateInKbps\n            id\n            iv\n            keyId\n            type\n            fileTemplate\n            codecs\n            height\n            width\n            displayAspectRatio\n          }\n        }\n      }\n    }\n  }\n  tvshow(id: $id) {\n    id\n    originalTitle\n    studio\n    released\n    cast\n    productionCountries\n    tags\n    title\n    description\n    synopsis\n    genres {\n      nodes {\n        tvshowGenre {\n          id\n          title\n        }\n      }\n    }\n    images {\n      nodes {\n        id\n        type\n        width\n        height\n        path\n        altText\n      }\n    }\n    licenses {\n      nodes {\n        countries\n        startTime\n        endTime\n      }\n    }\n    videos {\n      nodes {\n        id\n        type\n        title\n        dashManifest\n        hlsManifest\n        audioLanguages\n        subtitleLanguages\n        outputFormat\n        lengthInSeconds\n        captionLanguages\n        isProtected\n        cuePoints {\n          nodes {\n            id\n            cuePointTypeKey\n            timeInSeconds\n            value\n          }\n        }\n        videoStreams {\n          nodes {\n            label\n            format\n            frameRate\n            languageCode\n            bitrateInKbps\n            displayAspectRatio\n            pixelAspectRatio\n            samplingRate\n            fileTemplate\n            bitrateInKbps\n            id\n            iv\n            keyId\n            type\n            fileTemplate\n            codecs\n            height\n            width\n            displayAspectRatio\n          }\n        }\n      }\n    }\n    seasons {\n      nodes {\n        id\n        index\n        synopsis\n        episodes {\n          nodes {\n            id\n            index\n            originalTitle\n            studio\n            released\n            cast\n            productionCountries\n            tags\n            title\n            description\n            synopsis\n            season {\n              tvshowId\n            }\n            genres {\n              nodes {\n                tvshowGenre {\n                  id\n                  title\n                }\n              }\n            }\n            images {\n              nodes {\n                id\n                type\n                width\n                height\n                path\n                altText\n              }\n            }\n            licenses {\n              nodes {\n                countries\n                startTime\n                endTime\n              }\n            }\n            videos {\n              nodes {\n                id\n                type\n                title\n                dashManifest\n                hlsManifest\n                audioLanguages\n                subtitleLanguages\n                outputFormat\n                lengthInSeconds\n                captionLanguages\n                isProtected\n                cuePoints {\n                  nodes {\n                    id\n                    cuePointTypeKey\n                    timeInSeconds\n                    value\n                  }\n                }\n                videoStreams {\n                  nodes {\n                    label\n                    format\n                    frameRate\n                    languageCode\n                    bitrateInKbps\n                    displayAspectRatio\n                    pixelAspectRatio\n                    samplingRate\n                    fileTemplate\n                    bitrateInKbps\n                    id\n                    iv\n                    keyId\n                    type\n                    fileTemplate\n                    codecs\n                    height\n                    width\n                    displayAspectRatio\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n  season(id: $id) {\n    id\n    index\n    studio\n    released\n    cast\n    productionCountries\n    tags\n    description\n    synopsis\n    genres {\n      nodes {\n        tvshowGenre {\n          id\n          title\n        }\n      }\n    }\n    images {\n      nodes {\n        id\n        type\n        width\n        height\n        path\n        altText\n      }\n    }\n    licenses {\n      nodes {\n        countries\n        startTime\n        endTime\n      }\n    }\n    videos {\n      nodes {\n        id\n        type\n        title\n        dashManifest\n        hlsManifest\n        audioLanguages\n        subtitleLanguages\n        outputFormat\n        lengthInSeconds\n        captionLanguages\n        isProtected\n        cuePoints {\n          nodes {\n            id\n            cuePointTypeKey\n            timeInSeconds\n            value\n          }\n        }\n        videoStreams {\n          nodes {\n            label\n            format\n            frameRate\n            languageCode\n            bitrateInKbps\n            displayAspectRatio\n            pixelAspectRatio\n            samplingRate\n            fileTemplate\n            bitrateInKbps\n            id\n            iv\n            keyId\n            type\n            fileTemplate\n            codecs\n            height\n            width\n            displayAspectRatio\n          }\n        }\n      }\n    }\n  }\n  episode(id: $id) {\n    id\n    index\n    originalTitle\n    studio\n    released\n    cast\n    productionCountries\n    tags\n    title\n    description\n    synopsis\n    season {\n      id\n      index\n      tvshowId\n    }\n    genres {\n      nodes {\n        tvshowGenre {\n          id\n          title\n        }\n      }\n    }\n    images {\n      nodes {\n        id\n        type\n        width\n        height\n        path\n        altText\n      }\n    }\n    licenses {\n      nodes {\n        countries\n        startTime\n        endTime\n      }\n    }\n    videos {\n      nodes {\n        id\n        type\n        title\n        dashManifest\n        hlsManifest\n        audioLanguages\n        subtitleLanguages\n        outputFormat\n        lengthInSeconds\n        captionLanguages\n        isProtected\n        cuePoints {\n          nodes {\n            id\n            cuePointTypeKey\n            timeInSeconds\n            value\n          }\n        }\n        videoStreams {\n          nodes {\n            label\n            format\n            frameRate\n            languageCode\n            bitrateInKbps\n            displayAspectRatio\n            pixelAspectRatio\n            samplingRate\n            fileTemplate\n            bitrateInKbps\n            id\n            iv\n            keyId\n            type\n            fileTemplate\n            codecs\n            height\n            width\n            displayAspectRatio\n          }\n        }\n      }\n    }\n  }\n  channel(id: $id) {\n    id\n    title\n    hlsStreamUrl\n    description\n    dashStreamUrl\n    images {\n      nodes {\n        id\n        path\n        type\n      }\n    }\n  }\n}\n    `;\n\n/**\n * __useGetItemQuery__\n *\n * To run a query within a React component, call `useGetItemQuery` and pass it any options that fit your needs.\n * When your component renders, `useGetItemQuery` returns an object from Apollo Client that contains loading, error, and data properties\n * you can use to render your UI.\n *\n * @param baseOptions options that will be passed into the query, supported options are listed on: https://www.apollographql.com/docs/react/api/react-hooks/#options;\n *\n * @example\n * const { data, loading, error } = useGetItemQuery({\n *   variables: {\n *      id: // value for 'id'\n *   },\n * });\n */\nexport function useGetItemQuery(baseOptions: Apollo.QueryHookOptions<GetItemQuery, GetItemQueryVariables> & ({ variables: GetItemQueryVariables; skip?: boolean; } | { skip: boolean; }) ) {\n        const options = {...defaultOptions, ...baseOptions}\n        return Apollo.useQuery<GetItemQuery, GetItemQueryVariables>(GetItemDocument, options);\n      }\nexport function useGetItemLazyQuery(baseOptions?: Apollo.LazyQueryHookOptions<GetItemQuery, GetItemQueryVariables>) {\n          const options = {...defaultOptions, ...baseOptions}\n          return Apollo.useLazyQuery<GetItemQuery, GetItemQueryVariables>(GetItemDocument, options);\n        }\nexport function useGetItemSuspenseQuery(baseOptions?: Apollo.SkipToken | Apollo.SuspenseQueryHookOptions<GetItemQuery, GetItemQueryVariables>) {\n          const options = baseOptions === Apollo.skipToken ? baseOptions : {...defaultOptions, ...baseOptions}\n          return Apollo.useSuspenseQuery<GetItemQuery, GetItemQueryVariables>(GetItemDocument, options);\n        }\nexport type GetItemQueryHookResult = ReturnType<typeof useGetItemQuery>;\nexport type GetItemLazyQueryHookResult = ReturnType<typeof useGetItemLazyQuery>;\nexport type GetItemSuspenseQueryHookResult = ReturnType<typeof useGetItemSuspenseQuery>;\nexport type GetItemQueryResult = Apollo.QueryResult<GetItemQuery, GetItemQueryVariables>;\nexport const GetCollectionDocument = gql`\n    query GetCollection($id: String!) {\n  collection(id: $id) {\n    id\n    title\n    synopsis\n    description\n    items {\n      nodes {\n        id\n        relationType\n        episodeId\n        episode {\n          id\n          index\n          synopsis\n          genres {\n            nodes {\n              tvshowGenre {\n                title\n              }\n            }\n          }\n          cast\n          released\n          tags\n          images {\n            nodes {\n              id\n              type\n              path\n            }\n          }\n          videos {\n            nodes {\n              id\n              dashManifest\n              hlsManifest\n              cuePoints {\n                nodes {\n                  id\n                  cuePointTypeKey\n                  timeInSeconds\n                  value\n                }\n              }\n            }\n          }\n        }\n        seasonId\n        season {\n          id\n          index\n          studio\n          released\n          cast\n          productionCountries\n          tags\n          description\n          synopsis\n          genres {\n            nodes {\n              tvshowGenre {\n                id\n                title\n              }\n            }\n          }\n          images {\n            nodes {\n              id\n              type\n              width\n              height\n              path\n              altText\n            }\n          }\n          licenses {\n            nodes {\n              countries\n              startTime\n              endTime\n            }\n          }\n          videos {\n            nodes {\n              id\n              type\n              title\n              dashManifest\n              hlsManifest\n              audioLanguages\n              subtitleLanguages\n              outputFormat\n              lengthInSeconds\n              captionLanguages\n              isProtected\n              cuePoints {\n                nodes {\n                  id\n                  cuePointTypeKey\n                  timeInSeconds\n                  value\n                }\n              }\n              videoStreams {\n                nodes {\n                  label\n                  format\n                  frameRate\n                  languageCode\n                  bitrateInKbps\n                  displayAspectRatio\n                  pixelAspectRatio\n                  samplingRate\n                  fileTemplate\n                  bitrateInKbps\n                  id\n                  iv\n                  keyId\n                  type\n                  fileTemplate\n                  codecs\n                  height\n                  width\n                  displayAspectRatio\n                }\n              }\n            }\n          }\n        }\n        tvshowId\n        tvshow {\n          id\n          originalTitle\n          studio\n          released\n          cast\n          productionCountries\n          tags\n          title\n          description\n          synopsis\n          genres {\n            nodes {\n              tvshowGenre {\n                id\n                title\n              }\n            }\n          }\n          images {\n            nodes {\n              id\n              type\n              width\n              height\n              path\n              altText\n            }\n          }\n          licenses {\n            nodes {\n              countries\n              startTime\n              endTime\n            }\n          }\n          videos {\n            nodes {\n              id\n              type\n              title\n              dashManifest\n              hlsManifest\n              audioLanguages\n              subtitleLanguages\n              outputFormat\n              lengthInSeconds\n              captionLanguages\n              isProtected\n              cuePoints {\n                nodes {\n                  id\n                  cuePointTypeKey\n                  timeInSeconds\n                  value\n                }\n              }\n              videoStreams {\n                nodes {\n                  label\n                  format\n                  frameRate\n                  languageCode\n                  bitrateInKbps\n                  displayAspectRatio\n                  pixelAspectRatio\n                  samplingRate\n                  fileTemplate\n                  bitrateInKbps\n                  id\n                  iv\n                  keyId\n                  type\n                  fileTemplate\n                  codecs\n                  height\n                  width\n                  displayAspectRatio\n                }\n              }\n            }\n          }\n          seasons {\n            nodes {\n              id\n              index\n              synopsis\n              episodes {\n                nodes {\n                  id\n                  index\n                  title\n                  synopsis\n                }\n              }\n            }\n          }\n        }\n        movieId\n        movie {\n          id\n          originalTitle\n          studio\n          released\n          cast\n          productionCountries\n          tags\n          title\n          description\n          synopsis\n          genres {\n            nodes {\n              movieGenre {\n                id\n                title\n              }\n            }\n          }\n          images {\n            nodes {\n              id\n              type\n              width\n              height\n              path\n              altText\n            }\n          }\n          licenses {\n            nodes {\n              countries\n              startTime\n              endTime\n            }\n          }\n          videos {\n            nodes {\n              id\n              type\n              title\n              dashManifest\n              hlsManifest\n              audioLanguages\n              subtitleLanguages\n              outputFormat\n              lengthInSeconds\n              captionLanguages\n              isProtected\n              cuePoints {\n                nodes {\n                  id\n                  cuePointTypeKey\n                  timeInSeconds\n                  value\n                }\n              }\n              videoStreams {\n                nodes {\n                  label\n                  format\n                  frameRate\n                  languageCode\n                  bitrateInKbps\n                  displayAspectRatio\n                  pixelAspectRatio\n                  samplingRate\n                  fileTemplate\n                  bitrateInKbps\n                  id\n                  iv\n                  keyId\n                  type\n                  fileTemplate\n                  codecs\n                  height\n                  width\n                  displayAspectRatio\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n    `;\n\n/**\n * __useGetCollectionQuery__\n *\n * To run a query within a React component, call `useGetCollectionQuery` and pass it any options that fit your needs.\n * When your component renders, `useGetCollectionQuery` returns an object from Apollo Client that contains loading, error, and data properties\n * you can use to render your UI.\n *\n * @param baseOptions options that will be passed into the query, supported options are listed on: https://www.apollographql.com/docs/react/api/react-hooks/#options;\n *\n * @example\n * const { data, loading, error } = useGetCollectionQuery({\n *   variables: {\n *      id: // value for 'id'\n *   },\n * });\n */\nexport function useGetCollectionQuery(baseOptions: Apollo.QueryHookOptions<GetCollectionQuery, GetCollectionQueryVariables> & ({ variables: GetCollectionQueryVariables; skip?: boolean; } | { skip: boolean; }) ) {\n        const options = {...defaultOptions, ...baseOptions}\n        return Apollo.useQuery<GetCollectionQuery, GetCollectionQueryVariables>(GetCollectionDocument, options);\n      }\nexport function useGetCollectionLazyQuery(baseOptions?: Apollo.LazyQueryHookOptions<GetCollectionQuery, GetCollectionQueryVariables>) {\n          const options = {...defaultOptions, ...baseOptions}\n          return Apollo.useLazyQuery<GetCollectionQuery, GetCollectionQueryVariables>(GetCollectionDocument, options);\n        }\nexport function useGetCollectionSuspenseQuery(baseOptions?: Apollo.SkipToken | Apollo.SuspenseQueryHookOptions<GetCollectionQuery, GetCollectionQueryVariables>) {\n          const options = baseOptions === Apollo.skipToken ? baseOptions : {...defaultOptions, ...baseOptions}\n          return Apollo.useSuspenseQuery<GetCollectionQuery, GetCollectionQueryVariables>(GetCollectionDocument, options);\n        }\nexport type GetCollectionQueryHookResult = ReturnType<typeof useGetCollectionQuery>;\nexport type GetCollectionLazyQueryHookResult = ReturnType<typeof useGetCollectionLazyQuery>;\nexport type GetCollectionSuspenseQueryHookResult = ReturnType<typeof useGetCollectionSuspenseQuery>;\nexport type GetCollectionQueryResult = Apollo.QueryResult<GetCollectionQuery, GetCollectionQueryVariables>;\nexport const GetItemsDocument = gql`\n    query GetItems($ids: [String!]) {\n  movies(filter: {id: {in: $ids}}) {\n    nodes {\n      id\n      originalTitle\n      studio\n      released\n      cast\n      productionCountries\n      tags\n      title\n      description\n      synopsis\n      genres {\n        nodes {\n          movieGenre {\n            id\n            title\n          }\n        }\n      }\n      images {\n        nodes {\n          id\n          type\n          width\n          height\n          path\n          altText\n        }\n      }\n      licenses {\n        nodes {\n          countries\n          startTime\n          endTime\n        }\n      }\n      videos {\n        nodes {\n          id\n          type\n          title\n          dashManifest\n          hlsManifest\n          audioLanguages\n          subtitleLanguages\n          outputFormat\n          lengthInSeconds\n          captionLanguages\n          isProtected\n          cuePoints {\n            nodes {\n              id\n              cuePointTypeKey\n              timeInSeconds\n              value\n            }\n          }\n          videoStreams {\n            nodes {\n              label\n              format\n              frameRate\n              languageCode\n              bitrateInKbps\n              displayAspectRatio\n              pixelAspectRatio\n              samplingRate\n              fileTemplate\n              bitrateInKbps\n              id\n              iv\n              keyId\n              type\n              fileTemplate\n              codecs\n              height\n              width\n              displayAspectRatio\n            }\n          }\n        }\n      }\n    }\n  }\n  tvshows(filter: {id: {in: $ids}}) {\n    nodes {\n      id\n      originalTitle\n      studio\n      released\n      cast\n      productionCountries\n      tags\n      title\n      description\n      synopsis\n      genres {\n        nodes {\n          tvshowGenre {\n            id\n            title\n          }\n        }\n      }\n      images {\n        nodes {\n          id\n          type\n          width\n          height\n          path\n          altText\n        }\n      }\n      licenses {\n        nodes {\n          countries\n          startTime\n          endTime\n        }\n      }\n      videos {\n        nodes {\n          id\n          type\n          title\n          dashManifest\n          hlsManifest\n          audioLanguages\n          subtitleLanguages\n          outputFormat\n          lengthInSeconds\n          captionLanguages\n          isProtected\n          cuePoints {\n            nodes {\n              id\n              cuePointTypeKey\n              timeInSeconds\n              value\n            }\n          }\n          videoStreams {\n            nodes {\n              label\n              format\n              frameRate\n              languageCode\n              bitrateInKbps\n              displayAspectRatio\n              pixelAspectRatio\n              samplingRate\n              fileTemplate\n              bitrateInKbps\n              id\n              iv\n              keyId\n              type\n              fileTemplate\n              codecs\n              height\n              width\n              displayAspectRatio\n            }\n          }\n        }\n      }\n      seasons {\n        nodes {\n          id\n          index\n          synopsis\n          episodes {\n            nodes {\n              id\n              index\n              originalTitle\n              studio\n              released\n              cast\n              productionCountries\n              tags\n              title\n              description\n              synopsis\n              season {\n                tvshowId\n              }\n              genres {\n                nodes {\n                  tvshowGenre {\n                    id\n                    title\n                  }\n                }\n              }\n              images {\n                nodes {\n                  id\n                  type\n                  width\n                  height\n                  path\n                  altText\n                }\n              }\n              licenses {\n                nodes {\n                  countries\n                  startTime\n                  endTime\n                }\n              }\n              videos {\n                nodes {\n                  id\n                  type\n                  title\n                  dashManifest\n                  hlsManifest\n                  audioLanguages\n                  subtitleLanguages\n                  outputFormat\n                  lengthInSeconds\n                  captionLanguages\n                  isProtected\n                  cuePoints {\n                    nodes {\n                      id\n                      cuePointTypeKey\n                      timeInSeconds\n                      value\n                    }\n                  }\n                  videoStreams {\n                    nodes {\n                      label\n                      format\n                      frameRate\n                      languageCode\n                      bitrateInKbps\n                      displayAspectRatio\n                      pixelAspectRatio\n                      samplingRate\n                      fileTemplate\n                      bitrateInKbps\n                      id\n                      iv\n                      keyId\n                      type\n                      fileTemplate\n                      codecs\n                      height\n                      width\n                      displayAspectRatio\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n  seasons(filter: {id: {in: $ids}}) {\n    nodes {\n      id\n      index\n      studio\n      released\n      cast\n      productionCountries\n      tags\n      description\n      synopsis\n      genres {\n        nodes {\n          tvshowGenre {\n            id\n            title\n          }\n        }\n      }\n      images {\n        nodes {\n          id\n          type\n          width\n          height\n          path\n          altText\n        }\n      }\n      licenses {\n        nodes {\n          countries\n          startTime\n          endTime\n        }\n      }\n      videos {\n        nodes {\n          id\n          type\n          title\n          dashManifest\n          hlsManifest\n          audioLanguages\n          subtitleLanguages\n          outputFormat\n          lengthInSeconds\n          captionLanguages\n          isProtected\n          cuePoints {\n            nodes {\n              id\n              cuePointTypeKey\n              timeInSeconds\n              value\n            }\n          }\n          videoStreams {\n            nodes {\n              label\n              format\n              frameRate\n              languageCode\n              bitrateInKbps\n              displayAspectRatio\n              pixelAspectRatio\n              samplingRate\n              fileTemplate\n              bitrateInKbps\n              id\n              iv\n              keyId\n              type\n              fileTemplate\n              codecs\n              height\n              width\n              displayAspectRatio\n            }\n          }\n        }\n      }\n    }\n  }\n  episodes(filter: {id: {in: $ids}}) {\n    nodes {\n      id\n      index\n      originalTitle\n      studio\n      released\n      cast\n      productionCountries\n      tags\n      title\n      description\n      synopsis\n      season {\n        id\n        index\n        tvshowId\n      }\n      genres {\n        nodes {\n          tvshowGenre {\n            id\n            title\n          }\n        }\n      }\n      images {\n        nodes {\n          id\n          type\n          width\n          height\n          path\n          altText\n        }\n      }\n      licenses {\n        nodes {\n          countries\n          startTime\n          endTime\n        }\n      }\n      videos {\n        nodes {\n          id\n          type\n          title\n          dashManifest\n          hlsManifest\n          audioLanguages\n          subtitleLanguages\n          outputFormat\n          lengthInSeconds\n          captionLanguages\n          isProtected\n          cuePoints {\n            nodes {\n              id\n              cuePointTypeKey\n              timeInSeconds\n              value\n            }\n          }\n          videoStreams {\n            nodes {\n              label\n              format\n              frameRate\n              languageCode\n              bitrateInKbps\n              displayAspectRatio\n              pixelAspectRatio\n              samplingRate\n              fileTemplate\n              bitrateInKbps\n              id\n              iv\n              keyId\n              type\n              fileTemplate\n              codecs\n              height\n              width\n              displayAspectRatio\n            }\n          }\n        }\n      }\n    }\n  }\n  channels(filter: {id: {in: $ids}}) {\n    nodes {\n      id\n      title\n      hlsStreamUrl\n      description\n      dashStreamUrl\n      images {\n        nodes {\n          id\n          path\n          type\n        }\n      }\n    }\n  }\n}\n    `;\n\n/**\n * __useGetItemsQuery__\n *\n * To run a query within a React component, call `useGetItemsQuery` and pass it any options that fit your needs.\n * When your component renders, `useGetItemsQuery` returns an object from Apollo Client that contains loading, error, and data properties\n * you can use to render your UI.\n *\n * @param baseOptions options that will be passed into the query, supported options are listed on: https://www.apollographql.com/docs/react/api/react-hooks/#options;\n *\n * @example\n * const { data, loading, error } = useGetItemsQuery({\n *   variables: {\n *      ids: // value for 'ids'\n *   },\n * });\n */\nexport function useGetItemsQuery(baseOptions?: Apollo.QueryHookOptions<GetItemsQuery, GetItemsQueryVariables>) {\n        const options = {...defaultOptions, ...baseOptions}\n        return Apollo.useQuery<GetItemsQuery, GetItemsQueryVariables>(GetItemsDocument, options);\n      }\nexport function useGetItemsLazyQuery(baseOptions?: Apollo.LazyQueryHookOptions<GetItemsQuery, GetItemsQueryVariables>) {\n          const options = {...defaultOptions, ...baseOptions}\n          return Apollo.useLazyQuery<GetItemsQuery, GetItemsQueryVariables>(GetItemsDocument, options);\n        }\nexport function useGetItemsSuspenseQuery(baseOptions?: Apollo.SkipToken | Apollo.SuspenseQueryHookOptions<GetItemsQuery, GetItemsQueryVariables>) {\n          const options = baseOptions === Apollo.skipToken ? baseOptions : {...defaultOptions, ...baseOptions}\n          return Apollo.useSuspenseQuery<GetItemsQuery, GetItemsQueryVariables>(GetItemsDocument, options);\n        }\nexport type GetItemsQueryHookResult = ReturnType<typeof useGetItemsQuery>;\nexport type GetItemsLazyQueryHookResult = ReturnType<typeof useGetItemsLazyQuery>;\nexport type GetItemsSuspenseQueryHookResult = ReturnType<typeof useGetItemsSuspenseQuery>;\nexport type GetItemsQueryResult = Apollo.QueryResult<GetItemsQuery, GetItemsQueryVariables>;","import { injectable } from 'inversify';\nimport ApiService from '@jwp/ott-common/src/services/ApiService';\n\nimport { getDataOrThrow } from '../../../utils/api';\nimport type { GetPlaylistParams, Playlist, PlaylistItem } from '../../../../types/playlist';\nimport type { GetContentSearchParams } from '../../../../types/content-list';\nimport type { AdSchedule } from '../../../../types/ad-schedule';\nimport type { EpisodeInSeries, EpisodesWithPagination, GetSeriesParams, Series } from '../../../../types/series';\nimport env from '../../../env';\n\nimport { getApolloClient } from './apollo-client';\nimport { GetCollectionDocument, GetItemDocument, GetItemsDocument, KeywordSearchDocument } from './types/catalog-service-auto-generated';\nimport type { GetItemQuery, GetItemQueryVariables, GetItemsQuery, GetItemsQueryVariables, GetCollectionQuery, GetCollectionQueryVariables, KeywordSearchQuery, KeywordSearchQueryVariables, Movie, Episode, Tvshow, Season as AxSeason } from './types/catalog-service-auto-generated';\n\nconst PAGE_LIMIT = 20;\nconst CATALOG_API_BASE_URL = \"https://mosaic-ott-catalog.axprod.net/graphql\"\nconst IMAGE_API_BASE_URL = \"https://image.service.eu.axinom.net\"\nconst apolloClient = getApolloClient(CATALOG_API_BASE_URL);\nconst notImplemented = () => {\n  throw new Error(\"Not Implemented\");\n};\n\n@injectable()\nexport default class AxinomApiService extends ApiService {\n  \n  private transformToPlaylistItem = (\n    item: Episode | Movie | Tvshow | AxSeason,\n    contentType: 'movie' | 'episode' | 'series' | 'season',\n    isTrailer?: boolean\n  ): PlaylistItem => {\n\n    const images = (item?.images?.nodes as Array<{ path: string; type: string; width: number }> | undefined)\n    ?.filter(node => node.path)// && node.width)\n    .map(node => ({\n      src: IMAGE_API_BASE_URL + node.path,\n      type: node.type,\n      width: node.width\n    })) ?? [];\n\n    type VideoNode = { \n      hlsManifest: string; \n      dashManifest: string;\n      type: string; \n      lengthInSeconds: number;\n    };\n      \n    const sources = (\n      'videos' in item && Array.isArray(item?.videos?.nodes)\n        ? (item.videos.nodes as VideoNode[]) \n            .filter(node => (node.hlsManifest || node.dashManifest) && (isTrailer ? node.type === \"TRAILER\" : node.type === \"MAIN\"))\n            .map(node => ({\n              file: node.hlsManifest ?? node.dashManifest,\n              type: node.hlsManifest  ? 'application/vnd.apple.mpegurl' : 'application/dash+xml',\n              lengthInSeconds: node.lengthInSeconds\n            }))\n        : []\n    );\n\n    const has_any_trailer = 'videos' in item && Array.isArray(item?.videos?.nodes) ?\n     ((item.videos.nodes as VideoNode[]).find(node => (node.hlsManifest || node.dashManifest) && (node.type === \"TRAILER\")) ?? false) : false;\n \n   const genres = [''];\n   genres.pop();\n   if (contentType == \"movie\") {\n      (item as Movie).genres.nodes.forEach(node => {\n        genres.push(node.movieGenre?.title ?? '?');\n    })    \n  }\n  else if (contentType == \"series\") {\n    (item as Tvshow).genres.nodes.forEach(node => {\n      genres.push(node.tvshowGenre?.title ?? '?');\n  })    \n}\n   \n\n\n    return {\n      description: item?.description ?? '',\n      duration: sources.length > 0 ? sources[0]?.lengthInSeconds ?? 0 : 0,\n      feedid: 'na',     \n      genre: genres.join(',  '),\n      image: '',\n      link: '',\n      mediaid: item?.id,\n      pubdate: 0,\n      tags:  genres.join(','), \n      title: 'index' in item && contentType === 'season' ? item.index?.toString() ?? '' : ('title' in item ? (item.title ?? '') : ''),\n      contentType,\n      cardImage: images.find(p => p.type === \"COVER\")?.src || '/404.png',\n      backgroundImage: images.find(p => p.type === \"TEASER\")?.src || '/404.png',\n      images,\n      sources,      \n      ...(contentType === 'movie' && has_any_trailer && { trailerId: \"TRAILER_\" + item?.id }), \n      cast: item?.cast,\n      genres: genres.filter(genre => genre != 'Action') // a bit misued genre in axinom samples\n    };\n  };\n\n  tranformEpisodeToPlayListItem = (episode: Episode) => {\n    return this.transformToPlaylistItem(episode, 'episode');\n  };\n\n  tranformMovieToPlayListItem = (movie: Movie, isTrailer?: boolean) => {\n    return this.transformToPlaylistItem(movie, 'movie', isTrailer);\n  };\n\n  tranformSeasonToPlayListItem = (season: AxSeason) => {\n    return this.transformToPlaylistItem(season, 'season');\n  };\n\n  tranformTvShowToPlayListItem = (tvshow: Tvshow) => {\n    return this.transformToPlaylistItem(tvshow, 'series');\n  };\n\n  transformAxinomMediaItem = (query_result: GetItemQuery, isTrailer?: boolean) => {\n    if (query_result.movie) {\n      return this.tranformMovieToPlayListItem(query_result.movie as Movie, isTrailer);\n    } else if (query_result.episode) {\n      return this.tranformEpisodeToPlayListItem(query_result.episode as Episode);\n    } else if (query_result.tvshow) {\n      return this.tranformTvShowToPlayListItem(query_result.tvshow as Tvshow);\n    } else if (query_result.season) {\n      return this.tranformSeasonToPlayListItem(query_result.season as AxSeason);\n    }\n    return {\n      title: \"not found\"\n    };\n  };\n\n  /**\n   * Get watchlist by playlistId\n   */\n  getMediaByWatchlist = async ({\n    playlistId,\n    mediaIds,\n    token,\n    language,\n  }: {\n    playlistId: string;\n    mediaIds: string[];\n    token?: string;\n    language?: string;\n  }): Promise<PlaylistItem[] | undefined> => {\n    if (!mediaIds?.length) {\n      return [];\n    }\n    return notImplemented();    \n  };\n\n  /**\n   * Get media by id\n   */\n  getMediaById = async ({\n    id,\n    token,\n    drmPolicyId,\n    language,\n  }: {\n    id: string;\n    token?: string;\n    drmPolicyId?: string;\n    language?: string;\n  }): Promise<PlaylistItem | undefined> => {\n        \n    const result = await apolloClient.query<GetItemQuery, GetItemQueryVariables>({\n      context: { headers: language ? { 'mosaic-locale': language, } : undefined, },\n      query: GetItemDocument,\n      variables: { id: id.replace(\"TRAILER_\",'') },\n      fetchPolicy: 'no-cache',\n    });\n\n    if (result.errors) {      \n      throw new Error('MediaItem not found');\n    }        \n    const transformedMediaItemAxinom = this.transformAxinomMediaItem(result.data, id.startsWith(\"TRAILER_\"));\n    return transformedMediaItemAxinom as PlaylistItem;\n  };\n\n  /**\n   * Get media by id with passport\n   * Axinom: Not supported (yet), the function passed the id to getMediaById\n   */\n  getMediaByIdWithPassport = async ({\n    id,\n    siteId,\n    planId,\n    passport,\n    language,\n  }: {\n    id: string;\n    siteId: string;\n    planId: string;\n    passport: string;\n    language?: string;\n  }): Promise<PlaylistItem | undefined> => {            \n    return await this.getMediaById({id: id, token: undefined, drmPolicyId: undefined, language: language ?? undefined});\n  };\n\n  /**\n   * Get series by id\n   * @param {string} id\n   * @param params\n   */\n  getSeries = async (id: string, params: GetSeriesParams = {}): Promise<Series | undefined> => {\n    if (!id) {\n      throw new Error('Series ID is required');\n    }\n\n    const result = await apolloClient.query<GetItemQuery, GetItemQueryVariables>({\n      query: GetItemDocument,\n      variables: { id },\n      fetchPolicy: 'no-cache',\n    });\n\n    const tvshow = result?.data?.tvshow;\n    if (!tvshow) return undefined;\n\n    const seasons = tvshow.seasons?.nodes\n      ?.filter(season => !params.season || season.index === params.season)\n      .map(season => {\n        const seasonDuration = season.episodes?.nodes?.reduce((duration, episode) => {\n          const video = episode.videos?.nodes?.find(v => v.type === 'MAIN');\n          return duration + (video?.lengthInSeconds ?? 0);\n        }, 0) ?? 0;\n\n        return {\n          season_id: season.id,\n          season_number: season.index ?? 1,\n          season_title: `Season ${season.index ?? 1}`,\n          season_description: season.synopsis ?? '',\n          episode_count: season.episodes?.nodes?.length ?? 0,\n          total_duration: seasonDuration,\n        };\n      }) ?? [];\n\n    const episodeCount = seasons.reduce((count, season) => count + (season.episode_count ?? 0), 0);\n    const totalDuration = seasons.reduce((total, season) => total + (season.total_duration ?? 0), 0);\n\n    return {\n      series_id: tvshow.id,\n      episode_count: episodeCount,\n      season_count: seasons.length,\n      total_duration: totalDuration,\n      seasons,\n    };\n  };\n\n  /**\n   * Get all series for the given media_ids\n   */\n  getSeriesByMediaIds = async (mediaIds: string[]): Promise<Record<string, EpisodeInSeries[]> | undefined> => {    \n    const result = await apolloClient.query<GetItemsQuery, GetItemsQueryVariables>({\n      query: GetItemsDocument,\n      variables: { ids: mediaIds },\n      fetchPolicy: 'no-cache',\n    });\n    \n    const createMediaObject = (entity : Record<string, EpisodeInSeries[]>,  id: string, series_id: string, season_number: number, episode_number: number) => {      \n        entity[id] = [\n          {\n            series_id: series_id,\n            episode_number: episode_number,\n            season_number: season_number,\n          } as EpisodeInSeries,\n        ]    \n    };\n\n    const media_object: Record<string, EpisodeInSeries[]> | undefined = {};\n    result.data.episodes?.nodes.forEach(episode=> {\n      createMediaObject(media_object,\n        episode.id,\n        episode.season?.tvshowId ?? '', \n        episode?.season?.index ?? 0, \n        episode?.index ?? 0);        \n      }\n    );\n    return media_object;\n  }\n\n  /**\n   * Get all episodes of the selected series (when no particular season is selected or when episodes are attached to series)\n   * Problem: Axinom Mosaic does not have paged episodes per serie .. we have to download entire serie and then kind of mock the paging :/\n   */\n  getEpisodes = async ({\n    seriesId,\n    pageOffset,\n    pageLimit = PAGE_LIMIT,\n    afterId,\n    language,\n  }: {\n    seriesId: string | undefined;\n    pageOffset?: number;\n    pageLimit?: number;\n    afterId?: string;\n    language?: string;\n  }): Promise<EpisodesWithPagination> => {\n    if (!seriesId) {\n      throw new Error('Series ID is required');\n    }\n\n    const result = await apolloClient.query<GetItemQuery, GetItemQueryVariables>({\n      context: { headers: language ? { 'mosaic-locale': language, } : undefined, },\n      query: GetItemDocument,      \n      variables: { id: seriesId },\n      fetchPolicy: 'no-cache',\n    });\n\n    if (result.errors) {      \n      throw new Error('MediaItem not found');\n    }    \n    const serie = result.data?.tvshow;\n    \n    const episodes: PlaylistItem[] = [];\n    serie?.seasons.nodes.forEach(season => {\n      season.episodes.nodes.forEach(season_episode => { \n        if (season_episode!= null) {\n            const item = {\n            ...this.tranformEpisodeToPlayListItem(season_episode as Episode),\n            seasonNumber: season?.index?.toString() ?? '',\n            episodeNumber: season_episode?.index?.toString() ?? ''\n            } as PlaylistItem;\n            episodes.push(item);\n        }\n      });\n    });\n    \n const totalEpisodes = episodes.length ?? 1;\n const totalPages = Math.max(1, Math.ceil(totalEpisodes / pageLimit));\n const currentOffset = Math.min((pageOffset ?? 0 + 1), totalPages); \n const startIndex = (currentOffset - 1) * pageLimit;\n const endIndex = Math.min(startIndex + pageLimit, totalEpisodes);\n const filtered_episodes = episodes.slice(startIndex, endIndex);\n\n  const pagination = { \n    page: (pageOffset ?? 0) + 1,\n    page_limit: pageLimit,\n    total: totalEpisodes\n   };\n\n    return {\n      episodes: filtered_episodes,\n      pagination: pagination,\n    };\n  };\n\n  /**\n   * Get season of the selected series\n   */\n  getSeasonWithEpisodes = async ({\n    seriesId,\n    seasonNumber,\n    pageOffset,\n    pageLimit = PAGE_LIMIT,\n    language,\n  }: {\n    seriesId: string | undefined;\n    language: string;\n    seasonNumber: number;\n    pageOffset?: number;\n    pageLimit?: number;\n  }): Promise<EpisodesWithPagination> => {    \n    if (!seriesId) {\n      throw new Error('Series ID is required');\n    }\n\n    //Load serie with id - process it, but just the season number\n    const result = await apolloClient.query<GetItemQuery, GetItemQueryVariables>({\n      context: { headers: language ? { 'mosaic-locale': language, } : undefined, },\n      query: GetItemDocument,      \n      variables: { id: seriesId },\n      fetchPolicy: 'no-cache',\n    });\n\n    if (result.errors) {      \n      throw new Error('MediaItem not found');\n    }\n\n    const episodes: PlaylistItem[] = [];\n    result.data.tvshow?.seasons.nodes.forEach(season => {\n      if (season.index == seasonNumber) {\n      season.episodes.nodes.forEach(season_episode => { \n        if (episodes.length < pageLimit && season_episode!= null) {\n            const item = {\n            ...this.tranformEpisodeToPlayListItem(season_episode as Episode),\n            seasonNumber: season?.index?.toString() ?? '',\n            episodeNumber: season_episode?.index?.toString() ?? ''\n            } as PlaylistItem;\n            episodes.push(item);\n        }\n      });\n    }\n    });\n   \n  const pagination = { \n    page: (pageOffset ?? 0) + 1,\n    page_limit: pageLimit,\n    total: episodes.length ?? 1\n   };\n\n    return {\n      episodes: episodes,\n      pagination: pagination,\n    };\n  };\n\n  getAdSchedule = async (id: string | undefined | null): Promise<AdSchedule | undefined> => {\n    if (!id) {\n      throw new Error('Ad Schedule ID is required');\n    }\n\n    const url = env.APP_API_BASE_URL + `/v2/advertising/schedules/${id}.json`;\n    const response = await fetch(url, { credentials: 'omit' });\n\n    return (await getDataOrThrow(response)) as AdSchedule;\n  };\n\n\n\n  doKeyWordSearch = async (params: GetPlaylistParams = {}, language: string = env.APP_DEFAULT_LANGUAGE): Promise<Playlist | undefined> => {\n\n    //First we query get a playlist    \n    const result = await apolloClient.query<KeywordSearchQuery, KeywordSearchQueryVariables>({\n      context: { headers: language ? { 'mosaic-locale': language, } : undefined, },\n      query: KeywordSearchDocument,\n      variables: { keyword:  params.search ?? '' },\n      fetchPolicy: 'no-cache',\n    });\n\n    const transformedCollection: Playlist = {\n      playlist: [],\n      title: 'Search result'     \n    }\n    \n    transformedCollection.playlist = [];\n\n    result.data.movies?.nodes.forEach((item) => {      \n      transformedCollection.playlist.push(this.tranformMovieToPlayListItem(item as Movie));            \n    });\n    result.data.episodes?.nodes.forEach((item) => {      \n      transformedCollection.playlist.push(this.tranformEpisodeToPlayListItem(item as Episode));            \n    });\n    result.data.tvshows?.nodes.forEach((item) => {      \n      transformedCollection.playlist.push(this.tranformTvShowToPlayListItem(item as Tvshow));\n    });\n\n    return transformedCollection;\n  }\n\n\n  /**\n   * Get playlist by id\n   */\n  getPlaylistById = async (id?: string, params: GetPlaylistParams = {}, language: string = env.APP_DEFAULT_LANGUAGE): Promise<Playlist | undefined> => {\n    if (!id) {\n      return undefined;\n    }\n\n  if (id == \"KEYWORD-SEARCH\") {\n    return await this.doKeyWordSearch(params, language);\n  }\n\n  let related_media_item: PlaylistItem | undefined = undefined;\n  if (params.related_media_id) {    \n    related_media_item = await this.getMediaById({id: params?.related_media_id, token: undefined, drmPolicyId:undefined, language: language});    \n  }\n\n  //First we query get a playlist  \n  const result = await apolloClient.query<GetCollectionQuery, GetCollectionQueryVariables>({\n    context: { headers: language ? { 'mosaic-locale': language, } : undefined, },\n    query: GetCollectionDocument,\n    variables: { id:  id },\n    fetchPolicy: 'no-cache',\n  });\n\n  if (result.errors) {      \n    throw new Error('MediaItem not found');\n  }\n  const collection = result.data?.collection;\n\n    const transformedCollection: Playlist = {\n      description: collection?.description ?? '',      \n      feedid: collection?.id,      \n      title: params.related_media_id || !collection?.title ? \"More like this\" : collection?.title,\n      playlist: [],      \n      cardImageAspectRatio: \"2:3\",            \n    }        \n    \n    transformedCollection.playlist = [];\n    collection?.items?.nodes.forEach((item) => {      \n      switch (item.relationType) {\n        case \"MOVIE\":\n          if (item.movie!=null) {            \n            const movie_playlist_item = this.tranformMovieToPlayListItem(item.movie as Movie);\n            if (!related_media_item || this.arePlayListItemsRelated(related_media_item, movie_playlist_item)) {\n              transformedCollection.playlist.push(movie_playlist_item);\n            }\n          }\n          break;\n        case \"EPISODE\":\n            if (item.episode!=null) {\n              transformedCollection.playlist.push(this.tranformEpisodeToPlayListItem(item.episode as Episode));\n            }\n            break;\n        case \"TVSHOW\":\n            if (item.tvshow!=null) {\n              transformedCollection.playlist.push(this.tranformTvShowToPlayListItem(item.tvshow as Tvshow));\n            }\n            break;\n      }      \n    });  \n    return transformedCollection;\n  };\n\n  arePlayListItemsRelated = (a: PlaylistItem, b: PlaylistItem): boolean => {    \n    // We do the related item comparison client side over whole movie list, based on genre as a temp solution, as the catalog service does not expose an api for this for now\n    return Array.isArray(a.genres) && Array.isArray(b.genres) && a.mediaid != b.mediaid && a.genres.some(item => (b.genres as Array<string>).includes(item));    \n  }\n\n  getContentList = async ({ id, siteId, language }: { id: string | undefined; siteId: string; language: string }): Promise<Playlist | undefined> => {\n    if (!id || !siteId) {\n      throw new Error('List ID and Site ID are required');\n    }\n    return await this.getPlaylistById(id, undefined, language);\n  };\n\n  getContentSearch = async ({ siteId, params }: { siteId: string; params: GetContentSearchParams }) => {     \n    return await this.doKeyWordSearch({ search: params.searchTerm }) as Playlist;\n  };\n}\n","import i18next from 'i18next';\nimport { injectable } from 'inversify';\nimport { getI18n } from 'react-i18next';\n\nimport { configSchema } from '../../../utils/configSchema';\nimport { AppError } from '../../../utils/error';\nimport type { Config } from '../../../../types/config';\nimport env from '../../../env';\nimport mosaicConfig from '../axinom/axinom-demo-config.json';\nimport ConfigService from '../../ConfigService';\n\n/**\n * Set config setup changes in both config.service.ts and config.d.ts\n * */\n\n@injectable()\nexport default class AxinomConfigService extends ConfigService {\n\n  protected enrichConfig = (config: Config): Config => {\n    const { content, siteName } = config;\n    const updatedContent = content.map((content) => Object.assign({ featured: false }, content));\n\n    return { ...config, siteName: siteName || i18next.t('common:default_site_name'), content: updatedContent };\n  };\n\n  loadConfig = async (configLocation: string | undefined) => {\n    return this.enrichConfig(mosaicConfig as Config);\n  };\n}\n","// To organize imports in a better way\r\n/* eslint-disable import/order */\r\nimport 'reflect-metadata'; // include once in the app for inversify (see: https://github.com/inversify/InversifyJS/blob/master/README.md#-installation)\r\nimport { INTEGRATION, EPG_TYPE } from '../constants';\r\nimport { container } from './container';\r\nimport { API_ACCESS_BRIDGE_URL, DETERMINE_INTEGRATION_TYPE, INTEGRATION_TYPE } from './types';\r\n\r\nimport ApiService from '../services/ApiService';\r\nimport WatchHistoryService from '../services/WatchHistoryService';\r\nimport GenericEntitlementService from '../services/GenericEntitlementService';\r\nimport JWPEntitlementService from '../services/JWPEntitlementService';\r\nimport FavoriteService from '../services/FavoriteService';\r\nimport ConfigService from '../services/ConfigService';\r\nimport SettingsService from '../services/SettingsService';\r\n\r\nimport WatchHistoryController from '../controllers/WatchHistoryController';\r\nimport CheckoutController from '../controllers/CheckoutController';\r\nimport AccountController from '../controllers/AccountController';\r\nimport AccessController from '../controllers/AccessController';\r\nimport FavoritesController from '../controllers/FavoritesController';\r\nimport AppController from '../controllers/AppController';\r\nimport EpgController from '../controllers/EpgController';\r\n\r\n// Epg services\r\nimport EpgService from '../services/EpgService';\r\nimport ViewNexaEpgService from '../services/epg/ViewNexaEpgService';\r\nimport JWEpgService from '../services/epg/JWEpgService';\r\n\r\n// Access integration\r\nimport AccessService from '../services/AccessService';\r\nimport { getApiAccessBridgeUrl } from './functions/getApiAccessBridgeUrl';\r\n\r\n// Integration interfaces\r\nimport AccountService from '../services/integrations/AccountService';\r\nimport CheckoutService from '../services/integrations/CheckoutService';\r\nimport SubscriptionService from '../services/integrations/SubscriptionService';\r\n\r\n// Cleeng integration\r\nimport CleengService from '../services/integrations/cleeng/CleengService';\r\nimport CleengAccountService from '../services/integrations/cleeng/CleengAccountService';\r\nimport CleengCheckoutService from '../services/integrations/cleeng/CleengCheckoutService';\r\nimport CleengSubscriptionService from '../services/integrations/cleeng/CleengSubscriptionService';\r\n\r\n// JWP integration\r\nimport JWPAPIService from '../services/integrations/jwp/JWPAPIService';\r\nimport JWPAccountService from '../services/integrations/jwp/JWPAccountService';\r\nimport JWPCheckoutService from '../services/integrations/jwp/JWPCheckoutService';\r\nimport JWPSubscriptionService from '../services/integrations/jwp/JWPSubscriptionService';\r\nimport { getIntegrationType } from './functions/getIntegrationType';\r\nimport { isCleengIntegrationType, isJwpIntegrationType } from './functions/calculateIntegrationType';\r\n\r\n//Axinom integration\r\nimport AxinomApiService from '../services/integrations/axinom/AxinomApiService';\r\nimport AxinomConfigService from '../services/integrations/axinom/AxinomConfigService';\r\n\r\n// Common services\r\ncontainer.bind(ConfigService).toSelf();\r\ncontainer.bind(WatchHistoryService).toSelf();\r\ncontainer.bind(FavoriteService).toSelf();\r\ncontainer.bind(GenericEntitlementService).toSelf();\r\ncontainer.bind(ApiService).toSelf();\r\ncontainer.bind(SettingsService).toSelf();\r\ncontainer.bind(AccessService).toSelf();\r\n\r\n// Common controllers\r\ncontainer.bind(AppController).toSelf();\r\ncontainer.bind(WatchHistoryController).toSelf();\r\ncontainer.bind(FavoritesController).toSelf();\r\ncontainer.bind(EpgController).toSelf();\r\n\r\n// Integration controllers\r\ncontainer.bind(AccountController).toSelf();\r\ncontainer.bind(CheckoutController).toSelf();\r\ncontainer.bind(AccessController).toSelf();\r\n\r\n// EPG services\r\ncontainer.bind(EpgService).to(JWEpgService).whenTargetNamed(EPG_TYPE.jwp);\r\ncontainer.bind(EpgService).to(ViewNexaEpgService).whenTargetNamed(EPG_TYPE.viewNexa);\r\n\r\n// Functions\r\ncontainer.bind(INTEGRATION_TYPE).toDynamicValue(getIntegrationType);\r\ncontainer.bind(API_ACCESS_BRIDGE_URL).toDynamicValue(getApiAccessBridgeUrl);\r\n\r\n// Cleeng integration\r\ncontainer.bind(DETERMINE_INTEGRATION_TYPE).toConstantValue(isCleengIntegrationType);\r\ncontainer.bind(CleengService).toSelf();\r\ncontainer.bind(AccountService).to(CleengAccountService).whenTargetNamed(INTEGRATION.CLEENG);\r\ncontainer.bind(CheckoutService).to(CleengCheckoutService).whenTargetNamed(INTEGRATION.CLEENG);\r\ncontainer.bind(SubscriptionService).to(CleengSubscriptionService).whenTargetNamed(INTEGRATION.CLEENG);\r\n\r\n// JWP integration\r\ncontainer.bind(DETERMINE_INTEGRATION_TYPE).toConstantValue(isJwpIntegrationType);\r\ncontainer.bind(JWPAPIService).toSelf();\r\ncontainer.bind(JWPEntitlementService).toSelf();\r\ncontainer.bind(AccountService).to(JWPAccountService).whenTargetNamed(INTEGRATION.JWP);\r\ncontainer.bind(CheckoutService).to(JWPCheckoutService).whenTargetNamed(INTEGRATION.JWP);\r\ncontainer.bind(SubscriptionService).to(JWPSubscriptionService).whenTargetNamed(INTEGRATION.JWP);\r\n\r\n//Axinom integration\r\ncontainer.rebind(ApiService).to(AxinomApiService);\r\ncontainer.rebind(ConfigService).to(AxinomConfigService);","import { LogLevel } from './LogLevel';\r\nimport LogTransporter from './LogTransporter';\r\n\r\nexport default class ConsoleTransporter extends LogTransporter {\r\n  constructor(private readonly logLevel: LogLevel) {\r\n    super();\r\n  }\r\n\r\n  override log(level: LogLevel, scope: string, message: string, extra?: Record<string, unknown>, error?: Error) {\r\n    if (level < this.logLevel) return;\r\n\r\n    switch (level) {\r\n      case LogLevel.ERROR:\r\n      case LogLevel.FATAL:\r\n        console.error(`${LogLevel[level]} [${scope}] ${message}`);\r\n        break;\r\n      case LogLevel.WARN:\r\n        console.warn(`${LogLevel[level]} [${scope}] ${message}`);\r\n        break;\r\n      default:\r\n        // eslint-disable-next-line no-console\r\n        console.log(`${LogLevel[level]} [${scope}] ${message}`);\r\n    }\r\n\r\n    if (error) {\r\n      console.error(error);\r\n    }\r\n\r\n    if (extra && Object.keys(extra).length > 0) {\r\n      // eslint-disable-next-line no-console\r\n      console.log(extra);\r\n    }\r\n  }\r\n}\r\n","import { injectable } from '@jwp/ott-common/src/modules/container';\r\nimport StorageService from '@jwp/ott-common/src/services/StorageService';\r\nimport { logError } from '@jwp/ott-common/src/logger';\r\n\r\n@injectable()\r\nexport class LocalStorageService extends StorageService {\r\n  prefix: string = 'jwapp';\r\n\r\n  initialize(prefix: string) {\r\n    this.prefix = prefix;\r\n  }\r\n\r\n  getStorageKey(key: string) {\r\n    return `${this.prefix}.${key}`;\r\n  }\r\n\r\n  async getItem(key: string, parse: boolean, usePrefix = true) {\r\n    try {\r\n      const value = window.localStorage.getItem(usePrefix ? this.getStorageKey(key) : key);\r\n\r\n      return value && parse ? JSON.parse(value) : value;\r\n    } catch (error: unknown) {\r\n      logError('LocalStorageService', 'Failed to parse localStorage entry', { error });\r\n    }\r\n  }\r\n\r\n  async setItem(key: string, value: string, usePrefix = true) {\r\n    try {\r\n      window.localStorage.setItem(usePrefix ? this.getStorageKey(key) : key, value);\r\n    } catch (error: unknown) {\r\n      logError('LocalStorageService', 'Failed to store localStorage entry', { error });\r\n    }\r\n  }\r\n\r\n  async removeItem(key: string) {\r\n    try {\r\n      window.localStorage.removeItem(this.getStorageKey(key));\r\n    } catch (error: unknown) {\r\n      logError('LocalStorageService', 'Failed to remove localStorage entry', { error });\r\n    }\r\n  }\r\n\r\n  // helper functions for encoding and decoding Base64 strings\r\n  // this might end up in a different service\r\n  base64Encode(input: string): string {\r\n    return window.btoa(input);\r\n  }\r\n\r\n  base64Decode(input: string): string {\r\n    return window.atob(input);\r\n  }\r\n}\r\n","import '@jwp/ott-common/src/modules/register';\r\nimport { container } from '@jwp/ott-common/src/modules/container';\r\nimport StorageService from '@jwp/ott-common/src/services/StorageService';\r\nimport { BROADCAST_CHANNEL, GET_CUSTOMER_IP } from '@jwp/ott-common/src/modules/types';\r\nimport type { GetCustomerIP } from '@jwp/ott-common/types/get-customer-ip';\r\nimport LogTransporter from '@jwp/ott-common/src/services/logging/LogTransporter';\r\nimport ConsoleTransporter from '@jwp/ott-common/src/services/logging/ConsoleTransporter';\r\nimport { LogLevel } from '@jwp/ott-common/src/services/logging/LogLevel';\r\nimport { BroadcastChannel } from 'broadcast-channel';\r\n\r\nimport { getOverrideIP } from '#src/utils/ip';\r\nimport { LocalStorageService } from '#src/services/LocalStorageService';\r\n\r\n/**\r\n * Custom integration override\r\n *\r\n * @example\r\n * ```ts\r\n * // Custom integration services\r\n * const MY_INTEGRATION_NAME = 'CUSTOM';\r\n *\r\n * container.bind(AccountService).to(CustomAccountService).whenTargetNamed(MY_INTEGRATION_NAME);\r\n * container.bind(CheckoutService).to(CustomCheckoutService).whenTargetNamed(MY_INTEGRATION_NAME);\r\n * container.bind(SubscriptionService).to(CustomSubscriptionService).whenTargetNamed(MY_INTEGRATION_NAME);\r\n *\r\n * // Override integration type calculation\r\n * container.bind(DETERMINE_INTEGRATION_TYPE).toConstantValue((config: Config) => {\r\n *   return config.custom?.['custom'] ? MY_INTEGRATION_NAME : null;\r\n * })\r\n * ```\r\n */\r\n\r\ncontainer.bind(StorageService).to(LocalStorageService);\r\n\r\ncontainer.bind(BROADCAST_CHANNEL).toConstantValue(new BroadcastChannel('jwp-refresh-token-channel'));\r\n\r\n// Currently, this is only used for e2e testing to override the customer ip from a browser cookie\r\ncontainer.bind<GetCustomerIP>(GET_CUSTOMER_IP).toConstantValue(async () => getOverrideIP());\r\n\r\n/**\r\n * Log transporters\r\n *\r\n * Add custom log transporters by registering more modules to the LogTransporter type. The custom transporter must\r\n * extend the LogTransporter class.\r\n *\r\n * @example\r\n * ```ts\r\n * container.bind<LogTransporter>(LogTransporter).toDynamicValue(() => new GoogleGTMTransporter(import.meta.env.DEV ? LogLevel.SILENT : LogLevel.WARN));\r\n * ```\r\n */\r\ncontainer.bind<LogTransporter>(LogTransporter).toDynamicValue(() => new ConsoleTransporter(import.meta.env.DEV ? LogLevel.DEBUG : LogLevel.ERROR));\r\n\r\n/**\r\n * UI Component override\r\n *\r\n * @example\r\n * ```ts\r\n * // Define an identifier from the component (from `ui-react` for example):\r\n * export const CardIdentifier = Symbol('CARD');\r\n *\r\n * // Make sure the component is wrapped in the HOC:\r\n * export default createInjectableComponent(CardIdentifier, Card);\r\n *\r\n * // Override the component into the associated container, from register.ts:\r\n * import { container as uiComponentContainer } from '@jwp/ott-ui-react/src/modules/container';\r\n *\r\n * uiComponentContainer.bind<React.FC<CardProps>>(CardIdentifier).toConstantValue(CustomCard);\r\n * ```\r\n */\r\n\r\n// Override ui-react component\r\n// uiComponentContainer.bind<React.FC<CardProps>>(CardIdentifier).toConstantValue(CustomCard);\r\n","import React from 'react';\r\nimport { QueryClient, QueryClientProvider } from 'react-query';\r\n\r\nexport const queryClient = new QueryClient({\r\n  defaultOptions: {\r\n    queries: {\r\n      staleTime: 60 * 60 * 1000,\r\n      refetchOnWindowFocus: false,\r\n      retryOnMount: false,\r\n    },\r\n  },\r\n});\r\n\r\ntype QueryProviderProps = {\r\n  children: JSX.Element;\r\n};\r\n\r\nfunction QueryProvider({ children }: QueryProviderProps): JSX.Element {\r\n  return <QueryClientProvider client={queryClient}>{children}</QueryClientProvider>;\r\n}\r\n\r\nexport default QueryProvider;\r\n","import React, { type ReactNode } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { IS_DEMO_MODE, IS_DEVELOPMENT_BUILD, IS_PREVIEW_MODE } from '@jwp/ott-common/src/utils/common';\r\n\r\nimport DevStackTrace from '../DevStackTrace/DevStackTrace';\r\n\r\nimport styles from './ErrorPage.module.scss';\r\n\r\ninterface Props {\r\n  disableFallbackTranslation?: boolean;\r\n  title?: string | ReactNode;\r\n  message?: string | ReactNode;\r\n  learnMoreLabel?: string;\r\n  children?: React.ReactNode;\r\n  error?: Error;\r\n  helpLink?: string;\r\n}\r\n\r\nconst ErrorPage = ({ title, message, learnMoreLabel, ...rest }: Props) => {\r\n  const { t } = useTranslation('error');\r\n\r\n  return (\r\n    <ErrorPageWithoutTranslation\r\n      title={title || t('generic_error_heading')}\r\n      message={message || t('generic_error_description')}\r\n      learnMoreLabel={learnMoreLabel || t('learn_more')}\r\n      {...rest}\r\n    />\r\n  );\r\n};\r\n\r\nexport const ErrorPageWithoutTranslation = ({ title, children, message, learnMoreLabel, error, helpLink }: Props) => {\r\n  const logo = useConfigStore((s) => s.config?.assets?.banner);\r\n  const alt = ''; // intentionally empty for a11y, because adjacent text alternative\r\n\r\n  return (\r\n    <div className={styles.errorPage}>\r\n      <div className={styles.box}>\r\n        <img className={styles.image} src={logo || '/images/logo.png'} alt={alt} />\r\n        <h1 className={styles.title} aria-live=\"polite\">\r\n          {title || 'An error occurred'}\r\n        </h1>\r\n        <div className={styles.main}>\r\n          <p className={styles.message}>{message || 'Try refreshing this page or come back later.'}</p>\r\n          {children}\r\n          {(IS_DEVELOPMENT_BUILD || IS_DEMO_MODE || IS_PREVIEW_MODE) && helpLink && (\r\n            <div className={styles.links}>\r\n              <a href={helpLink} target={'_blank'} rel={'noreferrer'}>\r\n                {learnMoreLabel || 'Learn More'}\r\n              </a>\r\n              {(IS_DEVELOPMENT_BUILD || IS_PREVIEW_MODE) && error?.stack && (\r\n                <span className={styles.stack}>\r\n                  <DevStackTrace error={error} />\r\n                </span>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ErrorPage;\r\n","import classNames from 'classnames';\r\nimport React from 'react';\r\n\r\nimport styles from './Spinner.module.scss';\r\n\r\ntype Props = {\r\n  size?: 'small' | 'medium' | 'large';\r\n  className?: string;\r\n};\r\n\r\nconst Spinner = ({ size = 'medium', className = '' }: Props): JSX.Element => {\r\n  return (\r\n    <div className={classNames(styles.buffer, className, { [styles.small]: size === 'small', [styles.large]: size === 'large' })}>\r\n      <div />\r\n      <div />\r\n      <div />\r\n      <div />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Spinner;\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\n\r\nimport Spinner from '../Spinner/Spinner';\r\n\r\nimport styles from './LoadingOverlay.module.scss';\r\n\r\ntype Props = {\r\n  transparentBackground?: boolean;\r\n  inline?: boolean;\r\n};\r\n\r\nconst LoadingOverlay = ({ transparentBackground = false, inline = false }: Props): JSX.Element => {\r\n  const className = classNames(styles.loadingOverlay, {\r\n    [styles.transparent]: transparentBackground,\r\n    [styles.fixed]: !inline,\r\n    [styles.inline]: inline,\r\n  });\r\n\r\n  return (\r\n    <div className={className}>\r\n      <Spinner size=\"medium\" />\r\n    </div>\r\n  );\r\n};\r\nexport default LoadingOverlay;\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\n\r\nimport styles from './FormFeedback.module.scss';\r\n\r\ntype Props = {\r\n  visible?: boolean;\r\n  children?: React.ReactNode;\r\n  variant: 'info' | 'success' | 'warning' | 'error';\r\n};\r\n\r\nconst variantAriaMap = {\r\n  info: 'polite',\r\n  success: 'assertive',\r\n  warning: 'polite',\r\n  error: 'assertive',\r\n} as const;\r\n\r\nconst FormFeedback: React.FC<Props> = ({ children, variant = 'error', visible = true }: Props) => {\r\n  const className = classNames(styles.formFeedback, {\r\n    [styles.error]: variant === 'error',\r\n    [styles.warning]: variant === 'warning',\r\n    [styles.success]: variant === 'success',\r\n    [styles.info]: variant === 'info',\r\n    hidden: !visible,\r\n  });\r\n\r\n  const ariaLive = variantAriaMap[variant];\r\n\r\n  return (\r\n    <div aria-live={ariaLive} className={className}>\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FormFeedback;\r\n","import { secondsToMilliseconds } from 'date-fns';\r\nimport { type PropsWithChildren, createContext, useCallback, useContext, useState } from 'react';\r\nimport { createPortal } from 'react-dom';\r\n\r\nimport FormFeedback from '../../components/FormFeedback/FormFeedback';\r\n\r\nexport type AriaAnnouncerVariant = 'success' | 'error' | 'warning' | 'info';\r\ntype Announcement = { message: string; variant: AriaAnnouncerVariant };\r\ntype AnnounceFn = (message: string, variant: AriaAnnouncerVariant, duration?: number) => void;\r\ntype ContextValue = { announce: AnnounceFn };\r\n\r\nconst AriaAnnouncerContext = createContext<ContextValue | undefined>(undefined);\r\n\r\nexport const useAriaAnnouncer = () => {\r\n  const announce = useContext(AriaAnnouncerContext);\r\n\r\n  if (!announce) throw new Error('Announcer context is not defined');\r\n\r\n  return announce.announce;\r\n};\r\n\r\nexport const AriaAnnouncerProvider = ({ children }: PropsWithChildren) => {\r\n  const [announcement, setAnnouncement] = useState<Announcement | null>(null);\r\n\r\n  const announce = useCallback((message: string, variant: AriaAnnouncerVariant, duration = secondsToMilliseconds(10)) => {\r\n    setAnnouncement({ message, variant });\r\n\r\n    setTimeout(() => {\r\n      setAnnouncement(null);\r\n    }, duration);\r\n  }, []);\r\n\r\n  return (\r\n    <AriaAnnouncerContext.Provider value={{ announce }}>\r\n      {announcement &&\r\n        createPortal(\r\n          <FormFeedback variant={announcement.variant} visible={false}>\r\n            {announcement.message}\r\n          </FormFeedback>,\r\n          document.body,\r\n        )}\r\n      {children}\r\n    </AriaAnnouncerContext.Provider>\r\n  );\r\n};\r\n","import type { LanguageDefinition } from '../../types/i18n';\r\n\r\nexport const filterSupportedLanguages = (definedLanguages: LanguageDefinition[], enabledLanguages: string[]) => {\r\n  return enabledLanguages.reduce((languages, languageCode) => {\r\n    const foundLanguage = definedLanguages.find(({ code }) => code === languageCode);\r\n\r\n    if (foundLanguage) {\r\n      return [...languages, foundLanguage];\r\n    }\r\n\r\n    throw new Error(`Missing defined language for code: ${languageCode}`);\r\n  }, [] as LanguageDefinition[]);\r\n};\r\n","// This file is generated by i18next-parser-workspaces, do not modify manually.\r\n// Run `$ npx i18next-workspaces` to update this file\r\n\r\nexport const NAMESPACES = ['account', 'common', 'country', 'demo', 'epg', 'error', 'menu', 'search', 'us_state', 'user', 'video'];\r\n","import { initReactI18next } from 'react-i18next';\r\nimport LanguageDetector from 'i18next-browser-languagedetector';\r\nimport I18NextHttpBackend from 'i18next-http-backend';\r\nimport i18next from 'i18next';\r\nimport type { LanguageDefinition } from '@jwp/ott-common/types/i18n';\r\nimport { filterSupportedLanguages } from '@jwp/ott-common/src/utils/i18n';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\n\r\nimport { NAMESPACES } from './resources';\r\n\r\n// This list contains all languages that are supported by the OTT Web app by default\r\n// To enable the language, make sure that the language code is added to the `APP_ENABLED_LANGUAGES` environment variable\r\n// Before adding a defined language, ensure that the translation files are added to the `./public/locales/${code}` folder\r\nexport const DEFINED_LANGUAGES: LanguageDefinition[] = [\r\n  {\r\n    code: 'en',\r\n    displayName: 'English',\r\n  },\r\n  {\r\n    code: 'es',\r\n    displayName: 'Español',\r\n  },\r\n];\r\n\r\nconst initI18n = async () => {\r\n  const enabledLanguages = import.meta.env.APP_ENABLED_LANGUAGES?.split(',') || [];\r\n  const defaultLanguage = import.meta.env.APP_DEFAULT_LANGUAGE || 'en';\r\n\r\n  const supportedLanguages = filterSupportedLanguages(DEFINED_LANGUAGES, enabledLanguages);\r\n\r\n  useConfigStore.setState({ supportedLanguages });\r\n\r\n  if (!supportedLanguages.some(({ code }) => code === defaultLanguage)) {\r\n    throw new Error(`The default language is not enabled: ${defaultLanguage}`);\r\n  }\r\n\r\n  await i18next\r\n    .use(I18NextHttpBackend)\r\n    .use(LanguageDetector)\r\n    .use(initReactI18next)\r\n    .init({\r\n      supportedLngs: supportedLanguages.map(({ code }) => code),\r\n      fallbackLng: defaultLanguage,\r\n      // this option ensures that empty strings in translations will fall back to the default language\r\n      returnEmptyString: false,\r\n      ns: NAMESPACES,\r\n      defaultNS: 'common',\r\n      fallbackNS: 'common',\r\n      interpolation: {\r\n        escapeValue: false,\r\n      },\r\n      detection: {\r\n        order: ['localStorage', 'navigator'],\r\n        caches: ['localStorage'],\r\n        lookupLocalStorage: 'jwapp.language',\r\n      },\r\n      react: {\r\n        // disabled suspense to prevent re-loading the app while loading the resources\r\n        useSuspense: false,\r\n      },\r\n    });\r\n};\r\n\r\nexport default initI18n;\r\n","import { createURL, type QueryParamsArg } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport type { Location } from 'react-router-dom';\r\n\r\nimport type { AccountModals } from '../containers/AccountModal/AccountModal';\r\n\r\nexport const createURLFromLocation = (location: Location, queryParams: QueryParamsArg = {}) => {\r\n  return createURL(`${location.pathname}${location.search || ''}`, queryParams);\r\n};\r\n\r\nexport const modalURLFromLocation = (location: Location, u: keyof AccountModals | null, queryParams?: QueryParamsArg) => {\r\n  return createURL(`${location.pathname}${location.search || ''}`, { u, ...queryParams });\r\n};\r\n\r\n/**\r\n * Create a full modal URL including the hostname, mostly for external use (e.g., for the PayPal successUrl)\r\n *\r\n * @example\r\n * modalURLFromWindowLocation('login', { foo: 'bar' }) === 'https://jwplayer.com/?u=login&foo=bar'\r\n */\r\nexport const modalURLFromWindowLocation = (u: keyof AccountModals, queryParams?: QueryParamsArg) => {\r\n  return createURL(window.location.href, { u, ...queryParams });\r\n};\r\n","import React, { useCallback, useLayoutEffect, useRef } from 'react';\r\n\r\n/* eslint-disable @typescript-eslint/no-explicit-any */\r\n/**\r\n * The `useEventCallback` hook can be compared to the `useCallback` hook but without dependencies. It is a \"shortcut\"\r\n * to prevent re-renders based on callback changes due to dependency changes. This can be useful to improve the\r\n * performance or to prevent adding/removing event listeners to third-party libraries such as JW Player.\r\n *\r\n * @see {https://reactjs.org/docs/hooks-faq.html#how-to-avoid-passing-callbacks-down}\r\n *\r\n * @param {function} [callback]\r\n */\r\nconst useEventCallback = <T extends (...args: any[]) => unknown>(callback?: T): T => {\r\n  const fnRef = useRef(() => {\r\n    throw new Error('Callback called in render');\r\n  }) as unknown as React.MutableRefObject<T | undefined>;\r\n\r\n  useLayoutEffect(() => {\r\n    fnRef.current = callback;\r\n  }, [callback]);\r\n\r\n  // @ts-ignore\r\n  // ignore since we just want to pass all arguments to the callback function (which we don't know)\r\n  return useCallback((...args) => {\r\n    if (typeof fnRef.current === 'function') {\r\n      return fnRef.current(...args);\r\n    }\r\n  }, []);\r\n};\r\n\r\nexport default useEventCallback;\r\n","import { useSearchParams } from 'react-router-dom';\r\n\r\nfunction useQueryParam(key: string): string | null {\r\n  const [searchParams] = useSearchParams();\r\n\r\n  return searchParams.get(key);\r\n}\r\n\r\nexport default useQueryParam;\r\n","import { useEffect, useRef, useState } from 'react';\r\n\r\nconst useCountdown = (durationSeconds: number, intervalSeconds: number = 1, completeHandler?: () => void) => {\r\n  const timerRef = useRef<number>();\r\n  const [countdown, setCountdown] = useState(durationSeconds);\r\n\r\n  useEffect(() => {\r\n    window.clearTimeout(timerRef.current);\r\n    if (countdown === 0) {\r\n      if (completeHandler) completeHandler();\r\n      return;\r\n    }\r\n\r\n    timerRef.current = window.setTimeout(() => {\r\n      setCountdown((count) => count - intervalSeconds);\r\n    }, intervalSeconds * 1000);\r\n\r\n    return () => {\r\n      window.clearTimeout(timerRef.current);\r\n    };\r\n  }, [completeHandler, countdown, intervalSeconds]);\r\n\r\n  return countdown;\r\n};\r\n\r\nexport default useCountdown;\r\n","import { Container } from 'inversify';\r\n\r\nconst container = new Container({ defaultScope: 'Singleton', skipBaseClassChecks: true });\r\n\r\nexport { container };\r\n","import React, { type FC } from 'react';\r\n\r\nimport { container } from './container';\r\n\r\n// This HOC is used to override a component top-level, using Inversify\r\n// More info: platforms/web/src/modules/register.ts\r\nconst createInjectableComponent = <Props extends object>(identifier: symbol, DefaultComponent: FC<Props>) => {\r\n  return (props: Props) => {\r\n    const isOverridden = container.isBound(identifier);\r\n\r\n    if (isOverridden) {\r\n      const OverriddenComponent = container.get<FC<Props>>(identifier);\r\n\r\n      return <OverriddenComponent {...props} />;\r\n    }\r\n\r\n    return <DefaultComponent {...props} />;\r\n  };\r\n};\r\n\r\nexport default createInjectableComponent;\r\n","import React, { type MouseEventHandler } from 'react';\r\nimport classNames from 'classnames';\r\nimport { NavLink } from 'react-router-dom';\r\n\r\nimport Spinner from '../Spinner/Spinner';\r\nimport createInjectableComponent from '../../modules/createInjectableComponent';\r\n\r\nimport styles from './Button.module.scss';\r\n\r\nexport const ButtonIdentifier = Symbol(`BUTTON`);\r\n\r\ntype Color = 'default' | 'primary' | 'delete';\r\n\r\ntype Variant = 'contained' | 'outlined' | 'text' | 'danger' | 'delete';\r\n\r\nexport type ButtonProps = {\r\n  children?: React.ReactNode;\r\n  label: string;\r\n  active?: boolean;\r\n  color?: Color;\r\n  fullWidth?: boolean;\r\n  startIcon?: React.ReactElement;\r\n  variant?: Variant;\r\n  onClick?: MouseEventHandler<HTMLButtonElement>;\r\n  tabIndex?: number;\r\n  size?: 'small' | 'medium' | 'large';\r\n  to?: string;\r\n  role?: string;\r\n  className?: string;\r\n  type?: 'button' | 'submit' | 'reset';\r\n  disabled?: boolean;\r\n  busy?: boolean;\r\n  id?: string;\r\n  activeClassname?: string;\r\n} & React.AriaAttributes;\r\n\r\nconst Button: React.FC<ButtonProps> = ({\r\n  label,\r\n  children,\r\n  color = 'default',\r\n  startIcon,\r\n  fullWidth = false,\r\n  active = false,\r\n  variant = 'outlined',\r\n  size = 'medium',\r\n  disabled,\r\n  busy,\r\n  type = 'button',\r\n  to,\r\n  onClick,\r\n  className,\r\n  activeClassname = '',\r\n  ...rest\r\n}: ButtonProps) => {\r\n  const buttonClassName = (isActive: boolean) =>\r\n    classNames(styles.button, className, styles[color], styles[variant], {\r\n      [styles.active]: isActive,\r\n      [activeClassname]: isActive,\r\n      [styles.fullWidth]: fullWidth,\r\n      [styles.large]: size === 'large',\r\n      [styles.small]: size === 'small',\r\n      [styles.disabled]: disabled,\r\n    });\r\n\r\n  const content = (\r\n    <>\r\n      {startIcon && <div className={styles.startIcon}>{startIcon}</div>}\r\n      {<span className={classNames({ [styles.hidden]: busy }) || undefined}>{label}</span>}\r\n      {children}\r\n      {busy && <Spinner className={styles.centerAbsolute} size={'small'} />}\r\n    </>\r\n  );\r\n\r\n  if (to) {\r\n    return (\r\n      <NavLink className={({ isActive }) => buttonClassName(isActive)} to={to} {...rest} end>\r\n        {content}\r\n      </NavLink>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <button className={buttonClassName(active)} onClick={disabled ? undefined : onClick} type={type} aria-disabled={disabled} {...rest}>\r\n      {content}\r\n    </button>\r\n  );\r\n};\r\nexport default createInjectableComponent(ButtonIdentifier, Button);\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport useCountdown from '@jwp/ott-hooks-react/src/useCountdown';\r\n\r\nimport Button from '../Button/Button';\r\n\r\nimport styles from './Welcome.module.scss';\r\n\r\ntype Props = {\r\n  onCloseButtonClick?: () => void;\r\n  onCountdownCompleted?: () => void;\r\n  siteName?: string;\r\n};\r\n\r\nconst Welcome: React.FC<Props> = ({ onCloseButtonClick, onCountdownCompleted, siteName }) => {\r\n  const { t } = useTranslation('account');\r\n  const countdown = useCountdown(10, 1, onCountdownCompleted);\r\n\r\n  return (\r\n    <div className={styles.welcome}>\r\n      <h2>{t('checkout.welcome_title', { siteName })}</h2>\r\n      <p>{t('checkout.welcome_description', { siteName })}</p>\r\n      <Button variant=\"contained\" color=\"primary\" label={t('checkout.start_watching', { countdown })} onClick={onCloseButtonClick} size=\"large\" fullWidth />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Welcome;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport Button from '../Button/Button';\r\n\r\nimport styles from './PaymentFailed.module.scss';\r\n\r\ntype Props = {\r\n  type: 'error' | 'cancelled';\r\n  message: string | null;\r\n  onCloseButtonClick: () => void;\r\n};\r\n\r\nconst PaymentFailed: React.FC<Props> = ({ type, message, onCloseButtonClick }: Props) => {\r\n  const { t } = useTranslation('account');\r\n  return (\r\n    <div>\r\n      <h2 className={styles.title}>{type === 'cancelled' ? t('checkout.payment_cancelled') : t('checkout.payment_error')}</h2>\r\n      <p className={styles.message}>{type === 'cancelled' ? t('checkout.payment_cancelled_message') : message}</p>\r\n      <div>\r\n        <Button label={t('checkout.close')} onClick={onCloseButtonClick} color=\"primary\" variant=\"contained\" size=\"large\" fullWidth />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PaymentFailed;\r\n","import React, { type CSSProperties, useEffect, useRef, useState } from 'react';\r\nimport useEventCallback from '@jwp/ott-hooks-react/src/useEventCallback';\r\n\r\ntype Props = {\r\n  className?: string;\r\n  createStyle: (status: Status) => CSSProperties;\r\n  open?: boolean;\r\n  duration?: number;\r\n  delay?: number;\r\n  children?: React.ReactNode;\r\n  keepMounted?: boolean;\r\n  onOpenAnimationEnd?: () => void;\r\n  onCloseAnimationEnd?: () => void;\r\n};\r\n\r\nexport type Status = 'opening' | 'open' | 'closing' | 'closed';\r\n\r\nconst triggerReflow = (element: HTMLElement | null) => element?.scrollTop;\r\n\r\nconst Animation: React.FC<Props> = ({\r\n  className,\r\n  createStyle,\r\n  open = true,\r\n  duration = 250,\r\n  delay = 0,\r\n  onOpenAnimationEnd,\r\n  onCloseAnimationEnd,\r\n  keepMounted = false,\r\n  children,\r\n}) => {\r\n  const nodeRef = useRef<HTMLDivElement>(null);\r\n  const [status, setStatus] = useState<Status>('closed');\r\n  const [hasOpenedBefore, setHasOpenedBefore] = useState<boolean>(false);\r\n\r\n  const timeout = useRef<number>();\r\n  const timeout2 = useRef<number>();\r\n\r\n  // use event callbacks to ignore reactive dependencies\r\n  const openEvent = useEventCallback(() => {\r\n    setHasOpenedBefore(true);\r\n    // trigger a reflow to ensure the transition is respected after mount\r\n    triggerReflow(nodeRef.current);\r\n\r\n    timeout.current = window.setTimeout(() => setStatus('opening'), delay);\r\n    timeout2.current = window.setTimeout(() => {\r\n      setStatus('open');\r\n      onOpenAnimationEnd && onOpenAnimationEnd();\r\n    }, duration + delay);\r\n  });\r\n\r\n  const closeEvent = useEventCallback(() => {\r\n    if (hasOpenedBefore) {\r\n      timeout.current = window.setTimeout(() => setStatus('closing'), delay);\r\n      timeout2.current = window.setTimeout(() => {\r\n        setStatus('closed');\r\n        onCloseAnimationEnd && onCloseAnimationEnd();\r\n      }, duration + delay);\r\n    }\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (open) {\r\n      openEvent();\r\n    } else {\r\n      closeEvent();\r\n    }\r\n\r\n    return () => {\r\n      clearTimeout(timeout.current);\r\n      clearTimeout(timeout2.current);\r\n    };\r\n  }, [open, openEvent, closeEvent]);\r\n\r\n  if (!open && status === 'closed' && !keepMounted) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div style={createStyle(status)} className={className} ref={nodeRef}>\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Animation;\r\n","import React, { type CSSProperties, type ReactNode } from 'react';\r\n\r\nimport Animation, { type Status } from '../Animation';\r\n\r\ntype Props = {\r\n  open?: boolean;\r\n  duration?: number;\r\n  delay?: number;\r\n  onOpenAnimationEnd?: () => void;\r\n  onCloseAnimationEnd?: () => void;\r\n  children: ReactNode;\r\n  className?: string;\r\n};\r\n\r\nconst Grow = ({ open = true, duration = 250, delay = 0, onOpenAnimationEnd, onCloseAnimationEnd, children, className }: Props): JSX.Element | null => {\r\n  const seconds = duration / 1000;\r\n  const transition = `transform ${seconds}s ease-out`; // todo: -webkit-transform;\r\n  const createStyle = (status: Status): CSSProperties => ({\r\n    transition,\r\n    transform: status === 'opening' || status === 'open' ? 'scale(1)' : 'scale(0.7)',\r\n  });\r\n\r\n  return (\r\n    <Animation\r\n      createStyle={(status: Status) => createStyle(status)}\r\n      open={open}\r\n      duration={duration}\r\n      delay={delay}\r\n      onOpenAnimationEnd={onOpenAnimationEnd}\r\n      onCloseAnimationEnd={onCloseAnimationEnd}\r\n      className={className}\r\n    >\r\n      {children}\r\n    </Animation>\r\n  );\r\n};\r\n\r\nexport default Grow;\r\n","export const canUseDOM = !!(typeof window !== 'undefined' && window.document && window.document.createElement);\r\n\r\nlet size: number;\r\n\r\nexport default function scrollbarSize(recalc?: boolean) {\r\n  if ((!size && size !== 0) || recalc) {\r\n    if (canUseDOM) {\r\n      const scrollDiv = document.createElement('div');\r\n      scrollDiv.style.position = 'absolute';\r\n      scrollDiv.style.top = '-9999px';\r\n      scrollDiv.style.width = '50px';\r\n      scrollDiv.style.height = '50px';\r\n      scrollDiv.style.overflow = 'scroll';\r\n      document.body.appendChild(scrollDiv);\r\n      size = scrollDiv.offsetWidth - scrollDiv.clientWidth;\r\n      document.body.removeChild(scrollDiv);\r\n    }\r\n  }\r\n  return size;\r\n}\r\n\r\nexport const addScript = (src: string): Promise<void> => {\r\n  return new Promise((resolve) => {\r\n    const script: HTMLScriptElement = document.createElement('script');\r\n    script.type = 'text/javascript';\r\n    script.async = true;\r\n    script.src = src;\r\n    script.onload = () => resolve();\r\n    script.onerror = (error) => {\r\n      console.info('Error loading external script', error);\r\n      throw new Error('Error loading external script');\r\n    };\r\n    document.body.appendChild(script);\r\n  });\r\n};\r\n","import { useCallback, useEffect } from 'react';\r\n\r\nimport scrollbarSize from '../utils/dom';\r\n\r\nconst removeBodyScrolling = () => {\r\n  document.body.style.marginRight = `${scrollbarSize(true)}px`;\r\n  document.body.style.overflowY = 'hidden';\r\n};\r\n\r\nconst restoreBodyScrolling = () => {\r\n  const dialogs = Array.from(document.querySelectorAll('dialog'));\r\n  const openDialogs = dialogs.filter((dialog) => dialog.open).length;\r\n\r\n  if (!openDialogs) {\r\n    document.body.style.removeProperty('margin-right');\r\n    document.body.style.removeProperty('overflow-y');\r\n  }\r\n};\r\n\r\n// shared variable between `useModal` usages\r\nlet originElement: HTMLElement | undefined;\r\n\r\nexport const useModal = () => {\r\n  const restoreFocus = useCallback(() => {\r\n    // restore focus when the focus is \"lost\" to the body element\r\n    if (!originElement || document.activeElement !== document.body) {\r\n      return;\r\n    }\r\n\r\n    const dialogs = Array.from(document.querySelectorAll('dialog'));\r\n    const openDialogs = dialogs.filter((dialog) => dialog.open).length;\r\n\r\n    // this was the last open dialog\r\n    if (openDialogs === 0) {\r\n      originElement.focus();\r\n      originElement = undefined;\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      restoreBodyScrolling();\r\n      restoreFocus();\r\n    };\r\n  }, [restoreFocus]);\r\n\r\n  const handleOpen = useCallback(() => {\r\n    if (!originElement) {\r\n      originElement = document.activeElement as HTMLElement;\r\n    }\r\n\r\n    removeBodyScrolling();\r\n  }, []);\r\n\r\n  const handleClose = useCallback(() => {\r\n    restoreFocus();\r\n    restoreBodyScrolling();\r\n  }, [restoreFocus]);\r\n\r\n  return { handleOpen, handleClose };\r\n};\r\n","import React, { type HTMLAttributes, type KeyboardEventHandler, type ReactEventHandler, useEffect, useRef } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport useEventCallback from '@jwp/ott-hooks-react/src/useEventCallback';\r\nimport classNames from 'classnames';\r\n\r\nimport Grow from '../Animation/Grow/Grow';\r\nimport { useModal } from '../../hooks/useModal';\r\n\r\nimport styles from './Modal.module.scss';\r\n\r\nexport type AnimationProps = {\r\n  open?: boolean;\r\n  duration?: number;\r\n  delay?: number;\r\n  children: React.ReactNode;\r\n  className?: string;\r\n  onCloseAnimationEnd?: () => void;\r\n};\r\n\r\ntype Props = {\r\n  children?: React.ReactNode;\r\n  className?: string;\r\n  centered?: boolean;\r\n  AnimationComponent?: React.ElementType<AnimationProps>;\r\n  open: boolean;\r\n  onClose?: () => void;\r\n  animationContainerClassName?: string;\r\n  role?: HTMLAttributes<HTMLElement>['role'];\r\n} & React.AriaAttributes;\r\n\r\nconst Modal: React.FC<Props> = ({\r\n  open,\r\n  onClose,\r\n  children,\r\n  className,\r\n  centered,\r\n  role,\r\n  AnimationComponent = Grow,\r\n  animationContainerClassName,\r\n  ...ariaAttributes\r\n}: Props) => {\r\n  const modalRef = useRef<HTMLDialogElement>() as React.MutableRefObject<HTMLDialogElement>;\r\n  const mouseEventTargetsPairRef = useRef<Record<'downTarget' | 'upTarget', HTMLElement | null>>({ downTarget: null, upTarget: null });\r\n\r\n  const { handleOpen, handleClose } = useModal();\r\n\r\n  const closeModalEvent = useEventCallback(() => {\r\n    const onAnimationEndHandler = () => {\r\n      // modalRef.current?.close();\r\n      modalRef.current?.classList.remove(styles.close);\r\n      modalRef.current?.removeEventListener('animationend', onAnimationEndHandler);\r\n    };\r\n\r\n    if (modalRef.current?.open) {\r\n      modalRef.current.addEventListener('animationend', onAnimationEndHandler);\r\n      modalRef.current.classList.add(styles.close);\r\n    }\r\n  });\r\n\r\n  const openModalEvent = useEventCallback(() => {\r\n    handleOpen();\r\n    modalRef.current?.showModal();\r\n    modalRef.current?.classList.remove(styles.close);\r\n  });\r\n\r\n  const keyDownHandler: KeyboardEventHandler<HTMLDialogElement> = (event) => {\r\n    if (event.key === 'Escape' && modalRef.current.contains(event.target as HTMLElement)) {\r\n      event.preventDefault();\r\n      onClose?.();\r\n    }\r\n  };\r\n\r\n  const closeHandler: ReactEventHandler<HTMLDialogElement> = (event) => {\r\n    if (modalRef.current.contains(event.target as HTMLElement)) {\r\n      onClose?.();\r\n      handleClose();\r\n    }\r\n  };\r\n\r\n  const closeAnimationEndHandler = () => {\r\n    modalRef.current?.close();\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (open) {\r\n      openModalEvent();\r\n    } else {\r\n      closeModalEvent();\r\n    }\r\n  }, [openModalEvent, closeModalEvent, open]);\r\n\r\n  const clickHandler: ReactEventHandler<HTMLDialogElement> = (event) => {\r\n    const {\r\n      current: { downTarget, upTarget },\r\n    } = mouseEventTargetsPairRef;\r\n\r\n    // modal should only close if both mousedown and mouseup are done on the overlay\r\n    if (downTarget !== upTarget) {\r\n      return;\r\n    }\r\n\r\n    // Backdrop click (the dialog itself) will close the modal\r\n    if (event.target === modalRef.current) {\r\n      onClose?.();\r\n      handleClose();\r\n    }\r\n  };\r\n\r\n  return ReactDOM.createPortal(\r\n    <dialog\r\n      className={classNames(className, { [styles.centered]: centered })}\r\n      onKeyDown={keyDownHandler}\r\n      onClose={closeHandler}\r\n      onClick={clickHandler}\r\n      onMouseDown={(e) => {\r\n        mouseEventTargetsPairRef.current.downTarget = e.target as HTMLElement;\r\n      }}\r\n      onMouseUp={(e) => {\r\n        mouseEventTargetsPairRef.current.upTarget = e.target as HTMLElement;\r\n      }}\r\n      ref={modalRef}\r\n      role={role}\r\n      {...ariaAttributes}\r\n    >\r\n      <AnimationComponent open={open} duration={300} className={animationContainerClassName} onCloseAnimationEnd={closeAnimationEndHandler}>\r\n        {children}\r\n      </AnimationComponent>\r\n    </dialog>,\r\n    document.querySelector('body') as HTMLElement,\r\n  );\r\n};\r\n\r\nexport default Modal;\r\n","import React, { type CSSProperties, type ReactNode } from 'react';\r\n\r\nimport Animation, { type Status } from '../Animation';\r\n\r\ntype Props = {\r\n  open?: boolean;\r\n  duration?: number;\r\n  delay?: number;\r\n  onOpenAnimationEnd?: () => void;\r\n  onCloseAnimationEnd?: () => void;\r\n  children: ReactNode;\r\n  direction?: 'left' | 'top' | 'right' | 'bottom';\r\n  style?: CSSProperties;\r\n};\r\n\r\nconst Slide = ({\r\n  open = true,\r\n  duration = 250,\r\n  delay = 0,\r\n  onOpenAnimationEnd,\r\n  onCloseAnimationEnd,\r\n  children,\r\n  direction = 'top',\r\n  style = {},\r\n}: Props): JSX.Element | null => {\r\n  const seconds = duration / 1000;\r\n  const transition = `transform ${seconds}s ease, opacity ${seconds}s ease`; // todo: -webkit-transform;\r\n  const directions = {\r\n    left: 'translate(-15px, 0)',\r\n    top: 'translate(0, -15px)',\r\n    right: 'translate(15px, 0)',\r\n    bottom: 'translate(0, 15px)',\r\n  };\r\n  const createStyle = (status: Status): CSSProperties => ({\r\n    transition,\r\n    transform: status === 'opening' || status === 'open' ? 'translate(0, 0)' : directions[direction],\r\n    opacity: status === 'opening' || status === 'open' ? 1 : 0,\r\n    zIndex: 15,\r\n    ...style,\r\n  });\r\n\r\n  return (\r\n    <Animation\r\n      createStyle={(status: Status) => createStyle(status)}\r\n      open={open}\r\n      duration={duration}\r\n      delay={delay}\r\n      onOpenAnimationEnd={onOpenAnimationEnd}\r\n      onCloseAnimationEnd={onCloseAnimationEnd}\r\n    >\r\n      {children}\r\n    </Animation>\r\n  );\r\n};\r\n\r\nexport default Slide;\r\n","import * as React from \"react\";\nconst SvgClose = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\" }), /* @__PURE__ */ React.createElement(\"path\", { d: \"M0 0h24v24H0z\", fill: \"none\" }));\nexport default SvgClose;\n","import classNames from 'classnames';\r\nimport React, { type ButtonHTMLAttributes } from 'react';\r\n\r\nimport styles from './IconButton.module.scss';\r\n\r\nexport type Props = ButtonHTMLAttributes<HTMLButtonElement> & {\r\n  onClick?: () => void;\r\n  onBlur?: () => void;\r\n  children: JSX.Element;\r\n  className?: string;\r\n};\r\n\r\nconst IconButton: React.FC<Props> = ({ children, onClick, className, ...ariaProps }: Props) => {\r\n  return (\r\n    <button className={classNames(styles.iconButton, className)} type=\"button\" onClick={onClick} {...ariaProps}>\r\n      {children}\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default IconButton;\r\n","import classNames from 'classnames';\r\nimport React, { type FC, type SVGProps } from 'react';\r\n\r\nimport styles from './Icon.module.scss';\r\n\r\nexport type Props = {\r\n  icon: FC<SVGProps<SVGSVGElement>>;\r\n  className?: string;\r\n};\r\n\r\nconst Icon: FC<Props> = ({ icon: IconComponent, className }) => {\r\n  return <IconComponent className={classNames(styles.icon, className)} aria-hidden=\"true\" />;\r\n};\r\n\r\nexport default Icon;\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\nimport { useTranslation } from 'react-i18next';\r\nimport Close from '@jwp/ott-theme/assets/icons/close.svg?react';\r\n\r\nimport IconButton from '../IconButton/IconButton';\r\nimport Icon from '../Icon/Icon';\r\n\r\nimport styles from './ModalCloseButton.module.scss';\r\n\r\ntype Props = {\r\n  onClick?: () => void;\r\n  visible?: boolean;\r\n};\r\n\r\nconst ModalCloseButton: React.FC<Props> = ({ onClick, visible = true }: Props) => {\r\n  const { t } = useTranslation('common');\r\n\r\n  return (\r\n    <IconButton onClick={onClick} aria-label={t('close_modal')} className={classNames(styles.modalCloseButton, { [styles.hidden]: !visible })}>\r\n      <Icon icon={Close} />\r\n    </IconButton>\r\n  );\r\n};\r\n\r\nexport default ModalCloseButton;\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\n\r\nimport Modal from '../Modal/Modal';\r\nimport Slide from '../Animation/Slide/Slide';\r\nimport ModalCloseButton from '../ModalCloseButton/ModalCloseButton';\r\n\r\nimport styles from './Dialog.module.scss';\r\n\r\ntype Props = {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  size?: 'small' | 'large';\r\n  children: React.ReactNode;\r\n  role?: React.AriaRole;\r\n} & React.AriaAttributes;\r\n\r\nconst Dialog: React.FC<Props> = ({ open, onClose, children, size = 'small', role, ...ariaAttributes }: Props) => {\r\n  return (\r\n    <Modal open={open} onClose={onClose} AnimationComponent={Slide} role={role} centered>\r\n      <div className={classNames(styles.dialog, styles[size])} data-testid={testId('dialog')} {...ariaAttributes}>\r\n        {children}\r\n        <ModalCloseButton onClick={onClose} />\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default Dialog;\r\n","import { useCallback, useState } from 'react';\r\nimport { type AnySchema, ValidationError, type SchemaOf } from 'yup';\r\nimport type { FormErrors, GenericFormValues, UseFormBlurHandler, UseFormChangeHandler, UseFormSubmitHandler } from '@jwp/ott-common/types/form';\r\nimport { FormValidationError } from '@jwp/ott-common/src/errors/FormValidationError';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nexport type UseFormReturnValue<T> = {\r\n  values: T;\r\n  errors: FormErrors<T>;\r\n  validationSchemaError: boolean;\r\n  submitting: boolean;\r\n  handleChange: UseFormChangeHandler;\r\n  handleBlur: UseFormBlurHandler;\r\n  handleSubmit: UseFormSubmitHandler;\r\n  setValue: (key: keyof T, value: T[keyof T]) => void;\r\n  setErrors: (errors: FormErrors<T>) => void;\r\n  setSubmitting: (submitting: boolean) => void;\r\n  setValidationSchemaError: (error: boolean) => void;\r\n  reset: () => void;\r\n};\r\n\r\ntype UseFormMethods<T> = {\r\n  setValue: (key: keyof T, value: string | boolean) => void;\r\n  setErrors: (errors: FormErrors<T>) => void;\r\n  setSubmitting: (submitting: boolean) => void;\r\n  setValidationSchemaError: (error: boolean) => void;\r\n  validate: (validationSchema: AnySchema) => boolean;\r\n};\r\n\r\nexport type UseFormOnSubmitHandler<T> = (values: T, formMethods: UseFormMethods<T>) => void;\r\n\r\nexport default function useForm<T extends GenericFormValues>({\r\n  initialValues,\r\n  validationSchema,\r\n  validateOnBlur = false,\r\n  onSubmit,\r\n  onSubmitSuccess,\r\n  onSubmitError,\r\n}: {\r\n  initialValues: T;\r\n  validationSchema?: SchemaOf<T>;\r\n  validateOnBlur?: boolean;\r\n  onSubmit: UseFormOnSubmitHandler<T>;\r\n  onSubmitSuccess?: (values: T) => void;\r\n  onSubmitError?: ({ error, resetValue }: { error: unknown; resetValue: (key: keyof T) => void }) => void;\r\n}): UseFormReturnValue<T> {\r\n  const { t } = useTranslation('error');\r\n  const [touched, setTouched] = useState<Record<keyof T, boolean>>(\r\n    Object.fromEntries((Object.keys(initialValues) as Array<keyof T>).map((key) => [key, false])) as Record<keyof T, boolean>,\r\n  );\r\n  const [values, setValues] = useState<T>(initialValues);\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [errors, setErrors] = useState<FormErrors<T>>({});\r\n  const [validationSchemaError, setValidationSchemaError] = useState(false);\r\n\r\n  const reset = useCallback(() => {\r\n    setValues(initialValues);\r\n    setErrors({});\r\n    setValidationSchemaError(false);\r\n    setSubmitting(false);\r\n    setTouched(Object.fromEntries((Object.keys(initialValues) as Array<keyof T>).map((key) => [key, false])) as Record<keyof T, boolean>);\r\n  }, [initialValues]);\r\n\r\n  const validateField = (name: string, formValues: T) => {\r\n    if (!validationSchema) return;\r\n\r\n    try {\r\n      validationSchema.validateSyncAt(name, formValues);\r\n\r\n      // clear error\r\n      setErrors((errors) => ({ ...errors, [name]: null }));\r\n    } catch (error: unknown) {\r\n      if (error instanceof ValidationError) {\r\n        const errorMessage = error.errors[0];\r\n        setErrors((errors) => ({ ...errors, [name]: errorMessage }));\r\n        setValidationSchemaError(true);\r\n      }\r\n    }\r\n  };\r\n\r\n  const setValue = useCallback((name: keyof T, value: string | boolean) => {\r\n    setValues((current) => ({ ...current, [name]: value }));\r\n  }, []);\r\n\r\n  const handleChange: UseFormChangeHandler = (event) => {\r\n    const name = event.target.name;\r\n    const value = event.target instanceof HTMLInputElement && event.target.type === 'checkbox' ? event.target.checked : event.target.value;\r\n\r\n    const newValues = { ...values, [name]: value };\r\n\r\n    setValues(newValues);\r\n    setTouched((current) => ({ ...current, [name]: value }));\r\n\r\n    if (errors[name]) {\r\n      validateField(name, newValues);\r\n    }\r\n  };\r\n\r\n  const handleBlur: UseFormBlurHandler = (event) => {\r\n    if (!validateOnBlur || !touched[event.target.name]) return;\r\n\r\n    validateField(event.target.name, values);\r\n  };\r\n\r\n  const validate = (validationSchema: AnySchema) => {\r\n    try {\r\n      validationSchema.validateSync(values, { abortEarly: false });\r\n\r\n      return true;\r\n    } catch (error: unknown) {\r\n      if (error instanceof ValidationError) {\r\n        const newErrors: Record<string, string> = {};\r\n\r\n        for (let index = 0; index < error.inner.length; index++) {\r\n          const path = error.inner[index].path as string;\r\n          const message = error.inner[index].errors[0] as string;\r\n\r\n          if (path && message && !newErrors[path]) {\r\n            newErrors[path] = message;\r\n          }\r\n        }\r\n\r\n        if (error.inner.every((error) => error.type === 'required')) {\r\n          newErrors.form = t('validation_form_error.required');\r\n        } else {\r\n          newErrors.form = t('validation_form_error.other');\r\n        }\r\n\r\n        setErrors(newErrors as FormErrors<T>);\r\n      }\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  const handleSubmit: UseFormSubmitHandler = async (event) => {\r\n    event.preventDefault();\r\n\r\n    if (!onSubmit || submitting) return;\r\n\r\n    // reset errors before submitting\r\n    setErrors({});\r\n    setValidationSchemaError(false);\r\n\r\n    // validate values with schema\r\n    if (validationSchema && !validate(validationSchema)) {\r\n      setValidationSchemaError(true);\r\n      return;\r\n    }\r\n\r\n    // start submitting\r\n    setSubmitting(true);\r\n\r\n    try {\r\n      await onSubmit(values, { setValue, setErrors, setSubmitting, setValidationSchemaError, validate });\r\n      onSubmitSuccess?.(values);\r\n    } catch (error: unknown) {\r\n      const newErrors: Record<string, string> = {};\r\n\r\n      if (error instanceof FormValidationError) {\r\n        Object.entries(error.errors).forEach(([key, value]) => {\r\n          if (key && value && !newErrors[key]) {\r\n            newErrors[key] = value.join(',');\r\n          }\r\n        });\r\n      } else if (error instanceof Error) {\r\n        newErrors.form = error.message;\r\n      } else {\r\n        newErrors.form = t('unknown_error');\r\n      }\r\n      setErrors(newErrors as FormErrors<T>);\r\n\r\n      onSubmitError?.({\r\n        error,\r\n        resetValue: (key: keyof T) => setValue(key, ''),\r\n      });\r\n    }\r\n\r\n    setSubmitting(false);\r\n  };\r\n\r\n  return {\r\n    values,\r\n    errors,\r\n    validationSchemaError,\r\n    handleChange,\r\n    handleBlur,\r\n    handleSubmit,\r\n    submitting,\r\n    setValue,\r\n    setErrors,\r\n    setSubmitting,\r\n    setValidationSchemaError,\r\n    reset,\r\n  };\r\n}\r\n","import { useState } from 'react';\r\n\r\nconst useToggle = (initialState: boolean = false): [boolean, (forceValue?: boolean) => void] => {\r\n  const [state, setState] = useState(initialState);\r\n\r\n  const toggle = (forceValue?: boolean) => setState((current) => (typeof forceValue !== 'undefined' ? forceValue : !current));\r\n\r\n  return [state, toggle];\r\n};\r\n\r\nexport default useToggle;\r\n","import * as React from \"react\";\nconst SvgVisibility = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z\" }));\nexport default SvgVisibility;\n","import * as React from \"react\";\nconst SvgVisibilityOff = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M11.83,9L15,12.16C15,12.11 15,12.05 15,12A3,3 0 0,0 12,9C11.94,9 11.89,9 11.83,9M7.53,9.8L9.08,11.35C9.03,11.56 9,11.77 9,12A3,3 0 0,0 12,15C12.22,15 12.44,14.97 12.65,14.92L14.2,16.47C13.53,16.8 12.79,17 12,17A5,5 0 0,1 7,12C7,11.21 7.2,10.47 7.53,9.8M2,4.27L4.28,6.55L4.73,7C3.08,8.3 1.78,10 1,12C2.73,16.39 7,19.5 12,19.5C13.55,19.5 15.03,19.2 16.38,18.66L16.81,19.08L19.73,22L21,20.73L3.27,3M12,7A5,5 0 0,1 17,12C17,12.64 16.87,13.26 16.64,13.82L19.57,16.75C21.07,15.5 22.27,13.86 23,12C21.27,7.61 17,4.5 12,4.5C10.6,4.5 9.26,4.75 8,5.2L10.17,7.35C10.74,7.13 11.35,7 12,7Z\" }));\nexport default SvgVisibilityOff;\n","import { IS_TEST_MODE } from '@jwp/ott-common/src/utils/common';\r\nimport { useEffect, useState } from 'react';\r\n\r\nconst generateId = (prefix?: string, suffix?: string) => {\r\n  // This test code ensures that ID's in snapshots are always the same.\r\n  // Ideally it would be mocked in the test setup but there seems to be a bug with vitest if you mock Math.random\r\n  const randomId = IS_TEST_MODE ? 1235 : Math.random() * 10000;\r\n\r\n  return [prefix, Math.round(randomId), suffix]\r\n    .filter(Boolean)\r\n    .join('_')\r\n    .replace(/[\\s.]+/g, '_')\r\n    .toLowerCase();\r\n};\r\n\r\nconst useOpaqueId = (prefix?: string, suffix?: string, override?: string): string => {\r\n  const [id, setId] = useState(override || generateId(prefix, suffix));\r\n\r\n  useEffect(() => {\r\n    setId(override || generateId(prefix, suffix));\r\n  }, [override, prefix, suffix]);\r\n\r\n  return id;\r\n};\r\n\r\nexport default useOpaqueId;\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\nimport useOpaqueId from '@jwp/ott-hooks-react/src/useOpaqueId';\r\n\r\nimport styles from './HelperText.module.scss';\r\n\r\ntype Props = {\r\n  children: React.ReactNode;\r\n  className?: string;\r\n  error?: boolean;\r\n  id?: string;\r\n};\r\n\r\nconst HelperText: React.FC<Props> = ({ children, className, error, id }: Props) => {\r\n  const helperId = useOpaqueId('helper_text', undefined, id);\r\n\r\n  return children ? (\r\n    <div id={helperId} className={classNames(styles.helperText, { [styles.error]: error }, className)}>\r\n      {children}\r\n    </div>\r\n  ) : null;\r\n};\r\n\r\nexport default HelperText;\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\nimport useOpaqueId from '@jwp/ott-hooks-react/src/useOpaqueId';\r\n\r\nimport HelperText from '../HelperText/HelperText';\r\nimport type { FormControlProps } from '../../types/form';\r\n\r\nimport styles from './FormField.module.scss';\r\n\r\ntype RenderInputProps = {\r\n  helperTextId: string;\r\n  id: string;\r\n};\r\n\r\ntype Props = {\r\n  helperText?: React.ReactNode;\r\n  renderInput: (fieldProps: RenderInputProps) => React.ReactElement;\r\n} & Omit<FormControlProps, 'value' | 'placeholder'>;\r\n\r\nexport const FormField = ({ className, renderInput, required, label, error, helperText, testId, editing = true, name }: Props) => {\r\n  const formFieldClassName = classNames(styles.formField, className);\r\n  const id = useOpaqueId('text-field', name);\r\n  const helperTextId = useOpaqueId('helper_text', name);\r\n\r\n  return (\r\n    <div className={formFieldClassName} data-testid={testId}>\r\n      {!!label && (\r\n        <label htmlFor={id} className={styles.label}>\r\n          {label}\r\n          {required && editing ? <span aria-hidden=\"true\">*</span> : null}\r\n        </label>\r\n      )}\r\n      {renderInput({ helperTextId, id })}\r\n      {editing && (\r\n        <HelperText id={helperTextId} error={error}>\r\n          {helperText}\r\n        </HelperText>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","import React, { type InputHTMLAttributes, type RefObject, type TextareaHTMLAttributes } from 'react';\r\nimport classNames from 'classnames';\r\n\r\nimport type { FormControlProps } from '../../types/form';\r\n\r\nimport styles from './Input.module.scss';\r\n\r\ntype CommonProps = {\r\n  id?: string;\r\n  helperTextId?: string;\r\n  leftControl?: React.ReactNode;\r\n  rightControl?: React.ReactNode;\r\n  multiline?: boolean;\r\n} & FormControlProps;\r\n\r\ntype HTMLInputProps = Omit<InputHTMLAttributes<HTMLInputElement>, 'size'>;\r\ntype HTMLTextAreaProps = Omit<TextareaHTMLAttributes<HTMLTextAreaElement>, 'size'>;\r\n\r\ntype InputProps = HTMLInputProps & {\r\n  type?: InputHTMLAttributes<HTMLInputElement>['type'];\r\n  multiline?: boolean;\r\n  inputRef?: RefObject<HTMLInputElement>;\r\n  textAreaRef?: never;\r\n} & CommonProps;\r\ntype TextAreaProps = HTMLTextAreaProps & { type?: never; multiline: true; inputRef?: never; textAreaRef?: RefObject<HTMLTextAreaElement> } & CommonProps;\r\n\r\nexport type Props = InputProps | TextAreaProps;\r\n\r\nconst isTextArea = (_props: HTMLInputProps | HTMLTextAreaProps, multiline?: boolean): _props is HTMLTextAreaProps => !!multiline;\r\n\r\nconst Input = ({\r\n  required,\r\n  className,\r\n  disabled,\r\n  editing = true,\r\n  value,\r\n  id,\r\n  name,\r\n  multiline,\r\n  error,\r\n  helperTextId,\r\n  type,\r\n  textAreaRef,\r\n  inputRef,\r\n  leftControl,\r\n  rightControl,\r\n  ...inputProps\r\n}: Props) => {\r\n  // Default to 'text' if 'type' property is absent, which occurs in textareas.\r\n  const inputType = type || 'text';\r\n  const containerClassName = classNames(\r\n    styles.container,\r\n    {\r\n      [styles.error]: error,\r\n      [styles.disabled]: disabled,\r\n      [styles.leftControl]: !!leftControl,\r\n      [styles.rightControl]: !!rightControl,\r\n    },\r\n    className,\r\n  );\r\n\r\n  const ariaAttributes = {\r\n    'aria-required': !!required,\r\n    'aria-invalid': Boolean(required && error && value !== ''),\r\n    'aria-describedby': helperTextId,\r\n  } as const;\r\n\r\n  const commonProps: HTMLInputProps | HTMLTextAreaProps = {\r\n    id,\r\n    name,\r\n    value,\r\n    disabled,\r\n    rows: multiline ? 3 : undefined,\r\n    className: styles.input,\r\n    readOnly: !editing,\r\n    required: required,\r\n    ...ariaAttributes,\r\n    ...inputProps,\r\n  };\r\n\r\n  const input = isTextArea(commonProps, multiline) ? (\r\n    <textarea {...commonProps} ref={textAreaRef} />\r\n  ) : (\r\n    <input {...commonProps} type={inputType} ref={inputRef} />\r\n  );\r\n\r\n  return editing ? (\r\n    <div className={containerClassName}>\r\n      {leftControl ? <div className={styles.control}>{leftControl}</div> : null}\r\n      {input}\r\n      {rightControl ? <div className={styles.control}>{rightControl}</div> : null}\r\n    </div>\r\n  ) : (\r\n    input\r\n  );\r\n};\r\n\r\nexport default Input;\r\n","import React, { type InputHTMLAttributes } from 'react';\r\nimport classNames from 'classnames';\r\n\r\nimport { FormField } from '../../FormField/FormField';\r\nimport Input from '../../Input/Input';\r\nimport type { FormControlProps } from '../../../types/form';\r\n\r\nimport styles from './TextField.module.scss';\r\n\r\ntype InputProps = Omit<InputHTMLAttributes<HTMLInputElement>, 'size'>;\r\n\r\ntype Props = InputProps & {\r\n  helperText?: React.ReactNode;\r\n  multiline?: boolean;\r\n  leftControl?: React.ReactNode;\r\n  rightControl?: React.ReactNode;\r\n} & FormControlProps;\r\n\r\nconst TextField: React.FC<Props> = ({ className, helperText, label, error, required, editing = true, testId, name, ...inputProps }) => {\r\n  return (\r\n    <FormField\r\n      className={classNames(styles.textField, className)}\r\n      error={error}\r\n      helperText={helperText}\r\n      label={label}\r\n      required={required}\r\n      editing={editing}\r\n      testId={testId}\r\n      name={name}\r\n      renderInput={(fieldProps) => <Input editing={editing} error={error} name={name} required={required} {...fieldProps} {...inputProps} />}\r\n    />\r\n  );\r\n};\r\n\r\nexport default TextField;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport styles from './PasswordStrength.module.scss';\r\n\r\ntype Props = {\r\n  password: string;\r\n};\r\n\r\nconst PASSWORD_REGEX = /^(?=.*[a-z])(?=.*[0-9]).{8,}$/;\r\n\r\nconst PasswordStrength: React.FC<Props> = ({ password }: Props) => {\r\n  const { t } = useTranslation('account');\r\n\r\n  const passwordStrength = (password: string) => {\r\n    let strength = 0;\r\n\r\n    if (!password.match(PASSWORD_REGEX)) return strength;\r\n\r\n    if (password.match(/[A-Z]+/)) {\r\n      strength += 1;\r\n    }\r\n\r\n    if (password.match(/(\\d.*\\d)/)) {\r\n      strength += 1;\r\n    }\r\n\r\n    if (password.match(/[!,@#$%^&*?_~]/)) {\r\n      strength += 1;\r\n    }\r\n\r\n    if (password.match(/([!,@#$%^&*?_~].*[!,@#$%^&*?_~])/)) {\r\n      strength += 1;\r\n    }\r\n\r\n    return strength;\r\n  };\r\n  const strength = passwordStrength(password);\r\n  const labels = [\r\n    t('registration.password_strength.invalid'),\r\n    t('registration.password_strength.weak'),\r\n    t('registration.password_strength.fair'),\r\n    t('registration.password_strength.strong'),\r\n    t('registration.password_strength.very_strong'),\r\n  ];\r\n\r\n  if (!strength) return null;\r\n\r\n  return (\r\n    <div className={styles.passwordStrength} data-strength={strength}>\r\n      <div className={styles.passwordStrengthBar}>\r\n        <div className={styles.passwordStrengthFill} />\r\n      </div>\r\n      <span className=\"hidden\">{t('registration.password_strength_prefix')}</span> <span className={styles.label}>{labels[strength]}</span>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PasswordStrength;\r\n","import React, { type InputHTMLAttributes } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport useToggle from '@jwp/ott-hooks-react/src/useToggle';\r\nimport Visibility from '@jwp/ott-theme/assets/icons/visibility.svg?react';\r\nimport VisibilityOff from '@jwp/ott-theme/assets/icons/visibility_off.svg?react';\r\n\r\nimport TextField from '../TextField/TextField';\r\nimport PasswordStrength from '../../PasswordStrength/PasswordStrength';\r\nimport IconButton from '../../IconButton/IconButton';\r\nimport Icon from '../../Icon/Icon';\r\nimport type { FormControlProps } from '../../../types/form';\r\n\r\ntype InputProps = Omit<InputHTMLAttributes<HTMLInputElement>, 'size'>;\r\n\r\ntype Props = InputProps & {\r\n  helperText?: React.ReactNode;\r\n  showToggleView?: boolean;\r\n  showHelperText?: boolean;\r\n} & FormControlProps;\r\n\r\nconst PasswordField: React.FC<Props> = ({ value, showToggleView = true, helperText, showHelperText = true, ...props }: Props) => {\r\n  const { t } = useTranslation('account');\r\n  const [viewPassword, toggleViewPassword] = useToggle();\r\n\r\n  return (\r\n    <TextField\r\n      {...props}\r\n      helperText={\r\n        helperText ??\r\n        (showHelperText ? (\r\n          <React.Fragment>\r\n            <PasswordStrength password={value || ''} />\r\n            {t('reset.password_helper_text')}\r\n          </React.Fragment>\r\n        ) : null)\r\n      }\r\n      type={viewPassword ? 'text' : 'password'}\r\n      rightControl={\r\n        showToggleView ? (\r\n          <IconButton aria-label={t('reset.view_password')} onClick={() => toggleViewPassword()} aria-pressed={viewPassword}>\r\n            <Icon icon={viewPassword ? Visibility : VisibilityOff} />\r\n          </IconButton>\r\n        ) : null\r\n      }\r\n      required\r\n    />\r\n  );\r\n};\r\n\r\nexport default PasswordField;\r\n","import { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport type { DeleteAccountFormData } from '@jwp/ott-common/types/account';\r\nimport useForm from '@jwp/ott-hooks-react/src/useForm';\r\nimport { useCallback, useEffect, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useMutation } from 'react-query';\r\nimport { useLocation, useNavigate } from 'react-router';\r\nimport { object, string } from 'yup';\r\nimport { FormValidationError } from '@jwp/ott-common/src/errors/FormValidationError';\r\nimport classNames from 'classnames';\r\n\r\nimport { useAriaAnnouncer } from '../../containers/AnnouncementProvider/AnnoucementProvider';\r\nimport { modalURLFromLocation } from '../../utils/location';\r\nimport Button from '../Button/Button';\r\nimport PasswordField from '../form-fields/PasswordField/PasswordField';\r\nimport useQueryParam from '../../hooks/useQueryParam';\r\nimport FormFeedback from '../FormFeedback/FormFeedback';\r\n\r\nimport styles from './DeleteAccountModal.module.scss';\r\n\r\nconst DeleteAccountModal = () => {\r\n  const accountController = getModule(AccountController);\r\n\r\n  const { t } = useTranslation('user');\r\n  const announce = useAriaAnnouncer();\r\n  const u = useQueryParam('u');\r\n\r\n  const [enteredPassword, setEnteredPassword] = useState<string>('');\r\n\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n\r\n  const {\r\n    handleSubmit,\r\n    handleChange,\r\n    values,\r\n    errors,\r\n    setErrors,\r\n    reset: resetForm,\r\n  } = useForm<DeleteAccountFormData>({\r\n    initialValues: { password: '' },\r\n    validationSchema: object().shape({ password: string().required(t('login.field_required')) }),\r\n    onSubmit: (values) => {\r\n      setEnteredPassword(values.password);\r\n      navigate(modalURLFromLocation(location, 'delete-account-confirmation'), { replace: true });\r\n    },\r\n  });\r\n\r\n  const deleteAccount = useMutation(accountController.deleteAccountData, {\r\n    onSuccess: async () => {\r\n      navigate('/');\r\n      await accountController.logout();\r\n      announce(t('account.delete_account.success'), 'success');\r\n    },\r\n    onError: (error: unknown) => {\r\n      if (error instanceof FormValidationError) {\r\n        setErrors(error.errors);\r\n        navigate(modalURLFromLocation(location, 'delete-account'), { replace: true });\r\n      }\r\n      setEnteredPassword('');\r\n    },\r\n  });\r\n\r\n  useEffect(() => {\r\n    // when the user navigates directly to the confirmation step\r\n    if (u === 'delete-account-confirmation' && !enteredPassword) {\r\n      navigate(modalURLFromLocation(location, 'delete-account'), { replace: true });\r\n    }\r\n  }, [location, u, navigate, enteredPassword, deleteAccount, resetForm]);\r\n\r\n  const handleCancel = useCallback(() => {\r\n    navigate(modalURLFromLocation(location, null), { replace: true });\r\n  }, [location, navigate]);\r\n\r\n  // step 2: delete account confirmation\r\n  if (enteredPassword) {\r\n    return (\r\n      <div>\r\n        <h2 className={styles.heading}>{t('account.delete_account.title')}</h2>\r\n        <div className={styles.disclaimer}>\r\n          <p>{t('account.delete_account.modal.text_data_erasure')}</p>\r\n          <p>{t('account.delete_account.modal.text_revoked_access')}</p>\r\n          <div className={styles.warningBox}>\r\n            <p>{t('account.delete_account.modal.warning')}</p>\r\n          </div>\r\n          <p>\r\n            {t('account.delete_account.modal.text_cant_be_undone')} <br />\r\n            {t('account.delete_account.modal.text_contacts')}\r\n          </p>\r\n        </div>\r\n        <div className={styles.buttons}>\r\n          <Button disabled={deleteAccount.isLoading} variant=\"text\" label={t('account.cancel')} onClick={handleCancel} />\r\n          <Button\r\n            disabled={deleteAccount.isLoading}\r\n            variant=\"delete\"\r\n            label={t('account.delete_account.title')}\r\n            onClick={() => {\r\n              deleteAccount.mutate(enteredPassword);\r\n            }}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // step 1: enter your password\r\n  return (\r\n    <form onSubmit={handleSubmit}>\r\n      <h2 className={styles.heading}>{t('account.delete_account.title')}</h2>\r\n      <p className={styles.paragraph}>{t('account.delete_account.modal.description')}</p>\r\n      {errors.form && <FormFeedback variant=\"error\">{errors.form}</FormFeedback>}\r\n      <PasswordField\r\n        value={values.password}\r\n        onChange={handleChange}\r\n        label={t('account.password')}\r\n        placeholder={t('account.delete_account.modal.placeholder')}\r\n        error={!!errors.password || !!errors.form}\r\n        helperText={errors.password}\r\n        name=\"password\"\r\n        showHelperText={false}\r\n      />\r\n      <div className={classNames(styles.buttons, styles.stacked)}>\r\n        <Button type=\"submit\" color=\"primary\" label={t('account.continue')} fullWidth />\r\n        <Button type=\"button\" onClick={handleCancel} variant=\"text\" label={t('account.cancel')} fullWidth />\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default DeleteAccountModal;\r\n","import React, { useEffect, useMemo, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useLocation, useNavigate } from 'react-router';\r\nimport { useSearchParams } from 'react-router-dom';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport CheckoutController from '@jwp/ott-common/src/controllers/CheckoutController';\r\nimport { ACCESS_MODEL } from '@jwp/ott-common/src/constants';\r\nimport useEventCallback from '@jwp/ott-hooks-react/src/useEventCallback';\r\n\r\nimport Button from '../Button/Button';\r\nimport Spinner from '../Spinner/Spinner';\r\nimport { modalURLFromLocation } from '../../utils/location';\r\nimport { useAriaAnnouncer } from '../../containers/AnnouncementProvider/AnnoucementProvider';\r\n\r\nimport styles from './FinalizePayment.module.scss';\r\n\r\nconst FinalizePayment = () => {\r\n  const accountController = getModule(AccountController);\r\n  const checkoutController = getModule(CheckoutController);\r\n\r\n  const { t } = useTranslation('account');\r\n  const announce = useAriaAnnouncer();\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n\r\n  const { accessModel } = useConfigStore(({ accessModel }) => ({ accessModel }));\r\n  const [searchParams] = useSearchParams();\r\n  const redirectResult = searchParams.get('redirectResult');\r\n  const orderIdQueryParam = searchParams.get('orderId');\r\n\r\n  const [errorMessage, setErrorMessage] = useState<string>();\r\n\r\n  const paymentSuccessUrl = useMemo(() => {\r\n    return modalURLFromLocation(location, accessModel === ACCESS_MODEL.SVOD ? 'welcome' : null);\r\n  }, [accessModel, location]);\r\n\r\n  const checkPaymentResult = useEventCallback(async (redirectResult: string) => {\r\n    const orderId = orderIdQueryParam ? parseInt(orderIdQueryParam, 10) : undefined;\r\n\r\n    try {\r\n      await checkoutController.finalizeAdyenPayment({ redirectResult: decodeURI(redirectResult) }, orderId);\r\n      await accountController.reloadSubscriptions({ retry: 10 });\r\n\r\n      announce(t('checkout.payment_success'), 'success');\r\n      navigate(paymentSuccessUrl);\r\n    } catch (error: unknown) {\r\n      if (error instanceof Error) {\r\n        setErrorMessage(error.message);\r\n      }\r\n    }\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (!redirectResult) return;\r\n\r\n    checkPaymentResult(redirectResult);\r\n  }, [checkPaymentResult, redirectResult]);\r\n\r\n  return (\r\n    <div className={styles.container}>\r\n      {errorMessage ? (\r\n        <>\r\n          <h2 className={styles.title}>{errorMessage}</h2>\r\n          <Button\r\n            label={t('checkout.go_back_to_checkout')}\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            size=\"large\"\r\n            onClick={() => navigate(modalURLFromLocation(location, 'checkout'))}\r\n            fullWidth\r\n          />\r\n        </>\r\n      ) : (\r\n        <div>\r\n          <Spinner />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FinalizePayment;\r\n","import { useCallback, useEffect, useRef, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport CheckoutController from '@jwp/ott-common/src/controllers/CheckoutController';\r\n\r\ntype IntervalCheckAccessPayload = {\r\n  interval?: number;\r\n  iterations?: number;\r\n  offerId?: string;\r\n  callback?: ({ hasAccess, offerId }: { hasAccess: boolean; offerId: string }) => void;\r\n};\r\n\r\nconst useCheckAccess = () => {\r\n  const accountController = getModule(AccountController);\r\n  const checkoutController = getModule(CheckoutController);\r\n\r\n  const intervalRef = useRef<number>();\r\n  const [errorMessage, setErrorMessage] = useState<string | null>(null);\r\n  const { t } = useTranslation('user');\r\n\r\n  const offers = checkoutController.getSubscriptionOfferIds();\r\n\r\n  const intervalCheckAccess = useCallback(\r\n    ({ interval = 3000, iterations = 5, offerId = offers?.[0], callback }: IntervalCheckAccessPayload) => {\r\n      if (!offerId) {\r\n        callback?.({ hasAccess: false, offerId: '' });\r\n        return;\r\n      }\r\n\r\n      intervalRef.current = window.setInterval(async () => {\r\n        const hasAccess = await accountController.checkEntitlements(offerId);\r\n\r\n        if (hasAccess) {\r\n          window.clearInterval(intervalRef.current);\r\n          // No duplicate retry mechanism. This can also be a TVOD offer which isn't validated using the\r\n          // reloadSubscriptions method.\r\n          await accountController.reloadSubscriptions();\r\n          callback?.({ hasAccess: true, offerId: offerId || '' });\r\n        } else if (--iterations === 0) {\r\n          window.clearInterval(intervalRef.current);\r\n          setErrorMessage(t('payment.longer_than_usual'));\r\n          callback?.({ hasAccess: false, offerId: offerId || '' });\r\n        }\r\n      }, interval);\r\n    },\r\n    [offers, t, accountController],\r\n  );\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      window.clearInterval(intervalRef.current);\r\n    };\r\n  }, []);\r\n\r\n  return { intervalCheckAccess, errorMessage };\r\n};\r\n\r\nexport default useCheckAccess;\r\n","import React, { useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport useCheckAccess from '@jwp/ott-hooks-react/src/useCheckAccess';\r\nimport { modalURLFromLocation } from '@jwp/ott-ui-react/src/utils/location';\r\n\r\nimport Spinner from '../Spinner/Spinner';\r\nimport { useAriaAnnouncer } from '../../containers/AnnouncementProvider/AnnoucementProvider';\r\nimport useQueryParam from '../../hooks/useQueryParam';\r\n\r\nimport styles from './WaitingForPayment.module.scss';\r\n\r\nconst WaitingForPayment = () => {\r\n  const { t } = useTranslation('account');\r\n  const offerId = useQueryParam('offerId') || undefined;\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const announce = useAriaAnnouncer();\r\n  const { intervalCheckAccess, errorMessage } = useCheckAccess();\r\n\r\n  useEffect(() => {\r\n    intervalCheckAccess({\r\n      interval: 3000,\r\n      iterations: 5,\r\n      offerId,\r\n      callback: ({ hasAccess, offerId }) => {\r\n        if (!hasAccess) return;\r\n\r\n        announce(t('checkout.payment_success'), 'success');\r\n\r\n        // close the modal for PPV/TVOD offers\r\n        if (offerId.startsWith('C') || offerId.startsWith('P')) {\r\n          // @TODO should we show a dedicated modal for TVOD access?\r\n          navigate(modalURLFromLocation(location, null));\r\n        } else {\r\n          navigate(modalURLFromLocation(location, 'welcome'));\r\n        }\r\n      },\r\n    });\r\n    //eslint-disable-next-line\r\n  }, []);\r\n  return (\r\n    <div className={styles.center}>\r\n      {errorMessage ? (\r\n        <h2>{errorMessage}</h2>\r\n      ) : (\r\n        <>\r\n          <Spinner />\r\n          <h2>{t('checkout.waiting_for_payment')}</h2>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WaitingForPayment;\r\n","import React, { useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport Button from '../Button/Button';\r\nimport { type AriaAnnouncerVariant, useAriaAnnouncer } from '../../containers/AnnouncementProvider/AnnoucementProvider';\r\n\r\nimport styles from './UpgradeSubscription.module.scss';\r\n\r\ntype Props = {\r\n  type: 'error' | 'success' | 'pending';\r\n  onCloseButtonClick: () => void;\r\n};\r\n\r\nconst UpgradeSubscription: React.FC<Props> = ({ type, onCloseButtonClick }: Props) => {\r\n  const { t } = useTranslation('account');\r\n  const announce = useAriaAnnouncer();\r\n\r\n  // these comments exist for extracting dynamic i18n keys\r\n  // t('account:checkout.upgrade_success');\r\n  // t('account:checkout.upgrade_success_message');\r\n  // t('account:checkout.upgrade_pending');\r\n  // t('account:checkout.upgrade_pending_message');\r\n  // t('account:checkout.upgrade_error');\r\n  // t('account:checkout.upgrade_error_message');\r\n  const title = t(`checkout.upgrade_${type}`);\r\n  const message = t(`checkout.upgrade_${type}_message`);\r\n\r\n  useEffect(() => {\r\n    const typeToAnnounce = { error: 'error', success: 'succes', pending: 'info' }[type] as AriaAnnouncerVariant;\r\n\r\n    announce(message, typeToAnnounce);\r\n  }, [announce, message, type]);\r\n\r\n  return (\r\n    <div>\r\n      <h2 className={styles.title}>{title}</h2>\r\n      <p className={styles.message}>{message}</p>\r\n      <div>\r\n        <Button label={t('checkout.close')} onClick={onCloseButtonClick} color=\"primary\" variant=\"contained\" size=\"large\" fullWidth />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UpgradeSubscription;\r\n","import { useTranslation } from 'react-i18next';\r\nimport { useLocation, useNavigate } from 'react-router';\r\nimport { useCallback, useState } from 'react';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\n\r\nimport Button from '../Button/Button';\r\nimport FormFeedback from '../FormFeedback/FormFeedback';\r\nimport { modalURLFromLocation } from '../../utils/location';\r\n\r\nimport styles from './DeleteAccountPasswordWarning.module.scss';\r\n\r\nconst DeleteAccountPasswordWarning = () => {\r\n  const accountController = getModule(AccountController);\r\n\r\n  const { t } = useTranslation('user');\r\n  const email = useAccountStore((state) => state.user?.email);\r\n  const [errorMessage, setErrorMessage] = useState<string>();\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n\r\n  const handleCancel = useCallback(() => {\r\n    navigate(modalURLFromLocation(location, null), { replace: true });\r\n  }, [location, navigate]);\r\n  const proceedToAddPasswordClickHandler = async () => {\r\n    try {\r\n      if (email) {\r\n        await accountController.resetPassword(email, '');\r\n        navigate(modalURLFromLocation(location, 'add-password'));\r\n      }\r\n    } catch (error: unknown) {\r\n      setErrorMessage(t('account.add_password_error'));\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={styles.formContainer}>\r\n      {errorMessage && (\r\n        <div className={styles.formFeedback}>\r\n          <FormFeedback variant=\"error\">{errorMessage}</FormFeedback>\r\n        </div>\r\n      )}\r\n      <h2 className={styles.heading}>{t('account.delete_account_password_warning.title')}</h2>\r\n      <p className={styles.paragraph}>{t('account.delete_account_password_warning.text')}</p>\r\n      <div className={styles.passwordButtonsContainer}>\r\n        <Button\r\n          type=\"submit\"\r\n          onClick={proceedToAddPasswordClickHandler}\r\n          className={styles.button}\r\n          color=\"primary\"\r\n          fullWidth\r\n          label={t('account.proceed_to_adding_a_password')}\r\n        />\r\n        <Button type=\"button\" onClick={handleCancel} className={styles.button} variant=\"text\" fullWidth label={t('account.cancel')} />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DeleteAccountPasswordWarning;\r\n","import * as React from \"react\";\nconst SvgCreditcard = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { fill: \"currentColor\", d: \"M20,8H4V6H20M20,18H4V12H20M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z\" }));\nexport default SvgCreditcard;\n","import * as React from \"react\";\nconst SvgPaypal = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M7.37083 12.6026c-.70164 0-1.28549-.0571-1.72496-.1142l-1.34375 6.9595H.179688L3.83225.516163C5.08988.201006 7.07827 0 8.97801 0c1.75279 0 3.79949.286619 5.23309 1.28917 1.3172.88839 2.1354 2.23464 2.1354 4.0958 0 2.4344-1.1386 4.26703-2.6901 5.44083-1.6084 1.2333-3.8881 1.7768-6.28557 1.7768zm1.72496-9.30834c-.78902 0-1.34375.05832-1.69457.14393L6.28924 9.13832c.43821.08561.90681.14269 1.60845.14269 2.54311 0 4.20851-1.60433 4.20851-3.52257 0-1.8624-1.3741-2.46418-3.01041-2.46418zm7.22271.21844c.523.18487 1.0195.4169 1.4552.72213 1.3158.88715 2.1353 2.23339 2.1365 4.09456 0 2.43441-1.1398 4.26701-2.69 5.44201-1.6084 1.2321-3.8869 1.7756-6.2856 1.7756-.7016 0-1.28676-.0571-1.72497-.1154l-1.34501 6.9595H3.74219l.31915-1.6577h1.30702l1.34502-6.9582c.4382.057 1.02206.1141 1.72496.1141 2.39746 0 4.67586-.5447 6.28556-1.7755 1.549-1.1738 2.6888-3.00769 2.6888-5.44209 0-1.29909-.4053-2.34258-1.0942-3.15901z\" }));\nexport default SvgPaypal;\n","import React, { useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport type { PaymentMethod } from '@jwp/ott-common/types/checkout';\r\nimport CreditCard from '@jwp/ott-theme/assets/icons/creditcard.svg?react';\r\nimport PayPal from '@jwp/ott-theme/assets/icons/paypal.svg?react';\r\n\r\nimport Button from '../Button/Button';\r\nimport LoadingOverlay from '../LoadingOverlay/LoadingOverlay';\r\nimport Icon from '../Icon/Icon';\r\nimport { useAriaAnnouncer } from '../../containers/AnnouncementProvider/AnnoucementProvider';\r\n\r\nimport styles from './PaymentMethodForm.module.scss';\r\n\r\ntype Props = {\r\n  paymentMethodId?: number;\r\n  onCloseButtonClick: () => void;\r\n  paymentMethods?: PaymentMethod[];\r\n  onPaymentMethodChange: React.ChangeEventHandler<HTMLInputElement>;\r\n  renderPaymentMethod?: () => JSX.Element | null;\r\n  submitting: boolean;\r\n  updateSuccess: boolean;\r\n};\r\n\r\nconst PaymentMethodForm: React.FC<Props> = ({\r\n  paymentMethodId,\r\n  paymentMethods,\r\n  onCloseButtonClick,\r\n  onPaymentMethodChange,\r\n  renderPaymentMethod,\r\n  submitting,\r\n  updateSuccess,\r\n}) => {\r\n  const { t } = useTranslation('account');\r\n  const announce = useAriaAnnouncer();\r\n  // t('payment.longer_than_usual');\r\n\r\n  const cardPaymentMethod = paymentMethods?.find((method) => method.methodName === 'card');\r\n  const paypalPaymentMethod = paymentMethods?.find((method) => method.methodName === 'paypal');\r\n\r\n  useEffect(() => {\r\n    updateSuccess && announce(t('checkout.payment_success'), 'success');\r\n  }, [updateSuccess, announce, t]);\r\n\r\n  return (\r\n    <>\r\n      <h1 className={styles.title}>{t('payment.update_payment_details')}</h1>\r\n      {updateSuccess ? (\r\n        <>\r\n          <p className={styles.success}>{t('payment.update_payment_success')}</p>\r\n          <Button label={t('payment.back_to_profile')} onClick={onCloseButtonClick} color=\"primary\" fullWidth />\r\n        </>\r\n      ) : (\r\n        <>\r\n          <div className={styles.paymentMethodsInputs}>\r\n            {cardPaymentMethod ? (\r\n              <div className={styles.paymentMethod}>\r\n                <input\r\n                  className={styles.radio}\r\n                  type=\"radio\"\r\n                  name=\"paymentMethod\"\r\n                  value={cardPaymentMethod.id}\r\n                  id=\"card\"\r\n                  checked={paymentMethodId === cardPaymentMethod.id}\r\n                  onChange={onPaymentMethodChange}\r\n                />\r\n                <label className={styles.paymentMethodLabel} htmlFor=\"card\">\r\n                  <Icon icon={CreditCard} />\r\n                  {t('payment.credit_card')}\r\n                </label>\r\n              </div>\r\n            ) : null}\r\n            {paypalPaymentMethod ? (\r\n              <div className={styles.paymentMethod}>\r\n                <input\r\n                  className={styles.radio}\r\n                  type=\"radio\"\r\n                  name=\"paymentMethod\"\r\n                  value={paypalPaymentMethod.id}\r\n                  id=\"paypal\"\r\n                  checked={paymentMethodId === paypalPaymentMethod.id}\r\n                  onChange={onPaymentMethodChange}\r\n                />\r\n                <label className={styles.paymentMethodLabel} htmlFor=\"paypal\">\r\n                  <Icon icon={PayPal} /> {t('payment.paypal')}\r\n                </label>\r\n              </div>\r\n            ) : null}\r\n          </div>\r\n          <div>{renderPaymentMethod ? renderPaymentMethod() : null}</div>\r\n          {submitting && <LoadingOverlay transparentBackground inline />}\r\n        </>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PaymentMethodForm;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport Button from '../Button/Button';\r\nimport FormFeedback from '../FormFeedback/FormFeedback';\r\n\r\nimport styles from './PayPal.module.scss';\r\n\r\ntype Props = {\r\n  onSubmit?: () => void;\r\n  error: string | null;\r\n};\r\n\r\nconst PayPal: React.FC<Props> = ({ onSubmit, error }) => {\r\n  const { t } = useTranslation('account');\r\n\r\n  return (\r\n    <div className={styles.payPal}>\r\n      {error ? <FormFeedback variant=\"error\">{error}</FormFeedback> : null}\r\n      <p>{t('checkout.paypal_instructions')}</p>\r\n      <Button label={t('checkout.continue')} variant=\"contained\" color=\"primary\" size=\"large\" onClick={onSubmit} fullWidth />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PayPal;\r\n","import React, { useEffect, useRef } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport AdyenCheckout from '@adyen/adyen-web';\r\nimport type { CoreOptions } from '@adyen/adyen-web/dist/types/core/types';\r\nimport type { PaymentMethods } from '@adyen/adyen-web/dist/types/types';\r\n\r\nimport Button from '../Button/Button';\r\nimport FormFeedback from '../FormFeedback/FormFeedback';\r\n\r\nimport styles from './Adyen.module.scss';\r\nimport '@adyen/adyen-web/dist/adyen.css';\r\nimport './AdyenForm.scss';\r\n\r\ntype Props = {\r\n  configuration: CoreOptions;\r\n  error?: string;\r\n  type: AdyenPaymentMethodType;\r\n};\r\n\r\nconst Adyen: React.FC<Props> = ({ configuration, error, type }) => {\r\n  const { t } = useTranslation('account');\r\n  const checkoutElementRef = useRef(null);\r\n  const checkoutRef = useRef<InstanceType<PaymentMethods[typeof type]>>();\r\n\r\n  useEffect(() => {\r\n    if (!checkoutElementRef.current || !configuration.session) {\r\n      return;\r\n    }\r\n\r\n    const createCheckout = async () => {\r\n      const checkout = await AdyenCheckout(configuration);\r\n\r\n      if (checkoutElementRef.current) {\r\n        checkoutRef.current = checkout.create(type);\r\n        checkoutRef.current?.mount(checkoutElementRef.current);\r\n      }\r\n    };\r\n\r\n    createCheckout();\r\n\r\n    return () => {\r\n      checkoutRef.current?.unmount();\r\n    };\r\n  }, [configuration, type]);\r\n\r\n  return (\r\n    <div className={styles.adyen}>\r\n      {error ? <FormFeedback variant=\"error\">{error}</FormFeedback> : null}\r\n      <div className={styles.container} ref={checkoutElementRef} />\r\n      <Button\r\n        label={t('checkout.continue')}\r\n        variant=\"contained\"\r\n        color=\"primary\"\r\n        size=\"large\"\r\n        onClick={() => {\r\n          checkoutRef.current && checkoutRef.current.submit();\r\n        }}\r\n        fullWidth\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Adyen;\r\n","import type { CoreOptions } from '@adyen/adyen-web/dist/types/core/types';\r\nimport { useCallback, useEffect, useMemo, useState } from 'react';\r\nimport type DropinElement from '@adyen/adyen-web/dist/types/components/Dropin/Dropin';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport type { AdyenPaymentSession } from '@jwp/ott-common/types/checkout';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport CheckoutController from '@jwp/ott-common/src/controllers/CheckoutController';\r\nimport { modalURLFromLocation, modalURLFromWindowLocation } from '@jwp/ott-ui-react/src/utils/location';\r\nimport { ADYEN_LIVE_CLIENT_KEY, ADYEN_TEST_CLIENT_KEY } from '@jwp/ott-common/src/constants';\r\nimport useQueryParam from '@jwp/ott-ui-react/src/hooks/useQueryParam';\r\nimport useEventCallback from '@jwp/ott-hooks-react/src/useEventCallback';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport Adyen from '../../components/Adyen/Adyen';\r\nimport { useAriaAnnouncer } from '../AnnouncementProvider/AnnoucementProvider';\r\n\r\ntype Props = {\r\n  setProcessing: (loading: boolean) => void;\r\n  setPaymentError: (errorMessage?: string) => void;\r\n  paymentMethodId: number;\r\n  type: AdyenPaymentMethodType;\r\n  error?: string;\r\n};\r\n\r\nexport default function AdyenPaymentDetails({ setProcessing, type, setPaymentError, error, paymentMethodId }: Props) {\r\n  const accountController = getModule(AccountController);\r\n  const checkoutController = getModule(CheckoutController);\r\n\r\n  const isSandbox = accountController.getSandbox();\r\n  const { t } = useTranslation('account');\r\n  const announce = useAriaAnnouncer();\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const [session, setSession] = useState<AdyenPaymentSession>();\r\n\r\n  const redirectResult = useQueryParam('redirectResult');\r\n  const finalize = !!redirectResult;\r\n  const paymentSuccessUrl = modalURLFromLocation(location, 'payment-method-success');\r\n\r\n  const finalizePaymentDetails = useEventCallback(async (redirectResult: string) => {\r\n    try {\r\n      setProcessing(true);\r\n\r\n      await checkoutController.finalizeAdyenPaymentDetails({ redirectResult: decodeURI(redirectResult) }, paymentMethodId);\r\n      await accountController.reloadSubscriptions({ retry: 10 });\r\n\r\n      setProcessing(false);\r\n\r\n      announce(t('checkout.payment_success'), 'success');\r\n      navigate(paymentSuccessUrl);\r\n    } catch (error: unknown) {\r\n      setProcessing(false);\r\n\r\n      if (error instanceof Error) {\r\n        setPaymentError(error.message);\r\n        navigate(modalURLFromLocation(location, 'payment-method'), { replace: true });\r\n      }\r\n    }\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (!redirectResult) return;\r\n\r\n    finalizePaymentDetails(redirectResult);\r\n  }, [finalizePaymentDetails, redirectResult]);\r\n\r\n  useEffect(() => {\r\n    if (finalize) return;\r\n\r\n    const createSession = async () => {\r\n      setProcessing(true);\r\n\r\n      try {\r\n        const session = await checkoutController.createAdyenPaymentSession(window.origin, false);\r\n\r\n        setSession(session);\r\n      } catch (error: unknown) {\r\n        if (error instanceof Error) {\r\n          setPaymentError(error.message);\r\n        }\r\n      }\r\n\r\n      setProcessing(false);\r\n    };\r\n\r\n    createSession();\r\n  }, [setProcessing, setPaymentError, finalize, navigate, location, checkoutController]);\r\n\r\n  const onSubmit = useCallback(\r\n    async (state: AdyenEventData, handleAction: DropinElement['handleAction']) => {\r\n      if (!state.isValid) return;\r\n\r\n      try {\r\n        setProcessing(true);\r\n        setPaymentError(undefined);\r\n\r\n        const returnUrl = modalURLFromWindowLocation('payment-method', { paymentMethodId: `${paymentMethodId}` });\r\n        const result = await checkoutController.addAdyenPaymentDetails(state.data.paymentMethod, paymentMethodId, returnUrl);\r\n\r\n        if ('action' in result) {\r\n          handleAction(result.action);\r\n        }\r\n\r\n        await accountController.reloadSubscriptions({ retry: 5 });\r\n\r\n        navigate(paymentSuccessUrl, { replace: true });\r\n      } catch (error: unknown) {\r\n        if (error instanceof Error) {\r\n          setPaymentError(error.message);\r\n        }\r\n      }\r\n\r\n      setProcessing(false);\r\n    },\r\n    [navigate, paymentMethodId, paymentSuccessUrl, setPaymentError, setProcessing, accountController, checkoutController],\r\n  );\r\n\r\n  const adyenConfiguration: CoreOptions = useMemo(\r\n    () => ({\r\n      session,\r\n      showPayButton: false,\r\n      environment: isSandbox ? 'test' : 'live',\r\n      clientKey: isSandbox ? ADYEN_TEST_CLIENT_KEY : ADYEN_LIVE_CLIENT_KEY,\r\n      paymentMethodsConfiguration: {\r\n        card: {\r\n          hasHolderName: true,\r\n          holderNameRequired: true,\r\n        },\r\n      },\r\n      onAdditionalDetails: async (state: AdyenAdditionalEventData) => {\r\n        try {\r\n          setProcessing(true);\r\n\r\n          await checkoutController.finalizeAdyenPayment(state.data.details, paymentMethodId);\r\n\r\n          navigate(paymentSuccessUrl, { replace: true });\r\n        } catch (error: unknown) {\r\n          if (error instanceof Error) {\r\n            setPaymentError(error.message);\r\n            setProcessing(false);\r\n          }\r\n        }\r\n      },\r\n      onSubmit: (state: AdyenEventData, component: DropinElement) => onSubmit(state, component.handleAction),\r\n      onError: (error: Error) => setPaymentError(error.message),\r\n    }),\r\n    [session, isSandbox, setProcessing, paymentMethodId, navigate, paymentSuccessUrl, setPaymentError, onSubmit, checkoutController],\r\n  );\r\n\r\n  return <Adyen configuration={adyenConfiguration} type={type} error={error} />;\r\n}\r\n","import React, { useEffect, useState } from 'react';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useCheckoutStore } from '@jwp/ott-common/src/stores/CheckoutStore';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport CheckoutController from '@jwp/ott-common/src/controllers/CheckoutController';\r\nimport useQueryParam from '@jwp/ott-ui-react/src/hooks/useQueryParam';\r\n\r\nimport LoadingOverlay from '../../components/LoadingOverlay/LoadingOverlay';\r\nimport PaymentMethodForm from '../../components/PaymentMethodForm/PaymentMethodForm';\r\nimport PayPal from '../../components/PayPal/PayPal';\r\nimport AdyenPaymentDetails from '../AdyenPaymentDetails/AdyenPaymentDetails';\r\nimport { modalURLFromWindowLocation } from '../../utils/location';\r\n\r\ntype Props = {\r\n  onCloseButtonClick: () => void;\r\n};\r\n\r\nconst UpdatePaymentMethod = ({ onCloseButtonClick }: Props) => {\r\n  const checkoutController = getModule(CheckoutController);\r\n\r\n  const updateSuccess = useQueryParam('u') === 'payment-method-success';\r\n  const paymentMethodIdQueryParam = useQueryParam('paymentMethodId');\r\n  const parsedPaymentMethodId = paymentMethodIdQueryParam ? parseInt(paymentMethodIdQueryParam) : undefined;\r\n\r\n  const activePayment = useAccountStore((state) => state.activePayment);\r\n  const currentPaymentId = activePayment?.id;\r\n  const [paymentError, setPaymentError] = useState<string | undefined>(undefined);\r\n  const [paymentMethodId, setPaymentMethodId] = useState<number | undefined>(parsedPaymentMethodId);\r\n\r\n  const paymentMethods = useCheckoutStore((state) => state.paymentMethods);\r\n\r\n  const [processing, setProcessing] = useState<boolean>(false);\r\n\r\n  useEffect(() => {\r\n    checkoutController.getPaymentMethods();\r\n  }, [checkoutController]);\r\n\r\n  const handlePaymentMethodChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const toPaymentMethodId = parseInt(event.target.value);\r\n\r\n    setPaymentMethodId(toPaymentMethodId);\r\n    setPaymentError(undefined);\r\n  };\r\n\r\n  const handlePayPalSubmit = async () => {\r\n    setProcessing(true);\r\n\r\n    try {\r\n      setPaymentError(undefined);\r\n\r\n      const successUrl = modalURLFromWindowLocation('payment-method-success');\r\n      const waitingUrl = modalURLFromWindowLocation('waiting-for-payment');\r\n      const cancelUrl = modalURLFromWindowLocation('payment-cancelled');\r\n      const errorUrl = modalURLFromWindowLocation('payment-error');\r\n\r\n      const response = await checkoutController.updatePayPalPaymentMethod(\r\n        successUrl,\r\n        waitingUrl,\r\n        cancelUrl,\r\n        errorUrl,\r\n        paymentMethodId as number,\r\n        currentPaymentId,\r\n      );\r\n\r\n      if (response) {\r\n        window.location.href = response.redirectUrl;\r\n      }\r\n    } catch (error: unknown) {\r\n      if (error instanceof Error) {\r\n        setPaymentError(error.message);\r\n      }\r\n    }\r\n    setProcessing(false);\r\n  };\r\n\r\n  const renderPaymentMethod = () => {\r\n    const paymentMethod = paymentMethods?.find((method) => method.id === paymentMethodId);\r\n\r\n    if (paymentMethod?.methodName === 'card') {\r\n      return (\r\n        <AdyenPaymentDetails\r\n          paymentMethodId={paymentMethod.id}\r\n          setPaymentError={setPaymentError}\r\n          setProcessing={setProcessing}\r\n          error={paymentError}\r\n          type=\"card\"\r\n        />\r\n      );\r\n    } else if (paymentMethod?.methodName === 'paypal') {\r\n      return <PayPal onSubmit={handlePayPalSubmit} error={paymentError || null} />;\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  // loading state\r\n  if (!paymentMethods) {\r\n    return (\r\n      <div style={{ height: 300 }}>\r\n        <LoadingOverlay inline />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <PaymentMethodForm\r\n      onCloseButtonClick={onCloseButtonClick}\r\n      paymentMethods={paymentMethods}\r\n      paymentMethodId={paymentMethodId}\r\n      onPaymentMethodChange={handlePaymentMethodChange}\r\n      renderPaymentMethod={renderPaymentMethod}\r\n      updateSuccess={updateSuccess}\r\n      submitting={processing}\r\n    />\r\n  );\r\n};\r\n\r\nexport default UpdatePaymentMethod;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport Button from '../Button/Button';\r\nimport LoadingOverlay from '../LoadingOverlay/LoadingOverlay';\r\n\r\nimport styles from './EditCardDetailsForm.module.scss';\r\n\r\ntype Props = {\r\n  renderPaymentMethod?: () => JSX.Element | null;\r\n  submitting: boolean;\r\n  onCancel: () => void;\r\n};\r\n\r\nconst EditCardDetailsForm: React.FC<Props> = ({ renderPaymentMethod, submitting, onCancel }) => {\r\n  const { t } = useTranslation(['common', 'user']);\r\n  return (\r\n    <div>\r\n      <div className={styles.title}>\r\n        <h1>{t('user:payment.add_card_details')}</h1>\r\n      </div>\r\n      <div>{renderPaymentMethod ? renderPaymentMethod() : null}</div>\r\n      <Button onClick={onCancel} className={styles.cancelButton} fullWidth label={t('common:confirmation_dialog.close')} />\r\n      {submitting && <LoadingOverlay transparentBackground inline />}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditCardDetailsForm;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport TextField from '../TextField/TextField';\r\n\r\ntype Props = {\r\n  onChange?: React.ChangeEventHandler<HTMLInputElement>;\r\n  onBlur?: React.FocusEventHandler<HTMLInputElement>;\r\n  error?: string;\r\n  value?: string;\r\n};\r\n\r\nconst CreditCardCVCField: React.FC<Props> = ({ value, onChange, error, ...props }: Props) => {\r\n  const { t } = useTranslation('user');\r\n  const formatCVC: React.ChangeEventHandler<HTMLInputElement> = (e) => {\r\n    const clearValue = e.target.value.replace(/\\D+/g, '');\r\n    if (onChange) {\r\n      e.target.value = clearValue.slice(0, 4);\r\n      onChange(e);\r\n    }\r\n  };\r\n  return (\r\n    <TextField\r\n      label={t('payment.security_code')}\r\n      aria-label={t('payment.security_code')}\r\n      {...props}\r\n      error={!!error}\r\n      helperText={error ? error : null}\r\n      name=\"cardCVC\"\r\n      className=\"directPostSecurityCode\"\r\n      type=\"text\"\r\n      value={value}\r\n      onChange={formatCVC}\r\n      pattern=\"\\d*\"\r\n      placeholder=\"###\"\r\n      autoComplete=\"cc-csc\"\r\n      required\r\n    />\r\n  );\r\n};\r\n\r\nexport default CreditCardCVCField;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport TextField from '../TextField/TextField';\r\n\r\ntype Props = {\r\n  onChange?: React.ChangeEventHandler<HTMLInputElement | HTMLTextAreaElement>;\r\n  onBlur?: React.FocusEventHandler<HTMLInputElement | HTMLTextAreaElement>;\r\n  error?: string;\r\n  value?: string;\r\n};\r\n\r\nconst CreditCardExpiryField: React.FC<Props> = ({ value, onChange, error, ...props }: Props) => {\r\n  const { t } = useTranslation('account');\r\n  const formatExpirationDate: React.ChangeEventHandler<HTMLInputElement> = (e) => {\r\n    let clearValue = e.target.value.replace(/\\D+/g, '');\r\n\r\n    if (clearValue.length === 1) {\r\n      if (Number(clearValue) > 1) {\r\n        clearValue = '0' + clearValue;\r\n      }\r\n    } else if (clearValue.length === 2) {\r\n      if (Number(clearValue) > 12) {\r\n        clearValue = '12';\r\n      }\r\n    }\r\n\r\n    if (clearValue.length >= 3) {\r\n      e.target.value = `${clearValue.slice(0, 2)}/${clearValue.slice(2, 4)}`;\r\n    } else {\r\n      e.target.value = clearValue;\r\n    }\r\n    if (onChange) {\r\n      onChange(e);\r\n    }\r\n  };\r\n  return (\r\n    <TextField\r\n      label={t('payment.credit_card_expiry_date')}\r\n      {...props}\r\n      name=\"cardExpiry\"\r\n      className=\"directPostExpiryDate\"\r\n      value={value}\r\n      error={!!error}\r\n      helperText={error ? error : null}\r\n      onChange={formatExpirationDate}\r\n      type=\"text\"\r\n      pattern=\"\\d*\"\r\n      placeholder=\"MM/YY\"\r\n      autoComplete=\"cc-exp\"\r\n      required\r\n    />\r\n  );\r\n};\r\n\r\nexport default CreditCardExpiryField;\r\n","import React, { useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport Payment from 'payment';\r\n\r\nimport TextField from '../TextField/TextField';\r\n\r\nimport styles from './CreditCardNumberField.module.scss';\r\n\r\ntype Props = {\r\n  onChange?: React.ChangeEventHandler<HTMLInputElement>;\r\n  onBlur?: React.FocusEventHandler<HTMLInputElement>;\r\n  error?: string;\r\n  value?: string;\r\n};\r\n\r\nconst cardIssuers: { [key: string]: string } = {\r\n  visa: '/images/payments/visa.svg',\r\n  mastercard: '/images/payments/mastercard.svg',\r\n  maestro: '/images/payments/maestro.svg',\r\n  amex: '/images/payments/amex.svg',\r\n  discover: '/images/payments/discover.svg',\r\n  diners: '/images/payments/diners.svg',\r\n  dinersclub: '/images/payments/diners.svg',\r\n  unionpay: '/images/payments/unionpay.svg',\r\n  hiper: '/images/payments/hiper.svg',\r\n};\r\n\r\nconst CreditCardNumberField: React.FC<Props> = ({ value, error, onChange, onBlur, ...props }: Props) => {\r\n  const { t } = useTranslation('account');\r\n  const [cardIssuer, setCardIssuer] = useState<JSX.Element | null>(null);\r\n\r\n  const formatCreditCardNumber: React.ChangeEventHandler<HTMLInputElement> = (e) => {\r\n    const issuer = Payment.fns.cardType(e.target?.value);\r\n    const clearValue = e.target?.value.replace(/\\D+/g, '');\r\n\r\n    let nextValue;\r\n    setCardIssuer(\r\n      cardIssuers?.[issuer] ? (\r\n        <div className={styles.cardTypeWrapper}>\r\n          <img src={cardIssuers[issuer]} alt={issuer} height=\"25\" />\r\n        </div>\r\n      ) : null,\r\n    );\r\n\r\n    switch (issuer) {\r\n      case 'amex':\r\n        nextValue = `${clearValue.slice(0, 4)} ${clearValue.slice(4, 10)} ${clearValue.slice(10, 15)}`;\r\n        break;\r\n      case 'dinersclub':\r\n        nextValue = `${clearValue.slice(0, 4)} ${clearValue.slice(4, 10)} ${clearValue.slice(10, 14)}`;\r\n        break;\r\n      default:\r\n        nextValue = `${clearValue.slice(0, 4)} ${clearValue.slice(4, 8)} ${clearValue.slice(8, 12)} ${clearValue.slice(12, 16)}`;\r\n        break;\r\n    }\r\n\r\n    if (onChange) {\r\n      e.target.value = nextValue.trim();\r\n      onChange(e);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <TextField\r\n      value={value}\r\n      name=\"cardNumber\"\r\n      label={t('payment.credit_card_number')}\r\n      className=\"directPostCreditCardNumber\"\r\n      onChange={formatCreditCardNumber}\r\n      onBlur={onBlur}\r\n      error={!!error}\r\n      helperText={error ? error : null}\r\n      pattern=\"\\d*\"\r\n      {...props}\r\n      type=\"text\"\r\n      placeholder=\"1234 5678 9012 3456\"\r\n      rightControl={cardIssuer}\r\n      autoComplete=\"cc-number\"\r\n      required\r\n    />\r\n  );\r\n};\r\n\r\nexport default CreditCardNumberField;\r\n","import { useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport Payment from 'payment';\r\nimport { object, string } from 'yup';\r\nimport { useMutation } from 'react-query';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport useForm from '@jwp/ott-hooks-react/src/useForm';\r\n\r\nimport Button from '../Button/Button';\r\nimport CreditCardCVCField from '../form-fields/CreditCardCVCField/CreditCardCVCField';\r\nimport CreditCardExpiryField from '../form-fields/CreditCardExpiryField/CreditCardExpiryField';\r\nimport CreditCardNumberField from '../form-fields/CreditCardNumberField/CreditCardNumberField';\r\nimport TextField from '../form-fields/TextField/TextField';\r\nimport { useAriaAnnouncer } from '../../containers/AnnouncementProvider/AnnoucementProvider';\r\n\r\nimport styles from './EditCardPaymentForm.module.scss';\r\n\r\ntype EditCardPaymentFormData = {\r\n  cardholderName: string;\r\n  cardNumber: string;\r\n  cardExpiry: string;\r\n  cardCVC: string;\r\n  cardExpMonth: string;\r\n  cardExpYear: string;\r\n};\r\n\r\ntype Props = {\r\n  onCancel: () => void;\r\n  setUpdatingCardDetails: (e: boolean) => void;\r\n};\r\n\r\nconst EditCardPaymentForm: React.FC<Props> = ({ onCancel, setUpdatingCardDetails }) => {\r\n  const accountController = getModule(AccountController);\r\n  const announce = useAriaAnnouncer();\r\n\r\n  const { t } = useTranslation('account');\r\n  const { mutate: mutateCardDetails, isLoading } = useMutation(accountController.updateCardDetails);\r\n  const { activePayment } = useAccountStore(({ activePayment }) => ({ activePayment }), shallow);\r\n\r\n  const paymentData = useForm<EditCardPaymentFormData>({\r\n    initialValues: { cardholderName: '', cardNumber: '', cardExpiry: '', cardCVC: '', cardExpMonth: '', cardExpYear: '' },\r\n    validationSchema: object().shape({\r\n      cardholderName: string().required(),\r\n      cardNumber: string()\r\n        .required()\r\n        .test('card number validation', t('checkout.invalid_card_number'), (value) => {\r\n          return Payment.fns.validateCardNumber(value as string);\r\n        }),\r\n      cardExpiry: string()\r\n        .required()\r\n        .test('card expiry validation', t('checkout.invalid_card_expiry'), (value) => {\r\n          return Payment.fns.validateCardExpiry(value as string);\r\n        }),\r\n      cardCVC: string()\r\n        .required()\r\n        .test('cvc validation', t('checkout.invalid_cvc_number'), (value) => {\r\n          const issuer = Payment.fns.cardType(paymentData?.values?.cardNumber);\r\n\r\n          return Payment.fns.validateCardCVC(value as string, issuer);\r\n        }),\r\n      cardExpMonth: string().required(),\r\n      cardExpYear: string().required(),\r\n    }),\r\n    validateOnBlur: true,\r\n    onSubmit: async () => {\r\n      setUpdatingCardDetails(true);\r\n      mutateCardDetails(\r\n        {\r\n          cardName: paymentData.values.cardholderName,\r\n          cardNumber: paymentData.values.cardNumber.replace(/\\s+/g, ''),\r\n          cvc: parseInt(paymentData.values.cardCVC),\r\n          expMonth: parseInt(paymentData.values.cardExpMonth),\r\n          expYear: parseInt(paymentData.values.cardExpYear),\r\n          currency: activePayment?.currency || '',\r\n        },\r\n        {\r\n          onSettled: () => onCancel(),\r\n          onSuccess: () => {\r\n            announce(t('checkout.card_details_updated'), 'success');\r\n          },\r\n        },\r\n      );\r\n    },\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (paymentData.values.cardExpiry) {\r\n      const expiry = Payment.fns.cardExpiryVal(paymentData.values.cardExpiry);\r\n      if (expiry.month) {\r\n        paymentData.setValue('cardExpMonth', expiry.month.toString());\r\n      }\r\n      if (expiry.year) {\r\n        paymentData.setValue('cardExpYear', expiry.year.toString());\r\n      }\r\n    }\r\n    //eslint-disable-next-line\r\n  }, [paymentData.values.cardExpiry]);\r\n\r\n  return (\r\n    <div className={styles.paymentForm}>\r\n      <div>\r\n        <TextField\r\n          label={t('checkout.card_holder_name')}\r\n          name=\"cardholderName\"\r\n          value={paymentData?.values?.cardholderName}\r\n          onChange={paymentData?.handleChange}\r\n          onBlur={paymentData?.handleBlur}\r\n          placeholder={t('checkout.credit_card_name')}\r\n          autoComplete=\"cc-name\"\r\n          required\r\n        />\r\n      </div>\r\n      <div>\r\n        <CreditCardNumberField\r\n          value={paymentData?.values?.cardNumber?.toString()}\r\n          error={paymentData?.errors?.cardNumber}\r\n          onBlur={paymentData?.handleBlur}\r\n          onChange={paymentData?.handleChange}\r\n        />\r\n      </div>\r\n      <div className={styles.columns}>\r\n        <div>\r\n          <CreditCardExpiryField\r\n            value={paymentData?.values?.cardExpiry}\r\n            onBlur={paymentData?.handleBlur}\r\n            onChange={paymentData?.handleChange}\r\n            error={paymentData?.errors?.cardExpiry}\r\n          />\r\n        </div>\r\n        <div>\r\n          <CreditCardCVCField\r\n            value={paymentData?.values?.cardCVC}\r\n            onBlur={paymentData?.handleBlur}\r\n            onChange={paymentData?.handleChange}\r\n            error={paymentData?.errors?.cardCVC}\r\n          />\r\n        </div>\r\n      </div>\r\n      <div>\r\n        <Button\r\n          disabled={isLoading}\r\n          label={t('checkout.save')}\r\n          variant=\"contained\"\r\n          onClick={paymentData.handleSubmit as () => void}\r\n          type=\"submit\"\r\n          color=\"primary\"\r\n          size=\"large\"\r\n          fullWidth\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditCardPaymentForm;\r\n","import React, { useState } from 'react';\r\nimport { useLocation, useNavigate } from 'react-router';\r\nimport { modalURLFromLocation } from '@jwp/ott-ui-react/src/utils/location';\r\n\r\nimport EditCardDetailsForm from '../../../components/EditForm/EditCardDetailsForm';\r\nimport EditCardPaymentForm from '../../../components/EditCardPaymentForm/EditCardPaymentForm';\r\n\r\nconst EditCardDetails = () => {\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const [updatingCardDetails, setUpdatingCardDetails] = useState(false);\r\n\r\n  const closeHandler = () => {\r\n    navigate(modalURLFromLocation(location, null), { replace: false });\r\n  };\r\n\r\n  const renderPaymentMethod = () => {\r\n    return <EditCardPaymentForm onCancel={closeHandler} setUpdatingCardDetails={setUpdatingCardDetails} />;\r\n  };\r\n\r\n  return <EditCardDetailsForm onCancel={closeHandler} renderPaymentMethod={renderPaymentMethod} submitting={updatingCardDetails} />;\r\n};\r\n\r\nexport default EditCardDetails;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport type { EditPasswordFormData } from '@jwp/ott-common/types/account';\r\nimport type { FormErrors } from '@jwp/ott-common/types/form';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\n\r\nimport PasswordField from '../form-fields/PasswordField/PasswordField';\r\nimport TextField from '../form-fields/TextField/TextField';\r\nimport Button from '../Button/Button';\r\nimport FormFeedback from '../FormFeedback/FormFeedback';\r\nimport LoadingOverlay from '../LoadingOverlay/LoadingOverlay';\r\n\r\nimport styles from './EditPasswordForm.module.scss';\r\n\r\ntype Props = {\r\n  onSubmit: React.FormEventHandler<HTMLFormElement>;\r\n  onChange: React.ChangeEventHandler<HTMLInputElement | HTMLTextAreaElement>;\r\n  setValue?: (key: keyof EditPasswordFormData, value: string) => void;\r\n  onBlur: React.FocusEventHandler<HTMLInputElement | HTMLTextAreaElement>;\r\n  error?: string;\r\n  errors: FormErrors<EditPasswordFormData>;\r\n  value: EditPasswordFormData;\r\n  validationError?: boolean;\r\n  submitting: boolean;\r\n  showOldPasswordField?: boolean;\r\n  showResetTokenField?: boolean;\r\n  email?: string;\r\n  onResendEmailClick?: () => void;\r\n};\r\n\r\nconst EditPasswordForm: React.FC<Props> = ({\r\n  onSubmit,\r\n  onChange,\r\n  onBlur,\r\n  showOldPasswordField,\r\n  showResetTokenField,\r\n  value,\r\n  errors,\r\n  submitting,\r\n  validationError,\r\n  email,\r\n  onResendEmailClick,\r\n}: Props) => {\r\n  const { t } = useTranslation(['account', 'user']);\r\n  return (\r\n    <form onSubmit={onSubmit} data-testid={testId('forgot-password-form')} noValidate>\r\n      {errors.form && (\r\n        <FormFeedback variant=\"error\" visible={!validationError}>\r\n          {errors.form}\r\n        </FormFeedback>\r\n      )}\r\n      <h2 className={styles.title}>{showOldPasswordField && showResetTokenField ? t('user:account.add_password') : t('reset.password_reset')}</h2>\r\n      {showOldPasswordField && showResetTokenField && (\r\n        <p className={styles.paragraph}>\r\n          {t('user:account.add_password_modal_text', { email: email })}\r\n          <a className={styles.resendLink} onClick={onResendEmailClick}>\r\n            {t('user:account.resend_mail')}\r\n          </a>\r\n        </p>\r\n      )}\r\n      {showOldPasswordField && !showResetTokenField && (\r\n        <PasswordField\r\n          value={value.oldPassword}\r\n          onChange={onChange}\r\n          onBlur={onBlur}\r\n          label={t('reset.old_password')}\r\n          placeholder={t('reset.old_password')}\r\n          error={!!errors.oldPassword}\r\n          name=\"oldPassword\"\r\n          showToggleView={false}\r\n          showHelperText={false}\r\n          autoComplete=\"current-password\"\r\n          required\r\n        />\r\n      )}\r\n      {showResetTokenField && (\r\n        <TextField\r\n          className={styles.textField}\r\n          value={value.resetPasswordToken || ''}\r\n          onChange={onChange}\r\n          onBlur={onBlur}\r\n          label={t('reset.reset_password_token')}\r\n          placeholder={t('reset.reset_password_token')}\r\n          name=\"resetPasswordToken\"\r\n          type=\"text\"\r\n          autoComplete=\"\"\r\n          required\r\n        />\r\n      )}\r\n\r\n      <PasswordField\r\n        value={value.password}\r\n        onChange={onChange}\r\n        onBlur={onBlur}\r\n        label={t('reset.new_password')}\r\n        placeholder={t('reset.password')}\r\n        error={!!errors.password}\r\n        name=\"password\"\r\n        autoComplete=\"new-password\"\r\n        required\r\n      />\r\n\r\n      <PasswordField\r\n        value={value.passwordConfirmation}\r\n        onChange={onChange}\r\n        onBlur={onBlur}\r\n        label={t('reset.repeat_new_password')}\r\n        placeholder={t('reset.repeat_new_password')}\r\n        error={!!errors.passwordConfirmation}\r\n        name=\"passwordConfirmation\"\r\n        autoComplete=\"new-password\"\r\n        showHelperText={false}\r\n        required\r\n      />\r\n\r\n      <Button type=\"submit\" className={styles.button} fullWidth color=\"primary\" disabled={submitting} label={t('reset.confirm')} />\r\n      {submitting && <LoadingOverlay transparentBackground inline />}\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default EditPasswordForm;\r\n","import React from 'react';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport { object, string } from 'yup';\r\nimport { useTranslation } from 'react-i18next';\r\nimport type { EditPasswordFormData } from '@jwp/ott-common/types/account';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport useForm, { type UseFormOnSubmitHandler } from '@jwp/ott-hooks-react/src/useForm';\r\nimport { modalURLFromLocation } from '@jwp/ott-ui-react/src/utils/location';\r\nimport useQueryParam from '@jwp/ott-ui-react/src/hooks/useQueryParam';\r\n\r\nimport EditPasswordForm from '../../../components/EditPasswordForm/EditPasswordForm';\r\nimport { useAriaAnnouncer } from '../../AnnouncementProvider/AnnoucementProvider';\r\n\r\nconst ResetPassword = ({ type }: { type?: 'add' }) => {\r\n  const accountController = getModule(AccountController);\r\n\r\n  const { t } = useTranslation('account');\r\n  const announce = useAriaAnnouncer();\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const resetPasswordTokenParam = useQueryParam('resetPasswordToken');\r\n  const emailParam = useQueryParam('email');\r\n  const email = useAccountStore((state) => state.user?.email);\r\n  const user = useAccountStore.getState().user;\r\n\r\n  const passwordSubmitHandler: UseFormOnSubmitHandler<EditPasswordFormData> = async (formData, { setErrors, setSubmitting }) => {\r\n    const { oldPassword, password, passwordConfirmation, resetPasswordToken } = formData;\r\n    if (password !== passwordConfirmation) {\r\n      setErrors({ form: t('reset.passwords_do_not_match') });\r\n\r\n      return setSubmitting(false);\r\n    }\r\n    let resetToken = resetPasswordTokenParam;\r\n    if (resetPasswordToken) {\r\n      resetToken = resetPasswordToken;\r\n    }\r\n    try {\r\n      if (user && !resetToken) {\r\n        await accountController.changePasswordWithOldPassword(oldPassword || '', password, passwordConfirmation);\r\n      } else {\r\n        if (!resetToken) {\r\n          setErrors({ form: t('reset.invalid_link') });\r\n\r\n          return setSubmitting(false);\r\n        }\r\n        await accountController.changePasswordWithToken(emailParam || '', password, resetToken, passwordConfirmation);\r\n      }\r\n\r\n      announce(t('reset.password_reset_success'), 'success');\r\n      await accountController.logout();\r\n      navigate(modalURLFromLocation(location, 'login'));\r\n    } catch (error: unknown) {\r\n      if (error instanceof Error) {\r\n        if (error.message.includes('invalid param password')) {\r\n          setErrors({ password: t('reset.invalid_password') });\r\n        } else if (error.message.includes('resetPasswordToken is not valid')) {\r\n          setErrors({ form: t('reset.invalid_reset_link') });\r\n        } else if (error.message.includes('score does not match standards')) {\r\n          setErrors({ form: t('reset.password_strength') });\r\n        } else if (error.message.includes('old password does not match')) {\r\n          setErrors({ form: t('reset.old_password_does_not_match') });\r\n        } else if (error.message.includes('password could not be set')) {\r\n          setErrors({ form: t('reset.invalid_token') });\r\n        }\r\n      }\r\n    }\r\n    setSubmitting(false);\r\n  };\r\n\r\n  const passwordForm = useForm<EditPasswordFormData>({\r\n    initialValues: { password: '', passwordConfirmation: '' },\r\n    validationSchema: object().shape({\r\n      email: string(),\r\n      oldPassword: string(),\r\n      password: string()\r\n        .matches(/^(?=.*[a-z])(?=.*[0-9]).{8,}$/, t('registration.invalid_password'))\r\n        .required(t('login.field_required', { field: t('login.password') })),\r\n      passwordConfirmation: string().required(),\r\n      resetPasswordToken: string(),\r\n    }),\r\n    validateOnBlur: true,\r\n    onSubmit: passwordSubmitHandler,\r\n  });\r\n\r\n  const resendEmailClickHandler = async () => {\r\n    try {\r\n      if (email) {\r\n        await accountController.resetPassword(email, '');\r\n      }\r\n    } catch (error: unknown) {\r\n      passwordForm.setErrors({ form: t('user:account.resend_mail_error') });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <EditPasswordForm\r\n      value={passwordForm.values}\r\n      submitting={passwordForm.submitting}\r\n      onChange={passwordForm.handleChange}\r\n      onBlur={passwordForm.handleBlur}\r\n      errors={passwordForm.errors}\r\n      onSubmit={passwordForm.handleSubmit}\r\n      validationError={passwordForm.validationSchemaError}\r\n      showOldPasswordField={!!(user && !resetPasswordTokenParam)}\r\n      showResetTokenField={type === 'add' || (!user && !resetPasswordTokenParam)}\r\n      email={emailParam || email}\r\n      onResendEmailClick={resendEmailClickHandler}\r\n    />\r\n  );\r\n};\r\n\r\nexport default ResetPassword;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport type { Customer } from '@jwp/ott-common/types/account';\r\nimport type { Subscription } from '@jwp/ott-common/types/subscription';\r\nimport { formatLocalizedDate, formatPrice } from '@jwp/ott-common/src/utils/formatting';\r\n\r\nimport Button from '../Button/Button';\r\nimport FormFeedback from '../FormFeedback/FormFeedback';\r\n\r\nimport styles from './RenewSubscriptionForm.module.scss';\r\n\r\ntype Props = {\r\n  subscription: Subscription;\r\n  customer: Customer;\r\n  error: string | null;\r\n  submitting: boolean;\r\n  onConfirm: () => void;\r\n  onClose: () => void;\r\n};\r\n\r\nconst RenewSubscriptionForm: React.FC<Props> = ({ subscription, customer, error, submitting, onConfirm, onClose }: Props) => {\r\n  const { t, i18n } = useTranslation('account');\r\n\r\n  return (\r\n    <div>\r\n      {error ? <FormFeedback variant=\"error\">{error}</FormFeedback> : null}\r\n      <h2 className={styles.title}>{t('renew_subscription.renew_your_subscription')}</h2>\r\n      <p className={styles.paragraph}>{t('renew_subscription.explanation')}</p>\r\n      <div className={styles.infoBox}>\r\n        <p>\r\n          <strong>{subscription.offerTitle}</strong> <br />\r\n          {t('renew_subscription.next_billing_date_on', { date: formatLocalizedDate(new Date(subscription.expiresAt * 1000), i18n.language) })}\r\n        </p>\r\n        <p className={styles.price}>\r\n          <strong>{formatPrice(subscription.nextPaymentPrice, subscription.nextPaymentCurrency, customer.country)}</strong>\r\n          <small>/{t(`periods.${subscription.period}`)}</small>\r\n        </p>\r\n      </div>\r\n      <Button\r\n        className={styles.confirmButton}\r\n        color=\"primary\"\r\n        variant=\"contained\"\r\n        label={t('renew_subscription.renew_subscription')}\r\n        onClick={onConfirm}\r\n        fullWidth\r\n        disabled={submitting}\r\n        type=\"submit\"\r\n      />\r\n      <Button label={t('renew_subscription.no_thanks')} onClick={onClose} fullWidth />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RenewSubscriptionForm;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport type { Subscription } from '@jwp/ott-common/types/subscription';\r\nimport type { Customer } from '@jwp/ott-common/types/account';\r\nimport { formatLocalizedDate, formatPrice } from '@jwp/ott-common/src/utils/formatting';\r\n\r\nimport Button from '../Button/Button';\r\n\r\nimport styles from './SubscriptionRenewed.module.scss';\r\n\r\ntype Props = {\r\n  customer: Customer;\r\n  subscription: Subscription;\r\n  onClose: () => void;\r\n};\r\n\r\nconst SubscriptionRenewed: React.FC<Props> = ({ onClose, customer, subscription }: Props) => {\r\n  const { t, i18n } = useTranslation('account');\r\n  const date = formatLocalizedDate(new Date(subscription.expiresAt * 1000), i18n.language);\r\n  const price = formatPrice(subscription.nextPaymentPrice, subscription.nextPaymentCurrency, customer.country);\r\n\r\n  return (\r\n    <div>\r\n      <h2 className={styles.title}>{t('subscription_renewed.title')}</h2>\r\n      <p className={styles.paragraph}>{t('subscription_renewed.message', { date, price })}</p>\r\n      <Button label={t('subscription_renewed.back_to_profile')} onClick={onClose} fullWidth />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SubscriptionRenewed;\r\n","import React, { useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useLocation, useNavigate } from 'react-router';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport { modalURLFromLocation } from '@jwp/ott-ui-react/src/utils/location';\r\n\r\nimport LoadingOverlay from '../../../components/LoadingOverlay/LoadingOverlay';\r\nimport RenewSubscriptionForm from '../../../components/RenewSubscriptionForm/RenewSubscriptionForm';\r\nimport SubscriptionRenewed from '../../../components/SubscriptionRenewed/SubscriptionRenewed';\r\nimport { useAriaAnnouncer } from '../../AnnouncementProvider/AnnoucementProvider';\r\n\r\nconst RenewSubscription = () => {\r\n  const accountController = getModule(AccountController);\r\n\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const { t } = useTranslation('account');\r\n  const announce = useAriaAnnouncer();\r\n  const { subscription, user } = useAccountStore(({ subscription, user }) => ({ subscription, user }), shallow);\r\n  const [renewed, setRenewed] = useState(false);\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const renewSubscriptionConfirmHandler = async () => {\r\n    setSubmitting(true);\r\n    setError(null);\r\n\r\n    try {\r\n      await accountController.updateSubscription('active');\r\n      announce(t('renew_subscription.success'), 'success');\r\n      setRenewed(true);\r\n    } catch (error: unknown) {\r\n      setError(t('renew_subscription.unknown_error_occurred'));\r\n    }\r\n\r\n    setSubmitting(false);\r\n  };\r\n\r\n  const closeHandler = () => {\r\n    navigate(modalURLFromLocation(location, null), { replace: true });\r\n  };\r\n\r\n  if (!subscription || !user) return null;\r\n\r\n  return (\r\n    <React.Fragment>\r\n      {renewed ? (\r\n        <SubscriptionRenewed onClose={closeHandler} subscription={subscription} customer={user} />\r\n      ) : (\r\n        <RenewSubscriptionForm\r\n          subscription={subscription}\r\n          customer={user}\r\n          error={error}\r\n          onConfirm={renewSubscriptionConfirmHandler}\r\n          onClose={closeHandler}\r\n          submitting={submitting}\r\n        />\r\n      )}\r\n      {submitting ? <LoadingOverlay inline /> : null}\r\n    </React.Fragment>\r\n  );\r\n};\r\nexport default RenewSubscription;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport Button from '../Button/Button';\r\nimport FormFeedback from '../FormFeedback/FormFeedback';\r\n\r\nimport styles from './CancelSubscriptionForm.module.scss';\r\n\r\ntype Props = {\r\n  onConfirm: () => void;\r\n  onCancel: () => void;\r\n  error: string | null;\r\n  submitting: boolean;\r\n};\r\n\r\nconst CancelSubscriptionForm: React.FC<Props> = ({ onConfirm, onCancel, error, submitting }: Props) => {\r\n  const { t } = useTranslation('account');\r\n\r\n  return (\r\n    <div>\r\n      {error ? <FormFeedback variant=\"error\">{error}</FormFeedback> : null}\r\n      <h2 className={styles.title}>{t('cancel_subscription.title')}</h2>\r\n      <p className={styles.paragraph}>{t('cancel_subscription.explanation')}</p>\r\n      <Button\r\n        className={styles.confirmButton}\r\n        label={t('cancel_subscription.unsubscribe')}\r\n        color=\"primary\"\r\n        variant=\"contained\"\r\n        onClick={onConfirm}\r\n        fullWidth\r\n        disabled={submitting}\r\n        type=\"submit\"\r\n      />\r\n      <Button label={t('cancel_subscription.no_thanks')} variant=\"outlined\" onClick={onCancel} fullWidth />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CancelSubscriptionForm;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport Button from '../Button/Button';\r\n\r\nimport styles from './SubscriptionCancelled.module.scss';\r\n\r\ntype Props = {\r\n  expiresDate: string;\r\n  onClose: () => void;\r\n};\r\n\r\nconst SubscriptionCancelled: React.FC<Props> = ({ expiresDate, onClose }: Props) => {\r\n  const { t } = useTranslation('account');\r\n\r\n  return (\r\n    <div className={styles.SubscriptionCancelled}>\r\n      <h2 className={styles.title}>{t('subscription_cancelled.title')}</h2>\r\n      <p className={styles.paragraph}>{t('subscription_cancelled.message', { date: expiresDate })}</p>\r\n      <Button label={t('subscription_cancelled.return_to_profile')} variant=\"outlined\" onClick={onClose} fullWidth />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SubscriptionCancelled;\r\n","import React, { useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useLocation, useNavigate } from 'react-router';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport { modalURLFromLocation } from '@jwp/ott-ui-react/src/utils/location';\r\nimport { formatLocalizedDate } from '@jwp/ott-common/src/utils/formatting';\r\n\r\nimport CancelSubscriptionForm from '../../../components/CancelSubscriptionForm/CancelSubscriptionForm';\r\nimport LoadingOverlay from '../../../components/LoadingOverlay/LoadingOverlay';\r\nimport SubscriptionCancelled from '../../../components/SubscriptionCancelled/SubscriptionCancelled';\r\nimport { useAriaAnnouncer } from '../../AnnouncementProvider/AnnoucementProvider';\r\n\r\nconst CancelSubscription = () => {\r\n  const accountController = getModule(AccountController);\r\n\r\n  const { t, i18n } = useTranslation('account');\r\n  const announce = useAriaAnnouncer();\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const subscription = useAccountStore((s) => s.subscription);\r\n  const [cancelled, setCancelled] = useState(false);\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const expirationDateFormatted = subscription?.expiresAt ? formatLocalizedDate(new Date(subscription.expiresAt * 1000), i18n.language) : '';\r\n\r\n  const cancelSubscriptionConfirmHandler = async () => {\r\n    setSubmitting(true);\r\n    setError(null);\r\n\r\n    try {\r\n      await accountController.updateSubscription('cancelled');\r\n\r\n      if (expirationDateFormatted) {\r\n        announce(t('subscription_cancelled.message', { date: expirationDateFormatted }), 'success');\r\n      }\r\n\r\n      setCancelled(true);\r\n    } catch (error: unknown) {\r\n      setError(t('cancel_subscription.unknown_error_occurred'));\r\n    }\r\n\r\n    setSubmitting(false);\r\n  };\r\n\r\n  const closeHandler = () => {\r\n    navigate(modalURLFromLocation(location, null), { replace: true });\r\n  };\r\n\r\n  if (!subscription) return null;\r\n\r\n  return (\r\n    <React.Fragment>\r\n      {cancelled ? (\r\n        <SubscriptionCancelled expiresDate={expirationDateFormatted} onClose={closeHandler} />\r\n      ) : (\r\n        <CancelSubscriptionForm onConfirm={cancelSubscriptionConfirmHandler} onCancel={closeHandler} submitting={submitting} error={error} />\r\n      )}\r\n      {submitting ? <LoadingOverlay transparentBackground inline /> : null}\r\n    </React.Fragment>\r\n  );\r\n};\r\nexport default CancelSubscription;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport Button from '../Button/Button';\r\n\r\nimport styles from './ResetPasswordForm.module.scss';\r\n\r\ntype Props = {\r\n  onCancel: () => void;\r\n  onReset: () => void;\r\n  submitting: boolean;\r\n};\r\n\r\nconst ResetPasswordForm: React.FC<Props> = ({ onCancel, onReset, submitting }: Props) => {\r\n  const { t } = useTranslation('account');\r\n  return (\r\n    <div>\r\n      <h1 className={styles.title}>{t('reset.reset_password')}</h1>\r\n      <p className={styles.text}>{t('reset.text')}</p>\r\n      <Button onClick={onReset} className={styles.button} fullWidth color=\"primary\" label={t('reset.yes')} type=\"submit\" disabled={submitting} />\r\n      <Button onClick={onCancel} fullWidth label={t('reset.no')} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ResetPasswordForm;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport type { ForgotPasswordFormData } from '@jwp/ott-common/types/account';\r\nimport type { FormErrors } from '@jwp/ott-common/types/form';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\n\r\nimport Button from '../Button/Button';\r\nimport TextField from '../form-fields/TextField/TextField';\r\nimport FormFeedback from '../FormFeedback/FormFeedback';\r\n\r\nimport styles from './ForgotPasswordForm.module.scss';\r\n\r\ntype Props = {\r\n  onSubmit: React.FormEventHandler<HTMLFormElement>;\r\n  onChange: React.ChangeEventHandler<HTMLInputElement | HTMLTextAreaElement>;\r\n  onBlur: React.FocusEventHandler<HTMLInputElement | HTMLTextAreaElement>;\r\n  error?: string;\r\n  errors: FormErrors<ForgotPasswordFormData>;\r\n  value: ForgotPasswordFormData;\r\n  submitting: boolean;\r\n};\r\n\r\nconst ForgotPasswordForm: React.FC<Props> = ({ onSubmit, onChange, value, errors, submitting, onBlur }: Props) => {\r\n  const { t } = useTranslation('account');\r\n\r\n  return (\r\n    <form onSubmit={onSubmit} data-testid={testId('forgot-password-form')} noValidate>\r\n      <h2 className={styles.title}>{t('reset.forgot_password')}</h2>\r\n      {errors.form ? <FormFeedback variant=\"error\">{errors.form}</FormFeedback> : null}\r\n      <p className={styles.text}>{t('reset.forgot_text')}</p>\r\n      <TextField\r\n        value={value.email}\r\n        onChange={onChange}\r\n        onBlur={onBlur}\r\n        label={t('reset.email')}\r\n        placeholder={t('reset.email')}\r\n        error={!!errors.email || !!errors.form}\r\n        helperText={errors.email}\r\n        name=\"email\"\r\n        type=\"email\"\r\n        autoComplete=\"email\"\r\n        required\r\n      />\r\n      <Button type=\"submit\" className={styles.button} fullWidth color=\"primary\" disabled={submitting} label={t('reset.email_me')} />\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default ForgotPasswordForm;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Link, useLocation } from 'react-router-dom';\r\n\r\nimport Button from '../Button/Button';\r\nimport { modalURLFromLocation } from '../../utils/location';\r\n\r\nimport styles from './ConfirmationForm.module.scss';\r\n\r\ntype Props = {\r\n  email?: string;\r\n  loggedIn?: boolean;\r\n  onBackToLogin: () => void;\r\n};\r\n\r\nconst ConfirmationForm: React.FC<Props> = ({ email, onBackToLogin, loggedIn }: Props) => {\r\n  const { t } = useTranslation('account');\r\n  const location = useLocation();\r\n\r\n  return (\r\n    <div className={styles.forgotPasswordForm}>\r\n      <h2 className={styles.title}>{t('reset.link_sent')}</h2>\r\n      <p className={styles.text}>{t('reset.link_sent_text', { email: email })}</p>\r\n      <Button onClick={onBackToLogin} className={styles.button} fullWidth color=\"primary\" label={t('reset.back_login')} />\r\n      {!loggedIn && (\r\n        <React.Fragment>\r\n          <span className={styles.notSure}>{t('reset.not_sure')}</span>\r\n          <Link className={styles.link} to={modalURLFromLocation(location, 'forgot-password')}>\r\n            {t('reset.try_again')}\r\n          </Link>\r\n        </React.Fragment>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ConfirmationForm;\r\n","import React, { useState } from 'react';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport { object, string } from 'yup';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport type { ForgotPasswordFormData } from '@jwp/ott-common/types/account';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport { modalURLFromLocation } from '@jwp/ott-ui-react/src/utils/location';\r\nimport useForm, { type UseFormOnSubmitHandler } from '@jwp/ott-hooks-react/src/useForm';\r\nimport { logDebug, logError } from '@jwp/ott-common/src/logger';\r\nimport env from '@jwp/ott-common/src/env';\r\n\r\nimport ResetPasswordForm from '../../../components/ResetPasswordForm/ResetPasswordForm';\r\nimport ForgotPasswordForm from '../../../components/ForgotPasswordForm/ForgotPasswordForm';\r\nimport ConfirmationForm from '../../../components/ConfirmationForm/ConfirmationForm';\r\nimport LoadingOverlay from '../../../components/LoadingOverlay/LoadingOverlay';\r\n\r\ntype Prop = {\r\n  type: 'confirmation' | 'forgot' | 'reset' | 'edit';\r\n};\r\n\r\nconst ResetPassword: React.FC<Prop> = ({ type }: Prop) => {\r\n  const accountController = getModule(AccountController);\r\n\r\n  const { t } = useTranslation('account');\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const [resetPasswordSubmitting, setResetPasswordSubmitting] = useState<boolean>(false);\r\n\r\n  const { canChangePasswordWithOldPassword } = accountController.getFeatures();\r\n  const { customer: user } = useAccountStore(\r\n    ({ user }) => ({\r\n      customer: user,\r\n    }),\r\n    shallow,\r\n  );\r\n  const cancelClickHandler = () => {\r\n    navigate(modalURLFromLocation(location, null));\r\n  };\r\n\r\n  const backToLoginClickHandler = async () => {\r\n    navigate(\r\n      {\r\n        pathname: '/',\r\n        search: 'u=login',\r\n      },\r\n      { replace: true },\r\n    );\r\n\r\n    if (user) {\r\n      await accountController.logout();\r\n    }\r\n  };\r\n\r\n  const resetPasswordClickHandler = async () => {\r\n    const resetUrl = `${env.APP_PUBLIC_URL}/?u=edit-password`;\r\n    try {\r\n      if (!user?.email) {\r\n        logDebug('ResetPassword', 'invalid param email');\r\n        return;\r\n      }\r\n\r\n      setResetPasswordSubmitting(true);\r\n\r\n      await accountController.resetPassword(user.email, resetUrl);\r\n\r\n      setResetPasswordSubmitting(false);\r\n      navigate(modalURLFromLocation(location, 'send-confirmation'));\r\n    } catch (error: unknown) {\r\n      logError('ResetPassword', 'Failed to reset password', { error });\r\n    }\r\n  };\r\n\r\n  const emailSubmitHandler: UseFormOnSubmitHandler<ForgotPasswordFormData> = async (formData, { setErrors, setSubmitting }) => {\r\n    const resetUrl = `${env.APP_PUBLIC_URL}/?u=edit-password`;\r\n\r\n    try {\r\n      await accountController.resetPassword(formData.email, resetUrl);\r\n      const modal = canChangePasswordWithOldPassword ? 'edit-password' : 'send-confirmation';\r\n      navigate(modalURLFromLocation(location, modal));\r\n    } catch (error: unknown) {\r\n      if (error instanceof Error) {\r\n        if (error.message.toLowerCase().includes('invalid param email')) {\r\n          setErrors({ email: t('reset.wrong_email') });\r\n        } else {\r\n          setErrors({ form: error.message });\r\n        }\r\n      }\r\n    }\r\n    setSubmitting(false);\r\n  };\r\n\r\n  const emailForm = useForm<ForgotPasswordFormData>({\r\n    initialValues: { email: '' },\r\n    validationSchema: object().shape({\r\n      email: string()\r\n        .email(t('login.field_is_not_valid_email'))\r\n        .required(t('login.field_required', { field: t('login.email') })),\r\n    }),\r\n    validateOnBlur: true,\r\n    onSubmit: emailSubmitHandler,\r\n  });\r\n\r\n  return (\r\n    <React.Fragment>\r\n      {type === 'reset' && <ResetPasswordForm submitting={resetPasswordSubmitting} onCancel={cancelClickHandler} onReset={resetPasswordClickHandler} />}\r\n      {type === 'forgot' && (\r\n        <ForgotPasswordForm\r\n          value={emailForm.values}\r\n          submitting={emailForm.submitting}\r\n          onChange={emailForm.handleChange}\r\n          errors={emailForm.errors}\r\n          onSubmit={emailForm.handleSubmit}\r\n          onBlur={emailForm.handleBlur}\r\n        />\r\n      )}\r\n      {type === 'confirmation' && <ConfirmationForm loggedIn={!!user} email={user?.email || emailForm.values.email} onBackToLogin={backToLoginClickHandler} />}\r\n      {(emailForm.submitting || resetPasswordSubmitting) && <LoadingOverlay transparentBackground inline />}\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nexport default ResetPassword;\r\n","import AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport CheckoutController from '@jwp/ott-common/src/controllers/CheckoutController';\r\nimport type { FormValidationError } from '@jwp/ott-common/src/errors/FormValidationError';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useCheckoutStore } from '@jwp/ott-common/src/stores/CheckoutStore';\r\nimport { isSVODOffer } from '@jwp/ott-common/src/utils/offers';\r\nimport type { CardPaymentData, Offer, OfferType, Payment } from '@jwp/ott-common/types/checkout';\r\nimport { useEffect } from 'react';\r\nimport { useMutation } from 'react-query';\r\n\r\ntype Props = {\r\n  onUpdateOrderSuccess?: () => void;\r\n  onSubmitPaymentWithoutDetailsSuccess: () => void;\r\n  onSubmitPaypalPaymentSuccess: (response: { redirectUrl: string }) => void;\r\n  onSubmitStripePaymentSuccess: () => void;\r\n};\r\n\r\nconst useCheckout = ({ onUpdateOrderSuccess, onSubmitPaymentWithoutDetailsSuccess, onSubmitPaypalPaymentSuccess, onSubmitStripePaymentSuccess }: Props) => {\r\n  const accountController = getModule(AccountController);\r\n  const checkoutController = getModule(CheckoutController);\r\n\r\n  const { order, selectedOffer, paymentMethods, setOrder } = useCheckoutStore(({ order, selectedOffer, paymentMethods, setOrder }) => ({\r\n    order,\r\n    selectedOffer,\r\n    paymentMethods,\r\n    setOrder,\r\n  }));\r\n\r\n  const offerType: OfferType = selectedOffer && isSVODOffer(selectedOffer) ? 'svod' : 'tvod';\r\n\r\n  const initialiseOrder = useMutation<void, FormValidationError, { offer: Offer }>({\r\n    mutationKey: ['initialiseOrder'],\r\n    mutationFn: async ({ offer }) => !!offer && checkoutController.initialiseOrder(offer),\r\n  });\r\n\r\n  const updateOrder = useMutation<void, string, { paymentMethodId: number; couponCode: string }>({\r\n    mutationKey: ['updateOrder'],\r\n    mutationFn: async ({ paymentMethodId, couponCode }) => {\r\n      if (!order || !paymentMethodId) return;\r\n\r\n      return await checkoutController.updateOrder(order, paymentMethodId, couponCode);\r\n    },\r\n    onSuccess: onUpdateOrderSuccess,\r\n  });\r\n\r\n  const submitPaymentWithoutDetails = useMutation<Payment, Error, { captchaValue?: string }>({\r\n    mutationKey: ['submitPaymentWithoutDetails'],\r\n    mutationFn: checkoutController.paymentWithoutDetails,\r\n    onSuccess: async () => {\r\n      await accountController.reloadSubscriptions({ retry: 10 });\r\n      onSubmitPaymentWithoutDetailsSuccess();\r\n    },\r\n  });\r\n\r\n  const submitPaymentPaypal = useMutation<\r\n    { redirectUrl: string },\r\n    Error,\r\n    { successUrl: string; waitingUrl: string; cancelUrl: string; errorUrl: string; couponCode: string; captchaValue?: string }\r\n  >({\r\n    mutationKey: ['submitPaymentPaypal'],\r\n    mutationFn: checkoutController.paypalPayment,\r\n    onSuccess: onSubmitPaypalPaymentSuccess,\r\n  });\r\n\r\n  const submitPaymentStripe = useMutation<boolean, Error, { cardPaymentPayload: CardPaymentData; referrer: string; returnUrl: string }>({\r\n    mutationKey: ['submitPaymentStripe'],\r\n    mutationFn: checkoutController.directPostCardPayment,\r\n    onSuccess: onSubmitStripePaymentSuccess,\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (selectedOffer && !order && !initialiseOrder.isLoading && !initialiseOrder.isError) {\r\n      initialiseOrder.mutate({ offer: selectedOffer });\r\n    }\r\n  }, [selectedOffer, order, initialiseOrder]);\r\n\r\n  // Clear the order when unmounted\r\n  useEffect(() => {\r\n    return () => setOrder(null);\r\n  }, [setOrder]);\r\n\r\n  const isSubmitting =\r\n    initialiseOrder.isLoading ||\r\n    updateOrder.isLoading ||\r\n    submitPaymentWithoutDetails.isLoading ||\r\n    submitPaymentPaypal.isLoading ||\r\n    submitPaymentStripe.isLoading;\r\n\r\n  return {\r\n    selectedOffer,\r\n    offerType,\r\n    paymentMethods,\r\n    order,\r\n    isSubmitting,\r\n    updateOrder,\r\n    submitPaymentWithoutDetails,\r\n    submitPaymentPaypal,\r\n    submitPaymentStripe,\r\n  };\r\n};\r\n\r\nexport default useCheckout;\r\n","import * as React from \"react\";\nconst SvgArrowLeft = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z\" }));\nexport default SvgArrowLeft;\n","import React from 'react';\r\nimport ArrowLeft from '@jwp/ott-theme/assets/icons/arrow_left.svg?react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport Icon from '../Icon/Icon';\r\nimport IconButton from '../IconButton/IconButton';\r\n\r\nimport styles from './DialogBackButton.module.scss';\r\n\r\ntype Props = {\r\n  onClick?: () => void;\r\n};\r\n\r\nconst DialogBackButton: React.FC<Props> = ({ onClick }: Props) => {\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <IconButton onClick={onClick} className={styles.dialogBackButton} aria-label={t('common:back')}>\r\n      <Icon icon={ArrowLeft} />\r\n    </IconButton>\r\n  );\r\n};\r\n\r\nexport default DialogBackButton;\r\n","import ReCaptcha from 'react-google-recaptcha';\r\nimport { forwardRef } from 'react';\r\n\r\nimport styles from './RecaptchaField.module.scss';\r\n\r\ntype Props = {\r\n  siteKey: string;\r\n};\r\n\r\nconst RecaptchaField = forwardRef<ReCaptcha, Props>(({ siteKey }, ref) => {\r\n  return (\r\n    <div className={styles.captcha}>\r\n      <ReCaptcha ref={ref} sitekey={siteKey} size={'invisible'} badge=\"inline\" theme=\"dark\" />\r\n    </div>\r\n  );\r\n});\r\n\r\nexport default RecaptchaField;\r\n","import React, { type ReactNode } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport classNames from 'classnames';\r\nimport type { Offer, OfferType, Order, PaymentMethod } from '@jwp/ott-common/types/checkout';\r\nimport { formatPrice } from '@jwp/ott-common/src/utils/formatting';\r\nimport Close from '@jwp/ott-theme/assets/icons/close.svg?react';\r\nimport PayPal from '@jwp/ott-theme/assets/icons/paypal.svg?react';\r\nimport CreditCard from '@jwp/ott-theme/assets/icons/creditcard.svg?react';\r\nimport type { ReCAPTCHA } from 'react-google-recaptcha';\r\n\r\nimport Button from '../Button/Button';\r\nimport IconButton from '../IconButton/IconButton';\r\nimport FormFeedback from '../FormFeedback/FormFeedback';\r\nimport DialogBackButton from '../DialogBackButton/DialogBackButton';\r\nimport LoadingOverlay from '../LoadingOverlay/LoadingOverlay';\r\nimport Icon from '../Icon/Icon';\r\nimport RecaptchaField from '../RecaptchaField/RecaptchaField';\r\n\r\nimport styles from './CheckoutForm.module.scss';\r\n\r\ntype Props = {\r\n  paymentMethodId?: string;\r\n  onBackButtonClick: () => void;\r\n  paymentMethods?: PaymentMethod[];\r\n  onPaymentMethodChange: React.ChangeEventHandler<HTMLInputElement>;\r\n  onCouponFormSubmit: React.FormEventHandler<HTMLFormElement>;\r\n  onCouponInputChange: React.ChangeEventHandler<HTMLInputElement>;\r\n  onRedeemCouponButtonClick: () => void;\r\n  onCloseCouponFormClick: () => void;\r\n  error?: string;\r\n  couponFormOpen: boolean;\r\n  couponFormError?: string;\r\n  couponFormApplied?: boolean;\r\n  couponFormSubmitting?: boolean;\r\n  couponInputValue: string;\r\n  order: Order;\r\n  offer: Offer;\r\n  offerType: OfferType;\r\n  children: ReactNode;\r\n  submitting: boolean;\r\n  captchaSiteKey?: string;\r\n  recaptchaRef?: React.RefObject<ReCAPTCHA>;\r\n};\r\n\r\nconst CheckoutForm: React.FC<Props> = ({\r\n  paymentMethodId,\r\n  paymentMethods,\r\n  order,\r\n  offer,\r\n  offerType,\r\n  onBackButtonClick,\r\n  onPaymentMethodChange,\r\n  error,\r\n  couponFormOpen,\r\n  couponInputValue,\r\n  couponFormError,\r\n  couponFormApplied,\r\n  couponFormSubmitting,\r\n  onCouponInputChange,\r\n  onCloseCouponFormClick,\r\n  onCouponFormSubmit,\r\n  onRedeemCouponButtonClick,\r\n  children,\r\n  submitting,\r\n  captchaSiteKey,\r\n  recaptchaRef,\r\n}) => {\r\n  const { t } = useTranslation('account');\r\n\r\n  const getOfferPeriod = () => {\r\n    // t('periods.day', { count })\r\n    // t('periods.week', { count })\r\n    // t('periods.month', { count })\r\n    // t('periods.year', { count })\r\n    return offer ? t(`periods.${offer.period}`) : '';\r\n  };\r\n\r\n  const getFreeTrialText = (offer: Offer) => {\r\n    if (offer.freeDays) {\r\n      return t('checkout.days_trial', { count: offer.freeDays });\r\n    } else if (offer.freePeriods) {\r\n      // t('periods.day', { count })\r\n      // t('periods.week', { count })\r\n      // t('periods.month', { count })\r\n      // t('periods.year', { count })\r\n      const period = t(`periods.${offer.period}`, { count: offer.freePeriods });\r\n\r\n      return t('checkout.periods_trial', { count: offer.freePeriods, period });\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  const cardPaymentMethod = paymentMethods?.find((method) => method.methodName === 'card');\r\n  const paypalPaymentMethod = paymentMethods?.find((method) => method.methodName === 'paypal');\r\n\r\n  const orderTitle = offerType === 'svod' ? (offer.period === 'month' ? t('checkout.monthly') : t('checkout.yearly')) : offer.offerTitle;\r\n  return (\r\n    <div>\r\n      {error ? <FormFeedback variant=\"error\">{error}</FormFeedback> : null}\r\n      <h1 className={styles.title}>{t('checkout.payment_method')}</h1>\r\n      <div className={styles.order}>\r\n        <div className={styles.orderInfo}>\r\n          <p className={classNames(styles.orderTitle, { [styles.orderTitleMargin]: offerType === 'svod' })}>{orderTitle}</p>\r\n          {order.discount?.type === 'trial' ? <p className={styles.orderBillingDate}>{getFreeTrialText(offer)}</p> : null}\r\n        </div>\r\n        <div className={styles.orderPrice}>\r\n          <span>{formatPrice(offer.customerPriceInclTax, order.currency, offer.customerCountry)}</span>\r\n          {offerType === 'svod' && <small>/{getOfferPeriod()}</small>}\r\n        </div>\r\n      </div>\r\n      <div className={styles.couponForm}>\r\n        {couponFormOpen ? (\r\n          <form onSubmit={onCouponFormSubmit} noValidate>\r\n            <div className={styles.redeemCoupon}>\r\n              <IconButton aria-label=\"Close coupon form\" onClick={onCloseCouponFormClick}>\r\n                <Icon icon={Close} />\r\n              </IconButton>\r\n              <input\r\n                className={styles.couponInput}\r\n                name=\"couponCode\"\r\n                type=\"text\"\r\n                placeholder=\"Coupon code\"\r\n                value={couponInputValue}\r\n                onChange={onCouponInputChange}\r\n              />\r\n              <Button variant=\"outlined\" label=\"Apply\" type=\"submit\" disabled={couponFormSubmitting} />\r\n            </div>\r\n            {couponFormError ? <FormFeedback variant=\"error\">{couponFormError}</FormFeedback> : null}\r\n            {couponFormApplied ? <FormFeedback variant=\"success\">{t('checkout.coupon_applied')}</FormFeedback> : null}\r\n          </form>\r\n        ) : (\r\n          <Button variant=\"outlined\" label={t('checkout.redeem_coupon')} onClick={onRedeemCouponButtonClick} />\r\n        )}\r\n      </div>\r\n\r\n      <div>\r\n        <table className={styles.orderTotals}>\r\n          <tbody>\r\n            {order.discount?.applied && order.discount?.type === 'coupon' ? (\r\n              <tr>\r\n                <td className={styles.couponCell}>\r\n                  {t('checkout.coupon_discount')}\r\n                  <br />\r\n                  {!!offer.period && offerType === 'svod' && (\r\n                    <small>\r\n                      {t('checkout.discount_period', {\r\n                        count: order.discount?.periods,\r\n                        period: t(`periods.${offer.period}`, { count: order.discount?.periods }),\r\n                      })}\r\n                    </small>\r\n                  )}\r\n                </td>\r\n                <td>{formatPrice(-order.priceBreakdown.discountAmount * (1 + order.taxRate), order.currency, offer.customerCountry)}</td>\r\n              </tr>\r\n            ) : null}\r\n            {order.discount?.applied && order.discount?.type === 'trial' ? (\r\n              <tr>\r\n                <td className={styles.couponCell}>{t('checkout.free_trial_discount')}</td>\r\n                <td>{formatPrice(-offer.customerPriceInclTax, order.currency, offer.customerCountry)}</td>\r\n              </tr>\r\n            ) : null}\r\n            {order.priceBreakdown.paymentMethodFee > 0 && (\r\n              <tr>\r\n                <td>{t('checkout.payment_method_fee')}</td>\r\n                <td>{formatPrice(order.priceBreakdown.paymentMethodFee, order.currency, offer.customerCountry)}</td>\r\n              </tr>\r\n            )}\r\n          </tbody>\r\n          <tfoot>\r\n            <tr>\r\n              <td>{t('checkout.total_price')}</td>\r\n              <td>{formatPrice(order.totalPrice, order.currency, offer.customerCountry)}</td>\r\n            </tr>\r\n            {order.priceBreakdown.taxValue > 0 && (\r\n              <tr>\r\n                <td>{t('checkout.applicable_tax', { taxRate: Math.round(order.taxRate * 100) })}</td>\r\n                <td>{formatPrice(order.priceBreakdown.taxValue, order.currency, offer.customerCountry)}</td>\r\n              </tr>\r\n            )}\r\n          </tfoot>\r\n        </table>\r\n      </div>\r\n      {!!captchaSiteKey && <RecaptchaField siteKey={captchaSiteKey} ref={recaptchaRef} />}\r\n      <hr className={styles.divider} />\r\n      {order.requiredPaymentDetails ? (\r\n        <div className={styles.paymentMethods}>\r\n          {cardPaymentMethod ? (\r\n            <div className={styles.paymentMethod}>\r\n              <input\r\n                className={styles.radio}\r\n                type=\"radio\"\r\n                name=\"paymentMethodId\"\r\n                value={cardPaymentMethod.id}\r\n                id=\"card\"\r\n                checked={paymentMethodId === cardPaymentMethod.id.toString()}\r\n                onChange={onPaymentMethodChange}\r\n              />\r\n              <label className={styles.paymentMethodLabel} htmlFor=\"card\">\r\n                <Icon icon={CreditCard} /> {t('checkout.credit_card')}\r\n              </label>\r\n            </div>\r\n          ) : null}\r\n          {paypalPaymentMethod ? (\r\n            <div className={styles.paymentMethod}>\r\n              <input\r\n                className={styles.radio}\r\n                type=\"radio\"\r\n                name=\"paymentMethodId\"\r\n                value={paypalPaymentMethod.id}\r\n                id=\"paypal\"\r\n                checked={paymentMethodId === paypalPaymentMethod.id.toString()}\r\n                onChange={onPaymentMethodChange}\r\n              />\r\n              <label className={styles.paymentMethodLabel} htmlFor=\"paypal\">\r\n                <Icon icon={PayPal} /> {t('checkout.paypal')}\r\n              </label>\r\n            </div>\r\n          ) : null}\r\n        </div>\r\n      ) : null}\r\n      {children ? <div>{children}</div> : null}\r\n      {submitting && <LoadingOverlay transparentBackground inline />}\r\n      <DialogBackButton onClick={onBackButtonClick} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CheckoutForm;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport Button from '../Button/Button';\r\nimport FormFeedback from '../FormFeedback/FormFeedback';\r\n\r\nimport styles from './NoPaymentRequired.module.scss';\r\n\r\ntype Props = {\r\n  onSubmit?: () => void;\r\n  error: string | null;\r\n};\r\n\r\nconst NoPaymentRequired: React.FC<Props> = ({ onSubmit, error }) => {\r\n  const { t } = useTranslation('account');\r\n\r\n  return (\r\n    <div className={styles.noPaymentRequired}>\r\n      {error ? <FormFeedback variant=\"error\">{error}</FormFeedback> : null}\r\n      <p>{t('checkout.no_payment_needed')}</p>\r\n      <Button label={t('checkout.continue')} variant=\"contained\" color=\"primary\" size=\"large\" onClick={onSubmit} fullWidth />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NoPaymentRequired;\r\n","import { useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport Payment from 'payment';\r\nimport { object, string } from 'yup';\r\nimport useForm from '@jwp/ott-hooks-react/src/useForm';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\n\r\nimport Button from '../Button/Button';\r\nimport CreditCardCVCField from '../form-fields/CreditCardCVCField/CreditCardCVCField';\r\nimport CreditCardExpiryField from '../form-fields/CreditCardExpiryField/CreditCardExpiryField';\r\nimport CreditCardNumberField from '../form-fields/CreditCardNumberField/CreditCardNumberField';\r\nimport TextField from '../form-fields/TextField/TextField';\r\nimport FormFeedback from '../FormFeedback/FormFeedback';\r\n\r\nimport styles from './PaymentForm.module.scss';\r\n\r\nexport type PaymentFormData = {\r\n  cardholderName: string;\r\n  cardNumber: string;\r\n  cardExpiry: string;\r\n  cardCVC: string;\r\n  cardExpMonth: string;\r\n  cardExpYear: string;\r\n};\r\n\r\ntype Props = {\r\n  onPaymentFormSubmit: (values: PaymentFormData) => void;\r\n};\r\n\r\nconst PaymentForm: React.FC<Props> = ({ onPaymentFormSubmit }) => {\r\n  const { t } = useTranslation('account');\r\n\r\n  const { values, errors, setValue, handleChange, handleBlur, handleSubmit } = useForm<PaymentFormData>({\r\n    initialValues: { cardholderName: '', cardNumber: '', cardExpiry: '', cardCVC: '', cardExpMonth: '', cardExpYear: '' },\r\n    validationSchema: object()\r\n      .required()\r\n      .shape({\r\n        cardholderName: string().required(),\r\n        cardNumber: string()\r\n          .required()\r\n          .test('card number validation', t('checkout.invalid_card_number'), (value) => Payment.fns.validateCardNumber(value as string)),\r\n        cardExpiry: string()\r\n          .required()\r\n          .test('card expiry validation', t('checkout.invalid_card_expiry'), (value) => Payment.fns.validateCardExpiry(value as string)),\r\n        cardCVC: string()\r\n          .required()\r\n          .test('cvc validation', t('checkout.invalid_cvc_number'), (value, context) => {\r\n            const issuer = Payment.fns.cardType(context.parent.cardNumber);\r\n\r\n            return Payment.fns.validateCardCVC(value as string, issuer);\r\n          }),\r\n        cardExpMonth: string().required(),\r\n        cardExpYear: string().required(),\r\n      }),\r\n    validateOnBlur: true,\r\n    onSubmit: onPaymentFormSubmit,\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (values.cardExpiry) {\r\n      const expiry = Payment.fns.cardExpiryVal(values.cardExpiry);\r\n      if (expiry.month) {\r\n        setValue('cardExpMonth', expiry.month.toString());\r\n      }\r\n      if (expiry.year) {\r\n        setValue('cardExpYear', expiry.year.toString());\r\n      }\r\n    }\r\n    //eslint-disable-next-line\r\n  }, [values.cardExpiry]);\r\n\r\n  return (\r\n    <div className={styles.paymentForm}>\r\n      <form onSubmit={handleSubmit} data-testid={testId('payment_form')} noValidate>\r\n        {errors.form ? (\r\n          <div className={styles.formError}>\r\n            <FormFeedback variant=\"error\">{errors.form}</FormFeedback>\r\n          </div>\r\n        ) : null}\r\n        <div>\r\n          <TextField\r\n            label={t('checkout.card_holder_name')}\r\n            name=\"cardholderName\"\r\n            value={values.cardholderName}\r\n            onChange={handleChange}\r\n            onBlur={handleBlur}\r\n            placeholder={t('checkout.credit_card_name')}\r\n            autoComplete=\"cc-name\"\r\n            required\r\n          />\r\n        </div>\r\n        <div>\r\n          <CreditCardNumberField value={values.cardNumber.toString()} error={errors.cardNumber} onBlur={handleBlur} onChange={handleChange} />\r\n        </div>\r\n        <div className={styles.columns}>\r\n          <div>\r\n            <CreditCardExpiryField value={values.cardExpiry} onBlur={handleBlur} onChange={handleChange} error={errors.cardExpiry} />\r\n          </div>\r\n          <div>\r\n            <CreditCardCVCField value={values.cardCVC} onBlur={handleBlur} onChange={handleChange} error={errors.cardCVC} />\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <Button label={t('checkout.continue')} variant=\"contained\" color=\"primary\" type=\"submit\" size=\"large\" fullWidth />\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PaymentForm;\r\n","import type { CoreOptions } from '@adyen/adyen-web/dist/types/core/types';\r\nimport { useCallback, useEffect, useMemo, useState } from 'react';\r\nimport type DropinElement from '@adyen/adyen-web/dist/types/components/Dropin/Dropin';\r\nimport { useNavigate } from 'react-router';\r\nimport type { AdyenPaymentSession } from '@jwp/ott-common/types/checkout';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport CheckoutController from '@jwp/ott-common/src/controllers/CheckoutController';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport { createURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport { ADYEN_LIVE_CLIENT_KEY, ADYEN_TEST_CLIENT_KEY } from '@jwp/ott-common/src/constants';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport Adyen from '../../components/Adyen/Adyen';\r\nimport { useAriaAnnouncer } from '../AnnouncementProvider/AnnoucementProvider';\r\n\r\ntype Props = {\r\n  setUpdatingOrder: (loading: boolean) => void;\r\n  type: AdyenPaymentMethodType;\r\n  paymentSuccessUrl: string;\r\n  orderId?: number;\r\n  getCaptchaValue: () => Promise<string | undefined>;\r\n};\r\n\r\nexport default function AdyenInitialPayment({ setUpdatingOrder, type, paymentSuccessUrl, orderId, getCaptchaValue }: Props) {\r\n  const accountController = getModule(AccountController);\r\n  const checkoutController = getModule(CheckoutController);\r\n  const { t } = useTranslation(['account', 'error']);\r\n  const announce = useAriaAnnouncer();\r\n\r\n  const [error, setError] = useState<string>();\r\n  const [session, setSession] = useState<AdyenPaymentSession>();\r\n\r\n  const isSandbox = accountController.getSandbox();\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const createSession = async () => {\r\n      setUpdatingOrder(true);\r\n\r\n      try {\r\n        const session = await checkoutController.createAdyenPaymentSession(window.origin);\r\n\r\n        setSession(session);\r\n      } catch (error: unknown) {\r\n        if (error instanceof Error) {\r\n          setError(error.message);\r\n        }\r\n      }\r\n\r\n      setUpdatingOrder(false);\r\n    };\r\n\r\n    createSession();\r\n  }, [setUpdatingOrder, checkoutController]);\r\n\r\n  const onSubmit = useCallback(\r\n    async (state: AdyenEventData, handleAction: DropinElement['handleAction']) => {\r\n      if (!state.isValid) return;\r\n\r\n      try {\r\n        setUpdatingOrder(true);\r\n        setError(undefined);\r\n\r\n        if (orderId === undefined) {\r\n          setError(t('error:adyen_order_unknown'));\r\n          return;\r\n        }\r\n\r\n        const captchaValue = await getCaptchaValue();\r\n\r\n        const returnUrl = createURL(window.location.href, {\r\n          u: 'finalize-payment',\r\n          orderId: orderId,\r\n        });\r\n        const result = await checkoutController.initialAdyenPayment(state.data.paymentMethod, returnUrl, captchaValue);\r\n\r\n        if ('action' in result) {\r\n          handleAction(result.action);\r\n        }\r\n\r\n        await accountController.reloadSubscriptions({ retry: 10 });\r\n        announce(t('account:checkout.payment_success'), 'success');\r\n        navigate(paymentSuccessUrl, { replace: true });\r\n      } catch (error: unknown) {\r\n        if (error instanceof Error) {\r\n          setError(error.message);\r\n        }\r\n      }\r\n\r\n      setUpdatingOrder(false);\r\n    },\r\n    [setUpdatingOrder, orderId, checkoutController, accountController, announce, t, navigate, paymentSuccessUrl, getCaptchaValue],\r\n  );\r\n\r\n  const adyenConfiguration: CoreOptions = useMemo(\r\n    () => ({\r\n      session: session,\r\n      showPayButton: false,\r\n      environment: isSandbox ? 'test' : 'live',\r\n      clientKey: isSandbox ? ADYEN_TEST_CLIENT_KEY : ADYEN_LIVE_CLIENT_KEY,\r\n      paymentMethodsConfiguration: {\r\n        card: {\r\n          hasHolderName: true,\r\n          holderNameRequired: true,\r\n        },\r\n      },\r\n      onAdditionalDetails: async (state: AdyenAdditionalEventData) => {\r\n        try {\r\n          setUpdatingOrder(true);\r\n\r\n          const data = state.data.details as number | undefined;\r\n          await checkoutController.finalizeAdyenPayment(orderId, data);\r\n\r\n          announce(t('account:checkout.payment_success'), 'success');\r\n          navigate(paymentSuccessUrl, { replace: true });\r\n        } catch (error: unknown) {\r\n          if (error instanceof Error) {\r\n            setError(error.message);\r\n            setUpdatingOrder(false);\r\n          }\r\n        }\r\n      },\r\n      onSubmit: (state: AdyenEventData, component: DropinElement) => onSubmit(state, component.handleAction),\r\n      onError: (error: Error) => setError(error.message),\r\n    }),\r\n    [session, isSandbox, setUpdatingOrder, checkoutController, orderId, announce, t, navigate, paymentSuccessUrl, onSubmit],\r\n  );\r\n\r\n  return <Adyen configuration={adyenConfiguration} type={type} error={error} />;\r\n}\r\n","import { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport useEventCallback from '@jwp/ott-hooks-react/src/useEventCallback';\r\nimport { useRef } from 'react';\r\nimport type { ReCAPTCHA } from 'react-google-recaptcha';\r\n\r\nconst useRecaptcha = () => {\r\n  const recaptchaRef = useRef<ReCAPTCHA>(null);\r\n  const captchaSiteKey = useConfigStore(({ config }) => (config.custom?.captchaSiteKey ? (config.custom?.captchaSiteKey as string) : undefined));\r\n  const getCaptchaValue = useEventCallback(async () => (captchaSiteKey ? (await recaptchaRef.current?.executeAsync()) || undefined : undefined));\r\n\r\n  return { recaptchaRef, captchaSiteKey, getCaptchaValue };\r\n};\r\n\r\nexport default useRecaptcha;\r\n","import React, { useEffect, useState } from 'react';\r\nimport { useLocation, useNavigate } from 'react-router';\r\nimport useCheckout from '@jwp/ott-hooks-react/src/useCheckout';\r\nimport { modalURLFromLocation, modalURLFromWindowLocation } from '@jwp/ott-ui-react/src/utils/location';\r\nimport useForm from '@jwp/ott-hooks-react/src/useForm';\r\nimport { FormValidationError } from '@jwp/ott-common/src/errors/FormValidationError';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { createURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport { findDefaultCardMethodId } from '@jwp/ott-common/src/utils/payments';\r\n\r\nimport CheckoutForm from '../../../components/CheckoutForm/CheckoutForm';\r\nimport LoadingOverlay from '../../../components/LoadingOverlay/LoadingOverlay';\r\nimport PayPal from '../../../components/PayPal/PayPal';\r\nimport NoPaymentRequired from '../../../components/NoPaymentRequired/NoPaymentRequired';\r\nimport PaymentForm, { type PaymentFormData } from '../../../components/PaymentForm/PaymentForm';\r\nimport AdyenInitialPayment from '../../AdyenInitialPayment/AdyenInitialPayment';\r\nimport { useAriaAnnouncer } from '../../AnnouncementProvider/AnnoucementProvider';\r\nimport useRecaptcha from '../../../hooks/useRecaptcha';\r\n\r\nconst Checkout = () => {\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const [adyenUpdating, setAdyenUpdating] = useState(false); // @todo: integrate AdyenInitialPayment into useCheckout\r\n\r\n  const [couponFormOpen, setCouponFormOpen] = useState(false);\r\n  const [showCouponCodeSuccess, setShowCouponCodeSuccess] = useState(false);\r\n  const { t } = useTranslation('account');\r\n  const announce = useAriaAnnouncer();\r\n\r\n  const chooseOfferUrl = modalURLFromLocation(location, 'choose-offer');\r\n  const welcomeUrl = modalURLFromLocation(location, 'welcome');\r\n  const closeModalUrl = modalURLFromLocation(location, null);\r\n\r\n  const { recaptchaRef, captchaSiteKey, getCaptchaValue } = useRecaptcha();\r\n\r\n  const backButtonClickHandler = () => navigate(chooseOfferUrl);\r\n\r\n  const { selectedOffer, offerType, paymentMethods, order, isSubmitting, updateOrder, submitPaymentWithoutDetails, submitPaymentPaypal, submitPaymentStripe } =\r\n    useCheckout({\r\n      onUpdateOrderSuccess: () => !!couponCode && setShowCouponCodeSuccess(true),\r\n      onSubmitPaymentWithoutDetailsSuccess: () => {\r\n        announce(t('checkout.payment_success'), 'success');\r\n\r\n        return navigate(offerType === 'svod' ? welcomeUrl : closeModalUrl, { replace: true });\r\n      },\r\n      onSubmitPaypalPaymentSuccess: ({ redirectUrl }) => {\r\n        window.location.href = redirectUrl;\r\n      },\r\n      onSubmitStripePaymentSuccess: () => navigate(modalURLFromLocation(location, 'waiting-for-payment'), { replace: true }),\r\n    });\r\n\r\n  const {\r\n    values: { couponCode, paymentMethodId },\r\n    setValue,\r\n    submitting: couponFormSubmitting,\r\n    errors,\r\n    handleChange,\r\n    handleSubmit,\r\n  } = useForm({\r\n    initialValues: { couponCode: '', paymentMethodId: findDefaultCardMethodId(paymentMethods) },\r\n    onSubmit: ({ couponCode, paymentMethodId }) => {\r\n      setShowCouponCodeSuccess(false);\r\n\r\n      return updateOrder.mutateAsync({ couponCode, paymentMethodId: parseInt(paymentMethodId) });\r\n    },\r\n    onSubmitSuccess: ({ couponCode }): void => setShowCouponCodeSuccess(!!couponCode),\r\n    onSubmitError: ({ error }) => {\r\n      if (error instanceof FormValidationError && error.errors.order?.includes(`Order with id ${order?.id} not found`)) {\r\n        navigate(modalURLFromLocation(location, 'choose-offer'), { replace: true });\r\n      }\r\n    },\r\n  });\r\n\r\n  const handlePaymentMethodChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    handleChange(event);\r\n\r\n    // Always send payment method to backend\r\n    updateOrder.mutateAsync({ couponCode, paymentMethodId: parseInt(event.target.value) });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!selectedOffer) {\r\n      return navigate(chooseOfferUrl, { replace: true });\r\n    }\r\n  }, [navigate, chooseOfferUrl, selectedOffer]);\r\n\r\n  // Pre-select first payment method\r\n  useEffect(() => {\r\n    if (!paymentMethods?.length) return;\r\n\r\n    setValue('paymentMethodId', findDefaultCardMethodId(paymentMethods));\r\n  }, [paymentMethods, setValue]);\r\n\r\n  // clear after closing the checkout modal\r\n  useEffect(() => {\r\n    return () => setShowCouponCodeSuccess(false);\r\n  }, []);\r\n\r\n  // loading state\r\n  if (!selectedOffer || !order || !paymentMethods || !offerType) {\r\n    return (\r\n      <div style={{ height: 300 }}>\r\n        <LoadingOverlay inline />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const cancelUrl = modalURLFromWindowLocation('payment-cancelled');\r\n  const waitingUrl = modalURLFromWindowLocation('waiting-for-payment', { offerId: selectedOffer?.offerId });\r\n  const errorUrl = modalURLFromWindowLocation('payment-error');\r\n  const successUrlPaypal = offerType === 'svod' ? waitingUrl : createURL(window.location.href, { u: '' });\r\n  const referrer = window.location.href;\r\n\r\n  const paymentMethod = paymentMethods?.find((method) => method.id === parseInt(paymentMethodId));\r\n  const noPaymentRequired = !order?.requiredPaymentDetails;\r\n  const isStripePayment = paymentMethod?.methodName === 'card' && paymentMethod?.provider === 'stripe';\r\n  const isAdyenPayment = paymentMethod?.methodName === 'card' && paymentMethod?.paymentGateway === 'adyen';\r\n  const isPayPalPayment = paymentMethod?.methodName === 'paypal';\r\n\r\n  return (\r\n    <CheckoutForm\r\n      order={order}\r\n      offer={selectedOffer}\r\n      offerType={offerType}\r\n      error={errors.form}\r\n      onBackButtonClick={backButtonClickHandler}\r\n      paymentMethods={paymentMethods}\r\n      paymentMethodId={paymentMethodId}\r\n      onPaymentMethodChange={handlePaymentMethodChange}\r\n      onCouponFormSubmit={handleSubmit}\r\n      onCouponInputChange={handleChange}\r\n      onRedeemCouponButtonClick={() => setCouponFormOpen(true)}\r\n      onCloseCouponFormClick={() => setCouponFormOpen(false)}\r\n      couponInputValue={couponCode}\r\n      couponFormOpen={couponFormOpen}\r\n      couponFormApplied={showCouponCodeSuccess}\r\n      couponFormSubmitting={couponFormSubmitting}\r\n      couponFormError={errors.couponCode}\r\n      submitting={isSubmitting || adyenUpdating}\r\n      captchaSiteKey={captchaSiteKey}\r\n      recaptchaRef={recaptchaRef}\r\n    >\r\n      {noPaymentRequired && (\r\n        <NoPaymentRequired\r\n          onSubmit={async () => {\r\n            const captchaValue = await getCaptchaValue();\r\n\r\n            return submitPaymentWithoutDetails.mutateAsync({ captchaValue });\r\n          }}\r\n          error={submitPaymentWithoutDetails.error?.message || null}\r\n        />\r\n      )}\r\n      {isStripePayment && (\r\n        <PaymentForm\r\n          onPaymentFormSubmit={async (cardPaymentPayload: PaymentFormData) =>\r\n            await submitPaymentStripe.mutateAsync({ cardPaymentPayload, referrer, returnUrl: waitingUrl })\r\n          }\r\n        />\r\n      )}\r\n      {isAdyenPayment && (\r\n        <>\r\n          <AdyenInitialPayment\r\n            paymentSuccessUrl={offerType === 'svod' ? welcomeUrl : closeModalUrl}\r\n            setUpdatingOrder={setAdyenUpdating}\r\n            orderId={order.id}\r\n            type=\"card\"\r\n            getCaptchaValue={getCaptchaValue}\r\n          />\r\n        </>\r\n      )}\r\n      {isPayPalPayment && (\r\n        <PayPal\r\n          onSubmit={async () => {\r\n            const captchaValue = await getCaptchaValue();\r\n\r\n            submitPaymentPaypal.mutate({ successUrl: successUrlPaypal, waitingUrl, cancelUrl, errorUrl, couponCode, captchaValue });\r\n          }}\r\n          error={submitPaymentPaypal.error?.message || null}\r\n        />\r\n      )}\r\n    </CheckoutForm>\r\n  );\r\n};\r\n\r\nexport default Checkout;\r\n","import { useMutation, useQuery } from 'react-query';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useCheckoutStore } from '@jwp/ott-common/src/stores/CheckoutStore';\r\nimport CheckoutController from '@jwp/ott-common/src/controllers/CheckoutController';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport type { OfferType } from '@jwp/ott-common/types/checkout';\r\n\r\nconst useOffers = () => {\r\n  const checkoutController = getModule(CheckoutController);\r\n  const accountController = getModule(AccountController);\r\n\r\n  const { mediaOffers, subscriptionOffers, switchSubscriptionOffers, requestedMediaOffers } = useCheckoutStore(\r\n    ({ mediaOffers, subscriptionOffers, switchSubscriptionOffers, requestedMediaOffers }) => ({\r\n      mediaOffers,\r\n      subscriptionOffers,\r\n      switchSubscriptionOffers,\r\n      requestedMediaOffers,\r\n    }),\r\n    shallow,\r\n  );\r\n\r\n  const { isLoading: isInitialisationLoading } = useQuery<void>({\r\n    queryKey: ['initialiseOffers', requestedMediaOffers],\r\n    queryFn: checkoutController.initialiseOffers,\r\n  });\r\n\r\n  const chooseOffer = useMutation({\r\n    mutationKey: ['chooseOffer'],\r\n    mutationFn: checkoutController.chooseOffer,\r\n  });\r\n\r\n  const switchSubscription = useMutation({\r\n    mutationKey: ['switchSubscription'],\r\n    mutationFn: checkoutController.switchSubscription,\r\n    onSuccess: () => accountController.reloadSubscriptions({ delay: 3000, retry: 10 }), // A subscription switch usually takes at least 3 secs\r\n  });\r\n\r\n  const hasMediaOffers = mediaOffers.length > 0;\r\n  const hasSubscriptionOffers = subscriptionOffers.length > 0;\r\n  const hasPremierOffers = requestedMediaOffers.some((mediaOffer) => mediaOffer.premier);\r\n  const hasMultipleOfferTypes = (subscriptionOffers.length > 0 || switchSubscriptionOffers.length > 0) && hasMediaOffers && !hasPremierOffers;\r\n  const defaultOfferType: OfferType = hasPremierOffers || !hasSubscriptionOffers ? 'tvod' : 'svod';\r\n\r\n  return {\r\n    isLoading: isInitialisationLoading || chooseOffer.isLoading,\r\n    mediaOffers,\r\n    subscriptionOffers,\r\n    switchSubscriptionOffers,\r\n    chooseOffer,\r\n    switchSubscription,\r\n    hasMultipleOfferTypes,\r\n    defaultOfferType,\r\n  };\r\n};\r\n\r\nexport default useOffers;\r\n","import * as React from \"react\";\nconst SvgCheckCircle = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M10 17L5 12L6.41 10.59L10 14.17L17.59 6.58L19 8L10 17Z\" }));\nexport default SvgCheckCircle;\n","import React, { type FC, type SVGProps } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport classNames from 'classnames';\r\nimport type { FormErrors } from '@jwp/ott-common/types/form';\r\nimport type { Offer, ChooseOfferFormData } from '@jwp/ott-common/types/checkout';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { getOfferPrice, isSVODOffer } from '@jwp/ott-common/src/utils/offers';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\nimport CheckCircle from '@jwp/ott-theme/assets/icons/check_circle.svg?react';\r\n\r\nimport Button from '../Button/Button';\r\nimport FormFeedback from '../FormFeedback/FormFeedback';\r\nimport DialogBackButton from '../DialogBackButton/DialogBackButton';\r\nimport LoadingOverlay from '../LoadingOverlay/LoadingOverlay';\r\nimport Icon from '../Icon/Icon';\r\n\r\nimport styles from './ChooseOfferForm.module.scss';\r\n\r\ntype OfferBoxProps = {\r\n  offer: Offer;\r\n  selected: boolean;\r\n} & Pick<Props, 'onChange'>;\r\n\r\nconst OfferBox: React.FC<OfferBoxProps> = ({ offer, selected, onChange }: OfferBoxProps) => {\r\n  const { t } = useTranslation('account');\r\n\r\n  const getFreeTrialText = (offer: Offer) => {\r\n    if (offer.freeDays) {\r\n      return t('choose_offer.benefits.first_days_free', { count: offer.freeDays });\r\n    } else if (offer.freePeriods) {\r\n      // t('periods.day', { count })\r\n      // t('periods.week', { count })\r\n      // t('periods.month', { count })\r\n      // t('periods.year', { count })\r\n      const period = t(`periods.${offer.period}`, { count: offer.freePeriods });\r\n\r\n      return t('choose_offer.benefits.first_periods_free', { count: offer.freePeriods, period });\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  const renderListItem = (text: string, icon: FC<SVGProps<SVGSVGElement>>) => (\r\n    <li>\r\n      <Icon icon={icon} />\r\n      {text}\r\n      <span className=\"hidden\">.</span>\r\n    </li>\r\n  );\r\n\r\n  const renderOption = ({ title, periodString, secondBenefit }: { title: string; periodString?: string; secondBenefit?: string }) => (\r\n    <div className={styles.offer} aria-labelledby={`title-${offer.offerId}`}>\r\n      <input\r\n        className={styles.radio}\r\n        onChange={onChange}\r\n        type=\"radio\"\r\n        name={'selectedOfferId'}\r\n        value={offer.offerId}\r\n        id={offer.offerId}\r\n        checked={selected}\r\n        data-testid={testId(offer.offerId)}\r\n      />\r\n      <div className={styles.label}>\r\n        <label htmlFor={offer.offerId}>\r\n          <h2 className={styles.offerTitle} id={`title-${offer.offerId}`}>\r\n            {title}\r\n          </h2>\r\n          <span className=\"hidden\">.</span>\r\n          <hr className={styles.offerDivider} aria-hidden={true} />\r\n          <ul className={styles.offerBenefits}>\r\n            {offer.freeDays || offer.freePeriods ? renderListItem(getFreeTrialText(offer) || '', CheckCircle) : null}\r\n            {!!secondBenefit && renderListItem(secondBenefit, CheckCircle)}\r\n            {renderListItem(t('choose_offer.benefits.watch_on_all_devices'), CheckCircle)}\r\n          </ul>\r\n          <div className={styles.fill} />\r\n          <div className={styles.offerPrice}>\r\n            {getOfferPrice(offer)} {!!periodString && <small>/{periodString}</small>}\r\n          </div>\r\n        </label>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  if (isSVODOffer(offer)) {\r\n    const isMonthly = offer.period === 'month';\r\n\r\n    return renderOption({\r\n      title: isMonthly ? t('choose_offer.monthly') : t('choose_offer.yearly'),\r\n      secondBenefit: t('choose_offer.benefits.cancel_anytime'),\r\n      periodString: isMonthly ? t('periods.month') : t('periods.year'),\r\n    });\r\n  }\r\n\r\n  return renderOption({\r\n    title: offer.offerTitle,\r\n    secondBenefit:\r\n      !!offer.durationPeriod && !!offer.durationAmount\r\n        ? t('choose_offer.tvod_access', { period: offer.durationPeriod, count: offer.durationAmount })\r\n        : undefined,\r\n  });\r\n};\r\n\r\ntype Props = {\r\n  values: ChooseOfferFormData;\r\n  errors: FormErrors<ChooseOfferFormData>;\r\n  onChange: React.ChangeEventHandler<HTMLInputElement | HTMLTextAreaElement>;\r\n  onSubmit: React.FormEventHandler<HTMLFormElement>;\r\n  onBackButtonClickHandler?: () => void;\r\n  offers: Offer[];\r\n  showOfferTypeSwitch: boolean;\r\n  submitting: boolean;\r\n};\r\n\r\nconst ChooseOfferForm: React.FC<Props> = ({ values, errors, submitting, offers, showOfferTypeSwitch, onChange, onSubmit, onBackButtonClickHandler }: Props) => {\r\n  const siteName = useConfigStore((s) => s.config.siteName);\r\n  const { t } = useTranslation('account');\r\n  const { selectedOfferType, selectedOfferId } = values;\r\n\r\n  return (\r\n    <form onSubmit={onSubmit} data-testid={testId('choose-offer-form')} noValidate>\r\n      {onBackButtonClickHandler ? <DialogBackButton onClick={onBackButtonClickHandler} /> : null}\r\n      <h1 className={styles.title}>{t('choose_offer.title')}</h1>\r\n      <p className={styles.subtitle}>{t('choose_offer.watch_this_on_platform', { siteName })}</p>\r\n      {errors.form ? <FormFeedback variant=\"error\">{errors.form}</FormFeedback> : null}\r\n      {showOfferTypeSwitch && (\r\n        <div className={styles.offerGroupSwitch}>\r\n          <input\r\n            className={styles.radio}\r\n            onChange={onChange}\r\n            type=\"radio\"\r\n            name=\"selectedOfferType\"\r\n            id=\"svod\"\r\n            value=\"svod\"\r\n            checked={selectedOfferType === 'svod'}\r\n          />\r\n          <label className={classNames(styles.label, styles.offerGroupLabel)} htmlFor=\"svod\">\r\n            {t('choose_offer.subscription')}\r\n          </label>\r\n          <input\r\n            className={styles.radio}\r\n            onChange={onChange}\r\n            type=\"radio\"\r\n            name=\"selectedOfferType\"\r\n            id=\"tvod\"\r\n            value=\"tvod\"\r\n            checked={selectedOfferType === 'tvod'}\r\n          />\r\n          <label className={classNames(styles.label, styles.offerGroupLabel)} htmlFor=\"tvod\">\r\n            {t('choose_offer.one_time_only')}\r\n          </label>\r\n        </div>\r\n      )}\r\n      <div className={styles.offers}>\r\n        {!offers.length ? (\r\n          <p>{t('choose_offer.no_pricing_available')}</p>\r\n        ) : (\r\n          offers.map((offer) => <OfferBox key={offer.offerId} offer={offer} selected={selectedOfferId === offer.offerId} onChange={onChange} />)\r\n        )}\r\n      </div>\r\n      {submitting && <LoadingOverlay transparentBackground inline />}\r\n      <Button label={t('choose_offer.continue')} disabled={submitting || !offers.length} variant=\"contained\" color=\"primary\" type=\"submit\" fullWidth />\r\n    </form>\r\n  );\r\n};\r\nexport default ChooseOfferForm;\r\n","import React, { useEffect } from 'react';\r\nimport { mixed, object } from 'yup';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useLocation, useNavigate } from 'react-router';\r\nimport type { ChooseOfferFormData, OfferType } from '@jwp/ott-common/types/checkout';\r\nimport { modalURLFromLocation } from '@jwp/ott-ui-react/src/utils/location';\r\nimport useOffers from '@jwp/ott-hooks-react/src/useOffers';\r\nimport useForm from '@jwp/ott-hooks-react/src/useForm';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\n\r\nimport ChooseOfferForm from '../../../components/ChooseOfferForm/ChooseOfferForm';\r\nimport LoadingOverlay from '../../../components/LoadingOverlay/LoadingOverlay';\r\nimport useQueryParam from '../../../hooks/useQueryParam';\r\n\r\nconst ChooseOffer = () => {\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const { t } = useTranslation('account');\r\n  const isSwitch = useQueryParam('u') === 'upgrade-subscription';\r\n  const isPendingOffer = useAccountStore(({ pendingOffer }) => ({ isPendingOffer: !!pendingOffer }));\r\n\r\n  const { isLoading, mediaOffers, subscriptionOffers, switchSubscriptionOffers, defaultOfferType, hasMultipleOfferTypes, chooseOffer, switchSubscription } =\r\n    useOffers();\r\n\r\n  const checkoutUrl = modalURLFromLocation(location, 'checkout');\r\n  const upgradePendingUrl = modalURLFromLocation(location, 'upgrade-subscription-pending');\r\n  const upgradeSuccessUrl = modalURLFromLocation(location, 'upgrade-subscription-success');\r\n  const upgradeErrorUrl = modalURLFromLocation(location, 'upgrade-subscription-error');\r\n\r\n  const { values, errors, submitting, setValue, handleSubmit, handleChange } = useForm<ChooseOfferFormData>({\r\n    initialValues: { selectedOfferType: defaultOfferType, selectedOfferId: undefined },\r\n    validationSchema: object().shape({\r\n      selectedOfferId: mixed<string>().required(t('choose_offer.field_required')),\r\n      selectedOfferType: mixed<OfferType>().required(t('choose_offer.field_required')),\r\n    }),\r\n    onSubmit: async ({ selectedOfferType, selectedOfferId }) => {\r\n      if (!selectedOfferType || !selectedOfferId) return;\r\n\r\n      const offer = visibleOffers.find((offer) => offer.offerId === selectedOfferId);\r\n\r\n      if (!offer) return;\r\n\r\n      await chooseOffer.mutateAsync(offer);\r\n\r\n      if (isSwitch) {\r\n        return await switchSubscription.mutateAsync();\r\n      }\r\n    },\r\n    onSubmitSuccess: async () => {\r\n      if (isSwitch && isPendingOffer) return navigate(upgradePendingUrl);\r\n      if (isSwitch) return navigate(upgradeSuccessUrl);\r\n\r\n      navigate(checkoutUrl);\r\n    },\r\n    onSubmitError: () => navigate(upgradeErrorUrl),\r\n  });\r\n\r\n  const visibleOffers = values.selectedOfferType === 'tvod' ? mediaOffers : isSwitch ? switchSubscriptionOffers : subscriptionOffers;\r\n\r\n  useEffect(() => {\r\n    if (isLoading || !visibleOffers.length) return;\r\n\r\n    const offerId = visibleOffers[visibleOffers.length - 1]?.offerId;\r\n\r\n    setValue('selectedOfferId', offerId);\r\n  }, [visibleOffers, values.selectedOfferType, setValue, isLoading]);\r\n\r\n  useEffect(() => {\r\n    if (isLoading || !defaultOfferType) return;\r\n\r\n    setValue('selectedOfferType', defaultOfferType);\r\n  }, [isLoading, defaultOfferType, setValue]);\r\n\r\n  // loading state\r\n  if (isLoading) {\r\n    return (\r\n      <div style={{ height: 300 }}>\r\n        <LoadingOverlay inline />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <ChooseOfferForm\r\n      onSubmit={handleSubmit}\r\n      onChange={handleChange}\r\n      values={values}\r\n      errors={errors}\r\n      submitting={submitting}\r\n      offers={visibleOffers}\r\n      showOfferTypeSwitch={hasMultipleOfferTypes}\r\n    />\r\n  );\r\n};\r\n\r\nexport default ChooseOffer;\r\n","import React, { type InputHTMLAttributes } from 'react';\r\nimport classNames from 'classnames';\r\n\r\nimport type { FormControlProps } from '../../types/form';\r\n\r\nimport styles from './Select.module.scss';\r\n\r\ntype HTMLSelectProps = Omit<InputHTMLAttributes<HTMLSelectElement>, 'size'>;\r\n\r\ntype Props = HTMLSelectProps & {\r\n  id?: string;\r\n  helperTextId?: string;\r\n  options?: (string | { value: string; label: string })[];\r\n  optionsStyle?: string;\r\n  defaultLabel?: string;\r\n} & FormControlProps;\r\n\r\nconst Select = ({\r\n  required,\r\n  className,\r\n  disabled,\r\n  defaultLabel,\r\n  options,\r\n  optionsStyle,\r\n  editing = true,\r\n  value,\r\n  onChange,\r\n  id,\r\n  name,\r\n  error,\r\n  helperTextId,\r\n  type,\r\n  ...rest\r\n}: Props) => {\r\n  const handleChange = (event: React.ChangeEvent<HTMLSelectElement>) => {\r\n    if (!editing) {\r\n      return event.preventDefault();\r\n    }\r\n    onChange?.(event);\r\n  };\r\n\r\n  // Default to 'text' if 'type' property is absent, which occurs in textareas.\r\n  const containerClassName = classNames(\r\n    styles.container,\r\n    {\r\n      [styles.error]: error,\r\n      [styles.disabled]: disabled,\r\n    },\r\n    className,\r\n  );\r\n\r\n  const ariaAttributes = {\r\n    'aria-required': !!required,\r\n    'aria-invalid': Boolean(required && error && value !== ''),\r\n    'aria-describedby': helperTextId,\r\n  } as const;\r\n\r\n  const inputProps: HTMLSelectProps = {\r\n    id,\r\n    name,\r\n    value,\r\n    disabled,\r\n    className: styles.select,\r\n    readOnly: !editing,\r\n    required: required,\r\n    ...ariaAttributes,\r\n    ...rest,\r\n  };\r\n\r\n  return (\r\n    <div className={classNames({ [containerClassName]: editing })}>\r\n      <select {...inputProps} onChange={handleChange}>\r\n        {defaultLabel && (\r\n          <option className={classNames(styles.option, optionsStyle)} value=\"\" disabled={required}>\r\n            {defaultLabel}\r\n          </option>\r\n        )}\r\n        {options &&\r\n          options.map((option) => (\r\n            <option\r\n              className={classNames(styles.option, optionsStyle)}\r\n              key={typeof option === 'string' ? option : option.value}\r\n              value={typeof option === 'string' ? option : option.value}\r\n            >\r\n              {typeof option === 'string' ? option : option.label}\r\n            </option>\r\n          ))}\r\n      </select>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Select;\r\n","import React, { type InputHTMLAttributes } from 'react';\r\n\r\nimport { FormField } from '../../FormField/FormField';\r\nimport Select from '../../Select/Select';\r\nimport type { FormControlProps } from '../../../types/form';\r\n\r\ntype SelectProps = Omit<InputHTMLAttributes<HTMLSelectElement>, 'size'>;\r\n\r\ntype Props = SelectProps & {\r\n  defaultLabel?: string;\r\n  options?: (string | { value: string; label: string })[];\r\n  optionsStyle?: string;\r\n  helperText?: React.ReactNode;\r\n} & FormControlProps;\r\n\r\nconst Dropdown: React.FC<Props> = ({\r\n  name,\r\n  className,\r\n  label,\r\n  error,\r\n  helperText,\r\n  editing = true,\r\n  required = false,\r\n  size = 'medium',\r\n  testId,\r\n  lang,\r\n  ...inputProps\r\n}) => {\r\n  return (\r\n    <FormField\r\n      className={className}\r\n      error={error}\r\n      helperText={helperText}\r\n      label={label}\r\n      required={required}\r\n      editing={editing}\r\n      testId={testId}\r\n      name={name}\r\n      size={size}\r\n      lang={lang}\r\n      renderInput={(fieldProps) => <Select name={name} required={required} editing={editing} error={error} size={size} {...fieldProps} {...inputProps} />}\r\n    />\r\n  );\r\n};\r\n\r\nexport default Dropdown;\r\n","import React, { type InputHTMLAttributes } from 'react';\r\nimport classNames from 'classnames';\r\n\r\nimport { FormField } from '../../FormField/FormField';\r\nimport type { FormControlProps } from '../../../types/form';\r\n\r\nimport styles from './Checkbox.module.scss';\r\n\r\ntype HTMLCheckboxProps = Omit<InputHTMLAttributes<HTMLInputElement>, 'size'>;\r\n\r\ntype Props = HTMLCheckboxProps & {\r\n  checkboxLabel?: React.ReactNode;\r\n  helperText?: React.ReactNode;\r\n} & FormControlProps;\r\n\r\nconst Checkbox: React.FC<Props> = ({\r\n  className,\r\n  label,\r\n  checkboxLabel,\r\n  name,\r\n  onChange,\r\n  editing = true,\r\n  value,\r\n  helperText,\r\n  error,\r\n  required,\r\n  lang,\r\n  size,\r\n  ...rest\r\n}) => {\r\n  const fieldClassName = classNames(styles.checkbox, { [styles.error]: error }, className);\r\n  const handleChange: React.ChangeEventHandler<HTMLInputElement> = (event) => {\r\n    if (!editing) {\r\n      return event.preventDefault();\r\n    }\r\n    onChange?.(event);\r\n  };\r\n\r\n  return (\r\n    <FormField\r\n      className={fieldClassName}\r\n      name={name}\r\n      label={label}\r\n      editing={editing}\r\n      required={required}\r\n      error={error}\r\n      helperText={helperText}\r\n      renderInput={({ id, helperTextId }) => (\r\n        <div className={styles.row}>\r\n          <input\r\n            name={name}\r\n            type=\"checkbox\"\r\n            id={id}\r\n            value={value}\r\n            aria-required={required}\r\n            aria-describedby={helperTextId}\r\n            {...rest}\r\n            onChange={handleChange}\r\n            readOnly={!editing}\r\n          />\r\n          <label htmlFor={id} lang={lang}>\r\n            {required ? (\r\n              <span role=\"presentation\" aria-hidden=\"true\">\r\n                *\r\n              </span>\r\n            ) : (\r\n              ''\r\n            )}\r\n            {checkboxLabel}\r\n          </label>\r\n        </div>\r\n      )}\r\n    />\r\n  );\r\n};\r\n\r\nexport default Checkbox;\r\n","import React, { type InputHTMLAttributes } from 'react';\r\nimport classNames from 'classnames';\r\n\r\nimport type { FormControlProps } from '../../../types/form';\r\nimport { FormField } from '../../FormField/FormField';\r\n\r\nimport styles from './Radio.module.scss';\r\n\r\ntype HTMLRadioProps = Omit<InputHTMLAttributes<HTMLInputElement>, 'size'>;\r\n\r\ntype Props = HTMLRadioProps & {\r\n  values: { value: string; label: string }[];\r\n  helperText?: React.ReactNode;\r\n} & FormControlProps;\r\n\r\nconst Radio: React.FC<Props> = ({ name, onChange, label, value, editing = true, size, values, helperText, error, required, disabled, lang, ...rest }) => {\r\n  const handleChange: React.ChangeEventHandler<HTMLInputElement> = (event) => {\r\n    if (!editing) {\r\n      return event.preventDefault();\r\n    }\r\n    onChange?.(event);\r\n  };\r\n\r\n  return (\r\n    <FormField\r\n      name={name}\r\n      label={label}\r\n      error={error}\r\n      helperText={helperText}\r\n      required={required}\r\n      renderInput={({ id, helperTextId }) => (\r\n        <div id={id}>\r\n          {values.map(({ value: optionValue, label: optionLabel }, index) => (\r\n            <div className={classNames(styles.radio, { [styles.error]: error })} key={index} lang={lang}>\r\n              <input\r\n                value={optionValue}\r\n                name={name}\r\n                type=\"radio\"\r\n                id={id + index}\r\n                onChange={handleChange}\r\n                checked={value === optionValue}\r\n                required={required}\r\n                disabled={disabled}\r\n                aria-describedby={helperTextId}\r\n                {...rest}\r\n              />\r\n              <label htmlFor={id + index}>{optionLabel}</label>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    />\r\n  );\r\n};\r\n\r\nexport default Radio;\r\n","import React, { type InputHTMLAttributes, useRef, useState } from 'react';\r\nimport classNames from 'classnames';\r\nimport useOpaqueId from '@jwp/ott-hooks-react/src/useOpaqueId';\r\n\r\nimport { FormField } from '../../FormField/FormField';\r\nimport type { FormControlProps } from '../../../types/form';\r\n\r\nimport styles from './DateField.module.scss';\r\n\r\ntype InputProps = Omit<InputHTMLAttributes<HTMLInputElement>, 'size'>;\r\n\r\ntype Props = InputProps & {\r\n  format?: string;\r\n  helperText?: React.ReactNode;\r\n} & FormControlProps;\r\n\r\nconst parseDateString = (dateString: string | undefined) => {\r\n  if (!dateString) return null;\r\n\r\n  const date = new Date(dateString);\r\n\r\n  return isNaN(date.getTime()) ? null : date;\r\n};\r\n\r\nconst padLeft = (value: number) => {\r\n  return value > 0 && value < 10 ? `0${value}` : value.toString();\r\n};\r\n\r\nconst clamp = (value: number, min: number, max: number) => Math.min(max, Math.max(min, value));\r\n\r\nconst parseBlurValue = (value: string, min: number, max: number) => {\r\n  const parsed = clamp(parseInt(value), min, max);\r\n  if (isNaN(parsed)) return '';\r\n\r\n  return value.length > 0 && parsed < 10 ? padLeft(parsed) : parsed.toString();\r\n};\r\n\r\nconst parseInputValue = (value: string, min: number, max: number) => {\r\n  const parsed = clamp(parseInt(value), min, max);\r\n  if (isNaN(parsed)) return '';\r\n\r\n  return value.length > 1 && parsed < 10 ? padLeft(parsed) : parsed.toString();\r\n};\r\n\r\nconst DateField: React.FC<Props> = ({\r\n  className,\r\n  label,\r\n  error,\r\n  helperText,\r\n  value,\r\n  onChange,\r\n  format = 'YYYY-MM-DD',\r\n  name,\r\n  editing,\r\n  lang,\r\n  required,\r\n  onFocus,\r\n  testId,\r\n}: Props) => {\r\n  const parsedDate = parseDateString(value);\r\n\r\n  const [values, setValues] = useState({\r\n    date: parsedDate?.getDate().toString() || '',\r\n    month: parsedDate ? (parsedDate.getMonth() + 1).toString() : '',\r\n    year: parsedDate?.getFullYear().toString() || '',\r\n  });\r\n\r\n  const id = useOpaqueId('text-field', name);\r\n  const helperTextId = useOpaqueId('helper_text', name);\r\n\r\n  const hiddenInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  const dateFieldClassName = classNames(\r\n    styles.dateField,\r\n    {\r\n      [styles.error]: error,\r\n    },\r\n    className,\r\n  );\r\n\r\n  const handleFocus = (event: React.FocusEvent<HTMLInputElement>) => {\r\n    event.currentTarget.select();\r\n    onFocus?.(event);\r\n  };\r\n\r\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\r\n    if (event.key === 'Backspace' && values[event.currentTarget.name as 'date' | 'month' | 'year'] === '') {\r\n      (event.currentTarget.previousElementSibling as HTMLElement)?.focus();\r\n\r\n      return event.preventDefault();\r\n    }\r\n\r\n    if (!/^[0-9]$/.test(event.key) && event.key !== 'Tab' && event.key !== 'Backspace') {\r\n      return event.preventDefault();\r\n    }\r\n  };\r\n\r\n  const handleBlur = (event: React.FocusEvent<HTMLInputElement>) => {\r\n    const { name, value } = event.target;\r\n\r\n    setValues((current) => {\r\n      const date = name === 'date' ? parseBlurValue(value, 1, 31) : current.date;\r\n      const month = name === 'month' ? parseBlurValue(value, 1, 12) : current.month;\r\n      const year = name === 'year' ? parseBlurValue(value, 1900, 2100) : current.year;\r\n\r\n      return { date, month, year };\r\n    });\r\n  };\r\n\r\n  const triggerChangeEvent = (date: string, month: string, year: string) => {\r\n    const nativeInputValueSetter = Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype, 'value')?.set;\r\n\r\n    const newValue = date && month && year ? format.replace('YYYY', year).replace('MM', month).replace('DD', date) : '';\r\n\r\n    nativeInputValueSetter?.call(hiddenInputRef.current, newValue);\r\n\r\n    const inputEvent = new Event('input', { bubbles: true });\r\n\r\n    hiddenInputRef.current?.dispatchEvent(inputEvent);\r\n  };\r\n\r\n  const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const { name, value } = event.target;\r\n    const nextSibling = event.currentTarget?.nextElementSibling as HTMLInputElement;\r\n\r\n    const date = name === 'date' ? parseInputValue(value, 0, 31) : values.date;\r\n    const month = name === 'month' ? parseInputValue(value, 0, 12) : values.month;\r\n    const year = name === 'year' ? parseInputValue(value, 0, 2100).slice(0, 4) : values.year;\r\n\r\n    setValues({ date, month, year });\r\n\r\n    triggerChangeEvent(date, month, year);\r\n\r\n    if ((nextSibling && name === 'month' && month.length === 2) || (name === 'date' && date.length === 2)) {\r\n      setTimeout(() => nextSibling.focus(), 1);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <FormField\r\n      className={dateFieldClassName}\r\n      name={name}\r\n      helperText={helperText}\r\n      error={error}\r\n      label={label}\r\n      editing={editing}\r\n      lang={lang}\r\n      required={required}\r\n      testId={testId}\r\n      renderInput={() => (\r\n        <div className={styles.container}>\r\n          {/* don't be tempted to make it type=\"hidden\", onChange will practically be ignored that way */}\r\n          <input\r\n            ref={hiddenInputRef}\r\n            id={`${id}-hidden`}\r\n            className={styles.hiddenInput}\r\n            name={name}\r\n            onChange={onChange}\r\n            aria-invalid={error}\r\n            aria-describedby={helperTextId}\r\n          />\r\n          <input\r\n            className={styles.input}\r\n            name=\"date\"\r\n            placeholder=\"dd\"\r\n            value={values.date}\r\n            onFocus={handleFocus}\r\n            onBlur={handleBlur}\r\n            onChange={handleChange}\r\n            onKeyDown={handleKeyDown}\r\n            maxLength={2}\r\n            type=\"number\"\r\n            id={`${id}-date`}\r\n            autoComplete=\"bday-day\"\r\n          />\r\n          {' / '}\r\n          <input\r\n            className={styles.input}\r\n            name=\"month\"\r\n            placeholder=\"mm\"\r\n            value={values.month}\r\n            onFocus={handleFocus}\r\n            onBlur={handleBlur}\r\n            onChange={handleChange}\r\n            onKeyDown={handleKeyDown}\r\n            maxLength={2}\r\n            type=\"number\"\r\n            id={`${id}-month`}\r\n            autoComplete=\"bday-month\"\r\n          />\r\n          {' / '}\r\n          <input\r\n            className={styles.input}\r\n            name=\"year\"\r\n            placeholder=\"yyyy\"\r\n            value={values.year}\r\n            onFocus={handleFocus}\r\n            onBlur={handleBlur}\r\n            onChange={handleChange}\r\n            onKeyDown={handleKeyDown}\r\n            maxLength={4}\r\n            type=\"number\"\r\n            id={`${id}-year`}\r\n            autoComplete=\"bday-year\"\r\n          />\r\n        </div>\r\n      )}\r\n    />\r\n  );\r\n};\r\n\r\nexport default DateField;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport type { CleengCaptureField, CleengCaptureQuestionField, PersonalDetailsFormData } from '@jwp/ott-common/types/account';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\nimport useForm, { type UseFormOnSubmitHandler } from '@jwp/ott-hooks-react/src/useForm';\r\n\r\nimport TextField from '../form-fields/TextField/TextField';\r\nimport Button from '../Button/Button';\r\nimport Dropdown from '../form-fields/Dropdown/Dropdown';\r\nimport Checkbox from '../form-fields/Checkbox/Checkbox';\r\nimport Radio from '../form-fields/Radio/Radio';\r\nimport DateField from '../form-fields/DateField/DateField';\r\nimport LoadingOverlay from '../LoadingOverlay/LoadingOverlay';\r\nimport FormFeedback from '../FormFeedback/FormFeedback';\r\n\r\nimport styles from './PersonalDetailsForm.module.scss';\r\n\r\ntype Props = {\r\n  initialValues: PersonalDetailsFormData;\r\n  onSubmit: UseFormOnSubmitHandler<PersonalDetailsFormData>;\r\n  error?: string;\r\n  fields: Record<string, CleengCaptureField>;\r\n  questions: CleengCaptureQuestionField[];\r\n  onQuestionChange: React.ChangeEventHandler;\r\n  questionValues: Record<string, string>;\r\n  questionErrors: Record<string, string>;\r\n};\r\n\r\nconst PersonalDetailsForm: React.FC<Props> = ({ initialValues, onSubmit, fields, questions, onQuestionChange, questionValues, questionErrors }: Props) => {\r\n  const { t } = useTranslation('account');\r\n\r\n  const { setValue, handleSubmit, handleChange, values, errors, validationSchemaError, submitting } = useForm<PersonalDetailsFormData>({\r\n    initialValues,\r\n    onSubmit,\r\n  });\r\n\r\n  const renderQuestion = ({ value, key, question, required, enabled }: CleengCaptureQuestionField) => {\r\n    if (!enabled) {\r\n      return null;\r\n    }\r\n\r\n    const values = value?.split(';').map((question) => {\r\n      const [value, label = value] = question.split(':');\r\n\r\n      return { value, label };\r\n    });\r\n\r\n    const props = {\r\n      name: key,\r\n      onChange: onQuestionChange,\r\n      error: !!questionErrors[key],\r\n      helperText: questionErrors[key],\r\n      required,\r\n      key,\r\n    };\r\n\r\n    // The rendered field is determined by the given available options for each question:\r\n    // TextField <- when there is exactly 1 option and the value is empty (e.g. \"\")\r\n    // Checkbox  <- when there is exactly 1 option and the value is not empty (e.g. \"accepted\")\r\n    // Radio     <- when there are exactly 2 options\r\n    // Dropdown  <- when there are more than 2 options\r\n\r\n    if (values.length === 1 && values[0].value === '') {\r\n      return <TextField value={questionValues[key]} label={question} {...props} />;\r\n    } else if (values.length === 1) {\r\n      return <Checkbox checked={!!questionValues[key]} value={values[0].value} label={question} checkboxLabel={values[0].label} {...props} />;\r\n    } else if (values.length === 2) {\r\n      return <Radio values={values} value={questionValues[key]} label={question} {...props} />;\r\n    } else if (values.length > 2) {\r\n      return <Dropdown options={values} value={questionValues[key]} label={question} defaultLabel={t('personal_details.select_answer')} {...props} />;\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} data-testid={testId('personal_details-form')} noValidate>\r\n      <h2 className={styles.title}>{t('personal_details.title')}</h2>\r\n      {errors.form ? (\r\n        <FormFeedback variant=\"error\" visible={!validationSchemaError}>\r\n          {errors.form}\r\n        </FormFeedback>\r\n      ) : null}\r\n      {fields.firstNameLastName?.enabled ? (\r\n        <React.Fragment>\r\n          <TextField\r\n            value={values.firstName}\r\n            onChange={handleChange}\r\n            label={t('personal_details.fist_name')}\r\n            placeholder={t('personal_details.fist_name')}\r\n            error={!!errors.firstName}\r\n            helperText={errors.firstName}\r\n            required={fields.firstNameLastName.required}\r\n            name=\"firstName\"\r\n            autoComplete=\"given-name\"\r\n          />\r\n          <TextField\r\n            value={values.lastName}\r\n            onChange={handleChange}\r\n            label={t('personal_details.last_name')}\r\n            placeholder={t('personal_details.last_name')}\r\n            error={!!errors.lastName}\r\n            helperText={errors.lastName}\r\n            required={fields.firstNameLastName.required}\r\n            name=\"lastName\"\r\n            autoComplete=\"family-name\"\r\n          />\r\n        </React.Fragment>\r\n      ) : null}\r\n      {fields.companyName?.enabled ? (\r\n        <TextField\r\n          value={values.companyName}\r\n          onChange={handleChange}\r\n          label={t('personal_details.company_name')}\r\n          placeholder={t('personal_details.company_name')}\r\n          error={!!errors.companyName}\r\n          helperText={errors.companyName}\r\n          required={fields.companyName.required}\r\n          name=\"companyName\"\r\n          autoComplete=\"organization\"\r\n        />\r\n      ) : null}\r\n      {fields.address?.enabled ? (\r\n        <React.Fragment>\r\n          <TextField\r\n            value={values.address}\r\n            onChange={handleChange}\r\n            label={t('personal_details.address')}\r\n            placeholder={t('personal_details.address')}\r\n            error={!!errors.address}\r\n            helperText={errors.address}\r\n            required={fields.address.required}\r\n            name=\"address\"\r\n            autoComplete=\"address-line1\"\r\n          />\r\n          <TextField\r\n            value={values.address2}\r\n            onChange={handleChange}\r\n            label={t('personal_details.address2')}\r\n            placeholder={t('personal_details.address2')}\r\n            error={!!errors.address2}\r\n            helperText={errors.address2}\r\n            name=\"address2\"\r\n            autoComplete=\"address-line2\"\r\n          />\r\n          <TextField\r\n            value={values.city}\r\n            onChange={handleChange}\r\n            label={t('personal_details.city')}\r\n            placeholder={t('personal_details.city')}\r\n            error={!!errors.city}\r\n            helperText={errors.city}\r\n            required={fields.address.required}\r\n            name=\"city\"\r\n            autoComplete=\"address-level2\"\r\n          />\r\n          <TextField\r\n            value={values.state}\r\n            onChange={handleChange}\r\n            label={t('personal_details.state')}\r\n            placeholder={t('personal_details.state')}\r\n            error={!!errors.state}\r\n            helperText={errors.state}\r\n            required={fields.address.required}\r\n            name=\"state\"\r\n            autoComplete=\"address-level1\"\r\n          />\r\n          <TextField\r\n            value={values.postCode}\r\n            onChange={handleChange}\r\n            label={t('personal_details.post_code')}\r\n            placeholder={t('personal_details.post_code')}\r\n            error={!!errors.postCode}\r\n            helperText={errors.postCode}\r\n            required={fields.address.required}\r\n            name=\"postCode\"\r\n            autoComplete=\"postal-code\"\r\n          />\r\n        </React.Fragment>\r\n      ) : null}\r\n      {fields.phoneNumber?.enabled ? (\r\n        <TextField\r\n          value={values.phoneNumber}\r\n          onChange={handleChange}\r\n          label={t('personal_details.phone_number')}\r\n          placeholder={t('personal_details.phone_number')}\r\n          error={!!errors.phoneNumber}\r\n          helperText={errors.phoneNumber}\r\n          required={fields.phoneNumber.required}\r\n          name=\"phoneNumber\"\r\n        />\r\n      ) : null}\r\n      {fields.birthDate?.enabled ? (\r\n        <DateField\r\n          value={values.birthDate}\r\n          onChange={(event) => setValue('birthDate', event.currentTarget.value)}\r\n          label={t('personal_details.birth_date')}\r\n          error={!!errors.birthDate}\r\n          helperText={errors.birthDate}\r\n          required={fields.birthDate.required}\r\n          name=\"birthDate\"\r\n        />\r\n      ) : null}\r\n      {questions.map((question) => renderQuestion(question))}\r\n      <Button\r\n        className={styles.continue}\r\n        type=\"submit\"\r\n        label={t('personal_details.continue')}\r\n        variant=\"contained\"\r\n        color=\"primary\"\r\n        size=\"large\"\r\n        disabled={submitting}\r\n        fullWidth\r\n      />\r\n      {submitting && <LoadingOverlay transparentBackground inline />}\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default PersonalDetailsForm;\r\n","import React, { useCallback, useEffect, useMemo, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useLocation, useNavigate } from 'react-router';\r\nimport { mixed, object, string } from 'yup';\r\nimport { useQuery } from 'react-query';\r\nimport type { CaptureCustomAnswer, CleengCaptureQuestionField, PersonalDetailsFormData } from '@jwp/ott-common/types/account';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport { modalURLFromLocation } from '@jwp/ott-ui-react/src/utils/location';\r\nimport { ACCESS_MODEL } from '@jwp/ott-common/src/constants';\r\nimport { type UseFormOnSubmitHandler } from '@jwp/ott-hooks-react/src/useForm';\r\nimport useOffers from '@jwp/ott-hooks-react/src/useOffers';\r\n\r\nimport PersonalDetailsForm from '../../../components/PersonalDetailsForm/PersonalDetailsForm';\r\nimport LoadingOverlay from '../../../components/LoadingOverlay/LoadingOverlay';\r\n\r\nconst yupConditional = (required: boolean, message: string) => {\r\n  return required ? string().required(message) : mixed().notRequired();\r\n};\r\n\r\nconst PersonalDetails = () => {\r\n  const accountController = getModule(AccountController);\r\n\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const { t } = useTranslation('account');\r\n  const accessModel = useConfigStore((s) => s.accessModel);\r\n  const { data, isLoading } = useQuery('captureStatus', accountController.getCaptureStatus);\r\n  const { mediaOffers } = useOffers();\r\n  const hasMediaOffers = mediaOffers.length > 0;\r\n  const [questionValues, setQuestionValues] = useState<Record<string, string>>({});\r\n  const [questionErrors, setQuestionErrors] = useState<Record<string, string>>({});\r\n\r\n  const fields = useMemo(() => Object.fromEntries(data?.settings.map((item) => [item.key, item]) || []), [data]);\r\n\r\n  const questions = useMemo(\r\n    () => (data?.settings.filter((item) => !!(item as CleengCaptureQuestionField).question) as CleengCaptureQuestionField[]) || [],\r\n    [data],\r\n  );\r\n\r\n  const nextStep = useCallback(() => {\r\n    const hasOffers = accessModel === ACCESS_MODEL.SVOD || (accessModel === ACCESS_MODEL.AUTHVOD && hasMediaOffers);\r\n\r\n    navigate(modalURLFromLocation(location, hasOffers ? 'choose-offer' : 'welcome'), { replace: true });\r\n  }, [navigate, location, accessModel, hasMediaOffers]);\r\n\r\n  useEffect(() => {\r\n    if (!data) return;\r\n\r\n    if (!data.isCaptureEnabled || !data.shouldCaptureBeDisplayed) {\r\n      nextStep();\r\n    }\r\n\r\n    if (questions) {\r\n      setQuestionValues(Object.fromEntries(questions.map((question) => [question.key, ''])));\r\n    }\r\n  }, [data, nextStep, questions]);\r\n\r\n  const initialValues: PersonalDetailsFormData = useMemo(() => {\r\n    const [firstName, lastName] = (() => {\r\n      if (fields.firstNameLastName?.enabled) {\r\n        const firstNameLastName = fields.firstNameLastName?.answer as Record<string, string | null>;\r\n        return [firstNameLastName?.firstName || '', firstNameLastName?.lastName || ''];\r\n      }\r\n\r\n      return ['', ''];\r\n    })();\r\n\r\n    return {\r\n      firstName,\r\n      lastName,\r\n      birthDate: '',\r\n      companyName: '',\r\n      phoneNumber: '',\r\n      address: '',\r\n      address2: '',\r\n      city: '',\r\n      state: '',\r\n      postCode: '',\r\n      country: '',\r\n    };\r\n  }, [fields]);\r\n\r\n  const questionChangeHandler = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const value = event.target.type === 'checkbox' && !event.target.checked ? '' : event.target.value;\r\n\r\n    setQuestionValues((current) => ({ ...current, [event.target.name]: value }));\r\n  };\r\n\r\n  const submitHandler: UseFormOnSubmitHandler<PersonalDetailsFormData> = async (formData, { setErrors, setSubmitting, setValidationSchemaError, validate }) => {\r\n    const requiredMessage = t('personal_details.this_field_is_required');\r\n    const schema = object().shape({\r\n      firstName: yupConditional(!!fields.firstNameLastName?.required, requiredMessage),\r\n      lastName: yupConditional(!!fields.firstNameLastName?.required, requiredMessage),\r\n      address1: yupConditional(!!fields.address?.required, requiredMessage),\r\n      address2: yupConditional(!!fields.address?.required, requiredMessage),\r\n      postCode: yupConditional(!!fields.address?.required, requiredMessage),\r\n      state: yupConditional(!!fields.address?.required, requiredMessage),\r\n      city: yupConditional(!!fields.address?.required, requiredMessage),\r\n      companyName: yupConditional(!!fields.companyName?.required, requiredMessage),\r\n      birthDate: fields.birthDate?.required\r\n        ? string()\r\n            .required(requiredMessage)\r\n            .matches(/\\d{4}-\\d{2}-\\d{2}/, t('personal_details.birth_date_not_valid'))\r\n        : mixed().notRequired(),\r\n      phoneNumber: yupConditional(!!fields.phoneNumber?.required, requiredMessage),\r\n    });\r\n\r\n    const errors: Record<string, string> = {};\r\n\r\n    questions.forEach((question) => {\r\n      if (question.enabled && question.required && !questionValues[question.key]) {\r\n        errors[question.key] = t('personal_details.this_field_is_required');\r\n      }\r\n    });\r\n\r\n    setQuestionErrors(errors);\r\n\r\n    // we have validation errors\r\n    if (!validate(schema) || Object.keys(errors).length) {\r\n      setSubmitting(false);\r\n      setValidationSchemaError(true);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const removeEmpty = (obj: Record<string, unknown>) =>\r\n        Object.fromEntries(\r\n          Object.keys(obj)\r\n            .filter((key) => obj[key] !== '')\r\n            .map((key) => [key, obj[key]]),\r\n        );\r\n      const customAnswers = questions.map(\r\n        (question) =>\r\n          ({\r\n            question: question.question,\r\n            questionId: question.key,\r\n            value: questionValues[question.key],\r\n          } as CaptureCustomAnswer),\r\n      );\r\n\r\n      await accountController.updateCaptureAnswers(removeEmpty({ ...formData, customAnswers }));\r\n\r\n      nextStep();\r\n    } catch (error: unknown) {\r\n      if (error instanceof Error) {\r\n        setErrors({ form: error.message });\r\n      }\r\n    }\r\n\r\n    setSubmitting(false);\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div style={{ height: 400 }}>\r\n        <LoadingOverlay inline />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <PersonalDetailsForm\r\n      initialValues={initialValues}\r\n      fields={fields}\r\n      questions={questions}\r\n      onQuestionChange={questionChangeHandler}\r\n      questionValues={questionValues}\r\n      questionErrors={questionErrors}\r\n      onSubmit={submitHandler}\r\n    />\r\n  );\r\n};\r\n\r\nexport default PersonalDetails;\r\n","import { useMemo } from 'react';\r\nimport { useQuery } from 'react-query';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\n\r\nexport type SocialLoginURLs = Record<string, string>;\r\n\r\nexport default function useSocialLoginUrls(url: string) {\r\n  const accountController = getModule(AccountController);\r\n\r\n  const { data, error } = useQuery(['socialUrls', url], () => accountController.getSocialLoginUrls(url), {\r\n    enabled: accountController.getFeatures().hasSocialURLs,\r\n    retry: false,\r\n  });\r\n\r\n  const urls = useMemo(() => {\r\n    if (!data) return null;\r\n\r\n    return data.reduce((acc, url) => ({ ...acc, ...url }), {} as SocialLoginURLs);\r\n  }, [data]);\r\n\r\n  if (error || !urls) {\r\n    return null;\r\n  }\r\n\r\n  return urls;\r\n}\r\n","import { type ChangeEventHandler, type FC, type ReactNode, useMemo } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport type { CustomRegisterFieldVariant } from '@jwp/ott-common/types/account';\r\nimport { isTruthyCustomParamValue, testId } from '@jwp/ott-common/src/utils/common';\r\n\r\nimport Checkbox from '../form-fields/Checkbox/Checkbox';\r\nimport TextField from '../form-fields/TextField/TextField';\r\nimport Radio from '../form-fields/Radio/Radio';\r\nimport Dropdown from '../form-fields/Dropdown/Dropdown';\r\nimport DateField from '../form-fields/DateField/DateField';\r\n\r\nexport type CustomRegisterFieldCommonProps = {\r\n  type?: CustomRegisterFieldVariant;\r\n  name: string;\r\n  value: string | boolean;\r\n  onChange: ChangeEventHandler;\r\n} & Partial<{\r\n  label: ReactNode;\r\n  placeholder: string;\r\n  error: boolean;\r\n  helperText: string;\r\n  disabled: boolean;\r\n  required: boolean;\r\n  options: Record<string, string>;\r\n  editing: boolean;\r\n  lang: string;\r\n}>;\r\n\r\nconst CustomRegisterField: FC<CustomRegisterFieldCommonProps> = ({ type, value = '', label, options, editing, lang, ...props }) => {\r\n  const { t, i18n } = useTranslation();\r\n\r\n  const optionsList = useMemo(() => {\r\n    if (type && ['country', 'us_state'].includes(type)) {\r\n      const codes = Object.keys(i18n.getResourceBundle(i18n.language, type));\r\n\r\n      return codes.map((code) => ({\r\n        value: code,\r\n        label: t(`${type}:${code}`),\r\n      }));\r\n    }\r\n\r\n    if (options) {\r\n      return Object.entries(options).map(([value, label]) => ({ value, label }));\r\n    }\r\n\r\n    return [];\r\n  }, [type, options, i18n, t]);\r\n\r\n  switch (type) {\r\n    case 'input':\r\n      return <TextField {...props} value={String(value)} label={label} testId={testId(`crf-${type}`)} />;\r\n    case 'radio':\r\n      return <Radio {...props} label={label} values={optionsList} value={String(value)} data-testid={testId(`crf-${type}`)} lang={lang} />;\r\n    case 'select':\r\n    case 'country':\r\n    case 'us_state':\r\n      return (\r\n        <Dropdown\r\n          {...props}\r\n          options={optionsList}\r\n          value={String(value)}\r\n          label={label}\r\n          defaultLabel={props.placeholder}\r\n          testId={testId(`crf-${type}`)}\r\n          lang={lang}\r\n        />\r\n      );\r\n    case 'datepicker':\r\n      return <DateField {...props} value={String(value)} label={label} testId={testId(`crf-${type}`)} />;\r\n    default:\r\n      return <Checkbox {...props} checkboxLabel={label} checked={isTruthyCustomParamValue(value)} data-testid={testId(`crf-${type}`)} lang={lang} />;\r\n  }\r\n};\r\n\r\nexport default CustomRegisterField;\r\n","import React, { type MouseEventHandler } from 'react';\r\nimport { Link as RouterLink } from 'react-router-dom';\r\nimport classNames from 'classnames';\r\n\r\nimport styles from './Link.module.scss';\r\n\r\ntype Props = {\r\n  className?: string;\r\n  href?: string;\r\n  to?: string;\r\n  target?: string;\r\n  children?: React.ReactNode;\r\n  onClick?: MouseEventHandler<HTMLElement>;\r\n  onBlur?: () => void;\r\n  onFocus?: () => void;\r\n};\r\n\r\nconst Link: React.FC<Props> = ({ to, href, children, className, onClick, target, ...rest }: Props) => {\r\n  const linkClassName = classNames(styles.link, className);\r\n\r\n  if (to) {\r\n    return (\r\n      <RouterLink to={to} className={linkClassName} onClick={onClick} {...rest}>\r\n        {children}\r\n      </RouterLink>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <a\r\n      href={href}\r\n      className={linkClassName}\r\n      onClick={onClick}\r\n      target={target}\r\n      rel={\r\n        // Security thingy for old browsers.\r\n        // See https://mathiasbynens.github.io/rel-noopener/#recommendations\r\n        target === '_blank' ? 'noreferrer' : undefined\r\n      }\r\n      {...rest}\r\n    >\r\n      {children}\r\n    </a>\r\n  );\r\n};\r\n\r\nexport default Link;\r\n","import React, { type ChangeEventHandler, useEffect, useRef } from 'react';\r\nimport { useLocation } from 'react-router';\r\nimport { useTranslation } from 'react-i18next';\r\nimport DOMPurify from 'dompurify';\r\nimport type { FormErrors } from '@jwp/ott-common/types/form';\r\nimport type { CustomFormField, RegistrationFormData } from '@jwp/ott-common/types/account';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\nimport type { SocialLoginURLs } from '@jwp/ott-hooks-react/src/useSocialLoginUrls';\r\nimport env from '@jwp/ott-common/src/env';\r\nimport type { ReCAPTCHA } from 'react-google-recaptcha';\r\n\r\nimport TextField from '../form-fields/TextField/TextField';\r\nimport Button from '../Button/Button';\r\nimport CustomRegisterField from '../CustomRegisterField/CustomRegisterField';\r\nimport FormFeedback from '../FormFeedback/FormFeedback';\r\nimport LoadingOverlay from '../LoadingOverlay/LoadingOverlay';\r\nimport Link from '../Link/Link';\r\nimport { modalURLFromLocation } from '../../utils/location';\r\nimport PasswordField from '../form-fields/PasswordField/PasswordField';\r\nimport RecaptchaField from '../RecaptchaField/RecaptchaField';\r\n\r\nimport styles from './RegistrationForm.module.scss';\r\n\r\ntype Props = {\r\n  onSubmit: React.FormEventHandler<HTMLFormElement>;\r\n  onChange: React.ChangeEventHandler<HTMLInputElement | HTMLTextAreaElement>;\r\n  onBlur: React.FocusEventHandler<HTMLInputElement | HTMLTextAreaElement>;\r\n  onConsentChange: ChangeEventHandler<HTMLInputElement | HTMLTextAreaElement>;\r\n  errors: FormErrors<RegistrationFormData>;\r\n  values: RegistrationFormData;\r\n  loading: boolean;\r\n  consentValues: Record<string, string | boolean>;\r\n  consentErrors: string[];\r\n  submitting: boolean;\r\n  validationError?: boolean;\r\n  publisherConsents: CustomFormField[] | null;\r\n  socialLoginURLs: SocialLoginURLs | null;\r\n  captchaSiteKey?: string;\r\n  recaptchaRef?: React.RefObject<ReCAPTCHA>;\r\n};\r\n\r\nconst RegistrationForm: React.FC<Props> = ({\r\n  onSubmit,\r\n  onChange,\r\n  onBlur,\r\n  values,\r\n  errors,\r\n  submitting,\r\n  validationError,\r\n  loading,\r\n  publisherConsents,\r\n  consentValues,\r\n  onConsentChange,\r\n  consentErrors,\r\n  captchaSiteKey,\r\n  recaptchaRef,\r\n}: Props) => {\r\n  const { t, i18n } = useTranslation('account');\r\n  const location = useLocation();\r\n\r\n  const ref = useRef<HTMLDivElement>(null);\r\n  const htmlLang = i18n.language !== env.APP_DEFAULT_LANGUAGE ? env.APP_DEFAULT_LANGUAGE : undefined;\r\n\r\n  const formatConsentLabel = (label: string): string | JSX.Element => {\r\n    const sanitizedLabel = DOMPurify.sanitize(label);\r\n    const hasHrefOpenTag = /<a(.|\\n)*?>/.test(sanitizedLabel);\r\n    const hasHrefCloseTag = /<\\/a(.|\\n)*?>/.test(sanitizedLabel);\r\n\r\n    if (hasHrefOpenTag && hasHrefCloseTag) {\r\n      return <span dangerouslySetInnerHTML={{ __html: label }} />;\r\n    }\r\n\r\n    return label;\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (errors.form) {\r\n      ref.current?.scrollIntoView({ behavior: 'smooth', block: 'start', inline: 'nearest' });\r\n    }\r\n  }, [errors.form]);\r\n\r\n  return (\r\n    <form onSubmit={onSubmit} data-testid={testId('registration-form')} noValidate>\r\n      <div ref={ref}>\r\n        {errors.form ? (\r\n          <FormFeedback variant=\"error\" visible={!validationError}>\r\n            {errors.form}\r\n          </FormFeedback>\r\n        ) : null}\r\n      </div>\r\n      <h2 className={styles.title}>{t('registration.sign_up')}</h2>\r\n      <TextField\r\n        value={values.email}\r\n        onChange={onChange}\r\n        onBlur={onBlur}\r\n        label={t('registration.email')}\r\n        placeholder={t('registration.email')}\r\n        error={!!errors.email}\r\n        helperText={errors.email}\r\n        name=\"email\"\r\n        type=\"email\"\r\n        autoComplete=\"email\"\r\n        required\r\n      />\r\n      <PasswordField\r\n        value={values.password}\r\n        onChange={onChange}\r\n        onBlur={onBlur}\r\n        label={t('registration.password')}\r\n        placeholder={t('registration.password')}\r\n        error={!!errors.password}\r\n        name=\"password\"\r\n        autoComplete=\"new-password\"\r\n        required\r\n      />\r\n      {publisherConsents && (\r\n        <div className={styles.customFields} data-testid=\"custom-reg-fields\">\r\n          {publisherConsents.map((consent) => {\r\n            const consentError = consentErrors.find((error) => error === consent.name);\r\n\r\n            return (\r\n              <CustomRegisterField\r\n                key={consent.name}\r\n                type={consent.type}\r\n                name={consent.name}\r\n                options={consent.options}\r\n                label={formatConsentLabel(consent.label)}\r\n                placeholder={consent.placeholder}\r\n                value={consentValues[consent.name] || ''}\r\n                required={consent.required}\r\n                error={!!consentError}\r\n                helperText={consentError ? t('registration.field_required') : undefined}\r\n                onChange={onConsentChange}\r\n                lang={htmlLang}\r\n              />\r\n            );\r\n          })}\r\n        </div>\r\n      )}\r\n      {!!captchaSiteKey && <RecaptchaField siteKey={captchaSiteKey} ref={recaptchaRef} />}\r\n      <Button\r\n        className={styles.continue}\r\n        type=\"submit\"\r\n        label={t('registration.continue')}\r\n        variant=\"contained\"\r\n        color=\"primary\"\r\n        size=\"large\"\r\n        disabled={submitting}\r\n        fullWidth\r\n      />\r\n      <p className={styles.bottom}>\r\n        {t('registration.already_account')} <Link to={modalURLFromLocation(location, 'login')}>{t('login.sign_in')}</Link>\r\n      </p>\r\n      {(loading || submitting) && <LoadingOverlay transparentBackground inline />}\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default RegistrationForm;\r\n","import React, { useEffect, useState, type ChangeEventHandler } from 'react';\r\nimport { object, string } from 'yup';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useLocation, useNavigate } from 'react-router';\r\nimport type { RegistrationFormData } from '@jwp/ott-common/types/account';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport { checkConsentsFromValues, extractConsentValues, formatConsentsFromValues } from '@jwp/ott-common/src/utils/collection';\r\nimport useSocialLoginUrls from '@jwp/ott-hooks-react/src/useSocialLoginUrls';\r\nimport useForm from '@jwp/ott-hooks-react/src/useForm';\r\nimport { modalURLFromLocation, modalURLFromWindowLocation } from '@jwp/ott-ui-react/src/utils/location';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\n\r\nimport RegistrationForm from '../../../components/RegistrationForm/RegistrationForm';\r\nimport { useAriaAnnouncer } from '../../AnnouncementProvider/AnnoucementProvider';\r\nimport useRecaptcha from '../../../hooks/useRecaptcha';\r\n\r\nconst Registration = () => {\r\n  const accountController = getModule(AccountController);\r\n\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const { t } = useTranslation('account');\r\n  const announce = useAriaAnnouncer();\r\n  const [consentValues, setConsentValues] = useState<Record<string, string | boolean>>({});\r\n  const [consentErrors, setConsentErrors] = useState<string[]>([]);\r\n\r\n  const { publisherConsents, publisherConsentsLoading, loading } = useAccountStore(({ publisherConsents, publisherConsentsLoading, loading }) => ({\r\n    publisherConsents,\r\n    publisherConsentsLoading,\r\n    loading,\r\n  }));\r\n\r\n  const { recaptchaRef, captchaSiteKey, getCaptchaValue } = useRecaptcha();\r\n\r\n  const handleChangeConsent: ChangeEventHandler<HTMLInputElement | HTMLTextAreaElement> = ({ currentTarget }) => {\r\n    if (!currentTarget) return;\r\n\r\n    const { name, type } = currentTarget;\r\n    const value = type === 'checkbox' ? (currentTarget as HTMLInputElement).checked : currentTarget.value;\r\n\r\n    setConsentValues((current) => ({\r\n      ...current,\r\n      [name]: value,\r\n    }));\r\n\r\n    // Clear the errors for any checkbox that's toggled\r\n    setConsentErrors((errors) => errors.filter((e) => e !== name));\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!publisherConsents) {\r\n      accountController.getPublisherConsents();\r\n\r\n      return;\r\n    }\r\n\r\n    setConsentValues(extractConsentValues(publisherConsents));\r\n  }, [accountController, publisherConsents]);\r\n\r\n  const socialLoginURLs = useSocialLoginUrls(modalURLFromWindowLocation('personal-details'));\r\n\r\n  const { handleSubmit, handleChange, handleBlur, values, errors, validationSchemaError, submitting } = useForm<RegistrationFormData>({\r\n    initialValues: { email: '', password: '' },\r\n    validationSchema: object().shape({\r\n      email: string()\r\n        .email(t('registration.field_is_not_valid_email'))\r\n        .required(t('registration.field_required', { field: t('registration.email') })),\r\n      password: string()\r\n        .matches(/^(?=.*[a-z])(?=.*[0-9]).{8,}$/, t('registration.invalid_password', { field: t('registration.password') }))\r\n        .required(t('registration.field_required', { field: t('registration.password') })),\r\n      captchaValue: string().notRequired(),\r\n    }),\r\n    validateOnBlur: true,\r\n    onSubmit: async ({ email, password }) => {\r\n      const { consentsErrors } = checkConsentsFromValues(publisherConsents || [], consentValues);\r\n\r\n      if (consentsErrors.length) {\r\n        setConsentErrors(consentsErrors);\r\n        throw new Error(t('registration.consents_error'));\r\n      }\r\n\r\n      const captchaValue = await getCaptchaValue();\r\n\r\n      await accountController.register(email, password, window.location.href, formatConsentsFromValues(publisherConsents, consentValues), captchaValue);\r\n    },\r\n    onSubmitSuccess: () => {\r\n      announce(t('registration.success'), 'success');\r\n      navigate(modalURLFromLocation(location, 'personal-details'));\r\n    },\r\n  });\r\n\r\n  return (\r\n    <RegistrationForm\r\n      onSubmit={handleSubmit}\r\n      onChange={handleChange}\r\n      onConsentChange={handleChangeConsent}\r\n      onBlur={handleBlur}\r\n      values={values}\r\n      errors={errors}\r\n      consentErrors={consentErrors}\r\n      validationError={validationSchemaError}\r\n      submitting={submitting}\r\n      consentValues={consentValues}\r\n      publisherConsents={publisherConsents}\r\n      loading={loading || publisherConsentsLoading}\r\n      socialLoginURLs={socialLoginURLs}\r\n      captchaSiteKey={captchaSiteKey}\r\n      recaptchaRef={recaptchaRef}\r\n    />\r\n  );\r\n};\r\n\r\nexport default Registration;\r\n","import React from 'react';\r\nimport { useLocation } from 'react-router';\r\nimport { useTranslation } from 'react-i18next';\r\nimport type { FormErrors } from '@jwp/ott-common/types/form';\r\nimport type { LoginFormData } from '@jwp/ott-common/types/account';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\nimport useToggle from '@jwp/ott-hooks-react/src/useToggle';\r\nimport type { SocialLoginURLs } from '@jwp/ott-hooks-react/src/useSocialLoginUrls';\r\nimport Visibility from '@jwp/ott-theme/assets/icons/visibility.svg?react';\r\nimport VisibilityOff from '@jwp/ott-theme/assets/icons/visibility_off.svg?react';\r\n\r\nimport TextField from '../form-fields/TextField/TextField';\r\nimport Button from '../Button/Button';\r\nimport Link from '../Link/Link';\r\nimport IconButton from '../IconButton/IconButton';\r\nimport FormFeedback from '../FormFeedback/FormFeedback';\r\nimport LoadingOverlay from '../LoadingOverlay/LoadingOverlay';\r\nimport Icon from '../Icon/Icon';\r\nimport { modalURLFromLocation } from '../../utils/location';\r\n\r\nimport styles from './LoginForm.module.scss';\r\n\r\ntype Props = {\r\n  onSubmit: React.FormEventHandler<HTMLFormElement>;\r\n  onChange: React.ChangeEventHandler<HTMLInputElement | HTMLTextAreaElement>;\r\n  error?: string;\r\n  errors: FormErrors<LoginFormData>;\r\n  values: LoginFormData;\r\n  validationError?: boolean;\r\n  submitting: boolean;\r\n  socialLoginURLs: SocialLoginURLs | null;\r\n  siteName?: string;\r\n};\r\n\r\nconst LoginForm: React.FC<Props> = ({ onSubmit, onChange, values, errors, validationError, submitting, siteName }: Props) => {\r\n  const [viewPassword, toggleViewPassword] = useToggle();\r\n  const { t } = useTranslation('account');\r\n  const location = useLocation();\r\n\r\n  return (\r\n    <form onSubmit={onSubmit} data-testid={testId('login-form')} noValidate>\r\n      {errors.form ? (\r\n        <FormFeedback variant=\"error\" visible={!validationError}>\r\n          {errors.form}\r\n        </FormFeedback>\r\n      ) : null}\r\n      <h2 className={styles.title}>{t('login.sign_in')}</h2>\r\n      <TextField\r\n        value={values.email}\r\n        onChange={onChange}\r\n        label={t('login.email')}\r\n        placeholder={t('login.email')}\r\n        error={!!errors.email}\r\n        helperText={errors.email}\r\n        name=\"email\"\r\n        type=\"email\"\r\n        required\r\n        testId=\"login-email-input\"\r\n        autoComplete=\"email\"\r\n      />\r\n      <TextField\r\n        value={values.password}\r\n        onChange={onChange}\r\n        label={t('login.password')}\r\n        placeholder={t('login.password')}\r\n        error={!!errors.password}\r\n        helperText={errors.password}\r\n        name=\"password\"\r\n        type={viewPassword ? 'text' : 'password'}\r\n        rightControl={\r\n          <IconButton aria-label={t('login.view_password')} onClick={() => toggleViewPassword()} aria-pressed={viewPassword}>\r\n            <Icon icon={viewPassword ? Visibility : VisibilityOff} />\r\n          </IconButton>\r\n        }\r\n        required\r\n        testId=\"login-password-input\"\r\n        autoComplete=\"current-password\"\r\n      />\r\n      {submitting && <LoadingOverlay transparentBackground inline />}\r\n      <Link className={styles.link} to={modalURLFromLocation(location, 'forgot-password')}>\r\n        {t('login.forgot_password')}\r\n      </Link>\r\n      <Button type=\"submit\" label={t('login.sign_in')} variant=\"contained\" color=\"primary\" size=\"large\" disabled={submitting} fullWidth />\r\n      <p className={styles.bottom}>\r\n        {t('login.not_registered', { siteName })} <Link to={modalURLFromLocation(location, 'create-account')}>{t('login.sign_up')}</Link>\r\n      </p>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default LoginForm;\r\n","import React from 'react';\r\nimport { object, string } from 'yup';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useLocation, useNavigate } from 'react-router';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport useForm from '@jwp/ott-hooks-react/src/useForm';\r\nimport { modalURLFromLocation } from '@jwp/ott-ui-react/src/utils/location';\r\nimport useSocialLoginUrls from '@jwp/ott-hooks-react/src/useSocialLoginUrls';\r\nimport type { LoginFormData } from '@jwp/ott-common/types/account';\r\n\r\nimport LoginForm from '../../../components/LoginForm/LoginForm';\r\nimport { useAriaAnnouncer } from '../../AnnouncementProvider/AnnoucementProvider';\r\n\r\nconst Login = () => {\r\n  const accountController = getModule(AccountController);\r\n\r\n  const { siteName } = useConfigStore((s) => s.config);\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const { t } = useTranslation('account');\r\n  const announce = useAriaAnnouncer();\r\n\r\n  const socialLoginURLs = useSocialLoginUrls(window.location.href.split('?')[0]);\r\n\r\n  const { values, errors, submitting, validationSchemaError, handleSubmit, handleChange } = useForm<LoginFormData>({\r\n    initialValues: { email: '', password: '' },\r\n    validationSchema: object().shape({\r\n      email: string()\r\n        .email(t('login.field_is_not_valid_email'))\r\n        .required(t('login.field_required', { field: t('login.email') })),\r\n      password: string().required(t('login.field_required', { field: t('login.password') })),\r\n    }),\r\n    onSubmit: ({ email, password }) => accountController.login(email, password, window.location.href),\r\n    onSubmitSuccess: () => {\r\n      announce(t('login.sign_in_success'), 'success');\r\n      navigate(modalURLFromLocation(location, null));\r\n    },\r\n    onSubmitError: ({ resetValue }) => resetValue('password'),\r\n  });\r\n\r\n  return (\r\n    <LoginForm\r\n      values={values}\r\n      validationError={validationSchemaError}\r\n      errors={errors}\r\n      submitting={submitting}\r\n      siteName={siteName}\r\n      socialLoginURLs={socialLoginURLs}\r\n      onSubmit={handleSubmit}\r\n      onChange={handleChange}\r\n    />\r\n  );\r\n};\r\n\r\nexport default Login;\r\n","import React, { useEffect, useMemo, useRef } from 'react';\r\nimport { useLocation, useNavigate } from 'react-router';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport { modalURLFromLocation, createURLFromLocation } from '@jwp/ott-ui-react/src/utils/location';\r\nimport useEventCallback from '@jwp/ott-hooks-react/src/useEventCallback';\r\nimport useQueryParam from '@jwp/ott-ui-react/src/hooks/useQueryParam';\r\n\r\nimport LoadingOverlay from '../../components/LoadingOverlay/LoadingOverlay';\r\nimport Welcome from '../../components/Welcome/Welcome';\r\nimport PaymentFailed from '../../components/PaymentFailed/PaymentFailed';\r\nimport Dialog from '../../components/Dialog/Dialog';\r\nimport DeleteAccountModal from '../../components/DeleteAccountModal/DeleteAccountModal';\r\nimport FinalizePayment from '../../components/FinalizePayment/FinalizePayment';\r\nimport WaitingForPayment from '../../components/WaitingForPayment/WaitingForPayment';\r\nimport UpgradeSubscription from '../../components/UpgradeSubscription/UpgradeSubscription';\r\nimport DeleteAccountPasswordWarning from '../../components/DeleteAccountPasswordWarning/DeleteAccountPasswordWarning';\r\nimport UpdatePaymentMethod from '../UpdatePaymentMethod/UpdatePaymentMethod';\r\n\r\nimport EditCardDetails from './forms/EditCardDetails';\r\nimport EditPassword from './forms/EditPassword';\r\nimport RenewSubscription from './forms/RenewSubscription';\r\nimport CancelSubscription from './forms/CancelSubscription';\r\nimport ResetPassword from './forms/ResetPassword';\r\nimport Checkout from './forms/Checkout';\r\nimport ChooseOffer from './forms/ChooseOffer';\r\nimport PersonalDetails from './forms/PersonalDetails';\r\nimport Registration from './forms/Registration';\r\nimport Login from './forms/Login';\r\nimport styles from './AccountModal.module.scss';\r\n\r\n// @todo: connect with route typings\r\nconst PUBLIC_VIEWS = ['login', 'create-account', 'forgot-password', 'reset-password', 'send-confirmation', 'edit-password'];\r\n\r\nexport type AccountModals = {\r\n  login: 'login';\r\n  'create-account': 'create-account';\r\n  'personal-details': 'personal-details';\r\n  'choose-offer': 'choose-offer';\r\n  'edit-card': 'edit-card';\r\n  'upgrade-subscription': 'upgrade-subscription';\r\n  'upgrade-subscription-error': 'upgrade-subscription-error';\r\n  'upgrade-subscription-success': 'upgrade-subscription-success';\r\n  'upgrade-subscription-pending': 'upgrade-subscription-pending';\r\n  checkout: 'checkout';\r\n  'payment-error': 'payment-error';\r\n  'payment-cancelled': 'payment-cancelled';\r\n  welcome: 'welcome';\r\n  'reset-password': 'reset-password';\r\n  'forgot-password': 'forgot-password';\r\n  'add-password': 'add-password';\r\n  'delete-account': 'delete-account';\r\n  'delete-account-confirmation': 'delete-account-confirmation';\r\n  'warning-account-deletion': 'warning-account-deletion';\r\n  'send-confirmation': 'send-confirmation';\r\n  'edit-password': 'edit-password';\r\n  unsubscribe: 'unsubscribe';\r\n  'renew-subscription': 'renew-subscription';\r\n  'payment-method': 'payment-method';\r\n  'payment-method-success': 'payment-method-success';\r\n  'waiting-for-payment': 'waiting-for-payment';\r\n  'finalize-payment': 'finalize-payment';\r\n};\r\n\r\nconst AccountModal = () => {\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const viewParam = useQueryParam('u');\r\n  const viewParamRef = useRef(viewParam);\r\n  const message = useQueryParam('message');\r\n  const { loading, user } = useAccountStore(({ loading, user }) => ({ loading, user }), shallow);\r\n  const config = useConfigStore((s) => s.config);\r\n  const {\r\n    assets: { banner },\r\n    siteName,\r\n  } = config;\r\n  const isPublicView = viewParam && PUBLIC_VIEWS.includes(viewParam);\r\n\r\n  const toLogin = useEventCallback(() => {\r\n    navigate(modalURLFromLocation(location, 'login'));\r\n  });\r\n\r\n  // make sure the last view is rendered even when the modal gets closed\r\n  const view = useMemo(() => {\r\n    if (viewParam) viewParamRef.current = viewParam;\r\n    return viewParamRef.current;\r\n  }, [viewParam]);\r\n\r\n  useEffect(() => {\r\n    if (!!viewParam && !loading && !user && !isPublicView) {\r\n      toLogin();\r\n    }\r\n  }, [viewParam, loading, isPublicView, user, toLogin]);\r\n\r\n  const closeHandler = useEventCallback(() => {\r\n    navigate(createURLFromLocation(location, { u: null, message: null }));\r\n  });\r\n\r\n  const renderForm = () => {\r\n    if (!user && loading && !isPublicView) {\r\n      return (\r\n        <div style={{ height: 300 }}>\r\n          <LoadingOverlay inline />\r\n        </div>\r\n      );\r\n    }\r\n\r\n    switch (view) {\r\n      case 'login':\r\n        return <Login />;\r\n      case 'create-account':\r\n        return <Registration />;\r\n      case 'personal-details':\r\n        return <PersonalDetails />;\r\n      case 'choose-offer':\r\n        return <ChooseOffer />;\r\n      case 'edit-card':\r\n        return <EditCardDetails />;\r\n      case 'upgrade-subscription':\r\n        return <ChooseOffer />;\r\n      case 'upgrade-subscription-error':\r\n        return <UpgradeSubscription type=\"error\" onCloseButtonClick={closeHandler} />;\r\n      case 'upgrade-subscription-success':\r\n        return <UpgradeSubscription type=\"success\" onCloseButtonClick={closeHandler} />;\r\n      case 'upgrade-subscription-pending':\r\n        return <UpgradeSubscription type=\"pending\" onCloseButtonClick={closeHandler} />;\r\n      case 'checkout':\r\n        return <Checkout />;\r\n      case 'payment-error':\r\n        return <PaymentFailed type=\"error\" message={message} onCloseButtonClick={closeHandler} />;\r\n      case 'payment-cancelled':\r\n        return <PaymentFailed type=\"cancelled\" message={message} onCloseButtonClick={closeHandler} />;\r\n      case 'welcome':\r\n        return <Welcome onCloseButtonClick={closeHandler} onCountdownCompleted={closeHandler} siteName={siteName} />;\r\n      case 'reset-password':\r\n        return <ResetPassword type=\"reset\" />;\r\n      case 'forgot-password':\r\n        return <ResetPassword type=\"forgot\" />;\r\n      case 'add-password':\r\n        return <EditPassword type=\"add\" />;\r\n      case 'delete-account':\r\n      case 'delete-account-confirmation':\r\n        return <DeleteAccountModal />;\r\n      case 'warning-account-deletion':\r\n        return <DeleteAccountPasswordWarning />;\r\n      case 'send-confirmation':\r\n        return <ResetPassword type=\"confirmation\" />;\r\n      case 'edit-password':\r\n        return <EditPassword />;\r\n      case 'unsubscribe':\r\n        return <CancelSubscription />;\r\n      case 'renew-subscription':\r\n        return <RenewSubscription />;\r\n      case 'payment-method':\r\n      case 'payment-method-success':\r\n        return <UpdatePaymentMethod onCloseButtonClick={closeHandler} />;\r\n      case 'waiting-for-payment':\r\n        return <WaitingForPayment />;\r\n      case 'finalize-payment':\r\n        return <FinalizePayment />;\r\n    }\r\n  };\r\n\r\n  const shouldShowBanner = !['delete-account', 'delete-account-confirmation', 'edit-card', 'warning-account-deletion'].includes(view ?? '');\r\n  const dialogSize = ['delete-account-confirmation'].includes(view ?? '') ? 'large' : 'small';\r\n\r\n  return (\r\n    <Dialog size={dialogSize} open={!!viewParam} onClose={closeHandler}>\r\n      {shouldShowBanner && banner && (\r\n        <div className={styles.banner}>\r\n          <img src={banner} alt=\"\" />\r\n        </div>\r\n      )}\r\n      {renderForm()}\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default AccountModal;\r\n","export interface TestConfig {\r\n  id: string;\r\n  label: string;\r\n}\r\n\r\nexport const testConfigs = {\r\n  jwpAuth: {\r\n    id: '9qqwmnbx',\r\n    label: 'JWP AUTHVOD',\r\n  },\r\n  jwpSvod: {\r\n    id: 'a2kbjdv0',\r\n    label: 'JWP SVOD',\r\n  },\r\n  jwpAuthNoWatchlist: {\r\n    id: 'oqrsyxin',\r\n    label: 'JWP Authvod (No WL)',\r\n  },\r\n  basicNoAuth: {\r\n    id: 'gnnuzabk',\r\n    label: 'Demo App (No Auth)',\r\n  },\r\n  noStyling: {\r\n    id: 'kujzeu1b',\r\n    label: 'No Styling (No Auth)',\r\n  },\r\n  inlinePlayer: {\r\n    id: 'ata6ucb8',\r\n    label: 'Inline Player',\r\n  },\r\n  cleengAuthvod: {\r\n    id: 'nvqkufhy',\r\n    label: 'Cleeng Authvod',\r\n  },\r\n  cleengAuthvodNoWatchlist: {\r\n    id: '7weyqrua',\r\n    label: 'Cleeng Authvod (No WL)',\r\n  },\r\n  svod: {\r\n    id: 'ozylzc5m',\r\n    label: 'Cleeng SVOD',\r\n  },\r\n};\r\n\r\nexport const jwDevEnvConfigs = {\r\n  basicNoAuth: {\r\n    id: 'uzcyv8xh',\r\n    label: 'JW-Dev Basic Demo',\r\n  } as TestConfig,\r\n};\r\n","import { type ChangeEvent, useCallback } from 'react';\r\nimport { createURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport { CONFIG_QUERY_KEY } from '@jwp/ott-common/src/constants';\r\nimport { jwDevEnvConfigs, testConfigs } from '@jwp/ott-testing/constants';\r\n\r\nimport Select from '../Select/Select';\r\n\r\nimport styles from './DevConfigSelector.module.scss';\r\n\r\ninterface Props {\r\n  selectedConfig: string | undefined;\r\n}\r\n\r\nconst configs = __mode__ === 'jwdev' ? jwDevEnvConfigs : testConfigs;\r\nconst configOptions: { value: string; label: string }[] = [\r\n  { label: 'Select an App Config', value: '' },\r\n  ...Object.values(configs).map(({ id, label }) => ({ value: id, label: `${id.length > 8 ? 'ext-json' : id} - ${label}` })),\r\n];\r\n\r\nconst DevConfigSelector = ({ selectedConfig }: Props) => {\r\n  const onChange = useCallback((event: ChangeEvent<HTMLSelectElement>) => {\r\n    window.location.href = createURL(window.location.href, { [CONFIG_QUERY_KEY]: event.target.value });\r\n  }, []);\r\n\r\n  return (\r\n    <Select\r\n      className={styles.dropdown}\r\n      size=\"small\"\r\n      options={configOptions}\r\n      name=\"config-select\"\r\n      value={selectedConfig || ''}\r\n      onChange={onChange}\r\n      required={true}\r\n      aria-hidden={true}\r\n    />\r\n  );\r\n};\r\n\r\nexport default DevConfigSelector;\r\n","import { useQuery, useQueryClient } from 'react-query';\r\nimport type { Config } from '@jwp/ott-common/types/config';\r\nimport type { Settings } from '@jwp/ott-common/types/settings';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport AppController from '@jwp/ott-common/src/controllers/AppController';\r\nimport type { AppError } from '@jwp/ott-common/src/utils/error';\r\nimport { CACHE_TIME, STALE_TIME } from '@jwp/ott-common/src/constants';\r\nimport { logDebug } from '@jwp/ott-common/src/logger';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nconst applicationController = getModule(AppController);\r\n\r\ntype Resources = {\r\n  config: Config;\r\n  configSource: string | undefined;\r\n  settings: Settings;\r\n};\r\n\r\nexport type OnReadyCallback = (config: Config | undefined) => void;\r\n\r\nexport const useBootstrapApp = (url: string, onReady: OnReadyCallback) => {\r\n  const queryClient = useQueryClient();\r\n  const { i18n } = useTranslation();\r\n\r\n  const refreshEntitlements = () => queryClient.invalidateQueries({ queryKey: ['entitlements'] });\r\n\r\n  const { data, isLoading, error, isSuccess, refetch } = useQuery<Resources, Error | AppError>(\r\n    'config-init',\r\n    () => applicationController.initializeApp(url, i18n.language, refreshEntitlements),\r\n    {\r\n      refetchInterval: false,\r\n      retry: 1,\r\n      onSettled: (query) => {\r\n        logDebug('Bootstrap', 'Initialized application', { ...query });\r\n        onReady(query?.config);\r\n      },\r\n      cacheTime: CACHE_TIME,\r\n      staleTime: STALE_TIME,\r\n    },\r\n  );\r\n\r\n  return {\r\n    data,\r\n    isLoading,\r\n    error,\r\n    isSuccess,\r\n    refetch,\r\n  };\r\n};\r\n\r\nexport type BootstrapData = ReturnType<typeof useBootstrapApp>;\r\n","import type { Config } from '@jwp/ott-common/types/config';\r\nimport { calculateContrastColor } from '@jwp/ott-common/src/utils/common';\r\nimport env from '@jwp/ott-common/src/env';\r\n\r\nexport const setThemingVariables = (config: Config) => {\r\n  const root = document.querySelector(':root') as HTMLElement;\r\n  const { highlightColor, backgroundColor, headerBackground } = config.styling || {};\r\n  const bodyFont = env.APP_BODY_FONT;\r\n  const bodyAltFont = env.APP_BODY_ALT_FONT;\r\n\r\n  if (!root) return;\r\n\r\n  root.style.setProperty('--highlight-color', highlightColor || '#fff');\r\n  root.style.setProperty('--highlight-contrast-color', highlightColor ? calculateContrastColor(highlightColor) : '#000');\r\n\r\n  if (headerBackground) {\r\n    root.style.setProperty('--header-background', headerBackground);\r\n    root.style.setProperty('--header-contrast-color', calculateContrastColor(headerBackground));\r\n  }\r\n\r\n  if (backgroundColor) {\r\n    const bodyColor = calculateContrastColor(backgroundColor);\r\n    root.style.setProperty('--body-background-color', backgroundColor);\r\n    root.style.setProperty('--body-color', bodyColor);\r\n\r\n    if (bodyColor === '#000000') {\r\n      // disable text shadows when using a light background\r\n      root.style.setProperty('--body-text-shadow', 'none');\r\n      // hero shelf should always be dark, so on a light background we fall back to gray\r\n      root.style.setProperty('--hero-shelf-background-color', '#1f1f1f');\r\n      // currently, the EPG only supports a dark background\r\n      root.style.setProperty('--epg-background-color', '#262626');\r\n    }\r\n  }\r\n\r\n  if (bodyFont) {\r\n    root.style.setProperty('--body-font-family', bodyFont);\r\n  }\r\n\r\n  if (bodyAltFont) {\r\n    root.style.setProperty('--body-alt-font-family', bodyAltFont);\r\n  }\r\n};\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport Dialog from '../Dialog/Dialog';\r\nimport Button from '../Button/Button';\r\n\r\nimport styles from './ConfirmationDialog.module.scss';\r\n\r\ntype Props = {\r\n  open: boolean;\r\n  title: string;\r\n  body: string;\r\n  onConfirm: () => void;\r\n  onClose: () => void;\r\n  busy?: boolean;\r\n};\r\n\r\nconst ConfirmationDialog: React.FC<Props> = ({ open, title, body, onConfirm, onClose, busy }: Props) => {\r\n  const { t } = useTranslation('common');\r\n\r\n  return (\r\n    <Dialog open={open} onClose={onClose} role=\"alertdialog\">\r\n      <h2 className={styles.title}>{title}</h2>\r\n      <p className={styles.body}>{body}</p>\r\n      <Button\r\n        className={styles.confirmButton}\r\n        label={t('confirmation_dialog.confirm')}\r\n        variant={'contained'}\r\n        color={busy ? 'default' : 'primary'}\r\n        onClick={onConfirm}\r\n        fullWidth\r\n        disabled={busy}\r\n        busy={busy}\r\n      />\r\n      <Button label={t('confirmation_dialog.close')} variant=\"outlined\" onClick={onClose} fullWidth disabled={busy} />\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default ConfirmationDialog;\r\n","import React from 'react';\r\nimport { useRouteError } from 'react-router';\r\n\r\nimport ErrorPage from '../../components/ErrorPage/ErrorPage';\r\n\r\nconst RootErrorPage: React.FC = () => {\r\n  const error = useRouteError() as Error;\r\n\r\n  return <ErrorPage error={error} />;\r\n};\r\n\r\nexport default RootErrorPage;\r\n","import React, { useMemo } from 'react';\r\nimport DOMPurify from 'dompurify';\r\nimport { marked } from 'marked';\r\nimport classNames from 'classnames';\r\n\r\nimport styles from './MarkdownComponent.module.scss';\r\n\r\nconst renderer = new marked.Renderer();\r\nrenderer.link = (href: string, title: string, text: string) => {\r\n  const externalLink = /^(https?|www\\.|\\/\\/)/.test(href || '');\r\n  const targetAttr = externalLink ? 'target=\"_blank\"' : undefined;\r\n  const relAttr = externalLink ? 'rel=\"noopener\"' : undefined;\r\n  const titleAttr = title ? `title=\"${title}\"` : undefined;\r\n  const attributes = [targetAttr, relAttr, titleAttr].filter(Boolean);\r\n\r\n  return `<a href=\"${href}\" ${attributes.join(' ')}>${text}</a>`;\r\n};\r\n\r\n// remove images and GitHub flavoured markdown when rendering inline\r\nconst inlineRenderer = new marked.Renderer({ gfm: false });\r\ninlineRenderer.image = () => '';\r\ninlineRenderer.link = renderer.link;\r\n\r\ntype Props = {\r\n  markdownString: string;\r\n  className?: string;\r\n  inline?: boolean;\r\n  tag?: string;\r\n};\r\n\r\nconst MarkdownComponent: React.FC<Props> = ({ markdownString, className, tag = 'div', inline = false }) => {\r\n  const sanitizedHTMLString = useMemo(() => {\r\n    const dirtyHTMLString = inline ? marked.parseInline(markdownString, { renderer: inlineRenderer }) : marked.parse(markdownString, { renderer });\r\n\r\n    return DOMPurify.sanitize(dirtyHTMLString, { ADD_ATTR: ['target'] });\r\n  }, [inline, markdownString]);\r\n\r\n  return React.createElement(tag, {\r\n    dangerouslySetInnerHTML: { __html: sanitizedHTMLString },\r\n    className: classNames(styles.markdown, inline && styles.inline, className),\r\n  });\r\n};\r\n\r\nexport default MarkdownComponent;\r\n","import React from 'react';\r\n\r\nimport MarkdownComponent from '../../components/MarkdownComponent/MarkdownComponent';\r\n\r\nimport styles from './About.module.scss';\r\n\r\nconst About = () => {\r\n  const markdownPage = `# About JW OTT Webapp\r\n  \r\nJW OTT Webapp is an open-source, dynamically generated video website built around JW Player and JW Platform services. It enables you to easily publish your JW Player-hosted video content with no coding and minimal configuration.\r\n\r\nTo see an example of JW OTT Webapp in action, see [https://app-preview.jwplayer.com/](https://app-preview.jwplayer.com/).\r\n\r\n## Supported Features\r\n\r\n- Works with any JW Player edition, from Free to Enterprise (note that usage will count against your monthly JW streaming limits). Only cloud-hosted JW Players are supported.\r\n- It looks great on any device. The responsive UI automatically optimizes itself for desktop, tablet, and mobile screens.\r\n- Populates your site's media content using JSON feeds. If you are using JW Platform, this happens auto-magically based on playlists that you specify. Using feeds from other sources will require you to hack the source code.\r\n- Video titles, descriptions and hero images are populated from JW Platform JSON feed metadata.\r\n- Playback of HLS video content from the JW Platform CDN. You can add external URLs (for example, URLS from your own server or CDN) to your playlists in the Content section of your JW Player account dashboard, but they must be HLS streams (\\`.m3u8\\` files).\r\n- Support for live video streams (must be registered as external .m3u8 URLs in your JW Dashboard).\r\n- Customize the user interface with your own branding. The default app is configured for JW Player branding and content, but you can easily change this to use your own assets by modifying the \\`config.json\\` file. Advanced customization is possible (for example, editing the CSS files), but you will need to modify the source code and build from source.\r\n- Site-wide video search and related video recommendations powered by [JW Recommendations](https://docs.jwplayer.com/platform/docs/vdh-learn-about-recommendations).\r\n- Basic playback analytics is reported to your JW Dashboard.\r\n- Ad integrations (VAST, VPAID, GoogleIMA, etc.). These features require a JW Player Ads Edition license. For more information, see the [JW Player pricing page](https://www.jwplayer.com/pricing/).\r\n- A \"Favorites\" feature for users to save videos for watching later. A separate list for \"Continue Watching\" is also kept so users can resume watching videos from where they left off. The lists are per-browser at this time (i.e., lists do not sync across user's browsers or devices). The \"Continue Watching\" list can be disabled in your JW OTT Webapp's \\`config.json\\` file.\r\n- A grid view for a particular playlist of videos, with the ability to deep-link to the playlist through a static URL.\r\n- Social sharing options using the device native sharing dialog.\r\n\r\n## Unsupported Features\r\n\r\n- Security-related features (encrypted HLS, DRM, signed URLs)\r\n- Self-hosted JW Players`;\r\n\r\n  return <MarkdownComponent className={styles.about} markdownString={markdownPage} />;\r\n};\r\n\r\nexport default About;\r\n","import { QueryClient, useQuery, useQueryClient } from 'react-query';\r\nimport type { GetPlaylistParams, Playlist } from '@jwp/ott-common/types/playlist';\r\nimport ApiService from '@jwp/ott-common/src/services/ApiService';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { generatePlaylistPlaceholder } from '@jwp/ott-common/src/utils/collection';\r\nimport { isScheduledOrLiveMedia } from '@jwp/ott-common/src/utils/liveEvent';\r\nimport { isTruthyCustomParamValue } from '@jwp/ott-common/src/utils/common';\r\nimport type { ApiError } from '@jwp/ott-common/src/utils/api';\r\nimport type { AppMenuType } from '@jwp/ott-common/types/config';\r\nimport { APP_CONFIG_ITEM_TYPE } from '@jwp/ott-common/src/constants';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nconst placeholderData = generatePlaylistPlaceholder(30);\r\n\r\nexport const getPlaylistQueryOptions = ({\r\n  type,\r\n  contentId,\r\n  siteId,\r\n  enabled,\r\n  usePlaceholderData,\r\n  params = {},\r\n  queryClient,\r\n  language,\r\n}: {\r\n  type: AppMenuType;\r\n  contentId: string | undefined;\r\n  siteId: string;\r\n  enabled: boolean;\r\n  queryClient: QueryClient;\r\n  usePlaceholderData?: boolean;\r\n  params?: GetPlaylistParams;\r\n  language: string;\r\n}) => {\r\n  const apiService = getModule(ApiService);\r\n\r\n  return {\r\n    enabled: !!contentId && enabled,\r\n    queryKey: ['playlist', type, contentId, params, language],\r\n    queryFn: async () => {\r\n      if (type === APP_CONFIG_ITEM_TYPE.playlist) {\r\n        const playlist = await apiService.getPlaylistById(contentId, params, language);\r\n\r\n        // This pre-caches all playlist items and makes navigating a lot faster.\r\n        playlist?.playlist?.forEach((playlistItem) => {\r\n          queryClient.setQueryData(['media', playlistItem.mediaid], playlistItem);\r\n        });\r\n\r\n        return playlist;\r\n      } else if (type === APP_CONFIG_ITEM_TYPE.content_list) {\r\n        const contentList = await apiService.getContentList({ siteId, id: contentId, language });\r\n\r\n        return contentList;\r\n      }\r\n    },\r\n    placeholderData: contentId && usePlaceholderData ? placeholderData : undefined,\r\n    refetchInterval: (data: Playlist | undefined) => {\r\n      if (!data) return false;\r\n\r\n      const autoRefetch = isTruthyCustomParamValue(data.refetch) || data.playlist.some(isScheduledOrLiveMedia);\r\n\r\n      return autoRefetch ? 1000 * 30 : false;\r\n    },\r\n    retry: false,\r\n  };\r\n};\r\n\r\nexport default function usePlaylist(\r\n  contentId?: string,\r\n  params: GetPlaylistParams = {},\r\n  enabled: boolean = true,\r\n  usePlaceholderData: boolean = true,\r\n  type: AppMenuType = APP_CONFIG_ITEM_TYPE.playlist,\r\n) {\r\n  // Determine currently selected language\r\n  const { i18n } = useTranslation();\r\n  const language = i18n.language;\r\n\r\n  const queryClient = useQueryClient();\r\n  const siteId = useConfigStore((state) => state.config.siteId);\r\n\r\n  const queryOptions = getPlaylistQueryOptions({ type, contentId, siteId, params, queryClient, enabled, usePlaceholderData, language });\r\n\r\n  return useQuery<Playlist | undefined, ApiError>(queryOptions);\r\n}\r\n","import { PersonalShelf, PersonalShelves, PLAYLIST_LIMIT } from '@jwp/ott-common/src/constants';\r\nimport { useFavoritesStore } from '@jwp/ott-common/src/stores/FavoritesStore';\r\nimport { useWatchHistoryStore } from '@jwp/ott-common/src/stores/WatchHistoryStore';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport type { Content, AppContentType, AppMenuType } from '@jwp/ott-common/types/config';\r\nimport type { Playlist } from '@jwp/ott-common/types/playlist';\r\nimport { useQueries, useQueryClient } from 'react-query';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport { getPlaylistQueryOptions } from './usePlaylist';\r\n\r\ntype UsePlaylistResult = {\r\n  data: Playlist | undefined;\r\n  isSuccess?: boolean;\r\n  error?: unknown;\r\n  isPlaceholderData?: boolean;\r\n}[];\r\n\r\nconst isPlaylistType = (type: AppContentType): type is AppMenuType => !PersonalShelves.some((pType) => pType === type);\r\n\r\nconst usePlaylists = (content: Content[], rowsToLoad: number | undefined = undefined) => {\r\n  const page_limit = PLAYLIST_LIMIT.toString();\r\n  const queryClient = useQueryClient();\r\n\r\n  const siteId = useConfigStore((state) => state.config.siteId);\r\n  const favorites = useFavoritesStore((state) => state.getPlaylist());\r\n  const watchHistory = useWatchHistoryStore((state) => state.getPlaylist());\r\n\r\n  // Determine currently selected language\r\n  const { i18n } = useTranslation();\r\n\r\n  const playlistQueries = useQueries(\r\n    content.map(({ contentId, type }, index) => {\r\n      if (isPlaylistType(type)) {\r\n        return getPlaylistQueryOptions({\r\n          enabled: !rowsToLoad || rowsToLoad > index,\r\n          type,\r\n          siteId,\r\n          contentId,\r\n          queryClient,\r\n          usePlaceholderData: true,\r\n          params: { page_limit },\r\n          language: i18n.language,\r\n        });\r\n      }\r\n\r\n      return { enabled: false };\r\n    }),\r\n  );\r\n\r\n  const result: UsePlaylistResult = content.map(({ type }, index) => {\r\n    if (type === PersonalShelf.Favorites) return { data: favorites, isLoading: false, isSuccess: true };\r\n    if (type === PersonalShelf.ContinueWatching) return { data: watchHistory, isLoading: false, isSuccess: true };\r\n\r\n    const { data, isSuccess, error, isPlaceholderData } = playlistQueries[index];\r\n\r\n    return {\r\n      data,\r\n      isSuccess,\r\n      error,\r\n      isPlaceholderData,\r\n    };\r\n  });\r\n\r\n  return result;\r\n};\r\n\r\nexport default usePlaylists;\r\n","import { useTranslation } from 'react-i18next';\r\n\r\nexport const useTranslationKey = (key: string) => {\r\n  const { i18n } = useTranslation();\r\n\r\n  return `${key}-${i18n.language}`;\r\n};\r\n","import * as React from \"react\";\nconst SvgChevronLeft = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z\" }));\nexport default SvgChevronLeft;\n","import * as React from \"react\";\nconst SvgChevronRight = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z\" }));\nexport default SvgChevronRight;\n","/**\r\n * Add change event listener to given MediaQueryList instance\r\n * @param mediaQuery\r\n * @param callback\r\n */\r\nexport const addMediaQueryListChangeListener = (mediaQuery: MediaQueryList, callback: (event: MediaQueryListEvent) => void): void => {\r\n  if (typeof mediaQuery.addEventListener === 'undefined') {\r\n    mediaQuery.addListener(callback);\r\n  } else {\r\n    mediaQuery.addEventListener('change', callback);\r\n  }\r\n};\r\n\r\n/**\r\n * Remove change event listener from given MediaQueryList instance\r\n * @param mediaQuery\r\n * @param callback\r\n */\r\nexport const removeMediaQueryListChangeListener = (mediaQuery: MediaQueryList, callback: (event: MediaQueryListEvent) => void): void => {\r\n  if (typeof mediaQuery.removeEventListener === 'undefined') {\r\n    mediaQuery.removeListener(callback);\r\n  } else {\r\n    mediaQuery.removeEventListener('change', callback);\r\n  }\r\n};\r\n","import { useEffect, useState } from 'react';\r\n\r\nimport { addMediaQueryListChangeListener, removeMediaQueryListChangeListener } from '../utils/matchMedia';\r\n\r\nconst XS_MATCH_MEDIA: MediaQueryList = matchMedia('screen and (max-width: 479px)'); // mobile\r\nconst SM_MATCH_MEDIA: MediaQueryList = matchMedia('screen and (min-width: 480px) and (max-width: 767px)'); // tablet\r\nconst MD_MATCH_MEDIA: MediaQueryList = matchMedia('screen and (min-width: 768px) and (max-width: 1023px)'); // tablet large\r\nconst LG_MATCH_MEDIA: MediaQueryList = matchMedia('screen and (min-width: 1024px) and (max-width: 1199px)'); // desktop\r\n\r\nexport enum Breakpoint {\r\n  xs,\r\n  sm,\r\n  md,\r\n  lg,\r\n  xl,\r\n}\r\n\r\nexport type Breakpoints = {\r\n  [Breakpoint.xs]: number;\r\n  [Breakpoint.sm]: number;\r\n  [Breakpoint.md]: number;\r\n  [Breakpoint.lg]: number;\r\n  [Breakpoint.xl]: number;\r\n};\r\n\r\nconst getScreenSize = (): Breakpoint => {\r\n  if (XS_MATCH_MEDIA.matches) return Breakpoint.xs;\r\n  if (SM_MATCH_MEDIA.matches) return Breakpoint.sm;\r\n  if (MD_MATCH_MEDIA.matches) return Breakpoint.md;\r\n  if (LG_MATCH_MEDIA.matches) return Breakpoint.lg;\r\n  else return Breakpoint.xl;\r\n};\r\n\r\nconst useBreakpoint = (): Breakpoint => {\r\n  const [breakpoint, setBreakpoint] = useState<Breakpoint>(() => getScreenSize());\r\n\r\n  useEffect(() => {\r\n    const changeEventHandler = (): void => setBreakpoint(getScreenSize());\r\n\r\n    addMediaQueryListChangeListener(XS_MATCH_MEDIA, changeEventHandler);\r\n    addMediaQueryListChangeListener(SM_MATCH_MEDIA, changeEventHandler);\r\n    addMediaQueryListChangeListener(MD_MATCH_MEDIA, changeEventHandler);\r\n    addMediaQueryListChangeListener(LG_MATCH_MEDIA, changeEventHandler);\r\n\r\n    return () => {\r\n      removeMediaQueryListChangeListener(XS_MATCH_MEDIA, changeEventHandler);\r\n      removeMediaQueryListChangeListener(SM_MATCH_MEDIA, changeEventHandler);\r\n      removeMediaQueryListChangeListener(MD_MATCH_MEDIA, changeEventHandler);\r\n      removeMediaQueryListChangeListener(LG_MATCH_MEDIA, changeEventHandler);\r\n    };\r\n  }, []);\r\n\r\n  return breakpoint;\r\n};\r\n\r\nexport default useBreakpoint;\r\n","import * as React from \"react\";\nconst SvgLock = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { fill: \"currentColor\", d: \"M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z\" }));\nexport default SvgLock;\n","import * as React from \"react\";\nconst SvgToday = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M0 0h24v24H0z\", fill: \"none\" }), /* @__PURE__ */ React.createElement(\"path\", { d: \"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z\" }));\nexport default SvgToday;\n","import React, { forwardRef, useEffect, useState } from 'react';\r\nimport { createURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport { logInfo } from '@jwp/ott-common/src/logger';\r\n\r\nimport styles from './Image.module.scss';\r\n\r\ntype Props = {\r\n  className?: string;\r\n  image?: string;\r\n  onLoad?: () => void;\r\n  alt?: string;\r\n  width?: number;\r\n};\r\n\r\nconst setWidth = (url: string, width: number) => {\r\n  return createURL(url, { width });\r\n};\r\n\r\nconst cache = new Map();\r\n\r\nconst resolveImageURL = async (imgUrl: string, width: number) => {\r\n  const requestUrl = setWidth(imgUrl, width);\r\n  let url = requestUrl;\r\n\r\n  if (cache.has(requestUrl)) {\r\n    return cache.get(requestUrl);\r\n  }\r\n\r\n  try {\r\n    const response = await fetch(requestUrl);\r\n\r\n    // if redirected, cache and return resolved URL\r\n    if (response.redirected) {\r\n      url = response.url.replace('-1920', `-${width}`);\r\n    }\r\n\r\n    cache.set(requestUrl, url);\r\n  } catch (error) {\r\n    logInfo('Image', 'Failed to fetch image', { error, url });\r\n  }\r\n\r\n  return url;\r\n};\r\n\r\nconst Image = forwardRef<HTMLImageElement, Props>(({ className, image, onLoad, alt = '', width = 640 }, ref) => {\r\n  const [src, setSrc] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!image) return;\r\n\r\n    const loadImage = async () => {\r\n      const resolvedImage = await resolveImageURL(image, width);\r\n\r\n      setSrc(resolvedImage);\r\n      onLoad?.();\r\n    };\r\n\r\n    if (__mode__ === 'test') {\r\n      setSrc(setWidth(image, width));\r\n      onLoad?.();\r\n    } else {\r\n      loadImage();\r\n    }\r\n  }, [image, width, onLoad]);\r\n\r\n  if (!src) return null;\r\n\r\n  return <img ref={ref} className={`${className} ${styles.image}`} src={src} alt={alt} />;\r\n});\r\n\r\nexport default React.memo(Image);\r\n","import React, { memo } from 'react';\r\nimport classNames from 'classnames';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Link } from 'react-router-dom';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { formatDurationTag, formatLocalizedDateTime, formatSeriesMetaString } from '@jwp/ott-common/src/utils/formatting';\r\nimport { isLiveChannel, isSeries } from '@jwp/ott-common/src/utils/media';\r\nimport { isLiveEvent, MediaStatus } from '@jwp/ott-common/src/utils/liveEvent';\r\nimport Lock from '@jwp/ott-theme/assets/icons/lock.svg?react';\r\nimport Today from '@jwp/ott-theme/assets/icons/today.svg?react';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\nimport type { PosterAspectRatio } from '@jwp/ott-common/src/utils/collection';\r\n\r\nimport Image from '../Image/Image';\r\nimport Icon from '../Icon/Icon';\r\nimport createInjectableComponent from '../../modules/createInjectableComponent';\r\n\r\nimport styles from './Card.module.scss';\r\n\r\nexport const CardIdentifier = Symbol(`CARD`);\r\n\r\ntype ReplaceColon<T> = T extends `${infer Left}:${infer Right}` ? `${Left}${Right}` : T;\r\ntype PosterAspectRatioClass = ReplaceColon<PosterAspectRatio>;\r\n\r\nexport type CardProps = {\r\n  item: PlaylistItem;\r\n  onHover?: () => void;\r\n  progress?: number;\r\n  posterAspect?: PosterAspectRatio;\r\n  featured?: boolean;\r\n  disabled?: boolean;\r\n  loading?: boolean;\r\n  isCurrent?: boolean;\r\n  isLocked?: boolean;\r\n  currentLabel?: string;\r\n  url: string;\r\n  headingLevel?: number;\r\n  tabIndex?: number;\r\n};\r\n\r\nfunction Card({\r\n  onHover,\r\n  progress,\r\n  item,\r\n  posterAspect = '16:9',\r\n  featured = false,\r\n  disabled = false,\r\n  loading = false,\r\n  isCurrent = false,\r\n  isLocked = true,\r\n  currentLabel,\r\n  headingLevel = 3,\r\n  url,\r\n  tabIndex = 0,\r\n}: CardProps): JSX.Element {\r\n  const { title, duration, episodeNumber, seasonNumber, cardImage: image, mediaStatus, scheduledStart } = item;\r\n  const {\r\n    t,\r\n    i18n: { language },\r\n  } = useTranslation(['common', 'video']);\r\n  // t('play_item')\r\n\r\n  const cardClassName = classNames(styles.card, {\r\n    [styles.featured]: featured,\r\n    [styles.disabled]: disabled,\r\n  });\r\n  const aspectRatioClass = posterAspect ? styles[`aspect${posterAspect.replace(':', '') as PosterAspectRatioClass}`] : undefined;\r\n  const posterClassNames = classNames(styles.poster, aspectRatioClass, {\r\n    [styles.current]: isCurrent,\r\n  });\r\n\r\n  const isSeriesItem = isSeries(item);\r\n  const isLive = mediaStatus === MediaStatus.LIVE || isLiveChannel(item);\r\n  const isScheduled = mediaStatus === MediaStatus.SCHEDULED;\r\n\r\n  const renderTag = () => {\r\n    if (loading || !title) return null;\r\n\r\n    if (isSeriesItem) {\r\n      return <div className={styles.tag}>{t('video:series')}</div>;\r\n    } else if (episodeNumber) {\r\n      return <div className={styles.tag}>{formatSeriesMetaString(seasonNumber, episodeNumber)}</div>;\r\n    } else if (duration) {\r\n      return <div className={styles.tag}>{formatDurationTag(duration, { minutesAbbreviation: t('common:abbreviation.minutes') })}</div>;\r\n    } else if (isLive) {\r\n      return <div className={classNames(styles.tag, styles.live)}>{t('live')}</div>;\r\n    } else if (isScheduled) {\r\n      return (\r\n        <div className={styles.tag}>\r\n          <Icon icon={Today} className={styles.scheduled} />\r\n          {t('scheduled')}\r\n        </div>\r\n      );\r\n    }\r\n  };\r\n\r\n  const heading = React.createElement(`h${headingLevel}`, { className: classNames(styles.title, { [styles.loading]: loading }) }, loading ? '' : title);\r\n\r\n  return (\r\n    <Link\r\n      role=\"button\"\r\n      to={url}\r\n      className={cardClassName}\r\n      onClick={disabled ? (e) => e.preventDefault() : undefined}\r\n      onMouseEnter={onHover}\r\n      tabIndex={disabled ? -1 : tabIndex}\r\n      data-testid={testId(title)}\r\n    >\r\n      {!featured && (\r\n        <div className={styles.titleContainer}>\r\n          {heading}\r\n          {!!scheduledStart && isLiveEvent(item) && (\r\n            <div className={classNames(styles.scheduledStart, { [styles.loading]: loading })}>{formatLocalizedDateTime(scheduledStart, language)}</div>\r\n          )}\r\n        </div>\r\n      )}\r\n      <div className={posterClassNames}>\r\n        <Image className={styles.posterImage} image={image} width={featured ? 640 : 320} alt=\"\" />\r\n        {!loading && (\r\n          <div className={styles.meta}>\r\n            {featured && heading}\r\n            <div className={styles.tags}>\r\n              {isLocked && (\r\n                <div className={classNames(styles.tag, styles.lock)} aria-label={t('card_lock')} role=\"img\">\r\n                  <Icon icon={Lock} />\r\n                </div>\r\n              )}\r\n              {renderTag()}\r\n            </div>\r\n          </div>\r\n        )}\r\n        {isCurrent && <div className={styles.currentLabel}>{currentLabel}</div>}\r\n        {progress ? (\r\n          <div className={styles.progressContainer}>\r\n            <div className={styles.progressBar} style={{ width: `${Math.round(progress * 100)}%` }} />\r\n          </div>\r\n        ) : null}\r\n      </div>\r\n    </Link>\r\n  );\r\n}\r\n\r\nexport default memo(createInjectableComponent(CardIdentifier, Card));\r\n","import React, { useCallback } from 'react';\r\nimport classNames from 'classnames';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { CYCLE_MODE_RESTART, type RenderControl, type RenderPagination, TileSlider } from '@videodock/tile-slider';\r\nimport type { Playlist, PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport type { AccessModel, AppContentType } from '@jwp/ott-common/types/config';\r\nimport { isLocked } from '@jwp/ott-common/src/utils/entitlements';\r\nimport { mediaURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport { PersonalShelf } from '@jwp/ott-common/src/constants';\r\nimport ChevronLeft from '@jwp/ott-theme/assets/icons/chevron_left.svg?react';\r\nimport ChevronRight from '@jwp/ott-theme/assets/icons/chevron_right.svg?react';\r\nimport useBreakpoint, { Breakpoint, type Breakpoints } from '@jwp/ott-ui-react/src/hooks/useBreakpoint';\r\nimport type { PosterAspectRatio } from '@jwp/ott-common/src/utils/collection';\r\nimport '@videodock/tile-slider/lib/style.css';\r\n\r\nimport Card from '../Card/Card';\r\nimport Icon from '../Icon/Icon';\r\nimport createInjectableComponent from '../../modules/createInjectableComponent';\r\n\r\nimport styles from './Shelf.module.scss';\r\n\r\nexport const tileBreakpoints: Breakpoints = {\r\n  [Breakpoint.xs]: 1,\r\n  [Breakpoint.sm]: 2,\r\n  [Breakpoint.md]: 3,\r\n  [Breakpoint.lg]: 4,\r\n  [Breakpoint.xl]: 5,\r\n};\r\n\r\nexport const featuredTileBreakpoints: Breakpoints = {\r\n  [Breakpoint.xs]: 1,\r\n  [Breakpoint.sm]: 1,\r\n  [Breakpoint.md]: 1,\r\n  [Breakpoint.lg]: 1,\r\n  [Breakpoint.xl]: 1,\r\n};\r\n\r\nexport const ShelfIdentifier = Symbol(`SHELF`);\r\n\r\nexport type ShelfProps = {\r\n  playlist: Playlist;\r\n  type: AppContentType;\r\n  onCardHover?: (playlistItem: PlaylistItem) => void;\r\n  watchHistory?: { [key: string]: number };\r\n  enableTitle?: boolean;\r\n  enableCardTitles?: boolean;\r\n  featured?: boolean;\r\n  loading?: boolean;\r\n  error?: unknown;\r\n  title?: string;\r\n  accessModel: AccessModel;\r\n  isLoggedIn: boolean;\r\n  hasSubscription: boolean;\r\n  posterAspect?: PosterAspectRatio;\r\n  visibleTilesDelta?: number;\r\n};\r\n\r\nconst Shelf = ({\r\n  playlist,\r\n  type,\r\n  onCardHover,\r\n  title,\r\n  watchHistory,\r\n  featured = false,\r\n  loading = false,\r\n  error = null,\r\n  accessModel,\r\n  isLoggedIn,\r\n  hasSubscription,\r\n  posterAspect,\r\n  visibleTilesDelta = 0,\r\n}: ShelfProps) => {\r\n  const breakpoint: Breakpoint = useBreakpoint();\r\n  const { t } = useTranslation('common');\r\n  const tilesToShow: number = (featured ? featuredTileBreakpoints[breakpoint] : tileBreakpoints[breakpoint]) + visibleTilesDelta;\r\n\r\n  const renderTile = useCallback(\r\n    ({ item, isVisible }: { item: PlaylistItem; isVisible: boolean }) => {\r\n      const { mediaid: id, title } = item;\r\n      const url = mediaURL({ id, title, playlistId: playlist.feedid, play: type === PersonalShelf.ContinueWatching });\r\n\r\n      return (\r\n        <Card\r\n          key={item.mediaid}\r\n          progress={watchHistory ? watchHistory[item.mediaid] : undefined}\r\n          onHover={typeof onCardHover === 'function' ? () => onCardHover(item) : undefined}\r\n          featured={featured}\r\n          disabled={!isVisible}\r\n          loading={loading}\r\n          isLocked={isLocked(accessModel, isLoggedIn, hasSubscription, item)}\r\n          posterAspect={posterAspect}\r\n          item={item}\r\n          url={url}\r\n        />\r\n      );\r\n    },\r\n    [watchHistory, onCardHover, featured, loading, accessModel, isLoggedIn, hasSubscription, posterAspect, playlist.feedid, type],\r\n  );\r\n\r\n  const renderRightControl: RenderControl = useCallback(\r\n    ({ onClick }) => (\r\n      <button className={styles.chevron} aria-label={t('slide_next')} onClick={onClick}>\r\n        <Icon icon={ChevronRight} />\r\n      </button>\r\n    ),\r\n    [t],\r\n  );\r\n\r\n  const renderLeftControl: RenderControl = useCallback(\r\n    ({ onClick }) => (\r\n      <button className={styles.chevron} aria-label={t('slide_previous')} onClick={onClick}>\r\n        <Icon icon={ChevronLeft} />\r\n      </button>\r\n    ),\r\n    [t],\r\n  );\r\n\r\n  const renderPagination: RenderPagination = ({ page, pages }) => {\r\n    const items = Array.from({ length: pages }, (_, pageIndex) => pageIndex);\r\n\r\n    return (\r\n      <>\r\n        <div aria-live=\"polite\" className=\"hidden\">\r\n          {t('slide_indicator', { page: page + 1, pages })}\r\n        </div>\r\n        {featured && (\r\n          <div aria-hidden=\"true\" className={styles.dots}>\r\n            {items.map((current) => (\r\n              <span key={current} className={classNames(styles.dot, { [styles.active]: page === current })} />\r\n            ))}\r\n          </div>\r\n        )}\r\n      </>\r\n    );\r\n  };\r\n\r\n  if (error || !playlist?.playlist) return <h2 className={styles.error}>Could not load items</h2>;\r\n\r\n  return (\r\n    <div className={classNames(styles.shelf)}>\r\n      {featured ? null : loading ? <div className={styles.loadingTitle} /> : <h2 className={classNames(styles.title)}>{title || playlist.title}</h2>}\r\n      <TileSlider<PlaylistItem>\r\n        className={styles.slider}\r\n        items={playlist.playlist}\r\n        tilesToShow={tilesToShow}\r\n        cycleMode={CYCLE_MODE_RESTART}\r\n        showControls={!loading}\r\n        spacing={16}\r\n        renderLeftControl={renderLeftControl}\r\n        renderRightControl={renderRightControl}\r\n        renderPagination={renderPagination}\r\n        renderTile={renderTile}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default createInjectableComponent(ShelfIdentifier, Shelf);\r\n","import React from 'react';\r\n\r\nimport Spinner from '../Spinner/Spinner';\r\n\r\nimport styles from './InfiniteScrollLoader.module.scss';\r\n\r\nconst InfiniteScrollLoader = () => {\r\n  return (\r\n    <div className={styles.infiniteScrollLoader}>\r\n      <Spinner />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InfiniteScrollLoader;\r\n","import React, { type CSSProperties, type ReactNode } from 'react';\r\n\r\nimport Animation, { type Status } from '../Animation';\r\n\r\ntype Props = {\r\n  className?: string;\r\n  open?: boolean;\r\n  duration?: number;\r\n  delay?: number;\r\n  children?: ReactNode;\r\n  keepMounted?: boolean;\r\n  onOpenAnimationEnd?: () => void;\r\n  onCloseAnimationEnd?: () => void;\r\n};\r\n\r\nconst Fade: React.FC<Props> = ({ className, open = true, duration = 250, delay = 0, onOpenAnimationEnd, onCloseAnimationEnd, keepMounted, children }) => {\r\n  const seconds = duration / 1000;\r\n  const transition = `opacity ${seconds}s ease-in-out`;\r\n\r\n  const createStyle = (status: Status): CSSProperties => ({\r\n    transition,\r\n    opacity: status === 'opening' || status === 'open' ? 1 : 0,\r\n    willChange: 'opacity',\r\n  });\r\n\r\n  return (\r\n    <Animation\r\n      className={className}\r\n      createStyle={(status: Status) => createStyle(status)}\r\n      open={open}\r\n      duration={duration}\r\n      delay={delay}\r\n      onOpenAnimationEnd={onOpenAnimationEnd}\r\n      onCloseAnimationEnd={onCloseAnimationEnd}\r\n      keepMounted={keepMounted}\r\n    >\r\n      {children}\r\n    </Animation>\r\n  );\r\n};\r\n\r\nexport default Fade;\r\n","import { useEffect } from 'react';\r\nimport useEventCallback from '@jwp/ott-hooks-react/src/useEventCallback';\r\n\r\nexport const useScrolledDown = (start = 300, end = 30, onChange: (progress: number) => void) => {\r\n  const handleScroll = useEventCallback(() => {\r\n    const scrollTarget = document.scrollingElement || document.body;\r\n    const scrollPosition = scrollTarget.scrollTop;\r\n    const progress = Math.max(0, Math.min(1, (scrollPosition - start) / (end - start)));\r\n\r\n    onChange(progress);\r\n  });\r\n\r\n  useEffect(() => {\r\n    const { scrollingElement, documentElement, body } = document;\r\n    const listenerElement = scrollingElement && scrollingElement !== documentElement && scrollingElement !== body ? scrollingElement : window;\r\n\r\n    listenerElement.addEventListener('scroll', handleScroll, { passive: true });\r\n    return () => {\r\n      listenerElement.removeEventListener('scroll', handleScroll);\r\n    };\r\n  }, [handleScroll]);\r\n};\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\n\r\nimport MarkdownComponent from '../MarkdownComponent/MarkdownComponent';\r\n\r\nimport styles from './TruncatedText.module.scss';\r\n\r\ntype TruncatedTextProps = {\r\n  text: string;\r\n  maximumLines: number;\r\n  className?: string;\r\n};\r\n\r\nconst TruncatedText: React.FC<TruncatedTextProps> = ({ text, maximumLines, className }) => {\r\n  return (\r\n    <div\r\n      className={classNames(styles.truncatedText, className)}\r\n      style={{\r\n        maxHeight: `calc(1.5em * ${maximumLines})`,\r\n        WebkitLineClamp: maximumLines,\r\n        lineClamp: maximumLines,\r\n        display: '-webkit-box',\r\n      }}\r\n    >\r\n      <MarkdownComponent markdownString={text} inline />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TruncatedText;\r\n","import { useQueries } from 'react-query';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport type { GetEntitlementsResponse } from '@jwp/ott-common/types/checkout';\r\nimport type { MediaOffer } from '@jwp/ott-common/types/media';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport CheckoutController from '@jwp/ott-common/src/controllers/CheckoutController';\r\nimport { isLocked } from '@jwp/ott-common/src/utils/entitlements';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\n\r\nexport type UseEntitlementResult = {\r\n  isEntitled: boolean;\r\n  isMediaEntitlementLoading: boolean;\r\n  mediaOffers: MediaOffer[];\r\n};\r\n\r\nexport type UseEntitlement = (playlistItem?: PlaylistItem) => UseEntitlementResult;\r\n\r\ntype QueryResult = {\r\n  responseData?: GetEntitlementsResponse;\r\n};\r\n\r\nconst notifyOnChangeProps = ['data' as const, 'isLoading' as const];\r\n\r\n/**\r\n * useEntitlement()\r\n *\r\n * Free items: Access\r\n * AVOD - Regular items free, TVOD items need entitlement\r\n * AuthVOD - For regular items user should be logged in, TVOD items need entitlement\r\n * SVOD - For regular items user should have subscription OR entitlement, premier items need entitlement\r\n *\r\n *  */\r\nconst useEntitlement: UseEntitlement = (playlistItem) => {\r\n  const { accessModel } = useConfigStore();\r\n  const { user, subscription } = useAccountStore(\r\n    ({ user, subscription }) => ({\r\n      user,\r\n      subscription,\r\n    }),\r\n    shallow,\r\n  );\r\n\r\n  const checkoutController = getModule(CheckoutController, false);\r\n\r\n  const isPreEntitled = playlistItem && !isLocked(accessModel, !!user, !!subscription, playlistItem);\r\n  const mediaOffers = playlistItem?.mediaOffers || [];\r\n\r\n  // this query is invalidated when the subscription gets reloaded\r\n  const mediaEntitlementQueries = useQueries(\r\n    mediaOffers.map(({ offerId }) => ({\r\n      queryKey: ['entitlements', offerId],\r\n      queryFn: () => checkoutController?.getEntitlements({ offerId }),\r\n      enabled: !!playlistItem && !!user && !!user.id && !!offerId && !isPreEntitled,\r\n      refetchOnMount: 'always' as const,\r\n      notifyOnChangeProps,\r\n    })),\r\n  );\r\n\r\n  // when the user is logged out the useQueries will be disabled but could potentially return its cached data\r\n  const isMediaEntitled = !!user && mediaEntitlementQueries.some((item) => item.isSuccess && (item.data as QueryResult)?.responseData?.accessGranted);\r\n  const isMediaEntitlementLoading = !isMediaEntitled && mediaEntitlementQueries.some((item) => item.isLoading);\r\n\r\n  const isEntitled = !!playlistItem && (isPreEntitled || isMediaEntitled);\r\n\r\n  return { isEntitled, isMediaEntitlementLoading, mediaOffers };\r\n};\r\n\r\nexport default useEntitlement;\r\n","import * as React from \"react\";\nconst SvgPlay = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M8,5.14V19.14L19,12.14L8,5.14Z\" }));\nexport default SvgPlay;\n","import React, { useCallback, useEffect, useMemo } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useLocation, useNavigate } from 'react-router';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { useCheckoutStore } from '@jwp/ott-common/src/stores/CheckoutStore';\r\nimport { useWatchHistoryStore } from '@jwp/ott-common/src/stores/WatchHistoryStore';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport { modalURLFromLocation } from '@jwp/ott-ui-react/src/utils/location';\r\nimport useBreakpoint, { Breakpoint } from '@jwp/ott-ui-react/src/hooks/useBreakpoint';\r\nimport useEntitlement from '@jwp/ott-hooks-react/src/useEntitlement';\r\nimport Play from '@jwp/ott-theme/assets/icons/play.svg?react';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { ACCESS_MODEL } from '@jwp/ott-common/src/constants';\r\n\r\nimport Button from '../../components/Button/Button';\r\nimport Icon from '../../components/Icon/Icon';\r\n\r\nimport styles from './StartWatchingButton.module.scss';\r\n\r\ntype Props = {\r\n  item: PlaylistItem;\r\n  playUrl?: string;\r\n  disabled?: boolean;\r\n  onClick?: () => void;\r\n};\r\n\r\nconst StartWatchingButton: React.VFC<Props> = ({ item, playUrl, disabled = false, onClick }) => {\r\n  const { t } = useTranslation('video');\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const breakpoint = useBreakpoint();\r\n\r\n  // account\r\n  const accessModel = useConfigStore((state) => state.accessModel);\r\n  const user = useAccountStore((state) => state.user);\r\n  const isLoggedIn = !!user;\r\n\r\n  // watch history\r\n  const watchHistoryItem = useWatchHistoryStore((state) => item && state.getItem(item));\r\n  const videoProgress = watchHistoryItem?.progress;\r\n\r\n  // entitlement\r\n  const setRequestedMediaOffers = useCheckoutStore((s) => s.setRequestedMediaOffers);\r\n  const { isEntitled, mediaOffers } = useEntitlement(item);\r\n  const hasMediaOffers = !!mediaOffers.length;\r\n\r\n  const startWatchingLabel = useMemo((): string => {\r\n    if (isEntitled) return typeof videoProgress === 'number' ? t('continue_watching') : t('start_watching');\r\n    if (hasMediaOffers) return t('buy');\r\n    if (!isLoggedIn) return t('sign_up_to_start_watching');\r\n\r\n    return t('complete_your_subscription');\r\n  }, [isEntitled, isLoggedIn, hasMediaOffers, videoProgress, t]);\r\n\r\n  const handleStartWatchingClick = useCallback(() => {\r\n    if (isEntitled) {\r\n      if (onClick) {\r\n        onClick();\r\n        return;\r\n      }\r\n      return playUrl && navigate(playUrl);\r\n    }\r\n    if (!isLoggedIn) return navigate(modalURLFromLocation(location, 'create-account'));\r\n    if (hasMediaOffers) return navigate(modalURLFromLocation(location, 'choose-offer'));\r\n\r\n    return navigate('/u/payments');\r\n  }, [isEntitled, playUrl, navigate, isLoggedIn, location, hasMediaOffers, onClick]);\r\n\r\n  useEffect(() => {\r\n    // set the TVOD mediaOffers in the checkout store\r\n    setRequestedMediaOffers(mediaOffers);\r\n\r\n    return () => setRequestedMediaOffers([]);\r\n  }, [mediaOffers, setRequestedMediaOffers]);\r\n\r\n  // the user can't purchase access in an AVOD platform due to missing configuration, so we hide the button\r\n  if (accessModel === ACCESS_MODEL.AVOD && !isEntitled) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Button\r\n      color=\"primary\"\r\n      variant=\"contained\"\r\n      size=\"large\"\r\n      label={startWatchingLabel}\r\n      startIcon={isEntitled ? <Icon icon={Play} /> : undefined}\r\n      onClick={handleStartWatchingClick}\r\n      fullWidth={breakpoint < Breakpoint.md}\r\n      disabled={disabled}\r\n    >\r\n      {videoProgress ? (\r\n        <div className={styles.progressRail}>\r\n          <div className={styles.progress} style={{ width: `${videoProgress * 100}%` }} />\r\n        </div>\r\n      ) : null}\r\n    </Button>\r\n  );\r\n};\r\n\r\nexport default StartWatchingButton;\r\n","import type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport classNames from 'classnames';\r\nimport type { CSSProperties } from 'react';\r\nimport ChevronRight from '@jwp/ott-theme/assets/icons/chevron_right.svg?react';\r\nimport { mediaURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport { useNavigate } from 'react-router';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { isContentType, testId } from '@jwp/ott-common/src/utils/common';\r\nimport { MEDIA_CONTENT_TYPE } from '@jwp/ott-common/src/constants';\r\n\r\nimport TruncatedText from '../TruncatedText/TruncatedText';\r\nimport StartWatchingButton from '../../containers/StartWatchingButton/StartWatchingButton';\r\nimport Button from '../Button/Button';\r\nimport Icon from '../Icon/Icon';\r\nimport useBreakpoint, { Breakpoint } from '../../hooks/useBreakpoint';\r\n\r\nimport styles from './HeroShelf.module.scss';\r\n\r\nconst HeroShelfMetadata = ({\r\n  item,\r\n  loading,\r\n  playlistId,\r\n  style,\r\n  hidden,\r\n}: {\r\n  item: PlaylistItem | null;\r\n  loading: boolean;\r\n  playlistId: string | undefined;\r\n  style: CSSProperties;\r\n  hidden?: boolean;\r\n}) => {\r\n  const navigate = useNavigate();\r\n  const { t } = useTranslation('common');\r\n  const breakpoint = useBreakpoint();\r\n  const isMobile = breakpoint < Breakpoint.sm;\r\n\r\n  if (!item) return null;\r\n\r\n  const isWatchable =\r\n    !isContentType(item, MEDIA_CONTENT_TYPE.hub) && !isContentType(item, MEDIA_CONTENT_TYPE.liveChannel) && !isContentType(item, MEDIA_CONTENT_TYPE.page);\r\n  const hasVideo = item.sources.find((source) => source.file.indexOf('.m3u8') > -1 || source.file.indexOf('.mp4') > -1);\r\n\r\n  const showStartWatchingButton = hasVideo && isWatchable && !isMobile;\r\n\r\n  return (\r\n    <div\r\n      className={styles.metadata}\r\n      data-testid={testId(`shelf-hero-metadata--${hidden ? 'hidden' : 'visible'}`)}\r\n      style={{ ...style, visibility: hidden ? 'hidden' : undefined }}\r\n      aria-hidden={hidden ? 'true' : undefined}\r\n    >\r\n      <h2 className={classNames(loading ? styles.loadingTitle : styles.title)}>{!loading && item?.title}</h2>\r\n      <TruncatedText text={item?.description} maximumLines={3} />\r\n      <div>\r\n        {showStartWatchingButton && <StartWatchingButton item={item} playUrl={mediaURL({ id: item.mediaid, title: item.title, playlistId, play: true })} />}\r\n        <Button\r\n          label={t('common:more_info')}\r\n          onClick={() => navigate(mediaURL({ id: item.mediaid, title: item.title, playlistId }))}\r\n          startIcon={<Icon icon={ChevronRight} />}\r\n          size=\"large\"\r\n          variant={showStartWatchingButton ? undefined : 'contained'}\r\n          color={showStartWatchingButton ? undefined : 'primary'}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HeroShelfMetadata;\r\n","import type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport type { CSSProperties, TransitionEventHandler } from 'react';\r\nimport React from 'react';\r\n\r\nimport Image from '../Image/Image';\r\n\r\nimport styles from './HeroShelf.module.scss';\r\n\r\nconst HeroShelfBackground = ({\r\n  item,\r\n  style,\r\n  hidden,\r\n  onTransitionEnd,\r\n}: {\r\n  item: PlaylistItem | null;\r\n  style: CSSProperties;\r\n  hidden?: boolean;\r\n  onTransitionEnd?: TransitionEventHandler;\r\n}) => {\r\n  if (!item) return null;\r\n\r\n  const image = item?.backgroundImage;\r\n\r\n  return (\r\n    <div\r\n      style={{ ...style, visibility: hidden ? 'hidden' : undefined }}\r\n      aria-hidden={hidden ? 'true' : undefined}\r\n      key={item.mediaid}\r\n      onTransitionEnd={onTransitionEnd}\r\n    >\r\n      <Image className={styles.image} image={image} width={1920} alt={item?.title} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default React.memo(HeroShelfBackground);\r\n","import classNames from 'classnames';\r\nimport type { Playlist } from '@jwp/ott-common/types/playlist';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useMemo } from 'react';\r\n\r\nimport styles from './HeroShelf.module.scss';\r\n\r\nconst calculateDotSize = (direction: 'left' | 'right' | false, itemIndex: number, index: number, range: number, sizeSmall: number) => {\r\n  const isAnimatingLeft = direction === 'left';\r\n  const isAnimatingRight = direction === 'right';\r\n\r\n  const dotPosition = {\r\n    semiEdgeLeft: itemIndex === index - range + 1 && isAnimatingRight,\r\n    edgeLeft: itemIndex === index - range,\r\n    newDotLeft: itemIndex === index - range - 1,\r\n    semiEdgeRight: itemIndex === index + range - 1 && isAnimatingLeft,\r\n    edgeRight: itemIndex === index + range,\r\n    newDotRight: itemIndex === index + range + 1,\r\n  };\r\n\r\n  if (dotPosition.semiEdgeLeft || dotPosition.semiEdgeRight) return sizeSmall;\r\n  if (dotPosition.edgeLeft) return isAnimatingRight ? 0 : isAnimatingLeft ? 1 : sizeSmall;\r\n  if (dotPosition.edgeRight) return isAnimatingLeft ? 0 : isAnimatingRight ? 1 : sizeSmall;\r\n  if (dotPosition.newDotLeft) return isAnimatingLeft ? sizeSmall : 0;\r\n  if (dotPosition.newDotRight) return isAnimatingRight ? sizeSmall : 0;\r\n\r\n  return 1;\r\n};\r\n\r\ntype Props = {\r\n  playlist: Playlist;\r\n  index: number;\r\n  direction: 'left' | 'right' | false;\r\n  nextIndex: number;\r\n  setIndex: (index: number) => void;\r\n  range?: number;\r\n  animationDuration?: number;\r\n};\r\n\r\nconst HeroShelfPagination = ({ playlist, index: indexIn, direction, nextIndex: nextIndexIn, setIndex, range = 3, animationDuration = 200 }: Props) => {\r\n  const { t } = useTranslation('common');\r\n  const placeholderCount = range + 1; // Placeholders are used to keep a stable amount of DOM elements\r\n  const index = indexIn + placeholderCount;\r\n  const nextIndex = nextIndexIn + placeholderCount;\r\n\r\n  const playlistWithPlaceholders = useMemo(() => {\r\n    const placeholders: false[] = Array.from({ length: placeholderCount }).map(() => false);\r\n\r\n    return [...placeholders, ...playlist.playlist, ...placeholders];\r\n  }, [playlist.playlist, placeholderCount]);\r\n\r\n  return (\r\n    <>\r\n      <div aria-live=\"polite\" className=\"hidden\">\r\n        {t('slide_indicator', { page: indexIn + 1, pages: playlist.playlist.length })}\r\n      </div>\r\n      <nav className={styles.dots}>\r\n        <ul className={styles.dotsList}>\r\n          {playlistWithPlaceholders.map((current, itemIndex) => {\r\n            if (itemIndex < index - range - 1 || itemIndex > index + range + 1) {\r\n              return null;\r\n            }\r\n            if (!current) {\r\n              return <li className={classNames(styles.dotPlaceholder)} key={itemIndex} aria-hidden=\"true\" />;\r\n            }\r\n\r\n            const movementBase = 22; // dot width (10) + gap(12)\r\n            const movementTotal = Math.abs(index - nextIndex) * movementBase;\r\n            const movement = direction === 'left' ? movementTotal : direction === 'right' ? 0 - movementTotal : 0;\r\n            const transform = `translateX(${movement}px)`;\r\n            const transition = direction\r\n              ? `transform ${animationDuration}ms ease-out ${animationDuration / 3}ms, width ${animationDuration / 2}ms ease-out ${animationDuration / 3}ms`\r\n              : '';\r\n\r\n            const size = calculateDotSize(direction, itemIndex, index, range, 0.6);\r\n            const transformDiv = `scale(${size})`;\r\n            const transitionDiv = direction\r\n              ? `width ${animationDuration}ms ease-out, height ${animationDuration}ms ease-out, transform ${animationDuration}ms ease-out`\r\n              : '';\r\n\r\n            const isCurrent = itemIndex === index;\r\n            const hidden = size !== 1;\r\n            const ariaLabel = hidden ? undefined : t('slide_to', { item: itemIndex - placeholderCount + 1, items: playlist.playlist.length });\r\n\r\n            return (\r\n              <li key={current?.mediaid} aria-hidden={hidden || undefined} aria-current={isCurrent || undefined}>\r\n                <button\r\n                  className={classNames(styles.dot, itemIndex === nextIndex && styles.dotActive, !direction && itemIndex === index && styles.dotActive)}\r\n                  style={{ transform, transition }}\r\n                  aria-label={ariaLabel}\r\n                  disabled={hidden || undefined}\r\n                  onClick={hidden || isCurrent ? undefined : () => setIndex(itemIndex - placeholderCount)}\r\n                >\r\n                  <div style={{ transform: transformDiv, transition: transitionDiv }} />\r\n                </button>\r\n              </li>\r\n            );\r\n          })}\r\n        </ul>\r\n      </nav>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default HeroShelfPagination;\r\n","import useEventCallback from '@jwp/ott-hooks-react/src/useEventCallback';\r\nimport { useEffect, useLayoutEffect, useRef, useState } from 'react';\r\nimport classNames from 'classnames';\r\n\r\nimport useBreakpoint, { Breakpoint } from '../../hooks/useBreakpoint';\r\n\r\nimport styles from './HeroShelf.module.scss';\r\n\r\ntype Props = {\r\n  hasLeftItem: boolean;\r\n  hasRightItem: boolean;\r\n  renderLeftItem: (isSwiping: boolean) => React.ReactNode;\r\n  renderItem: () => React.ReactNode;\r\n  renderRightItem: (isSwiping: boolean) => React.ReactNode;\r\n  loading: boolean;\r\n  direction: 'left' | 'right' | null;\r\n  isSwipeAnimation: boolean;\r\n  onSwipeLeft: () => void;\r\n  onSwipeRight: () => void;\r\n};\r\n\r\nconst HeroSwipeSlider = ({\r\n  hasLeftItem,\r\n  hasRightItem,\r\n  renderItem,\r\n  renderLeftItem,\r\n  renderRightItem,\r\n  direction,\r\n  isSwipeAnimation,\r\n  onSwipeLeft,\r\n  onSwipeRight,\r\n}: Props) => {\r\n  const movementRef = useRef({ x: 0, y: 0, start: Date.now() });\r\n  const containerRef = useRef<HTMLDivElement | null>(null);\r\n  const [swipeAction, setSwipeAction] = useState<'slide' | 'scroll' | null>(null);\r\n  const breakpoint = useBreakpoint();\r\n  const isMobile = breakpoint <= Breakpoint.sm;\r\n\r\n  const handleTouchStart = useEventCallback((event: TouchEvent) => {\r\n    if (direction) return;\r\n    movementRef.current = { x: event.touches[0].clientX, y: event.touches[0].clientY, start: Date.now() };\r\n    setSwipeAction(null);\r\n  });\r\n\r\n  const handleTouchMove = useEventCallback((event: TouchEvent) => {\r\n    if (direction) return;\r\n    if (!containerRef.current) return;\r\n\r\n    const movementX: number = event.changedTouches[0].clientX - movementRef.current.x;\r\n    const movementY: number = event.changedTouches[0].clientY - movementRef.current.y;\r\n    const currentSwipeAction = Math.abs(movementX) > Math.abs(movementY) ? 'slide' : 'scroll';\r\n\r\n    if (!swipeAction) setSwipeAction(currentSwipeAction);\r\n    if (currentSwipeAction === 'scroll' || swipeAction === 'scroll') return;\r\n\r\n    // Prevent scrolling while sliding\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Follow touch horizontally\r\n    const maxLeft = hasRightItem ? -window.innerWidth : 0;\r\n    const maxRight = hasLeftItem ? window.innerWidth : 0;\r\n    const limitedMovementX = Math.max(Math.min(movementX, maxRight), maxLeft);\r\n\r\n    containerRef.current.style.transform = `translateX(${limitedMovementX}px)`;\r\n    containerRef.current.style.transition = 'none';\r\n  });\r\n\r\n  const handleTouchEnd = useEventCallback((event: TouchEvent) => {\r\n    if (direction) return;\r\n    if (!containerRef.current) return;\r\n    if (swipeAction === 'scroll') return;\r\n\r\n    const movementX = movementRef.current.x - event.changedTouches[0].clientX;\r\n    const velocity = Math.round((movementX / (Date.now() - movementRef.current.start)) * 100);\r\n    const velocityTreshold = 80;\r\n\r\n    if (hasRightItem && (movementX > window.innerWidth / 2 || velocity > velocityTreshold)) {\r\n      onSwipeRight();\r\n    } else if (hasLeftItem && (movementX < -window.innerWidth / 2 || velocity < -velocityTreshold)) {\r\n      onSwipeLeft();\r\n    } else {\r\n      containerRef.current.style.transition = 'transform 0.2s ease-out';\r\n      containerRef.current.style.transform = 'translateX(0)';\r\n    }\r\n    setSwipeAction(null);\r\n  });\r\n\r\n  useLayoutEffect(() => {\r\n    if (!containerRef.current) return;\r\n    if (isSwipeAnimation && direction === 'left') {\r\n      containerRef.current.style.transition = 'transform 0.2s ease-out';\r\n      containerRef.current.style.transform = `translateX(100%)`;\r\n    } else if (isSwipeAnimation && direction === 'right') {\r\n      containerRef.current.style.transition = 'transform 0.2s ease-out';\r\n      containerRef.current.style.transform = `translateX(-100%)`;\r\n    } else {\r\n      containerRef.current.style.transform = 'translateX(0)';\r\n      containerRef.current.style.transition = 'none';\r\n    }\r\n  }, [direction, isSwipeAnimation]);\r\n\r\n  useEffect(() => {\r\n    const container = containerRef.current;\r\n    if (!container) return;\r\n\r\n    container.addEventListener('touchstart', handleTouchStart);\r\n    container.addEventListener('touchmove', handleTouchMove, { passive: false });\r\n    container.addEventListener('touchend', handleTouchEnd);\r\n\r\n    return () => {\r\n      container.removeEventListener('touchstart', handleTouchStart);\r\n      container.removeEventListener('touchmove', handleTouchMove);\r\n      container.removeEventListener('touchend', handleTouchEnd);\r\n    };\r\n  }, [handleTouchStart, handleTouchMove, handleTouchEnd]);\r\n\r\n  return (\r\n    <div ref={containerRef} className={classNames(styles.swipeSlider, isMobile && styles.swipeSliderMobile)}>\r\n      {renderLeftItem(swipeAction === 'slide')}\r\n      {renderItem()}\r\n      {renderRightItem(swipeAction === 'slide')}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HeroSwipeSlider;\r\n","import React, { useCallback, useEffect, useRef, useState, type CSSProperties, type TransitionEventHandler } from 'react';\r\nimport type { Playlist } from '@jwp/ott-common/types/playlist';\r\nimport classNames from 'classnames';\r\nimport { useTranslation } from 'react-i18next';\r\nimport ChevronLeft from '@jwp/ott-theme/assets/icons/chevron_left.svg?react';\r\nimport ChevronRight from '@jwp/ott-theme/assets/icons/chevron_right.svg?react';\r\n\r\nimport { useScrolledDown } from '../../hooks/useScrolledDown';\r\nimport Icon from '../Icon/Icon';\r\nimport useBreakpoint, { Breakpoint } from '../../hooks/useBreakpoint';\r\n\r\nimport styles from './HeroShelf.module.scss';\r\nimport HeroShelfMetadata from './HeroShelfMetadata';\r\nimport HeroShelfBackground from './HeroShelfBackground';\r\nimport HeroShelfPagination from './HeroShelfPagination';\r\nimport HeroSwipeSlider from './HeroSwipeSlider';\r\n\r\ntype Props = {\r\n  playlist: Playlist;\r\n  loading?: boolean;\r\n  error?: unknown;\r\n};\r\n\r\nconst HeroShelf = ({ playlist, loading = false, error = null }: Props) => {\r\n  const [index, setIndex] = useState(0);\r\n  const [nextIndex, setNextIndex] = useState(0);\r\n  const { t } = useTranslation('common');\r\n  const breakpoint = useBreakpoint();\r\n  const isMobile = breakpoint <= Breakpoint.sm;\r\n  const posterRef = useRef<HTMLDivElement>(null);\r\n  const [direction, setDirection] = useState<'left' | 'right' | null>(null);\r\n  const [animationPhase, setAnimationPhase] = useState<'init' | 'start' | 'end' | null>(null);\r\n  const [isSwipeAnimation, setIsSwipeAnimation] = useState(false);\r\n\r\n  useScrolledDown(50, isMobile ? 200 : 600, (progress: number) => {\r\n    if (posterRef.current) posterRef.current.style.opacity = `${Math.max(1 - progress, isMobile ? 0 : 0.1)}`;\r\n  });\r\n\r\n  const slideTo = (toIndex: number, isSwiping = false) => {\r\n    if (animationPhase) return;\r\n\r\n    setNextIndex(toIndex);\r\n    setDirection(toIndex > index ? 'right' : 'left');\r\n    setAnimationPhase('init');\r\n    setIsSwipeAnimation(isSwiping);\r\n  };\r\n\r\n  const handleSlideLeft = () => slideTo(index - 1);\r\n  const handleSlideRight = () => slideTo(index + 1);\r\n  const handleSwipeLeft = () => slideTo(index - 1, true);\r\n  const handleSwipeRight = () => slideTo(index + 1, true);\r\n\r\n  const handleBackgroundAnimationEnd: TransitionEventHandler = useCallback(\r\n    (event) => {\r\n      // Transform has the longest transition (after opacity)\r\n      if (event.propertyName === 'transform' && animationPhase === 'start') {\r\n        setAnimationPhase('end');\r\n      }\r\n    },\r\n    [animationPhase],\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (!direction) return;\r\n    if (animationPhase === 'init') {\r\n      setAnimationPhase('start');\r\n      return;\r\n    }\r\n    if (animationPhase === 'end') {\r\n      setIndex(nextIndex);\r\n      setDirection(null);\r\n      setAnimationPhase(null);\r\n      setIsSwipeAnimation(false);\r\n    }\r\n  }, [animationPhase, direction, nextIndex]);\r\n\r\n  const isAnimating = animationPhase === 'start' || animationPhase === 'end';\r\n  const directionFactor = direction === 'left' ? 1 : direction === 'right' ? -1 : 0;\r\n\r\n  const getBackgroundStyle = (side?: 'left' | 'right') => {\r\n    const backgroundX = isMobile ? 10 : 40;\r\n\r\n    if (side == 'left') {\r\n      return {\r\n        transform: `scale(1.2) translateX(${animationPhase === 'init' ? backgroundX * -1 : 0}px)`,\r\n        opacity: isAnimating ? 1 : 0,\r\n        transition: isAnimating ? 'opacity 0.3s ease-out, transform 0.3s ease-out' : 'none',\r\n      };\r\n    }\r\n    if (side == 'right') {\r\n      return {\r\n        transform: `scale(1.2) translateX(${animationPhase === 'init' ? backgroundX : 0}px)`,\r\n        opacity: isAnimating ? 1 : 0,\r\n        transition: isAnimating ? 'opacity 0.3s ease-out, transform 0.3s ease-out' : 'none',\r\n      };\r\n    }\r\n    return {\r\n      transform: `scale(1.2) translateX(${isAnimating ? backgroundX * directionFactor : 0}px)`,\r\n      opacity: isAnimating ? 0 : 1,\r\n      transition: isAnimating ? `opacity ${isMobile ? 0.3 : 0.1}s ease-out, transform 0.3s ease-in` : 'none',\r\n    };\r\n  };\r\n\r\n  const getMetadataStyle = (side?: 'left' | 'right', isSwiping = false): CSSProperties => {\r\n    if (side === 'left') {\r\n      return {\r\n        left: isSwiping || isSwipeAnimation ? '-100%' : animationPhase === 'init' ? -60 : 0,\r\n        opacity: isSwiping || isSwipeAnimation || isAnimating ? 1 : 0,\r\n        transition: isAnimating ? 'opacity 0.2s ease-out, left 0.2s ease-out' : 'none',\r\n        pointerEvents: 'none',\r\n      };\r\n    }\r\n    if (side === 'right') {\r\n      return {\r\n        left: isSwiping || isSwipeAnimation ? '100%' : animationPhase === 'init' ? 60 : 0,\r\n        opacity: isSwiping || isSwipeAnimation || isAnimating ? 1 : 0,\r\n        transition: isAnimating ? 'opacity 0.2s ease-out, left 0.2s ease-out' : 'none',\r\n        pointerEvents: 'none',\r\n      };\r\n    }\r\n    return {\r\n      left: isAnimating && direction ? 60 * directionFactor : 0,\r\n      opacity: isAnimating ? 0 : 1,\r\n      transition: isAnimating ? 'opacity 0.15s ease-out, left 0.15s ease-out' : 'none',\r\n      pointerEvents: isAnimating ? 'none' : 'initial',\r\n    };\r\n  };\r\n\r\n  const item = playlist.playlist[index];\r\n  const leftItem = playlist.playlist[nextIndex < index ? nextIndex : index - 1] || null;\r\n  const rightItem = playlist.playlist[nextIndex > index ? nextIndex : index + 1] || null;\r\n\r\n  const renderedItem = animationPhase !== 'end' ? item : direction === 'right' ? leftItem : rightItem;\r\n\r\n  if (error || !playlist?.playlist) return <h2 className={styles.error}>Could not load items</h2>;\r\n\r\n  return (\r\n    <div className={classNames(styles.shelf)}>\r\n      <div className={styles.poster} ref={posterRef}>\r\n        <div className={styles.background} id=\"background\">\r\n          <HeroShelfBackground\r\n            item={leftItem}\r\n            style={getBackgroundStyle('left')}\r\n            key={renderedItem?.mediaid === leftItem?.mediaid ? 'left-item' : leftItem?.mediaid}\r\n            hidden={direction !== 'left'}\r\n          />\r\n          <HeroShelfBackground item={renderedItem} style={getBackgroundStyle()} key={renderedItem?.mediaid} onTransitionEnd={handleBackgroundAnimationEnd} />\r\n          <HeroShelfBackground\r\n            item={rightItem}\r\n            style={getBackgroundStyle('right')}\r\n            key={renderedItem?.mediaid === rightItem?.mediaid ? 'right-item' : rightItem?.mediaid}\r\n            hidden={direction !== 'right'}\r\n          />\r\n          <div className={styles.fade} />\r\n        </div>\r\n        <div className={styles.fade2} />\r\n      </div>\r\n      <button\r\n        className={classNames(styles.chevron, styles.chevronLeft)}\r\n        aria-label={t('slide_previous')}\r\n        disabled={!leftItem}\r\n        onClick={leftItem ? handleSlideLeft : undefined}\r\n      >\r\n        <Icon icon={ChevronLeft} />\r\n      </button>\r\n      <HeroSwipeSlider\r\n        direction={direction}\r\n        isSwipeAnimation={isSwipeAnimation}\r\n        loading={loading}\r\n        onSwipeLeft={handleSwipeLeft}\r\n        onSwipeRight={handleSwipeRight}\r\n        hasLeftItem={!!leftItem}\r\n        hasRightItem={!!rightItem}\r\n        renderLeftItem={(isSwiping: boolean) => (\r\n          <HeroShelfMetadata\r\n            loading={loading}\r\n            item={leftItem}\r\n            playlistId={playlist.feedid}\r\n            style={getMetadataStyle('left', isSwiping)}\r\n            key={renderedItem?.mediaid === leftItem?.mediaid ? 'left-item' : leftItem?.mediaid}\r\n            hidden={direction !== 'left' && !isSwiping}\r\n          />\r\n        )}\r\n        renderItem={() => (\r\n          <HeroShelfMetadata loading={loading} item={renderedItem} playlistId={playlist.feedid} key={renderedItem?.mediaid} style={getMetadataStyle()} />\r\n        )}\r\n        renderRightItem={(isSwiping: boolean) => (\r\n          <HeroShelfMetadata\r\n            loading={loading}\r\n            item={rightItem}\r\n            playlistId={playlist.feedid}\r\n            style={getMetadataStyle('right', isSwiping)}\r\n            key={renderedItem?.mediaid === rightItem?.mediaid ? 'right-item' : rightItem?.mediaid}\r\n            hidden={direction !== 'right' && !isSwiping}\r\n          />\r\n        )}\r\n      />\r\n      <button\r\n        className={classNames(styles.chevron, styles.chevronRight)}\r\n        aria-label={t('slide_next')}\r\n        disabled={!rightItem}\r\n        onClick={rightItem ? handleSlideRight : undefined}\r\n      >\r\n        <Icon icon={ChevronRight} />\r\n      </button>\r\n      <HeroShelfPagination playlist={playlist} index={index} setIndex={slideTo} nextIndex={nextIndex} direction={direction || false} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HeroShelf;\r\n","import React, { useEffect, useState } from 'react';\r\nimport classNames from 'classnames';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport InfiniteScroll from 'react-infinite-scroller';\r\nimport type { Content } from '@jwp/ott-common/types/config';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { useWatchHistoryStore } from '@jwp/ott-common/src/stores/WatchHistoryStore';\r\nimport { slugify } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport { parseAspectRatio, parseTilesDelta } from '@jwp/ott-common/src/utils/collection';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\nimport { PersonalShelf, SHELF_LAYOUT_TYPE } from '@jwp/ott-common/src/constants';\r\nimport usePlaylists from '@jwp/ott-hooks-react/src/usePlaylists';\r\nimport { useTranslationKey } from '@jwp/ott-hooks-react/src/useTranslationKey';\r\n\r\nimport Shelf from '../../components/Shelf/Shelf';\r\nimport InfiniteScrollLoader from '../../components/InfiniteScrollLoader/InfiniteScrollLoader';\r\nimport ErrorPage from '../../components/ErrorPage/ErrorPage';\r\nimport Fade from '../../components/Animation/Fade/Fade';\r\nimport HeroShelf from '../../components/HeroShelf/HeroShelf';\r\n\r\nimport styles from './ShelfList.module.scss';\r\n\r\nconst INITIAL_ROWS_TO_LOAD = 6;\r\nconst ROWS_TO_LOAD_STEP = 4;\r\n\r\ntype Props = {\r\n  rows: Content[];\r\n};\r\n\r\nconst ShelfList = ({ rows }: Props) => {\r\n  const { accessModel } = useConfigStore(({ accessModel }) => ({ accessModel }), shallow);\r\n  const [rowsToLoad, setRowsToLoad] = useState(INITIAL_ROWS_TO_LOAD);\r\n  const { t } = useTranslation('error');\r\n  const translationKey = useTranslationKey('title');\r\n\r\n  const watchHistoryDictionary = useWatchHistoryStore((state) => state.getDictionaryWithSeries());\r\n\r\n  // User\r\n  const { user, subscription } = useAccountStore(({ user, subscription }) => ({ user, subscription }), shallow);\r\n\r\n  // Todo: move to more common package?\r\n\r\n  const playlists = usePlaylists(rows, rowsToLoad);\r\n\r\n  useEffect(() => {\r\n    // reset row count when the page changes\r\n    return () => setRowsToLoad(INITIAL_ROWS_TO_LOAD);\r\n  }, [rows]);\r\n\r\n  // If all playlists are empty (most probably due to geo restrictions), we show an empty shelves error\r\n  const allPlaylistsEmpty = playlists.every(({ data, isSuccess }) => isSuccess && !data?.playlist?.length);\r\n\r\n  if (allPlaylistsEmpty) {\r\n    return <ErrorPage title={t('empty_shelves_heading')} message={t('empty_shelves_description')} />;\r\n  }\r\n\r\n  return (\r\n    <div className={styles.shelfList}>\r\n      <InfiniteScroll\r\n        style={{ overflow: 'hidden' }}\r\n        loadMore={() => setRowsToLoad((current) => current + ROWS_TO_LOAD_STEP)}\r\n        hasMore={rowsToLoad < rows.length}\r\n        loader={<InfiniteScrollLoader key=\"loader\" />}\r\n        useWindow={false}\r\n      >\r\n        {rows.slice(0, rowsToLoad).map(({ type, featured, title, custom }, index) => {\r\n          const { data: playlist, isPlaceholderData, error } = playlists[index];\r\n\r\n          if (!playlist?.playlist?.length) return null;\r\n\r\n          const posterAspect = parseAspectRatio(playlist.cardImageAspectRatio || playlist.shelfImageAspectRatio);\r\n          const visibleTilesDelta = parseTilesDelta(posterAspect);\r\n\r\n          const translatedValue = custom?.[translationKey] || (playlist?.[translationKey] as string);\r\n          const translatedTitle = translatedValue || title || playlist?.title;\r\n\r\n          const isHero = custom?.layoutType === SHELF_LAYOUT_TYPE.hero && index === 0;\r\n          const isFeatured = !isHero && (custom?.layoutType === SHELF_LAYOUT_TYPE.featured || featured);\r\n\r\n          return (\r\n            <section\r\n              key={`${index}_${playlist.id}`}\r\n              className={classNames(styles.shelfContainer, { [styles.hero]: isHero, [styles.featured]: isFeatured })}\r\n              data-testid={testId(`shelf-${isHero ? 'hero' : isFeatured ? 'featured' : type === 'playlist' ? slugify(translatedTitle) : type}`)}\r\n              aria-label={translatedTitle}\r\n            >\r\n              <Fade duration={250} delay={index * 33} open>\r\n                {isHero ? (\r\n                  <HeroShelf loading={isPlaceholderData} error={error} playlist={playlist} />\r\n                ) : (\r\n                  <Shelf\r\n                    loading={isPlaceholderData}\r\n                    error={error}\r\n                    type={type}\r\n                    playlist={playlist}\r\n                    watchHistory={type === PersonalShelf.ContinueWatching ? watchHistoryDictionary : undefined}\r\n                    title={translatedTitle}\r\n                    featured={isFeatured}\r\n                    accessModel={accessModel}\r\n                    isLoggedIn={!!user}\r\n                    hasSubscription={!!subscription}\r\n                    posterAspect={posterAspect}\r\n                    visibleTilesDelta={visibleTilesDelta}\r\n                  />\r\n                )}\r\n              </Fade>\r\n            </section>\r\n          );\r\n        })}\r\n      </InfiniteScroll>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ShelfList;\r\n","import React from 'react';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport type { Content } from '@jwp/ott-common/types/config';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport ShelfList from '../../containers/ShelfList/ShelfList';\r\n\r\nconst Home = () => {\r\n  const { config } = useConfigStore(({ config, accessModel }) => ({ config, accessModel }), shallow);\r\n  const content: Content[] = config?.content;\r\n  const { t } = useTranslation('common');\r\n\r\n  return (\r\n    <>\r\n      <h1 className=\"hideUntilFocus\">{t('home')}</h1>\r\n      <ShelfList rows={content} />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n","import { createStore } from './utils';\r\n\r\ntype UIState = {\r\n  searchQuery: string;\r\n  searchActive: boolean;\r\n  userMenuOpen: boolean;\r\n  sideBarOpen: boolean;\r\n  languageMenuOpen: boolean;\r\n  preSearchPage?: string;\r\n};\r\n\r\nexport const useUIStore = createStore<UIState>('UIStore', () => ({\r\n  searchQuery: '',\r\n  searchActive: false,\r\n  userMenuOpen: false,\r\n  sideBarOpen: false,\r\n  languageMenuOpen: false,\r\n}));\r\n","import { useEffect, useRef } from 'react';\r\n\r\nconst useFirstRender = () => {\r\n  const firstRenderRef = useRef(true);\r\n\r\n  useEffect(() => {\r\n    firstRenderRef.current = false;\r\n  }, []);\r\n\r\n  return firstRenderRef.current;\r\n};\r\n\r\nexport default useFirstRender;\r\n","import { type MutableRefObject, useEffect, useRef } from 'react';\r\nimport { debounce } from '@jwp/ott-common/src/utils/common';\r\n\r\nconst useDebounce = <T extends (...args: any[]) => unknown>(callback: T, time: number) => {\r\n  const fnRef = useRef() as MutableRefObject<T | undefined>;\r\n  const debounceRef = useRef(\r\n    debounce((...rest) => {\r\n      if (fnRef.current) fnRef.current(...rest);\r\n    }, time),\r\n  );\r\n\r\n  useEffect(() => {\r\n    fnRef.current = callback;\r\n  }, [callback]);\r\n\r\n  return debounceRef.current;\r\n};\r\n\r\nexport default useDebounce;\r\n","import { useCallback } from 'react';\r\nimport { useNavigate } from 'react-router';\r\nimport { useUIStore } from '@jwp/ott-common/src/stores/UIStore';\r\nimport useDebounce from '@jwp/ott-hooks-react/src/useDebounce';\r\n\r\n// Manages the query of the Search bar\r\nconst useSearchQueryUpdater = () => {\r\n  const navigate = useNavigate();\r\n\r\n  const updateSearchPath = useDebounce((query: string) => {\r\n    navigate(`/q/${encodeURIComponent(query)}`);\r\n  }, 350);\r\n  const updateSearchQuery = useCallback(\r\n    (query: string) => {\r\n      useUIStore.setState({\r\n        searchQuery: query,\r\n      });\r\n      updateSearchPath(query);\r\n    },\r\n    [updateSearchPath],\r\n  );\r\n  const resetSearchQuery = useCallback(() => {\r\n    const returnPage = useUIStore.getState().preSearchPage;\r\n\r\n    useUIStore.setState({\r\n      searchQuery: '',\r\n      preSearchPage: undefined,\r\n    });\r\n\r\n    navigate(returnPage || '/');\r\n  }, [navigate]);\r\n\r\n  return { updateSearchQuery, resetSearchQuery };\r\n};\r\n\r\nexport default useSearchQueryUpdater;\r\n","import { useQuery, type UseQueryResult } from 'react-query';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport ApiService from '@jwp/ott-common/src/services/ApiService';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport type { ApiError } from '@jwp/ott-common/src/utils/api';\r\nimport usePlaylist from '@jwp/ott-hooks-react/src/usePlaylist';\r\nimport { CACHE_TIME, STALE_TIME } from '@jwp/ott-common/src/constants';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { isTruthyCustomParamValue } from '@jwp/ott-common/src/utils/common';\r\nimport type { Playlist } from '@jwp/ott-common/types/playlist';\r\nimport { generatePlaylistPlaceholder } from '@jwp/ott-common/src/utils/collection';\r\n\r\nconst placeholderData = generatePlaylistPlaceholder(30);\r\n\r\nconst useAppContentSearch = ({ siteId, enabled, query }: { query: string; siteId: string; enabled: boolean }) => {\r\n  const apiService = getModule(ApiService);\r\n\r\n  const appContentSearchQuery: UseQueryResult<Playlist | undefined, ApiError> = useQuery(\r\n    ['app-search', query],\r\n    async () => {\r\n      const searchResult = await apiService.getContentSearch({ siteId, params: { searchTerm: query } });\r\n\r\n      return searchResult;\r\n    },\r\n    {\r\n      placeholderData: enabled ? placeholderData : undefined,\r\n      enabled: enabled,\r\n      staleTime: STALE_TIME,\r\n      cacheTime: CACHE_TIME,\r\n    },\r\n  );\r\n\r\n  return appContentSearchQuery;\r\n};\r\n\r\nexport const useSearch = (query: string) => {\r\n  const { config } = useConfigStore(({ config }) => ({ config }), shallow);\r\n\r\n  const siteId = config?.siteId;\r\n  const searchPlaylist = config?.features?.searchPlaylist;\r\n  const hasAppContentSearch = isTruthyCustomParamValue(config?.custom?.appContentSearch);\r\n\r\n  const playlistQuery = usePlaylist(searchPlaylist || '', { search: query || '' }, !hasAppContentSearch, !!query);\r\n  // New app content search flow\r\n  const appContentSearchQuery = useAppContentSearch({ siteId, enabled: hasAppContentSearch, query });\r\n\r\n  return hasAppContentSearch\r\n    ? { data: appContentSearchQuery.data, isFetching: appContentSearchQuery.isFetching, error: appContentSearchQuery.error }\r\n    : {\r\n        isFetching: playlistQuery.isFetching,\r\n        error: playlistQuery.error,\r\n        data: playlistQuery.data,\r\n      };\r\n};\r\n","import { throttle } from '@jwp/ott-common/src/utils/common';\r\nimport useEventCallback from '@jwp/ott-hooks-react/src/useEventCallback';\r\nimport { useEffect, useMemo, useRef, useState } from 'react';\r\n\r\nimport styles from './LayoutGrid.module.scss';\r\n\r\ntype Props<Item> = {\r\n  className?: string;\r\n  columnCount: number;\r\n  data: Item[];\r\n  renderCell: (item: Item, tabIndex: number) => JSX.Element;\r\n  getCellKey: (item: Item) => string;\r\n};\r\n\r\nconst scrollIntoViewThrottled = throttle(function (focusedElement: HTMLElement) {\r\n  focusedElement.scrollIntoView({ behavior: 'smooth', block: 'center' });\r\n}, 300);\r\n\r\n// Keyboard-accessible grid layout, with focus management\r\nconst LayoutGrid = <Item extends object>({ className, columnCount, data, renderCell, getCellKey }: Props<Item>) => {\r\n  const [currentRowIndex, setCurrentRowIndex] = useState(0);\r\n  const [currentColumnIndex, setCurrentColumnIndex] = useState(0);\r\n  const gridRef = useRef<HTMLDivElement>(null);\r\n  const rowCount = Math.ceil(data.length / columnCount);\r\n\r\n  const focusGridCell = (rowIndex: number, columnIndex: number) => {\r\n    const gridCell = document.getElementById(`layout_grid_${rowIndex}-${columnIndex}`) as HTMLDivElement | null;\r\n    const focusableElement = gridCell?.querySelector('button, a, input, [tabindex]:not([tabindex=\"-1\"])') as HTMLElement | null;\r\n    const elementToFocus = focusableElement || gridCell;\r\n\r\n    setCurrentRowIndex(rowIndex);\r\n    setCurrentColumnIndex(columnIndex);\r\n\r\n    if (!elementToFocus) return;\r\n\r\n    elementToFocus.focus({ preventScroll: true });\r\n    scrollIntoViewThrottled(elementToFocus);\r\n  };\r\n\r\n  const handleKeyDown = useEventCallback((event: React.KeyboardEvent<HTMLDivElement>) => {\r\n    const { key, ctrlKey } = event;\r\n\r\n    if (!['ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown', 'Home', 'End', 'PageUp', 'PageDown'].includes(key)) return;\r\n\r\n    event.preventDefault();\r\n\r\n    const maxRow = rowCount - 1;\r\n    const isOnFirstColumn = currentColumnIndex === 0;\r\n    const isOnLastColumn = currentColumnIndex === columnCount - 1;\r\n    const isOnFirstRow = currentRowIndex === 0;\r\n    const isOnLastRow = currentRowIndex === maxRow;\r\n    const maxRightLastRow = (data.length % columnCount || columnCount) - 1; // Never go beyond last item\r\n    const maxRight = isOnLastRow ? maxRightLastRow : columnCount - 1;\r\n\r\n    const nextRowIndex = Math.min(currentRowIndex + 1, maxRow);\r\n    const previousRowIndex = Math.max(currentRowIndex - 1, 0);\r\n\r\n    switch (key) {\r\n      case 'ArrowLeft':\r\n        if (isOnFirstColumn && !isOnFirstRow) {\r\n          // Move to last of previous row\r\n          return focusGridCell(previousRowIndex, columnCount - 1);\r\n        }\r\n        return focusGridCell(currentRowIndex, Math.max(currentColumnIndex - 1, 0));\r\n      case 'ArrowRight':\r\n        if (isOnLastColumn && !isOnLastRow) {\r\n          // Move to first of next row\r\n          return focusGridCell(nextRowIndex, 0);\r\n        }\r\n        return focusGridCell(currentRowIndex, Math.min(currentColumnIndex + 1, maxRight));\r\n      case 'ArrowUp':\r\n        return focusGridCell(previousRowIndex, currentColumnIndex);\r\n      case 'ArrowDown':\r\n        return focusGridCell(nextRowIndex, nextRowIndex === maxRow ? Math.min(currentColumnIndex, maxRightLastRow) : currentColumnIndex);\r\n      case 'Home':\r\n        if (ctrlKey) {\r\n          return focusGridCell(0, 0);\r\n        }\r\n        return focusGridCell(currentRowIndex, 0);\r\n      case 'End':\r\n        if (ctrlKey) {\r\n          return focusGridCell(maxRow, maxRightLastRow);\r\n        }\r\n        return focusGridCell(currentRowIndex, maxRight);\r\n      case 'PageUp':\r\n        return focusGridCell(previousRowIndex, currentColumnIndex);\r\n      case 'PageDown':\r\n        return focusGridCell(nextRowIndex, nextRowIndex === maxRow ? Math.min(maxRightLastRow, currentColumnIndex) : currentColumnIndex);\r\n      default:\r\n        return;\r\n    }\r\n  });\r\n\r\n  // When the window size changes, correct indexes if necessary\r\n  useEffect(() => {\r\n    // the focused element is not within the grid element\r\n    if (!gridRef.current?.contains(document.activeElement)) {\r\n      return;\r\n    }\r\n\r\n    const maxRightLastRow = (data.length % columnCount || columnCount) - 1; // Never go beyond last item\r\n\r\n    if (currentColumnIndex > columnCount - 1) {\r\n      return focusGridCell(currentRowIndex, columnCount - 1);\r\n    }\r\n\r\n    if (currentRowIndex === rowCount - 1 && currentColumnIndex > maxRightLastRow) {\r\n      return focusGridCell(currentRowIndex, maxRightLastRow);\r\n    }\r\n    // this logic should only react when the column count changes\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [columnCount]);\r\n\r\n  const gridCellStyle = useMemo(() => ({ width: `${Math.floor((100 / columnCount) * 100) / 100}%` }), [columnCount]);\r\n\r\n  return (\r\n    <div role=\"grid\" ref={gridRef} aria-rowcount={rowCount} className={className} onKeyDown={handleKeyDown}>\r\n      {Array.from({ length: rowCount }).map((_, rowIndex) => (\r\n        <div role=\"row\" key={rowIndex} aria-rowindex={rowIndex + 1} className={styles.row}>\r\n          {data.slice(rowIndex * columnCount, rowIndex * columnCount + columnCount).map((item, columnIndex) => (\r\n            <div\r\n              role=\"gridcell\"\r\n              id={`layout_grid_${rowIndex}-${columnIndex}`}\r\n              key={getCellKey(item)}\r\n              aria-colindex={columnIndex + 1}\r\n              className={styles.cell}\r\n              style={gridCellStyle}\r\n            >\r\n              {renderCell(item, currentRowIndex === rowIndex && currentColumnIndex === columnIndex ? 0 : -1)}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LayoutGrid;\r\n","import React, { useCallback, useEffect, useState } from 'react';\r\nimport classNames from 'classnames';\r\nimport InfiniteScroll from 'react-infinite-scroller';\r\nimport type { Playlist, PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport type { AccessModel } from '@jwp/ott-common/types/config';\r\nimport { isLocked } from '@jwp/ott-common/src/utils/entitlements';\r\nimport { parseAspectRatio, parseTilesDelta } from '@jwp/ott-common/src/utils/collection';\r\nimport useBreakpoint, { Breakpoint, type Breakpoints } from '@jwp/ott-ui-react/src/hooks/useBreakpoint';\r\n\r\nimport Card from '../Card/Card';\r\nimport InfiniteScrollLoader from '../InfiniteScrollLoader/InfiniteScrollLoader';\r\nimport LayoutGrid from '../LayoutGrid/LayoutGrid';\r\nimport createInjectableComponent from '../../modules/createInjectableComponent';\r\n\r\nimport styles from './CardGrid.module.scss';\r\n\r\nconst INITIAL_ROW_COUNT = 6;\r\nconst LOAD_ROWS_COUNT = 4;\r\n\r\ntype VisibleTiles = 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10;\r\n\r\nconst defaultCols: Breakpoints = {\r\n  [Breakpoint.xs]: 2,\r\n  [Breakpoint.sm]: 2,\r\n  [Breakpoint.md]: 3,\r\n  [Breakpoint.lg]: 4,\r\n  [Breakpoint.xl]: 5,\r\n};\r\n\r\nexport const CardGridIdentifier = Symbol(`CARD_GRID`);\r\n\r\nexport type CardGridProps = {\r\n  playlist: Playlist;\r\n  watchHistory?: { [key: string]: number };\r\n  isLoading: boolean;\r\n  cols?: Breakpoints;\r\n  currentCardItem?: PlaylistItem;\r\n  currentCardLabel?: string;\r\n  accessModel: AccessModel;\r\n  isLoggedIn: boolean;\r\n  hasSubscription: boolean;\r\n  hasMore?: boolean;\r\n  headingLevel?: number;\r\n  loadMore?: () => void;\r\n  onCardHover?: (item: PlaylistItem) => void;\r\n  getUrl: (item: PlaylistItem) => string;\r\n};\r\n\r\nconst getCellKey = (item: PlaylistItem) => item.mediaid;\r\n\r\nfunction CardGrid({\r\n  playlist,\r\n  watchHistory,\r\n  isLoading = false,\r\n  cols = defaultCols,\r\n  currentCardItem,\r\n  currentCardLabel,\r\n  accessModel,\r\n  isLoggedIn,\r\n  hasSubscription,\r\n  hasMore,\r\n  getUrl,\r\n  loadMore,\r\n  onCardHover,\r\n  headingLevel,\r\n}: CardGridProps) {\r\n  const breakpoint: Breakpoint = useBreakpoint();\r\n  const posterAspect = parseAspectRatio(playlist.cardImageAspectRatio || playlist.shelfImageAspectRatio);\r\n  const visibleTiles = (cols[breakpoint] + parseTilesDelta(posterAspect)) as VisibleTiles;\r\n  const [rowCount, setRowCount] = useState(INITIAL_ROW_COUNT);\r\n\r\n  const defaultLoadMore = () => setRowCount((current) => current + LOAD_ROWS_COUNT);\r\n  const defaultHasMore = rowCount * visibleTiles < playlist.playlist.length;\r\n\r\n  useEffect(() => {\r\n    // reset row count when the page changes\r\n    setRowCount(INITIAL_ROW_COUNT);\r\n  }, [playlist.feedid]);\r\n\r\n  const renderCell = useCallback(\r\n    (playlistItem: PlaylistItem, tabIndex: number) => (\r\n      <Card\r\n        tabIndex={tabIndex}\r\n        progress={watchHistory ? watchHistory[playlistItem.mediaid] : undefined}\r\n        url={getUrl(playlistItem)}\r\n        onHover={typeof onCardHover === 'function' ? () => onCardHover(playlistItem) : undefined}\r\n        loading={isLoading}\r\n        isCurrent={currentCardItem && currentCardItem.mediaid === playlistItem.mediaid}\r\n        currentLabel={currentCardLabel}\r\n        isLocked={isLocked(accessModel, isLoggedIn, hasSubscription, playlistItem)}\r\n        posterAspect={posterAspect}\r\n        item={playlistItem}\r\n        headingLevel={headingLevel}\r\n      />\r\n    ),\r\n    [accessModel, currentCardItem, currentCardLabel, getUrl, hasSubscription, headingLevel, isLoading, isLoggedIn, onCardHover, posterAspect, watchHistory],\r\n  );\r\n\r\n  return (\r\n    <InfiniteScroll\r\n      pageStart={0}\r\n      loadMore={loadMore ?? defaultLoadMore}\r\n      hasMore={hasMore ?? defaultHasMore}\r\n      loader={<InfiniteScrollLoader key=\"loader\" />}\r\n      useWindow={false}\r\n    >\r\n      <LayoutGrid\r\n        className={classNames(styles.container, styles[`cols-${visibleTiles}`])}\r\n        data={loadMore ? playlist.playlist : playlist.playlist.slice(0, rowCount * visibleTiles)}\r\n        columnCount={visibleTiles}\r\n        renderCell={renderCell}\r\n        getCellKey={getCellKey}\r\n      />\r\n    </InfiniteScroll>\r\n  );\r\n}\r\n\r\nexport default createInjectableComponent(CardGridIdentifier, CardGrid);\r\n","import React, { useEffect, useMemo } from 'react';\r\nimport { useParams } from 'react-router';\r\nimport { Helmet } from 'react-helmet';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { useUIStore } from '@jwp/ott-common/src/stores/UIStore';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { mediaURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport useFirstRender from '@jwp/ott-hooks-react/src/useFirstRender';\r\nimport useSearchQueryUpdater from '@jwp/ott-ui-react/src/hooks/useSearchQueryUpdater';\r\nimport { useSearch } from '@jwp/ott-hooks-react/src/useSearch';\r\nimport useOpaqueId from '@jwp/ott-hooks-react/src/useOpaqueId';\r\n\r\nimport CardGrid from '../../components/CardGrid/CardGrid';\r\nimport ErrorPage from '../../components/ErrorPage/ErrorPage';\r\n\r\nimport styles from './Search.module.scss';\r\n\r\nconst Search = () => {\r\n  const { t } = useTranslation('search');\r\n  const { config, accessModel } = useConfigStore(({ config, accessModel }) => ({ config, accessModel }), shallow);\r\n  const { siteName, features } = config;\r\n  const headingId = useOpaqueId('search_heading');\r\n\r\n  const firstRender = useFirstRender();\r\n  const searchQuery = useUIStore((state) => state.searchQuery);\r\n  const { updateSearchQuery } = useSearchQueryUpdater();\r\n  const params = useParams();\r\n  const query = params['*'];\r\n  const { isFetching, error, data: playlist } = useSearch(query || '');\r\n\r\n  // User\r\n  const { user, subscription } = useAccountStore(({ user, subscription }) => ({ user, subscription }), shallow);\r\n\r\n  const getURL = (playlistItem: PlaylistItem) =>\r\n    mediaURL({\r\n      id: playlistItem.mediaid,\r\n      title: playlistItem.title,\r\n      playlistId: features?.searchPlaylist,\r\n    });\r\n\r\n  const title = useMemo(() => {\r\n    if (isFetching) return t('heading');\r\n    if (!query) return t('start_typing');\r\n    if (!playlist?.playlist.length) return t('no_results_heading', { query });\r\n\r\n    return t('title', { count: playlist.playlist.length, query });\r\n  }, [isFetching, playlist?.playlist.length, query, t]);\r\n\r\n  // Update the search bar query to match the route param on mount\r\n  useEffect(() => {\r\n    if (!firstRender) {\r\n      return;\r\n    }\r\n\r\n    if (query && query !== searchQuery) {\r\n      updateSearchQuery(query);\r\n    }\r\n  }, [firstRender, query, searchQuery, updateSearchQuery]);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      useUIStore.setState({\r\n        searchQuery: '',\r\n        searchActive: false,\r\n      });\r\n    };\r\n  }, []);\r\n\r\n  if ((error || !playlist) && !isFetching) {\r\n    return (\r\n      <ErrorPage title={t('error_heading')}>\r\n        <h2 className={styles.subHeading}>{t('error_subheading')}</h2>\r\n        <p>{t('error_description')}</p>\r\n      </ErrorPage>\r\n    );\r\n  }\r\n\r\n  if (!query) {\r\n    return <ErrorPage title={title} />;\r\n  }\r\n\r\n  if (!playlist?.playlist.length) {\r\n    return (\r\n      <>\r\n        <Helmet>\r\n          <title>\r\n            {title} - {siteName}\r\n          </title>\r\n        </Helmet>\r\n        <ErrorPage title={title}>\r\n          <h2 className={styles.subHeading}>{t('suggestions')}</h2>\r\n          <ul>\r\n            <li>{t('tip_one')}</li>\r\n            <li>{t('tip_two')}</li>\r\n            <li>{t('tip_three')}</li>\r\n          </ul>\r\n        </ErrorPage>\r\n      </>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={styles.search}>\r\n      <Helmet>\r\n        <title>\r\n          {title} - {siteName}\r\n        </title>\r\n      </Helmet>\r\n      <header className={styles.header}>\r\n        <h2 id={headingId} aria-live={isFetching ? undefined : 'polite'}>\r\n          {title}\r\n        </h2>\r\n      </header>\r\n      <CardGrid\r\n        aria-labelledby={headingId}\r\n        getUrl={getURL}\r\n        playlist={playlist}\r\n        isLoading={firstRender}\r\n        accessModel={accessModel}\r\n        isLoggedIn={!!user}\r\n        hasSubscription={!!subscription}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Search;\r\n","import * as React from \"react\";\nconst SvgAccountCircle = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M12,19.2C9.5,19.2 7.29,17.92 6,16C6.03,14 10,12.9 12,12.9C14,12.9 17.97,14 18,16C16.71,17.92 14.5,19.2 12,19.2M12,5A3,3 0 0,1 15,8A3,3 0 0,1 12,11A3,3 0 0,1 9,8A3,3 0 0,1 12,5M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z\" }));\nexport default SvgAccountCircle;\n","import * as React from \"react\";\nconst SvgBalanceWallet = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M5,3C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V16.72C21.59,16.37 22,15.74 22,15V9C22,8.26 21.59,7.63 21,7.28V5A2,2 0 0,0 19,3H5M5,5H19V7H13A2,2 0 0,0 11,9V15A2,2 0 0,0 13,17H19V19H5V5M13,9H20V15H13V9M16,10.5A1.5,1.5 0 0,0 14.5,12A1.5,1.5 0 0,0 16,13.5A1.5,1.5 0 0,0 17.5,12A1.5,1.5 0 0,0 16,10.5Z\" }));\nexport default SvgBalanceWallet;\n","import * as React from \"react\";\nconst SvgExit = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M19,3H5C3.89,3 3,3.89 3,5V9H5V5H19V19H5V15H3V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M10.08,15.58L11.5,17L16.5,12L11.5,7L10.08,8.41L12.67,11H3V13H12.67L10.08,15.58Z\" }));\nexport default SvgExit;\n","import * as React from \"react\";\nconst SvgFavorite = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\" }));\nexport default SvgFavorite;\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport useOpaqueId from '@jwp/ott-hooks-react/src/useOpaqueId';\r\n\r\nimport Dialog from '../Dialog/Dialog';\r\nimport Button from '../Button/Button';\r\n\r\nimport styles from './Alert.module.scss';\r\n\r\ntype Props = {\r\n  open: boolean;\r\n  message: string | null;\r\n  onClose: () => void;\r\n  isSuccess?: boolean;\r\n  actionsOverride?: React.ReactNode;\r\n  titleOverride?: string;\r\n};\r\n\r\nconst Alert: React.FC<Props> = ({ open, message, onClose, isSuccess, actionsOverride, titleOverride }: Props) => {\r\n  const { t } = useTranslation('common');\r\n  const headingId = useOpaqueId('alert-heading');\r\n\r\n  return (\r\n    <Dialog open={open} onClose={onClose} role=\"alertdialog\" aria-modal=\"true\" aria-labelledby={headingId}>\r\n      <h2 id={headingId} className={styles.title}>\r\n        {titleOverride ?? (isSuccess ? t('alert.success') : t('alert.title'))}\r\n      </h2>\r\n      <p className={styles.body}>{message}</p>\r\n      {actionsOverride ?? <Button label={t('alert.close')} variant=\"outlined\" onClick={onClose} fullWidth />}\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default Alert;\r\n","import React, { useCallback, useContext, type ReactElement, type ReactNode } from 'react';\r\nimport type { GenericFormValues } from '@jwp/ott-common/types/form';\r\nimport useOpaqueId from '@jwp/ott-hooks-react/src/useOpaqueId';\r\n\r\nimport Button from '../Button/Button';\r\nimport LoadingOverlay from '../LoadingOverlay/LoadingOverlay';\r\n\r\nimport styles from './Form.module.scss';\r\nimport { FormContext } from './Form';\r\n\r\nexport interface FormSectionContentArgs<T extends GenericFormValues, TErrors> {\r\n  values: T;\r\n  isEditing: boolean;\r\n  isBusy: boolean;\r\n  onChange: React.ChangeEventHandler<HTMLInputElement | HTMLTextAreaElement>;\r\n  errors?: TErrors | undefined;\r\n}\r\n\r\nexport interface FormSectionProps<TData extends GenericFormValues, TErrors> {\r\n  className?: string;\r\n  panelHeaderClassName?: string;\r\n  label: string;\r\n  editButton?: string | ReactElement;\r\n  saveButton?: string;\r\n  cancelButton?: string;\r\n  onSubmit?: (values: TData) => Promise<{ errors?: string[] }>;\r\n  content?: (args: FormSectionContentArgs<TData, TErrors>) => ReactNode;\r\n  children?: never;\r\n  readOnly?: boolean;\r\n}\r\n\r\nexport function FormSection<TData extends GenericFormValues>({\r\n  className,\r\n  panelHeaderClassName,\r\n  label,\r\n  editButton,\r\n  saveButton,\r\n  cancelButton,\r\n  onSubmit,\r\n  content,\r\n  readOnly = false,\r\n}: FormSectionProps<TData, string[]>): ReactElement<FormSectionProps<TData, string[]>> | null {\r\n  const sectionId = useOpaqueId(label);\r\n  const {\r\n    formState: { values, activeSectionId, errors: formErrors, isBusy },\r\n    setFormState,\r\n    isLoading,\r\n    onCancel,\r\n  } = useContext(FormContext) as FormContext<TData>;\r\n\r\n  const isEditing = sectionId === activeSectionId;\r\n\r\n  const onChange = useCallback(\r\n    ({ currentTarget }: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n      if (!currentTarget) return;\r\n\r\n      const { name, type } = currentTarget;\r\n      const value = type === 'checkbox' ? (currentTarget as HTMLInputElement).checked : currentTarget.value;\r\n\r\n      if (!isEditing) {\r\n        onCancel();\r\n      }\r\n\r\n      setFormState((oldState) => {\r\n        const newValues = { ...oldState.values };\r\n\r\n        // This logic handles nested names like 'consents.terms'\r\n        name.split('.').reduce((parent, field, index, arr) => {\r\n          if (index === arr.length - 1) {\r\n            parent[field] = value;\r\n          } else {\r\n            parent[field] = { ...parent[field] } || {};\r\n          }\r\n\r\n          return parent[field];\r\n        }, newValues);\r\n\r\n        return {\r\n          ...oldState,\r\n          values: newValues,\r\n          activeSectionId: sectionId,\r\n        };\r\n      });\r\n    },\r\n    [isEditing, onCancel, sectionId, setFormState],\r\n  );\r\n\r\n  const handleSubmit = useCallback(\r\n    async function handleSubmit(event?: React.FormEvent) {\r\n      event && event.preventDefault();\r\n\r\n      if (onSubmit) {\r\n        let response: { errors?: string[] };\r\n\r\n        try {\r\n          setFormState((s) => {\r\n            return { ...s, isBusy: true, errors: [] };\r\n          });\r\n          response = await onSubmit(values);\r\n        } catch (error: unknown) {\r\n          response = { errors: Array.of(error instanceof Error ? error.message : (error as string)) };\r\n        }\r\n\r\n        // Don't leave edit mode if there are errors\r\n        if (response?.errors?.length) {\r\n          setFormState((s) => {\r\n            return {\r\n              ...s,\r\n              errors: response?.errors,\r\n              isBusy: false,\r\n            };\r\n          });\r\n\r\n          return;\r\n        }\r\n      }\r\n\r\n      setFormState((s) => {\r\n        return {\r\n          ...s,\r\n          activeSectionId: undefined,\r\n          isBusy: false,\r\n        };\r\n      });\r\n    },\r\n    [onSubmit, setFormState, values],\r\n  );\r\n\r\n  const onEdit = useCallback(\r\n    function onEdit() {\r\n      if (!isEditing) {\r\n        onCancel();\r\n        setFormState((s) => {\r\n          return {\r\n            ...s,\r\n            activeSectionId: sectionId,\r\n          };\r\n        });\r\n      }\r\n    },\r\n    [isEditing, onCancel, sectionId, setFormState],\r\n  );\r\n\r\n  return (\r\n    <section aria-labelledby={sectionId} className={className}>\r\n      <div className={panelHeaderClassName}>\r\n        <h2 id={sectionId}>{label}</h2>\r\n      </div>\r\n      {isBusy && isEditing && <LoadingOverlay transparentBackground />}\r\n      {content && (\r\n        <form className={styles.flexBox} noValidate onSubmit={(event) => event.preventDefault()}>\r\n          {content({\r\n            values,\r\n            isEditing,\r\n            isBusy,\r\n            onChange,\r\n            ...(isEditing ? { errors: formErrors } : {}),\r\n          })}\r\n        </form>\r\n      )}\r\n      {(saveButton || editButton || cancelButton) && (\r\n        <div className={styles.controls}>\r\n          {isEditing ? (\r\n            <>\r\n              {saveButton && <Button label={saveButton} type=\"submit\" onClick={handleSubmit} disabled={isLoading} />}\r\n              {cancelButton && <Button label={cancelButton} type=\"reset\" variant=\"text\" onClick={onCancel} />}\r\n            </>\r\n          ) : (\r\n            !readOnly &&\r\n            editButton &&\r\n            (typeof editButton === 'object' ? (\r\n              (editButton as ReactElement)\r\n            ) : (\r\n              <Button label={editButton as string} type=\"button\" onClick={onEdit} disabled={isLoading} />\r\n            ))\r\n          )}\r\n        </div>\r\n      )}\r\n    </section>\r\n  );\r\n}\r\n","import React, { createContext, useCallback, useEffect, useState, type SetStateAction } from 'react';\r\nimport type { GenericFormValues } from '@jwp/ott-common/types/form';\r\n\r\nimport type { FormSectionProps } from './FormSection';\r\nimport { FormSection } from './FormSection';\r\n\r\ninterface Props<TData> {\r\n  initialValues: TData;\r\n  isLoading?: boolean;\r\n  onReset?: () => void;\r\n  children?: FormSectionProps<TData, string[]>[];\r\n}\r\n\r\nexport interface FormContext<TData> {\r\n  isLoading?: boolean;\r\n  onCancel: () => void;\r\n  formState: FormState<TData>;\r\n  setFormState: React.Dispatch<SetStateAction<FormState<TData>>>;\r\n}\r\n\r\ninterface FormState<TData> {\r\n  values: TData;\r\n  activeSectionId: string | undefined;\r\n  isDirty: boolean;\r\n  isBusy: boolean;\r\n  errors?: string[];\r\n}\r\n\r\nexport const FormContext = createContext<FormContext<GenericFormValues> | undefined>(undefined);\r\n\r\nfunction Form<TData extends GenericFormValues>({ isLoading, initialValues, onReset, children }: Props<TData>): JSX.Element {\r\n  const [state, setState] = useState<FormState<TData>>({\r\n    values: initialValues,\r\n    activeSectionId: undefined,\r\n    isDirty: false,\r\n    isBusy: false,\r\n  });\r\n\r\n  const onCancel = useCallback(\r\n    function onCancel() {\r\n      setState((s) => {\r\n        return {\r\n          ...s,\r\n          values: initialValues,\r\n          isDirty: false,\r\n          activeSectionId: undefined,\r\n          success: false,\r\n          errors: undefined,\r\n        };\r\n      });\r\n      onReset && onReset();\r\n    },\r\n    [initialValues, onReset],\r\n  );\r\n\r\n  useEffect(() => {\r\n    // Don't overwrite values if a section is being edited, since that would wipe out anything the user has entered\r\n    if (!state.activeSectionId) {\r\n      setState((s) => {\r\n        return {\r\n          ...s,\r\n          values: initialValues,\r\n        };\r\n      });\r\n    }\r\n  }, [initialValues, state.activeSectionId]);\r\n\r\n  return (\r\n    <FormContext.Provider\r\n      value={{\r\n        isLoading,\r\n        onCancel,\r\n        formState: state,\r\n        setFormState: setState,\r\n      }}\r\n    >\r\n      {children?.map((props, i) => (\r\n        <FormSection<TData> key={i} {...props} />\r\n      ))}\r\n    </FormContext.Provider>\r\n  );\r\n}\r\n\r\nexport default Form;\r\n","import React, { useEffect, useMemo, useState } from 'react';\r\nimport { Trans, useTranslation } from 'react-i18next';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport DOMPurify from 'dompurify';\r\nimport { useMutation } from 'react-query';\r\nimport type { CustomFormField } from '@jwp/ott-common/types/account';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport { isTruthy, isTruthyCustomParamValue, testId } from '@jwp/ott-common/src/utils/common';\r\nimport { logError } from '@jwp/ott-common/src/logger';\r\nimport { formatConsents, formatConsentsFromValues, formatConsentsToRegisterFields, formatConsentValues } from '@jwp/ott-common/src/utils/collection';\r\nimport useToggle from '@jwp/ott-hooks-react/src/useToggle';\r\nimport Visibility from '@jwp/ott-theme/assets/icons/visibility.svg?react';\r\nimport VisibilityOff from '@jwp/ott-theme/assets/icons/visibility_off.svg?react';\r\nimport env from '@jwp/ott-common/src/env';\r\n\r\nimport type { FormSectionContentArgs, FormSectionProps } from '../Form/FormSection';\r\nimport Alert from '../Alert/Alert';\r\nimport Button from '../Button/Button';\r\nimport Form from '../Form/Form';\r\nimport IconButton from '../IconButton/IconButton';\r\nimport FormFeedback from '../FormFeedback/FormFeedback';\r\nimport TextField from '../form-fields/TextField/TextField';\r\nimport Checkbox from '../form-fields/Checkbox/Checkbox';\r\nimport CustomRegisterField from '../CustomRegisterField/CustomRegisterField';\r\nimport Icon from '../Icon/Icon';\r\nimport { modalURLFromLocation } from '../../utils/location';\r\nimport { useAriaAnnouncer } from '../../containers/AnnouncementProvider/AnnoucementProvider';\r\n\r\nimport styles from './Account.module.scss';\r\n\r\ntype Props = {\r\n  panelClassName?: string;\r\n  panelHeaderClassName?: string;\r\n  canUpdateEmail?: boolean;\r\n};\r\n\r\ninterface FormErrors {\r\n  email?: string;\r\n  confirmationPassword?: string;\r\n  firstName?: string;\r\n  lastName?: string;\r\n  form?: string;\r\n}\r\n\r\nconst Account = ({ panelClassName, panelHeaderClassName, canUpdateEmail = true }: Props): JSX.Element => {\r\n  const accountController = getModule(AccountController);\r\n\r\n  const { t, i18n } = useTranslation('user');\r\n  const announce = useAriaAnnouncer();\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const [viewPassword, toggleViewPassword] = useToggle();\r\n  const exportData = useMutation(accountController.exportAccountData);\r\n  const [isAlertVisible, setIsAlertVisible] = useState(false);\r\n  const exportDataMessage = exportData.isSuccess ? t('account.export_data_success') : t('account.export_data_error');\r\n  const htmlLang = i18n.language !== env.APP_DEFAULT_LANGUAGE ? env.APP_DEFAULT_LANGUAGE : undefined;\r\n\r\n  useEffect(() => {\r\n    if (exportData.isSuccess || exportData.isError) {\r\n      setIsAlertVisible(true);\r\n    }\r\n  }, [exportData.isSuccess, exportData.isError]);\r\n\r\n  const { customer, customerConsents, publisherConsents } = useAccountStore(\r\n    ({ user, customerConsents, publisherConsents }) => ({\r\n      customer: user,\r\n      customerConsents,\r\n      publisherConsents,\r\n    }),\r\n    shallow,\r\n  );\r\n\r\n  const { canChangePasswordWithOldPassword, canExportAccountData, canDeleteAccount } = accountController.getFeatures();\r\n  // users authenticated with social (register_source: facebook, google, twitter) do not have password by default\r\n  const registerSource = customer?.metadata?.register_source;\r\n  const isSocialLogin = (registerSource && registerSource !== 'inplayer') || false;\r\n  const shouldAddPassword = (isSocialLogin && !customer?.metadata?.has_password) || false;\r\n\r\n  // load consents (move to `useConsents` hook?)\r\n  useEffect(() => {\r\n    if (!publisherConsents) {\r\n      accountController.getPublisherConsents();\r\n\r\n      return;\r\n    }\r\n  }, [accountController, publisherConsents]);\r\n\r\n  const [termsConsents, nonTermsConsents] = useMemo(() => {\r\n    const terms: CustomFormField[] = [];\r\n    const nonTerms: CustomFormField[] = [];\r\n\r\n    publisherConsents?.forEach((consent) => {\r\n      if (!consent?.type || consent?.type === 'checkbox') {\r\n        terms.push(consent);\r\n      } else {\r\n        nonTerms.push(consent);\r\n      }\r\n    });\r\n\r\n    return [terms, nonTerms];\r\n  }, [publisherConsents]);\r\n\r\n  const consents = useMemo(() => formatConsents(publisherConsents, customerConsents), [publisherConsents, customerConsents]);\r\n\r\n  const consentsValues = useMemo(() => formatConsentValues(publisherConsents, customerConsents), [publisherConsents, customerConsents]);\r\n\r\n  const initialValues = useMemo(\r\n    () => ({\r\n      ...customer,\r\n      consents,\r\n      consentsValues,\r\n      confirmationPassword: '',\r\n    }),\r\n    [customer, consents, consentsValues],\r\n  );\r\n\r\n  const formatConsentLabel = (label: string): string | JSX.Element => {\r\n    const sanitizedLabel = DOMPurify.sanitize(label);\r\n    const hasHrefOpenTag = /<a(.|\\n)*?>/.test(sanitizedLabel);\r\n    const hasHrefCloseTag = /<\\/a(.|\\n)*?>/.test(sanitizedLabel);\r\n\r\n    if (hasHrefOpenTag && hasHrefCloseTag) {\r\n      return <span dangerouslySetInnerHTML={{ __html: label }} />;\r\n    }\r\n\r\n    return label;\r\n  };\r\n\r\n  function translateErrors(errors?: string[]): FormErrors {\r\n    const formErrors: FormErrors = {};\r\n    // Some errors are combined in a single CSV string instead of one string per error\r\n    errors\r\n      ?.flatMap((e) => e.split(','))\r\n      .forEach((error) => {\r\n        switch (error.trim()) {\r\n          case 'Invalid param email':\r\n            formErrors.form = t('account.errors.validation_error');\r\n            formErrors.email = t('account.errors.invalid_param_email');\r\n            break;\r\n          case 'Customer email already exists':\r\n            formErrors.form = t('account.errors.validation_error');\r\n            formErrors.email = t('account.errors.email_exists');\r\n            break;\r\n          case 'Please enter a valid e-mail address.':\r\n            formErrors.form = t('account.errors.validation_error');\r\n            formErrors.email = t('account.errors.please_enter_valid_email');\r\n            break;\r\n          case 'Invalid confirmationPassword': {\r\n            formErrors.form = t('account.errors.validation_error');\r\n            formErrors.confirmationPassword = t('account.errors.invalid_password');\r\n            break;\r\n          }\r\n          case 'firstName can have max 50 characters.': {\r\n            formErrors.form = t('account.errors.validation_error');\r\n            formErrors.firstName = t('account.errors.first_name_too_long');\r\n            break;\r\n          }\r\n          case 'lastName can have max 50 characters.': {\r\n            formErrors.form = t('account.errors.validation_error');\r\n            formErrors.lastName = t('account.errors.last_name_too_long');\r\n            break;\r\n          }\r\n          case 'Email update not supported': {\r\n            formErrors.form = t('account.errors.email_update_not_supported');\r\n            break;\r\n          }\r\n          case 'Wrong email/password combination': {\r\n            formErrors.form = t('account.errors.wrong_combination');\r\n            break;\r\n          }\r\n          default: {\r\n            formErrors.form = t('account.errors.unknown_error');\r\n            logError('Account', 'Unknown error', { error });\r\n            break;\r\n          }\r\n        }\r\n      });\r\n\r\n    return formErrors;\r\n  }\r\n\r\n  function formSection(props: FormSectionProps<typeof initialValues, FormErrors>) {\r\n    return {\r\n      ...props,\r\n      className: panelClassName,\r\n      panelHeaderClassName: panelHeaderClassName,\r\n      saveButton: t('account.save'),\r\n      cancelButton: t('account.cancel'),\r\n      content: (args: FormSectionContentArgs<typeof initialValues, string[]>) => {\r\n        // This function just allows the sections below to use the FormError type instead of an array of errors\r\n        const formErrors = translateErrors(args.errors);\r\n\r\n        // Render the section content, but also add a warning text if there's a form level error\r\n        return (\r\n          <>\r\n            {formErrors?.form ? <FormFeedback variant=\"error\">{formErrors.form}</FormFeedback> : null}\r\n            {props.content?.({ ...args, errors: formErrors })}\r\n          </>\r\n        );\r\n      },\r\n    };\r\n  }\r\n\r\n  const editPasswordClickHandler = async () => {\r\n    if (!customer) {\r\n      return;\r\n    }\r\n    if (isSocialLogin && shouldAddPassword) {\r\n      await accountController.resetPassword(customer.email, '');\r\n      return navigate(modalURLFromLocation(location, 'add-password'));\r\n    }\r\n\r\n    navigate(modalURLFromLocation(location, canChangePasswordWithOldPassword ? 'edit-password' : 'reset-password'));\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <h1 className=\"hideUntilFocus\">{t('nav.account')}</h1>\r\n\r\n      <Form initialValues={initialValues}>\r\n        {[\r\n          formSection({\r\n            label: t('account.about_you'),\r\n            editButton: t('account.edit_information'),\r\n            onSubmit: async (values) => {\r\n              const consents = formatConsentsFromValues(publisherConsents, { ...values.metadata, ...values.consentsValues });\r\n\r\n              const response = await accountController.updateUser({\r\n                firstName: values.firstName || '',\r\n                lastName: values.lastName || '',\r\n                metadata: {\r\n                  ...values.metadata,\r\n                  ...formatConsentsToRegisterFields(consents),\r\n                  consents: JSON.stringify(consents),\r\n                },\r\n              });\r\n\r\n              announce(t('account.update_success', { section: t('account.about_you') }), 'success');\r\n\r\n              return response;\r\n            },\r\n            content: (section) => (\r\n              <>\r\n                <TextField\r\n                  name=\"firstName\"\r\n                  label={t('account.firstname')}\r\n                  value={section.values.firstName || ''}\r\n                  onChange={section.onChange}\r\n                  error={!!section.errors?.firstName}\r\n                  helperText={section.errors?.firstName}\r\n                  disabled={section.isBusy}\r\n                  editing={section.isEditing}\r\n                  autoComplete=\"given-name\"\r\n                  lang={htmlLang}\r\n                />\r\n                <TextField\r\n                  name=\"lastName\"\r\n                  label={t('account.lastname')}\r\n                  value={section.values.lastName || ''}\r\n                  onChange={section.onChange}\r\n                  error={!!section.errors?.lastName}\r\n                  helperText={section.errors?.lastName}\r\n                  disabled={section.isBusy}\r\n                  editing={section.isEditing}\r\n                  autoComplete=\"family-name\"\r\n                  lang={htmlLang}\r\n                />\r\n              </>\r\n            ),\r\n          }),\r\n          formSection({\r\n            label: t('account.email'),\r\n            onSubmit: async (values) => {\r\n              if (!values.email || !values.confirmationPassword) {\r\n                throw new Error('Wrong email/password combination');\r\n              }\r\n              const response = await accountController.updateUser({\r\n                email: values.email || '',\r\n                confirmationPassword: values.confirmationPassword,\r\n              });\r\n\r\n              announce(t('account.update_success', { section: t('account.email') }), 'success');\r\n\r\n              return response;\r\n            },\r\n            editButton: t('account.edit_account'),\r\n            readOnly: !canUpdateEmail,\r\n            content: (section) => (\r\n              <>\r\n                <TextField\r\n                  name=\"email\"\r\n                  label={t('account.email')}\r\n                  value={section.values.email || ''}\r\n                  onChange={section.onChange}\r\n                  error={!!section.errors?.email}\r\n                  helperText={section.errors?.email}\r\n                  disabled={section.isBusy}\r\n                  editing={section.isEditing}\r\n                  autoComplete=\"email\"\r\n                  required\r\n                />\r\n                {section.isEditing && (\r\n                  <TextField\r\n                    name=\"confirmationPassword\"\r\n                    label={t('account.confirm_password')}\r\n                    value={section.values.confirmationPassword}\r\n                    onChange={section.onChange}\r\n                    error={!!section.errors?.confirmationPassword}\r\n                    helperText={section.errors?.confirmationPassword}\r\n                    type={viewPassword ? 'text' : 'password'}\r\n                    disabled={section.isBusy}\r\n                    autoComplete=\"current-password\"\r\n                    rightControl={\r\n                      <IconButton aria-label={t('account.view_password')} onClick={() => toggleViewPassword()} aria-pressed={viewPassword}>\r\n                        <Icon icon={viewPassword ? Visibility : VisibilityOff} />\r\n                      </IconButton>\r\n                    }\r\n                    required\r\n                  />\r\n                )}\r\n              </>\r\n            ),\r\n          }),\r\n          formSection({\r\n            label: t('account.security'),\r\n            editButton: (\r\n              <Button\r\n                label={shouldAddPassword ? t('account.add_password') : t('account.edit_password')}\r\n                type=\"button\"\r\n                onClick={() => (customer ? editPasswordClickHandler() : null)}\r\n              />\r\n            ),\r\n          }),\r\n          formSection({\r\n            label: t('account.terms_and_tracking'),\r\n            saveButton: t('account.update_consents'),\r\n            onSubmit: async (values) => {\r\n              const response = await accountController.updateConsents(formatConsentsFromValues(publisherConsents, values.consentsValues));\r\n\r\n              announce(t('account.update_success', { section: t('account.terms_and_tracking') }), 'success');\r\n\r\n              return response;\r\n            },\r\n            content: (section) => (\r\n              <>\r\n                {termsConsents?.map((consent, index) => (\r\n                  <Checkbox\r\n                    key={index}\r\n                    name={`consentsValues.${consent.name}`}\r\n                    checked={isTruthyCustomParamValue(section.values.consentsValues?.[consent.name])}\r\n                    onChange={section.onChange}\r\n                    checkboxLabel={formatConsentLabel(consent.label)}\r\n                    disabled={consent.required || section.isBusy}\r\n                    required={consent.required}\r\n                    lang={htmlLang}\r\n                  />\r\n                ))}\r\n              </>\r\n            ),\r\n          }),\r\n          nonTermsConsents?.length &&\r\n            formSection({\r\n              label: t('account.other_registration_details'),\r\n              saveButton: t('account.update_consents'),\r\n              onSubmit: (values) => accountController.updateConsents(formatConsentsFromValues(publisherConsents, values.consentsValues)),\r\n              content: (section) => (\r\n                <div className={styles.customFields} data-testid={testId('custom-reg-fields')}>\r\n                  {nonTermsConsents.map((consent) => (\r\n                    <CustomRegisterField\r\n                      key={consent.name}\r\n                      type={consent.type}\r\n                      name={`consentsValues.${consent.name}`}\r\n                      options={consent.options}\r\n                      label={formatConsentLabel(consent.label)}\r\n                      placeholder={consent.placeholder}\r\n                      value={section.values.consentsValues[consent.name]}\r\n                      disabled={(consent.type === 'checkbox' && consent.required) || section.isBusy}\r\n                      onChange={section.onChange}\r\n                      required={consent.required}\r\n                    />\r\n                  ))}\r\n                </div>\r\n              ),\r\n            }),\r\n          canExportAccountData &&\r\n            formSection({\r\n              label: t('account.export_data_title'),\r\n              content: (section) => (\r\n                <div className={styles.textWithButtonContainer}>\r\n                  <div>\r\n                    <Trans t={t} i18nKey=\"account.export_data_body\" values={{ email: section.values.email }} />\r\n                  </div>\r\n                  <div>\r\n                    <Button\r\n                      label={t('account.export_data_title')}\r\n                      type=\"button\"\r\n                      disabled={exportData.isLoading}\r\n                      onClick={async () => {\r\n                        exportData.mutate();\r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              ),\r\n            }),\r\n          canDeleteAccount &&\r\n            formSection({\r\n              label: t('account.delete_account.title'),\r\n              content: () => (\r\n                <div className={styles.textWithButtonContainer}>\r\n                  <div>{t('account.delete_account.body')}</div>\r\n                  <div>\r\n                    <Button\r\n                      label={t('account.delete_account.title')}\r\n                      type=\"button\"\r\n                      variant=\"danger\"\r\n                      onClick={() => {\r\n                        navigate(modalURLFromLocation(location, shouldAddPassword ? 'warning-account-deletion' : 'delete-account'));\r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              ),\r\n            }),\r\n        ].filter(isTruthy)}\r\n      </Form>\r\n      {canExportAccountData && (\r\n        <Alert open={isAlertVisible} message={exportDataMessage} onClose={() => setIsAlertVisible(false)} isSuccess={exportData.isSuccess} />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Account;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport type { AccessModel } from '@jwp/ott-common/types/config';\r\nimport type { Playlist, PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { mediaURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport { Breakpoint, type Breakpoints } from '@jwp/ott-ui-react/src/hooks/useBreakpoint';\r\n\r\nimport Button from '../Button/Button';\r\nimport CardGrid from '../CardGrid/CardGrid';\r\n\r\nimport styles from './Favorites.module.scss';\r\n\r\ntype Props = {\r\n  playlist: Playlist;\r\n  accessModel: AccessModel;\r\n  hasSubscription: boolean;\r\n  onCardHover?: (item: PlaylistItem) => void;\r\n  onClearFavoritesClick: () => void;\r\n};\r\n\r\nconst cols: Breakpoints = {\r\n  [Breakpoint.xs]: 2,\r\n  [Breakpoint.sm]: 3,\r\n  [Breakpoint.md]: 3,\r\n  [Breakpoint.lg]: 3,\r\n  [Breakpoint.xl]: 3,\r\n};\r\n\r\nconst Favorites = ({ playlist, accessModel, hasSubscription, onCardHover, onClearFavoritesClick }: Props): JSX.Element => {\r\n  const { t } = useTranslation('user');\r\n  const getURL = (playlistItem: PlaylistItem) => mediaURL({ id: playlistItem.mediaid, title: playlistItem.title, playlistId: playlistItem.feedid });\r\n\r\n  return (\r\n    <div>\r\n      <div className={styles.header}>\r\n        <h1>{t('favorites.title')}</h1>\r\n        {playlist.playlist.length > 0 ? <Button label={t('favorites.clear')} onClick={onClearFavoritesClick} /> : null}\r\n      </div>\r\n      {playlist.playlist.length > 0 ? (\r\n        <CardGrid\r\n          getUrl={getURL}\r\n          playlist={playlist}\r\n          onCardHover={onCardHover}\r\n          cols={cols}\r\n          isLoading={false}\r\n          accessModel={accessModel}\r\n          isLoggedIn={true}\r\n          hasSubscription={hasSubscription}\r\n        />\r\n      ) : (\r\n        <p>{t('favorites.no_favorites')}</p>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Favorites;\r\n","import { useMutation } from 'react-query';\r\nimport type { Customer } from '@jwp/ott-common/types/account';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport CheckoutController from '@jwp/ott-common/src/controllers/CheckoutController';\r\n\r\nexport const useSubscriptionChange = (\r\n  isUpgradeOffer: boolean,\r\n  selectedOfferId: string | null,\r\n  customer: Customer | null,\r\n  activeSubscriptionId: string | number | undefined,\r\n) => {\r\n  const accountController = getModule(AccountController);\r\n  const checkoutController = getModule(CheckoutController);\r\n\r\n  const updateSubscriptionMetadata = useMutation(accountController.updateUser, {\r\n    onSuccess: () => {\r\n      useAccountStore.setState({\r\n        loading: false,\r\n      });\r\n    },\r\n  });\r\n\r\n  return useMutation(checkoutController.changeSubscription, {\r\n    onSuccess: () => {\r\n      if (!isUpgradeOffer && selectedOfferId) {\r\n        updateSubscriptionMetadata.mutate({\r\n          firstName: customer?.firstName || '',\r\n          lastName: customer?.lastName || '',\r\n          metadata: {\r\n            [`${activeSubscriptionId}_pending_downgrade`]: selectedOfferId,\r\n          },\r\n        });\r\n      }\r\n    },\r\n  });\r\n};\r\n","import * as React from \"react\";\nconst SvgExternalLink = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z\" }));\nexport default SvgExternalLink;\n","import classNames from 'classnames';\r\nimport { useTranslation } from 'react-i18next';\r\nimport type { Offer } from '@jwp/ott-common/types/checkout';\r\nimport { formatLocalizedDate, formatPrice } from '@jwp/ott-common/src/utils/formatting';\r\n\r\nimport Checkbox from '../form-fields/Checkbox/Checkbox';\r\n\r\nimport styles from './OfferSwitch.module.scss';\r\n\r\ntype OfferSwitchProps = {\r\n  isCurrentOffer: boolean;\r\n  pendingDowngradeOfferId: string;\r\n  offer: Offer;\r\n  selected: boolean;\r\n  onChange: (offerId: string) => void;\r\n  expiresAt: number | undefined;\r\n};\r\n\r\nconst OfferSwitch = ({ isCurrentOffer, pendingDowngradeOfferId, offer, selected, onChange, expiresAt }: OfferSwitchProps) => {\r\n  const { t, i18n } = useTranslation(['user', 'account']);\r\n  const { customerPriceInclTax, customerCurrency, period } = offer;\r\n\r\n  const isPendingDowngrade = pendingDowngradeOfferId === offer.offerId;\r\n\r\n  return (\r\n    <div className={classNames(styles.offerSwitchContainer, { [styles.activeOfferSwitchContainer]: selected })}>\r\n      <Checkbox disabled={isPendingDowngrade} name={offer.offerId} checked={selected} onChange={() => onChange(offer.offerId)} />\r\n      <div className={styles.offerSwitchInfoContainer}>\r\n        {(isCurrentOffer || isPendingDowngrade) && (\r\n          <div className={classNames(styles.currentPlanHeading, { [styles.activeCurrentPlanHeading]: selected })}>\r\n            {isCurrentOffer && t('user:payment.current_plan').toUpperCase()}\r\n            {isPendingDowngrade && t('user:payment.pending_downgrade').toUpperCase()}\r\n          </div>\r\n        )}\r\n        <div className={styles.offerSwitchPlanContainer}>\r\n          <div>{t(`user:payment.${period === 'month' ? 'monthly' : 'annual'}_subscription`)}</div>\r\n          {(isCurrentOffer || isPendingDowngrade) && expiresAt && (\r\n            <div className={styles.nextBillingDate}>\r\n              {isCurrentOffer &&\r\n                !pendingDowngradeOfferId &&\r\n                t('user:payment.next_billing_date_on', { date: formatLocalizedDate(new Date(expiresAt * 1000), i18n.language) })}\r\n              {isPendingDowngrade && t('user:payment.downgrade_on', { date: formatLocalizedDate(new Date(expiresAt * 1000), i18n.language) })}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n      <div className={styles.price}>\r\n        {formatPrice(customerPriceInclTax, customerCurrency, undefined)}\r\n        <span className={styles.paymentFrequency}>/{t(`account:periods.${period}_one`)}</span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OfferSwitch;\r\n","import React, { useEffect, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport type { AccessModel } from '@jwp/ott-common/types/config';\r\nimport type { Customer } from '@jwp/ott-common/types/account';\r\nimport type { Offer } from '@jwp/ott-common/types/checkout';\r\nimport type { PaymentDetail, Subscription, Transaction } from '@jwp/ott-common/types/subscription';\r\nimport { formatLocalizedDate, formatPrice } from '@jwp/ott-common/src/utils/formatting';\r\nimport { ACCESS_MODEL } from '@jwp/ott-common/src/constants';\r\nimport ExternalLink from '@jwp/ott-theme/assets/icons/external_link.svg?react';\r\nimport PayPal from '@jwp/ott-theme/assets/icons/paypal.svg?react';\r\nimport useBreakpoint, { Breakpoint } from '@jwp/ott-ui-react/src/hooks/useBreakpoint';\r\nimport useOpaqueId from '@jwp/ott-hooks-react/src/useOpaqueId';\r\nimport classNames from 'classnames';\r\n\r\nimport IconButton from '../IconButton/IconButton';\r\nimport Alert from '../Alert/Alert';\r\nimport Button from '../Button/Button';\r\nimport LoadingOverlay from '../LoadingOverlay/LoadingOverlay';\r\nimport OfferSwitch from '../OfferSwitch/OfferSwitch';\r\nimport TextField from '../form-fields/TextField/TextField';\r\nimport Icon from '../Icon/Icon';\r\nimport Link from '../Link/Link';\r\nimport { modalURLFromLocation } from '../../utils/location';\r\n\r\nimport styles from './Payment.module.scss';\r\n\r\nconst VISIBLE_TRANSACTIONS = 4;\r\n\r\ntype Props = {\r\n  accessModel: AccessModel;\r\n  activeSubscription: Subscription | null;\r\n  activePaymentDetail: PaymentDetail | null;\r\n  transactions: Transaction[] | null;\r\n  customer: Customer;\r\n  pendingOffer: Offer | null;\r\n  isLoading: boolean;\r\n  offerSwitchesAvailable: boolean;\r\n  onShowReceiptClick: (transactionId: string) => void;\r\n  panelClassName?: string;\r\n  panelHeaderClassName?: string;\r\n  onShowAllTransactionsClick?: () => void;\r\n  onUpgradeSubscriptionClick?: () => void;\r\n  showAllTransactions: boolean;\r\n  canUpdatePaymentMethod: boolean;\r\n  canRenewSubscription?: boolean;\r\n  canShowReceipts?: boolean;\r\n  offers?: Offer[];\r\n  pendingDowngradeOfferId?: string;\r\n  changeSubscriptionPlan: {\r\n    isLoading: boolean;\r\n    isError: boolean;\r\n    isSuccess: boolean;\r\n    reset: () => void;\r\n  };\r\n  onChangePlanClick: () => void;\r\n  selectedOfferId: string | null;\r\n  setSelectedOfferId: (offerId: string | null) => void;\r\n  isUpgradeOffer: boolean | undefined;\r\n  setIsUpgradeOffer: (isUpgradeOffer: boolean | undefined) => void;\r\n  isExternalPaymentProvider: boolean;\r\n  paymentProvider?: string;\r\n  paymentProviderLink?: string;\r\n};\r\n\r\nconst Payment = ({\r\n  accessModel,\r\n  activePaymentDetail,\r\n  activeSubscription,\r\n  pendingOffer,\r\n  transactions,\r\n  customer,\r\n  isLoading,\r\n  panelClassName,\r\n  panelHeaderClassName,\r\n  onShowAllTransactionsClick,\r\n  showAllTransactions,\r\n  onShowReceiptClick,\r\n  canRenewSubscription = false,\r\n  canShowReceipts = false,\r\n  canUpdatePaymentMethod,\r\n  onUpgradeSubscriptionClick,\r\n  offerSwitchesAvailable,\r\n  offers = [],\r\n  pendingDowngradeOfferId = '',\r\n  changeSubscriptionPlan,\r\n  onChangePlanClick,\r\n  selectedOfferId,\r\n  setSelectedOfferId,\r\n  isUpgradeOffer,\r\n  setIsUpgradeOffer,\r\n  isExternalPaymentProvider,\r\n  paymentProvider,\r\n  paymentProviderLink,\r\n}: Props): JSX.Element => {\r\n  const subscriptionDetailsId = useOpaqueId('subscription-details');\r\n  const paymentMethodId = useOpaqueId('payment-method');\r\n  const billingHistoryId = useOpaqueId('billing-history');\r\n  const { t, i18n } = useTranslation(['user', 'account']);\r\n  const hiddenTransactionsCount = transactions ? transactions?.length - VISIBLE_TRANSACTIONS : 0;\r\n  const hasMoreTransactions = hiddenTransactionsCount > 0;\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const isGrantedSubscription = activeSubscription?.period === 'granted';\r\n  const breakpoint = useBreakpoint();\r\n  const isMobile = breakpoint === Breakpoint.xs;\r\n\r\n  const [isChangingOffer, setIsChangingOffer] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isChangingOffer) {\r\n      setSelectedOfferId(activeSubscription?.accessFeeId ?? null);\r\n    }\r\n  }, [activeSubscription, isChangingOffer, setSelectedOfferId]);\r\n\r\n  useEffect(() => {\r\n    setIsChangingOffer(false);\r\n  }, [activeSubscription?.status, activeSubscription?.pendingSwitchId]);\r\n\r\n  useEffect(() => {\r\n    if (selectedOfferId && offers) {\r\n      setIsUpgradeOffer(\r\n        (offers.find((offer) => offer.offerId === selectedOfferId)?.customerPriceInclTax ?? 0) >\r\n          (offers.find((offer) => offer.offerId === activeSubscription?.accessFeeId)?.customerPriceInclTax ?? 0),\r\n      );\r\n    }\r\n  }, [selectedOfferId, offers, activeSubscription, setIsUpgradeOffer]);\r\n\r\n  function onCompleteSubscriptionClick() {\r\n    navigate(modalURLFromLocation(location, 'choose-offer'));\r\n  }\r\n\r\n  function onEditCardDetailsClick() {\r\n    navigate(modalURLFromLocation(location, 'edit-card'));\r\n  }\r\n\r\n  function onCancelSubscriptionClick() {\r\n    navigate(modalURLFromLocation(location, 'unsubscribe'));\r\n  }\r\n\r\n  function onRenewSubscriptionClick() {\r\n    navigate(modalURLFromLocation(location, 'renew-subscription'));\r\n  }\r\n\r\n  function getTitle(period: Subscription['period']) {\r\n    switch (period) {\r\n      case 'month':\r\n        return t('user:payment.monthly_subscription');\r\n      case 'year':\r\n        return t('user:payment.annual_subscription');\r\n      case 'day':\r\n        return t('user:payment.daily_subscription');\r\n      case 'week':\r\n        return t('user:payment.weekly_subscription');\r\n      case 'granted':\r\n        return t('user:payment.granted_subscription');\r\n      default:\r\n        return t('user:payment.other');\r\n    }\r\n  }\r\n\r\n  const showChangeSubscriptionButton = (!isExternalPaymentProvider && offerSwitchesAvailable) || (!isChangingOffer && !canRenewSubscription);\r\n\r\n  return (\r\n    <>\r\n      <Alert\r\n        isSuccess={!changeSubscriptionPlan.isError}\r\n        message={\r\n          !changeSubscriptionPlan.isError\r\n            ? isUpgradeOffer\r\n              ? t('user:payment.upgrade_plan_success')\r\n              : t('user:payment.downgrade_plan_success', {\r\n                  date: activeSubscription?.expiresAt && formatLocalizedDate(new Date(activeSubscription.expiresAt * 1000), i18n.language),\r\n                })\r\n            : t('user:payment.change_plan_error')\r\n        }\r\n        open={isChangingOffer && (changeSubscriptionPlan.isSuccess || changeSubscriptionPlan.isError)}\r\n        onClose={() => {\r\n          changeSubscriptionPlan.reset();\r\n          setIsChangingOffer(false);\r\n        }}\r\n      />\r\n      <h1 className=\"hideUntilFocus\">{t('nav.payments')}</h1>\r\n      {accessModel === ACCESS_MODEL.SVOD && (\r\n        <section aria-labelledby={subscriptionDetailsId} className={panelClassName}>\r\n          <div className={panelHeaderClassName}>\r\n            <h2 id={subscriptionDetailsId}>{isChangingOffer ? t('user:payment.change_plan') : t('user:payment.subscription_details')}</h2>\r\n          </div>\r\n          {activeSubscription ? (\r\n            <React.Fragment>\r\n              {!isChangingOffer && (\r\n                <div className={styles.infoBox} key={activeSubscription.subscriptionId}>\r\n                  <p>\r\n                    <strong>{getTitle(activeSubscription.period)}</strong> <br />\r\n                    {activeSubscription.status === 'active' && !isGrantedSubscription && !pendingDowngradeOfferId\r\n                      ? t('user:payment.next_billing_date_on', { date: formatLocalizedDate(new Date(activeSubscription.expiresAt * 1000), i18n.language) })\r\n                      : t('user:payment.subscription_expires_on', { date: formatLocalizedDate(new Date(activeSubscription.expiresAt * 1000), i18n.language) })}\r\n                    {(pendingOffer || pendingDowngradeOfferId) && activeSubscription.status !== 'cancelled' && (\r\n                      <span className={styles.pendingSwitch}>\r\n                        {t('user:payment.pending_offer_switch', {\r\n                          title: getTitle(pendingOffer?.period || offers.find((offer) => offer.offerId === pendingDowngradeOfferId)?.period || 'month'),\r\n                        })}\r\n                      </span>\r\n                    )}\r\n                  </p>\r\n                  {!isGrantedSubscription && (\r\n                    <p className={styles.price}>\r\n                      <strong>{formatPrice(activeSubscription.nextPaymentPrice, activeSubscription.nextPaymentCurrency, customer.country)}</strong>\r\n                      <small>/{t(`account:periods.${activeSubscription.period}`)}</small>\r\n                    </p>\r\n                  )}\r\n                </div>\r\n              )}\r\n              {isExternalPaymentProvider ? (\r\n                <p className={styles.explanation}>\r\n                  {t('account:external_payment.explanation', { paymentProvider })}{' '}\r\n                  <Link href={paymentProviderLink} target=\"_blank\">\r\n                    {t('account:external_payment.manage_subscription')}\r\n                  </Link>\r\n                </p>\r\n              ) : (\r\n                showChangeSubscriptionButton && (\r\n                  <Button\r\n                    className={styles.upgradeSubscription}\r\n                    label={t('user:payment.change_subscription')}\r\n                    disabled={!canRenewSubscription && activeSubscription.status === 'cancelled'}\r\n                    onClick={() => {\r\n                      if (offers.length > 1 && !canRenewSubscription) {\r\n                        setIsChangingOffer(true);\r\n                      } else {\r\n                        onUpgradeSubscriptionClick?.();\r\n                      }\r\n                    }}\r\n                    fullWidth={isMobile}\r\n                    color=\"primary\"\r\n                    data-testid=\"change-subscription-button\"\r\n                  />\r\n                )\r\n              )}\r\n              {(activeSubscription.status === 'active' || activeSubscription.status === 'active_trial') &&\r\n              !isGrantedSubscription &&\r\n              !isChangingOffer &&\r\n              canRenewSubscription ? (\r\n                <Button\r\n                  label={t('user:payment.cancel_subscription')}\r\n                  onClick={onCancelSubscriptionClick}\r\n                  fullWidth={isMobile}\r\n                  data-testid=\"cancel-subscription-button\"\r\n                />\r\n              ) : canRenewSubscription ? (\r\n                <Button label={t('user:payment.renew_subscription')} onClick={onRenewSubscriptionClick} />\r\n              ) : null}\r\n            </React.Fragment>\r\n          ) : isLoading ? null : (\r\n            <React.Fragment>\r\n              <p>{t('user:payment.no_subscription')}</p>\r\n              <Button variant=\"contained\" color=\"primary\" label={t('user:payment.complete_subscription')} onClick={onCompleteSubscriptionClick} />\r\n            </React.Fragment>\r\n          )}\r\n          {isChangingOffer && (\r\n            <div className={styles.changePlanContainer}>\r\n              {offers\r\n                .filter((o) => o.planSwitchEnabled)\r\n                .map((offer) => (\r\n                  <OfferSwitch\r\n                    key={offer.offerId}\r\n                    isCurrentOffer={offer.offerId === activeSubscription?.accessFeeId}\r\n                    pendingDowngradeOfferId={pendingDowngradeOfferId}\r\n                    offer={offer}\r\n                    selected={selectedOfferId === offer.offerId}\r\n                    onChange={(offerId) => setSelectedOfferId(offerId)}\r\n                    expiresAt={activeSubscription?.expiresAt}\r\n                  />\r\n                ))}\r\n              <div className={styles.changePlanButtons}>\r\n                <Button\r\n                  label={t('user:account.save')}\r\n                  onClick={onChangePlanClick}\r\n                  disabled={selectedOfferId === activeSubscription?.accessFeeId || changeSubscriptionPlan.isLoading}\r\n                />\r\n                <Button label={t('user:account.cancel')} onClick={() => setIsChangingOffer(false)} variant=\"text\" />\r\n                {activeSubscription?.status !== 'cancelled' && (\r\n                  <Button\r\n                    className={styles.changePlanCancelButton}\r\n                    label={t('user:payment.cancel_subscription')}\r\n                    onClick={onCancelSubscriptionClick}\r\n                    variant=\"danger\"\r\n                    data-testid=\"cancel-subscription-button\"\r\n                  />\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </section>\r\n      )}\r\n      <section aria-labelledby={paymentMethodId} className={panelClassName}>\r\n        <div className={panelHeaderClassName}>\r\n          <h2 id={paymentMethodId}>{t('user:payment.payment_method')}</h2>\r\n        </div>\r\n        {activePaymentDetail ? (\r\n          activePaymentDetail.paymentMethod === 'paypal' ? (\r\n            <div>\r\n              <div className={styles.paypal}>\r\n                <Icon icon={PayPal} /> {t('account:payment.paypal')}\r\n              </div>\r\n\r\n              {activePaymentDetail.currency}\r\n            </div>\r\n          ) : (\r\n            <div key={activePaymentDetail.id}>\r\n              <TextField\r\n                label={t('user:payment.card_number')}\r\n                name=\"cardNumber\"\r\n                value={`•••• •••• •••• ${activePaymentDetail.paymentMethodSpecificParams.lastCardFourDigits || ''}`}\r\n                aria-label={t('user:payment.card_number_hidden', { number: activePaymentDetail.paymentMethodSpecificParams.lastCardFourDigits })}\r\n                editing={false}\r\n                autoComplete=\"cc-number\"\r\n              />\r\n              <div className={styles.cardDetails}>\r\n                <TextField\r\n                  label={t('user:payment.expiry_date')}\r\n                  name=\"cardExpiry\"\r\n                  value={activePaymentDetail.paymentMethodSpecificParams.cardExpirationDate}\r\n                  editing={false}\r\n                  autoComplete=\"cc-exp\"\r\n                />\r\n                <TextField\r\n                  label={t('user:payment.security_code')}\r\n                  name=\"cardSecurityCode\"\r\n                  value={'******'}\r\n                  editing={false}\r\n                  aria-label={t('user:payment.security_code_hidden')}\r\n                  autoComplete=\"cc-csc\"\r\n                />\r\n              </div>\r\n              <Button\r\n                className={classNames({ [styles.editCard]: canUpdatePaymentMethod })}\r\n                label={t('account:payment.edit_card')}\r\n                variant=\"outlined\"\r\n                onClick={onEditCardDetailsClick}\r\n              />\r\n            </div>\r\n          )\r\n        ) : (\r\n          <div>\r\n            <p>{!isLoading && t('user:payment.no_payment_methods')}</p>\r\n          </div>\r\n        )}\r\n        {canUpdatePaymentMethod && (\r\n          <Button label={t('user:payment.update_payment_details')} type=\"button\" onClick={() => navigate(modalURLFromLocation(location, 'payment-method'))} />\r\n        )}\r\n      </section>\r\n      <section aria-labelledby={billingHistoryId} className={panelClassName}>\r\n        <div className={panelHeaderClassName}>\r\n          <h2 id={billingHistoryId}>{t('user:payment.billing_history')}</h2>\r\n        </div>\r\n        {transactions?.length ? (\r\n          <React.Fragment>\r\n            {transactions?.slice(0, showAllTransactions ? 9999 : VISIBLE_TRANSACTIONS).map((transaction) => (\r\n              <div className={styles.infoBox} key={transaction.transactionId}>\r\n                <p className={styles.transactionItem}>\r\n                  <strong>{formatLocalizedDate(new Date(transaction.transactionDate * 1000), i18n.language)}</strong>\r\n                  <span>{transaction.offerTitle}</span>\r\n                  <span>{transaction.transactionId}</span>\r\n                </p>\r\n                <div className={styles.transactionDetails}>\r\n                  <div className={styles.transactionPrice}>\r\n                    {!isGrantedSubscription &&\r\n                      t('user:payment.price_paid_with', {\r\n                        price: formatPrice(parseFloat(transaction.transactionPriceInclTax), transaction.transactionCurrency, transaction.customerCountry),\r\n                        method: transaction.paymentMethod,\r\n                      })}\r\n                  </div>\r\n                  {canShowReceipts && (\r\n                    <IconButton\r\n                      aria-label={t('user:payment.show_receipt')}\r\n                      // JW integration specific: uses `trxToken` as the unique identifier for each transaction\r\n                      // Note: `transactionId` is shared with rebills and is not guaranteed to be unique\r\n                      onClick={() => !isLoading && onShowReceiptClick(transaction?.trxToken ?? transaction.transactionId)}\r\n                    >\r\n                      <Icon icon={ExternalLink} />\r\n                    </IconButton>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ))}\r\n            {!showAllTransactions && hasMoreTransactions ? (\r\n              <React.Fragment>\r\n                <p>{t('user:payment.hidden_transactions', { count: hiddenTransactionsCount })}</p>\r\n                <Button label={t('user:payment.show_all')} onClick={onShowAllTransactionsClick} />\r\n              </React.Fragment>\r\n            ) : null}\r\n          </React.Fragment>\r\n        ) : (\r\n          <div>\r\n            <p>{!isLoading && t('user:payment.no_transactions')}</p>\r\n          </div>\r\n        )}\r\n      </section>\r\n      {isLoading && <LoadingOverlay inline />}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Payment;\r\n","import { useState } from 'react';\r\nimport { useLocation, useNavigate } from 'react-router';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport useOffers from '@jwp/ott-hooks-react/src/useOffers';\r\nimport { useSubscriptionChange } from '@jwp/ott-hooks-react/src/useSubscriptionChange';\r\n\r\nimport styles from '../../pages/User/User.module.scss';\r\nimport LoadingOverlay from '../../components/LoadingOverlay/LoadingOverlay';\r\nimport Payment from '../../components/Payment/Payment';\r\nimport { modalURLFromLocation } from '../../utils/location';\r\n\r\n/**\r\n * Handles billing receipts by either downloading the receipt directly if it is an instance of Blob,\r\n * or opening it in a new window if it is a string representation.\r\n *\r\n * @param {Blob | string} receipt - The billing receipt data. If a Blob, it will be downloaded; if a string,\r\n * it will be treated as an HTML representation and opened in a new window.\r\n * @param {string} transactionId - The unique identifier for the transaction associated with the receipt.\r\n *\r\n * @returns {void}\r\n *\r\n */\r\nconst processBillingReceipt = (receipt: Blob | string, transactionId: string) => {\r\n  if (receipt instanceof Blob) {\r\n    const url = window.URL.createObjectURL(new Blob([receipt]));\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    link.setAttribute('download', `receipt_${transactionId}.pdf`);\r\n    document.body.appendChild(link);\r\n    link.click();\r\n  } else {\r\n    const newWindow = window.open('', `Receipt ${transactionId}`, '');\r\n    const htmlString = window.atob(receipt as unknown as string);\r\n\r\n    if (newWindow) {\r\n      newWindow.opener = null;\r\n      newWindow.document.write(htmlString);\r\n      newWindow.document.close();\r\n    }\r\n  }\r\n};\r\n\r\nconst EXTERNAL_PAYMENT_METHODS = ['Apple In-App', 'Google In-App', 'Roku In-App'];\r\nconst STORE_LINKS: Record<string, string> = {\r\n  apple: 'https://support.apple.com/118428',\r\n  google: 'https://support.google.com/googleplay/answer/7018481',\r\n  roku: 'https://support.roku.com/article/208756478',\r\n};\r\n\r\nconst PaymentContainer = () => {\r\n  const accountController = getModule(AccountController);\r\n\r\n  const navigate = useNavigate();\r\n\r\n  const { accessModel } = useConfigStore(({ accessModel }) => ({ accessModel }), shallow);\r\n  const { user: customer, subscription: activeSubscription, transactions, activePayment, pendingOffer, loading } = useAccountStore();\r\n  const { canUpdatePaymentMethod, canShowReceipts, canRenewSubscription } = accountController.getFeatures();\r\n  const { subscriptionOffers, switchSubscriptionOffers } = useOffers();\r\n\r\n  const [showAllTransactions, setShowAllTransactions] = useState(false);\r\n  const [isLoadingReceipt, setIsLoadingReceipt] = useState(false);\r\n  const [selectedOfferId, setSelectedOfferId] = useState<string | null>(activeSubscription?.accessFeeId ?? null);\r\n  const [isUpgradeOffer, setIsUpgradeOffer] = useState<boolean | undefined>(undefined);\r\n\r\n  const location = useLocation();\r\n\r\n  const handleUpgradeSubscriptionClick = async () => navigate(modalURLFromLocation(location, 'upgrade-subscription'));\r\n\r\n  const handleShowReceiptClick = async (transactionId: string) => {\r\n    setIsLoadingReceipt(true);\r\n\r\n    try {\r\n      const receipt = await accountController.getReceipt(transactionId);\r\n      if (receipt) {\r\n        processBillingReceipt(receipt, transactionId);\r\n      }\r\n    } catch (error: unknown) {\r\n      throw new Error(\"Couldn't parse receipt. \" + (error instanceof Error ? error.message : ''));\r\n    }\r\n\r\n    setIsLoadingReceipt(false);\r\n  };\r\n\r\n  const changeSubscriptionPlan = useSubscriptionChange(isUpgradeOffer ?? false, selectedOfferId, customer, activeSubscription?.subscriptionId);\r\n\r\n  const onChangePlanClick = async () => {\r\n    if (selectedOfferId && activeSubscription?.subscriptionId) {\r\n      changeSubscriptionPlan.mutate({\r\n        accessFeeId: selectedOfferId.slice(1),\r\n        subscriptionId: `${activeSubscription.subscriptionId}`,\r\n      });\r\n    }\r\n  };\r\n\r\n  if (!customer) {\r\n    return <LoadingOverlay />;\r\n  }\r\n\r\n  const pendingDowngradeOfferId = (customer.metadata?.[`${activeSubscription?.subscriptionId}_pending_downgrade`] as string) || '';\r\n  const isExternalPaymentProvider = !!activeSubscription && EXTERNAL_PAYMENT_METHODS.includes(activeSubscription.paymentMethod);\r\n  const paymentProvider = activeSubscription?.paymentMethod.split(' ')[0] || 'unknown';\r\n  const paymentProviderLink = STORE_LINKS[paymentProvider.toLowerCase()];\r\n\r\n  return (\r\n    <Payment\r\n      accessModel={accessModel}\r\n      activeSubscription={activeSubscription}\r\n      activePaymentDetail={activePayment}\r\n      transactions={transactions}\r\n      customer={customer}\r\n      pendingOffer={pendingOffer}\r\n      isLoading={loading || isLoadingReceipt}\r\n      panelClassName={styles.panel}\r\n      panelHeaderClassName={styles.panelHeader}\r\n      onShowAllTransactionsClick={() => setShowAllTransactions(true)}\r\n      showAllTransactions={showAllTransactions}\r\n      canUpdatePaymentMethod={canUpdatePaymentMethod}\r\n      canRenewSubscription={canRenewSubscription}\r\n      onUpgradeSubscriptionClick={handleUpgradeSubscriptionClick}\r\n      offerSwitchesAvailable={switchSubscriptionOffers.length > 0}\r\n      canShowReceipts={canShowReceipts}\r\n      onShowReceiptClick={handleShowReceiptClick}\r\n      offers={subscriptionOffers}\r\n      pendingDowngradeOfferId={pendingDowngradeOfferId}\r\n      changeSubscriptionPlan={changeSubscriptionPlan}\r\n      onChangePlanClick={onChangePlanClick}\r\n      selectedOfferId={selectedOfferId}\r\n      setSelectedOfferId={(offerId: string | null) => setSelectedOfferId(offerId)}\r\n      isUpgradeOffer={isUpgradeOffer}\r\n      setIsUpgradeOffer={(isUpgradeOffer: boolean | undefined) => setIsUpgradeOffer(isUpgradeOffer)}\r\n      isExternalPaymentProvider={isExternalPaymentProvider}\r\n      paymentProvider={paymentProvider}\r\n      paymentProviderLink={paymentProviderLink}\r\n    />\r\n  );\r\n};\r\n\r\nexport default PaymentContainer;\r\n","import { useCallback, useEffect, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Navigate, Route, Routes, useNavigate } from 'react-router-dom';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport FavoritesController from '@jwp/ott-common/src/controllers/FavoritesController';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport { ACCESS_MODEL } from '@jwp/ott-common/src/constants';\r\nimport useBreakpoint, { Breakpoint } from '@jwp/ott-ui-react/src/hooks/useBreakpoint';\r\nimport AccountCircle from '@jwp/ott-theme/assets/icons/account_circle.svg?react';\r\nimport BalanceWallet from '@jwp/ott-theme/assets/icons/balance_wallet.svg?react';\r\nimport Exit from '@jwp/ott-theme/assets/icons/exit.svg?react';\r\nimport Favorite from '@jwp/ott-theme/assets/icons/favorite.svg?react';\r\nimport { RELATIVE_PATH_USER_ACCOUNT, RELATIVE_PATH_USER_FAVORITES, RELATIVE_PATH_USER_PAYMENTS } from '@jwp/ott-common/src/paths';\r\nimport { useFavoritesStore } from '@jwp/ott-common/src/stores/FavoritesStore';\r\n\r\nimport AccountComponent from '../../components/Account/Account';\r\nimport Button from '../../components/Button/Button';\r\nimport ConfirmationDialog from '../../components/ConfirmationDialog/ConfirmationDialog';\r\nimport Favorites from '../../components/Favorites/Favorites';\r\nimport LoadingOverlay from '../../components/LoadingOverlay/LoadingOverlay';\r\nimport PaymentContainer from '../../containers/PaymentContainer/PaymentContainer';\r\nimport Icon from '../../components/Icon/Icon';\r\n\r\nimport styles from './User.module.scss';\r\n\r\nconst User = (): JSX.Element => {\r\n  const favoritesController = getModule(FavoritesController);\r\n  const accountController = getModule(AccountController);\r\n\r\n  const { accessModel, favoritesList } = useConfigStore(\r\n    (s) => ({\r\n      accessModel: s.accessModel,\r\n      favoritesList: s.config.features?.favoritesList,\r\n    }),\r\n    shallow,\r\n  );\r\n  const navigate = useNavigate();\r\n  const { t } = useTranslation('user');\r\n  const breakpoint = useBreakpoint();\r\n  const [clearFavoritesOpen, setClearFavoritesOpen] = useState(false);\r\n\r\n  const isLargeScreen = breakpoint > Breakpoint.md;\r\n  const { user: customer, subscription, loading } = useAccountStore();\r\n  const { canUpdateEmail } = accountController.getFeatures();\r\n  const favorites = useFavoritesStore((state) => state.getPlaylist());\r\n\r\n  const onLogout = useCallback(async () => {\r\n    // Empty customer on a user page leads to navigate (code bellow), so we don't repeat it here\r\n    await accountController.logout();\r\n  }, [accountController]);\r\n\r\n  useEffect(() => {\r\n    if (!loading && !customer) {\r\n      navigate('/', { replace: true });\r\n    }\r\n  }, [navigate, customer, loading]);\r\n\r\n  if (!customer) {\r\n    return (\r\n      <div className={styles.user}>\r\n        <LoadingOverlay inline />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={styles.user}>\r\n      {isLargeScreen && (\r\n        <nav className={styles.leftColumn}>\r\n          <div className={styles.panel}>\r\n            <ul>\r\n              <li>\r\n                <Button\r\n                  to={RELATIVE_PATH_USER_ACCOUNT}\r\n                  label={t('nav.account')}\r\n                  variant=\"text\"\r\n                  startIcon={<Icon icon={AccountCircle} />}\r\n                  className={styles.button}\r\n                />\r\n              </li>\r\n\r\n              {favoritesList && (\r\n                <li>\r\n                  <Button\r\n                    to={RELATIVE_PATH_USER_FAVORITES}\r\n                    label={t('nav.favorites')}\r\n                    variant=\"text\"\r\n                    startIcon={<Icon icon={Favorite} />}\r\n                    className={styles.button}\r\n                  />\r\n                </li>\r\n              )}\r\n\r\n              {accessModel !== ACCESS_MODEL.AVOD && (\r\n                <li>\r\n                  <Button\r\n                    to={RELATIVE_PATH_USER_PAYMENTS}\r\n                    label={t('nav.payments')}\r\n                    variant=\"text\"\r\n                    startIcon={<Icon icon={BalanceWallet} />}\r\n                    className={styles.button}\r\n                  />\r\n                </li>\r\n              )}\r\n\r\n              <li className={styles.logoutLi}>\r\n                <Button onClick={onLogout} label={t('nav.logout')} variant=\"text\" startIcon={<Icon icon={Exit} />} className={styles.button} />\r\n              </li>\r\n            </ul>\r\n          </div>\r\n        </nav>\r\n      )}\r\n      <div className={styles.mainColumn}>\r\n        <Routes>\r\n          <Route\r\n            path={RELATIVE_PATH_USER_ACCOUNT}\r\n            element={<AccountComponent panelClassName={styles.panel} panelHeaderClassName={styles.panelHeader} canUpdateEmail={canUpdateEmail} />}\r\n          />\r\n          {favoritesList && (\r\n            <Route\r\n              path={RELATIVE_PATH_USER_FAVORITES}\r\n              element={\r\n                <>\r\n                  <Favorites\r\n                    playlist={favorites}\r\n                    onClearFavoritesClick={() => setClearFavoritesOpen(true)}\r\n                    accessModel={accessModel}\r\n                    hasSubscription={!!subscription}\r\n                  />\r\n                  <ConfirmationDialog\r\n                    open={clearFavoritesOpen}\r\n                    title={t('favorites.clear_favorites_title')}\r\n                    body={t('favorites.clear_favorites_body')}\r\n                    onConfirm={async () => {\r\n                      await favoritesController.clear();\r\n                      setClearFavoritesOpen(false);\r\n                    }}\r\n                    onClose={() => setClearFavoritesOpen(false)}\r\n                  />\r\n                </>\r\n              }\r\n            />\r\n          )}\r\n          <Route\r\n            path={RELATIVE_PATH_USER_PAYMENTS}\r\n            element={accessModel !== ACCESS_MODEL.AVOD ? <PaymentContainer /> : <Navigate to={RELATIVE_PATH_USER_ACCOUNT} />}\r\n          />\r\n          <Route path=\"*\" element={<Navigate to={RELATIVE_PATH_USER_ACCOUNT} />} />\r\n        </Routes>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default User;\r\n","import type { Playlist, PlaylistItem } from '../../types/playlist';\r\nimport type { DurationAbbreviation } from '../../types/i18n';\r\n\r\nimport { formatDuration, formatVideoSchedule } from './formatting';\r\n\r\nexport const createVideoMetadata = (media: PlaylistItem, i18n: DurationAbbreviation & { episodesLabel?: string }) => {\r\n  const metaData = [];\r\n  const duration = formatDuration(media.duration, i18n);\r\n\r\n  if (media.pubdate) metaData.push(String(new Date(media.pubdate * 1000).getFullYear()));\r\n  if (!i18n.episodesLabel && duration) metaData.push(duration);\r\n  if (i18n.episodesLabel) metaData.push(i18n.episodesLabel);\r\n  if (media.genre) metaData.push(media.genre);\r\n  if (media.rating) metaData.push(media.rating);\r\n\r\n  return metaData;\r\n};\r\nexport const createPlaylistMetadata = (playlist: Playlist, episodesLabel?: string) => {\r\n  const metaData = [];\r\n\r\n  if (episodesLabel) metaData.push(episodesLabel);\r\n  if (playlist.genre) metaData.push(playlist.genre as string);\r\n  if (playlist.rating) metaData.push(playlist.rating as string);\r\n\r\n  return metaData;\r\n};\r\nexport const createLiveEventMetadata = (media: PlaylistItem, locale: string, i18n: DurationAbbreviation) => {\r\n  const metaData = [];\r\n  const scheduled = formatVideoSchedule(locale, media.scheduledStart, media.scheduledEnd);\r\n  const duration = formatDuration(media.duration, i18n);\r\n\r\n  if (scheduled) metaData.push(scheduled);\r\n  if (duration) metaData.push(duration);\r\n  if (media.genre) metaData.push(media.genre);\r\n  if (media.rating) metaData.push(media.rating);\r\n\r\n  return metaData;\r\n};\r\n","import { useQuery, type UseBaseQueryResult } from 'react-query';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport ApiService from '@jwp/ott-common/src/services/ApiService';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { isScheduledOrLiveMedia } from '@jwp/ott-common/src/utils/liveEvent';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nexport type UseMediaResult<TData = PlaylistItem, TError = unknown> = UseBaseQueryResult<TData, TError>;\r\n\r\nexport default function useMedia(mediaId: string, enabled: boolean = true): UseMediaResult {\r\n  const apiService = getModule(ApiService);\r\n\r\n  // Determine currently selected language\r\n  const { i18n } = useTranslation();\r\n  const language = i18n.language;\r\n\r\n  return useQuery(['media', mediaId, language], () => apiService.getMediaById({ id: mediaId, language }), {\r\n    enabled: !!mediaId && enabled,\r\n    refetchInterval: (data, _) => {\r\n      if (!data) return false;\r\n\r\n      const autoRefetch = isScheduledOrLiveMedia(data);\r\n\r\n      return autoRefetch ? 1000 * 30 : false;\r\n    },\r\n    staleTime: 60 * 1000 * 10, // 10 min\r\n  });\r\n}\r\n","import * as React from \"react\";\nconst SvgPlayTrailer = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M19,19H5V5H19M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M10,8V16L15,12L10,8Z\" }));\nexport default SvgPlayTrailer;\n","import React, { type FC, Fragment } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport useBreakpoint, { Breakpoint } from '@jwp/ott-ui-react/src/hooks/useBreakpoint';\r\n\r\nimport Select from '../Select/Select';\r\nimport Button from '../Button/Button';\r\n\r\nimport styles from './Filter.module.scss';\r\n\r\ntype FilterOption =\r\n  | {\r\n      label: string;\r\n      value: string;\r\n    }\r\n  | string;\r\n\r\ntype Props = {\r\n  name: string;\r\n  value: string;\r\n  defaultLabel: string;\r\n  options: FilterOption[];\r\n  forceDropdown?: boolean;\r\n  setValue: (value: string) => void;\r\n};\r\n\r\nconst Filter: FC<Props> = ({ name, value, defaultLabel, options, setValue, forceDropdown = false }) => {\r\n  const { t } = useTranslation('common');\r\n  const breakpoint: Breakpoint = useBreakpoint();\r\n\r\n  if (!options.length) {\r\n    return null;\r\n  }\r\n  const handleChange = (event: React.ChangeEvent<HTMLSelectElement>) => setValue(event.target.value);\r\n\r\n  const showFilterRow = !forceDropdown && breakpoint >= Breakpoint.md && options.length < 6;\r\n\r\n  return (\r\n    <Fragment>\r\n      {showFilterRow ? (\r\n        <div className={styles.filterRow} role=\"listbox\" aria-label={t('filter_videos_by', { name })}>\r\n          {options.map((option) => {\r\n            const optionLabel = typeof option === 'string' ? option : option.label;\r\n            const optionValue = typeof option === 'string' ? option : option.value;\r\n            const active = value === optionValue;\r\n\r\n            return <Button label={optionLabel} onClick={() => setValue(optionValue)} key={optionValue} active={active} role=\"option\" aria-selected={active} />;\r\n          })}\r\n          <Button label={defaultLabel} onClick={() => setValue('')} active={value === ''} key={defaultLabel} role=\"option\" aria-selected={value === ''} />\r\n        </div>\r\n      ) : (\r\n        <div className={styles.filterDropDown}>\r\n          <Select\r\n            className={styles.dropDown}\r\n            size=\"small\"\r\n            options={options}\r\n            defaultLabel={defaultLabel}\r\n            name={name}\r\n            value={value}\r\n            onChange={handleChange}\r\n            aria-label={t('filter_videos_by', { name })}\r\n          />\r\n        </div>\r\n      )}\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default Filter;\r\n","import React, { useRef, type PropsWithChildren } from 'react';\r\n\r\nimport Image from '../Image/Image';\r\nimport { useScrolledDown } from '../../hooks/useScrolledDown';\r\nimport useBreakpoint, { Breakpoint } from '../../hooks/useBreakpoint';\r\n\r\nimport styles from './Hero.module.scss';\r\n\r\ntype Props = PropsWithChildren<{\r\n  image?: string;\r\n}>;\r\n\r\nconst Hero = ({ image, children }: Props) => {\r\n  const alt = ''; // intentionally empty for a11y, because adjacent text alternative\r\n  const posterRef = useRef<HTMLImageElement>(null);\r\n  const breakpoint = useBreakpoint();\r\n  const isMobile = breakpoint <= Breakpoint.sm;\r\n\r\n  useScrolledDown(50, isMobile ? 150 : 500, (progress: number) => {\r\n    if (posterRef.current) posterRef.current.style.opacity = `${Math.max(1 - progress, 0.1)}`;\r\n  });\r\n\r\n  return (\r\n    <div className={styles.hero}>\r\n      <Image ref={posterRef} className={styles.poster} image={image} width={1280} alt={alt} />\r\n      <div className={styles.posterFade} />\r\n      <div className={styles.info}>{children}</div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Hero;\r\n","import React from 'react';\r\n\r\nimport styles from './Hero.module.scss';\r\n\r\nconst HeroTitle = ({ title }: { title: string }) => {\r\n  return <h1 className={styles.title}>{title}</h1>;\r\n};\r\n\r\nexport default HeroTitle;\r\n","import classNames from 'classnames';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport ChevronRight from '@jwp/ott-theme/assets/icons/chevron_right.svg?react';\r\n\r\nimport IconButton from '../IconButton/IconButton';\r\nimport Icon from '../Icon/Icon';\r\nimport useBreakpoint from '../../hooks/useBreakpoint';\r\nimport MarkdownComponent from '../MarkdownComponent/MarkdownComponent';\r\n\r\nimport styles from './CollapsibleText.module.scss';\r\n\r\ntype Props = {\r\n  text: string;\r\n  className?: string;\r\n};\r\n\r\nconst CollapsibleText: React.FC<Props> = ({ text, className }: Props) => {\r\n  const divRef = useRef<HTMLDivElement>() as React.MutableRefObject<HTMLDivElement>;\r\n  const breakpoint = useBreakpoint();\r\n  const [doesFlowOver, setDoesFlowOver] = useState(false);\r\n  const [expanded, setExpanded] = useState(false);\r\n\r\n  const ariaLabel = expanded ? 'Collapse' : 'Expand';\r\n\r\n  const clippablePixels = 4;\r\n  const maxHeight = 60;\r\n\r\n  useEffect(() => {\r\n    divRef.current && setDoesFlowOver(divRef.current.scrollHeight > divRef.current.offsetHeight + clippablePixels || maxHeight < divRef.current.offsetHeight);\r\n  }, [maxHeight, text, breakpoint]);\r\n\r\n  return (\r\n    <div className={classNames(styles.collapsibleText)}>\r\n      <p\r\n        ref={divRef}\r\n        id=\"collapsible-content\"\r\n        className={classNames(styles.textContainer, className, { [styles.collapsed]: !expanded && doesFlowOver })}\r\n        style={{ maxHeight: expanded ? divRef.current.scrollHeight : maxHeight }}\r\n      >\r\n        <MarkdownComponent tag=\"span\" markdownString={text} inline />\r\n      </p>\r\n      {doesFlowOver && (\r\n        <IconButton\r\n          aria-label={ariaLabel}\r\n          aria-expanded={expanded}\r\n          aria-controls=\"collapsible-content\"\r\n          className={classNames(styles.chevron, { [styles.expanded]: expanded })}\r\n          onClick={() => setExpanded(!expanded)}\r\n        >\r\n          <Icon icon={ChevronRight} />\r\n        </IconButton>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CollapsibleText;\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\n\r\nimport CollapsibleText from '../CollapsibleText/CollapsibleText';\r\nimport TruncatedText from '../TruncatedText/TruncatedText';\r\nimport useBreakpoint, { Breakpoint } from '../../hooks/useBreakpoint';\r\n\r\nimport styles from './Hero.module.scss';\r\n\r\nconst HeroDescription = ({ className, description, maximumLines = 8 }: { className?: string; description: string; maximumLines?: number }) => {\r\n  const breakpoint: Breakpoint = useBreakpoint();\r\n  const isMobile = breakpoint === Breakpoint.xs;\r\n\r\n  return isMobile ? (\r\n    <CollapsibleText text={description} className={classNames(styles.description, className)} />\r\n  ) : (\r\n    <TruncatedText text={description} maximumLines={maximumLines} className={classNames(styles.description, className)} />\r\n  );\r\n};\r\n\r\nexport default HeroDescription;\r\n","import React, { type PropsWithChildren } from 'react';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\n\r\nimport Hero from '../Hero/Hero';\r\nimport HeroTitle from '../Hero/HeroTitle';\r\nimport HeroDescription from '../Hero/HeroDescription';\r\n\r\nimport styles from './VideoDetails.module.scss';\r\n\r\ntype Props = PropsWithChildren<{\r\n  title: string;\r\n  description: string;\r\n  primaryMetadata: React.ReactNode;\r\n  secondaryMetadata?: React.ReactNode;\r\n  image?: string;\r\n  startWatchingButton: React.ReactNode;\r\n  shareButton: React.ReactNode;\r\n  favoriteButton?: React.ReactNode;\r\n  trailerButton?: React.ReactNode;\r\n}>;\r\n\r\nconst VideoDetails = ({\r\n  title,\r\n  description,\r\n  primaryMetadata,\r\n  secondaryMetadata,\r\n  image,\r\n  startWatchingButton,\r\n  shareButton,\r\n  favoriteButton,\r\n  trailerButton,\r\n  children,\r\n}: Props) => {\r\n  return (\r\n    <div data-testid={testId('cinema-layout')}>\r\n      <header className={styles.videoDetails} data-testid={testId('video-details')} id=\"video-details\">\r\n        <Hero image={image}>\r\n          <HeroTitle title={title} />\r\n          <div className={styles.metaContainer}>\r\n            <div className={styles.primaryMetadata}>{primaryMetadata}</div>\r\n            {secondaryMetadata && <div className={styles.secondaryMetadata}>{secondaryMetadata}</div>}\r\n          </div>\r\n          <HeroDescription className={styles.description} description={description} />\r\n          <div className={styles.buttonBar}>\r\n            {startWatchingButton}\r\n            {trailerButton}\r\n            {favoriteButton}\r\n            {shareButton}\r\n          </div>\r\n        </Hero>\r\n      </header>\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VideoDetails;\r\n","import React from 'react';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\nimport useBreakpoint, { Breakpoint } from '@jwp/ott-ui-react/src/hooks/useBreakpoint';\r\n\r\nimport CollapsibleText from '../CollapsibleText/CollapsibleText';\r\nimport MarkdownComponent from '../MarkdownComponent/MarkdownComponent';\r\n\r\nimport styles from './VideoDetailsInline.module.scss';\r\n\r\ntype Props = {\r\n  title: string | React.ReactNode;\r\n  description: string;\r\n  primaryMetadata: React.ReactNode;\r\n  shareButton: React.ReactNode;\r\n  favoriteButton: React.ReactNode;\r\n  trailerButton: React.ReactNode;\r\n  live?: boolean;\r\n};\r\n\r\nconst VideoDetailsInline: React.FC<Props> = ({ title, description, primaryMetadata, shareButton, favoriteButton, trailerButton }) => {\r\n  const breakpoint: Breakpoint = useBreakpoint();\r\n  const isMobile = breakpoint === Breakpoint.xs;\r\n\r\n  const TitleComponent = typeof title === 'string' ? 'h1' : 'div';\r\n\r\n  return (\r\n    <div className={styles.details} data-testid={testId('video-details-inline')}>\r\n      <TitleComponent className={styles.title}>{title}</TitleComponent>\r\n      <div className={styles.inlinePlayerMetadata}>\r\n        <div className={styles.primaryMetadata}>{primaryMetadata}</div>\r\n        <div className={styles.buttonBar}>\r\n          {trailerButton}\r\n          {favoriteButton}\r\n          {shareButton}\r\n        </div>\r\n      </div>\r\n      {isMobile ? (\r\n        <CollapsibleText text={description} className={styles.description} />\r\n      ) : (\r\n        <MarkdownComponent markdownString={description} className={styles.description} />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VideoDetailsInline;\r\n","import React, { memo, useState } from 'react';\r\nimport classNames from 'classnames';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Link } from 'react-router-dom';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { formatDurationTag, formatLocalizedDateTime, formatSeriesMetaString } from '@jwp/ott-common/src/utils/formatting';\r\nimport { isLiveChannel, isSeries } from '@jwp/ott-common/src/utils/media';\r\nimport { MediaStatus } from '@jwp/ott-common/src/utils/liveEvent';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\nimport Lock from '@jwp/ott-theme/assets/icons/lock.svg?react';\r\nimport Today from '@jwp/ott-theme/assets/icons/today.svg?react';\r\n\r\nimport Image from '../Image/Image';\r\nimport Icon from '../Icon/Icon';\r\n\r\nimport styles from './VideoListItem.module.scss';\r\n\r\ntype VideoListItemProps = {\r\n  onHover?: () => void;\r\n  item: PlaylistItem;\r\n  progress?: number;\r\n  loading?: boolean;\r\n  isActive?: boolean;\r\n  activeLabel?: string;\r\n  isLocked?: boolean;\r\n  url: string;\r\n};\r\n\r\nfunction VideoListItem({ onHover, progress, activeLabel, item, url, loading = false, isActive = false, isLocked = true }: VideoListItemProps): JSX.Element {\r\n  const { title, duration, seasonNumber, episodeNumber, cardImage: image, mediaStatus, scheduledStart } = item;\r\n\r\n  const {\r\n    t,\r\n    i18n: { language },\r\n  } = useTranslation('common');\r\n  const [imageLoaded, setImageLoaded] = useState(false);\r\n  const posterImageClassNames = classNames(styles.posterImage, {\r\n    [styles.visible]: imageLoaded,\r\n  });\r\n\r\n  const isSeriesItem = isSeries(item);\r\n  const isLive = mediaStatus === MediaStatus.LIVE || isLiveChannel(item);\r\n  const isScheduled = mediaStatus === MediaStatus.SCHEDULED;\r\n\r\n  const renderTag = () => {\r\n    if (loading || !title) return null;\r\n\r\n    if (isSeriesItem) {\r\n      return <div className={styles.tag}>{t('video:series')}</div>;\r\n    } else if (episodeNumber) {\r\n      return <div className={styles.tag}>{formatSeriesMetaString(seasonNumber, episodeNumber)}</div>;\r\n    } else if (duration) {\r\n      return <div className={styles.tag}>{formatDurationTag(duration, { minutesAbbreviation: t('common:abbreviation.minutes') })}</div>;\r\n    } else if (isLive) {\r\n      return <div className={classNames(styles.tag, styles.live)}>{t('live')}</div>;\r\n    } else if (isScheduled) {\r\n      return (\r\n        <div className={styles.tag}>\r\n          <Icon icon={Today} className={styles.scheduled} />\r\n          {t('scheduled')}\r\n        </div>\r\n      );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Link role=\"button\" to={url} className={styles.listItem} onMouseEnter={onHover} tabIndex={0} data-testid={testId(title)}>\r\n      <div className={styles.titleContainer}>\r\n        <h3 className={styles.title}>{title}</h3>\r\n        {!!scheduledStart && <div className={styles.scheduledStart}>{formatLocalizedDateTime(scheduledStart, language)}</div>}\r\n      </div>\r\n      <div className={styles.poster}>\r\n        <Image className={posterImageClassNames} image={image} onLoad={() => setImageLoaded(true)} width={320} alt=\"\" />\r\n        <div className={styles.tags}>\r\n          {isLocked && (\r\n            <div className={classNames(styles.tag, styles.lock)} aria-label={t('card_lock')}>\r\n              <Icon icon={Lock} />\r\n            </div>\r\n          )}\r\n          {renderTag()}\r\n        </div>\r\n        {isActive && <div className={styles.activeLabel}>{activeLabel}</div>}\r\n        {progress ? (\r\n          <div className={styles.progressContainer}>\r\n            <div className={styles.progressBar} style={{ width: `${Math.round(progress * 100)}%` }} />\r\n          </div>\r\n        ) : null}\r\n      </div>\r\n    </Link>\r\n  );\r\n}\r\n\r\nexport default memo(VideoListItem);\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\nimport InfiniteScroll from 'react-infinite-scroller';\r\nimport type { AccessModel } from '@jwp/ott-common/types/config';\r\nimport type { Playlist, PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { isLocked } from '@jwp/ott-common/src/utils/entitlements';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\n\r\nimport VideoListItem from '../VideoListItem/VideoListItem';\r\nimport InfiniteScrollLoader from '../InfiniteScrollLoader/InfiniteScrollLoader';\r\n\r\nimport styles from './VideoList.module.scss';\r\n\r\ntype Props = {\r\n  playlist?: Playlist;\r\n  header?: React.ReactNode;\r\n  watchHistory?: { [key: string]: number };\r\n  isLoading: boolean;\r\n  activeMediaId?: string;\r\n  activeLabel?: string;\r\n  className?: string;\r\n  accessModel: AccessModel;\r\n  isLoggedIn: boolean;\r\n  hasSubscription: boolean;\r\n  hasMore?: boolean;\r\n  loadMore?: () => void;\r\n  onListItemHover?: (item: PlaylistItem) => void;\r\n  getUrl: (item: PlaylistItem) => string;\r\n};\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-empty-function\r\nconst defaultLoadMore = () => {};\r\n\r\nfunction VideoList({\r\n  playlist,\r\n  header,\r\n  onListItemHover,\r\n  isLoading = false,\r\n  watchHistory,\r\n  activeMediaId,\r\n  activeLabel,\r\n  className,\r\n  accessModel,\r\n  isLoggedIn,\r\n  hasSubscription,\r\n  hasMore,\r\n  loadMore = defaultLoadMore,\r\n  getUrl,\r\n}: Props) {\r\n  return (\r\n    <div className={classNames(styles.container, !!className && className)} data-testid={testId('video-list')}>\r\n      {!!header && header}\r\n      <div className={styles.content}>\r\n        <InfiniteScroll\r\n          element=\"ul\"\r\n          pageStart={0}\r\n          loadMore={loadMore ?? defaultLoadMore}\r\n          hasMore={hasMore ?? false}\r\n          className={styles.list}\r\n          loader={<InfiniteScrollLoader key=\"loader\" />}\r\n          useWindow={false}\r\n        >\r\n          {playlist?.playlist?.map((playlistItem: PlaylistItem) => (\r\n            <li key={playlistItem.mediaid}>\r\n              <VideoListItem\r\n                url={getUrl(playlistItem)}\r\n                progress={watchHistory ? watchHistory[playlistItem.mediaid] : undefined}\r\n                onHover={() => onListItemHover && onListItemHover(playlistItem)}\r\n                loading={isLoading}\r\n                isActive={activeMediaId === playlistItem.mediaid}\r\n                activeLabel={activeLabel}\r\n                isLocked={isLocked(accessModel, isLoggedIn, hasSubscription, playlistItem)}\r\n                item={playlistItem}\r\n              />\r\n            </li>\r\n          ))}\r\n        </InfiniteScroll>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default VideoList;\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\nimport type { Playlist, PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport type { AccessModel } from '@jwp/ott-common/types/config';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\nimport useBreakpoint, { Breakpoint } from '@jwp/ott-ui-react/src/hooks/useBreakpoint';\r\n\r\nimport CardGrid from '../CardGrid/CardGrid';\r\nimport Filter from '../Filter/Filter';\r\nimport VideoDetails from '../VideoDetails/VideoDetails';\r\nimport VideoDetailsInline from '../VideoDetailsInline/VideoDetailsInline';\r\nimport VideoList from '../VideoList/VideoList';\r\n\r\nimport styles from './VideoLayout.module.scss';\r\n\r\ntype FilterProps = {\r\n  filterMetadata?: React.ReactNode;\r\n  filters?: (string | { label: string; value: string })[];\r\n  currentFilter?: string;\r\n  defaultFilterLabel?: string;\r\n  setFilter?: (value: string) => void;\r\n};\r\n\r\ntype LoadMoreProps = {\r\n  hasMore?: boolean;\r\n  loadMore?: () => void;\r\n};\r\n\r\ntype VideoDetailsProps = {\r\n  title: string;\r\n  description: string;\r\n  image?: string;\r\n  primaryMetadata: React.ReactNode;\r\n  secondaryMetadata?: React.ReactNode;\r\n  shareButton: React.ReactNode;\r\n  favoriteButton: React.ReactNode;\r\n  trailerButton: React.ReactNode;\r\n  startWatchingButton: React.ReactNode;\r\n  live?: boolean;\r\n};\r\n\r\ntype VideoListProps = {\r\n  relatedTitle?: string;\r\n  onItemHover?: (item: PlaylistItem) => void;\r\n  watchHistory?: { [key: string]: number };\r\n  activeMediaId?: string;\r\n  activeLabel?: string;\r\n  getURL: (item: PlaylistItem) => string;\r\n};\r\n\r\ntype Props = {\r\n  inlineLayout: boolean;\r\n  player: React.ReactNode;\r\n  isLoading: boolean;\r\n  accessModel: AccessModel;\r\n  isLoggedIn: boolean;\r\n  hasSubscription: boolean;\r\n  children?: React.ReactNode;\r\n  item?: PlaylistItem;\r\n  playlist?: Playlist;\r\n} & FilterProps &\r\n  VideoDetailsProps &\r\n  VideoListProps &\r\n  LoadMoreProps;\r\n\r\nconst VideoLayout: React.FC<Props> = ({\r\n  inlineLayout,\r\n  player,\r\n  playlist,\r\n  accessModel,\r\n  isLoading,\r\n  isLoggedIn,\r\n  item,\r\n  hasSubscription,\r\n  // video details\r\n  title,\r\n  description,\r\n  image,\r\n  primaryMetadata,\r\n  secondaryMetadata,\r\n  shareButton,\r\n  favoriteButton,\r\n  startWatchingButton,\r\n  trailerButton,\r\n  // list\r\n  relatedTitle,\r\n  watchHistory,\r\n  activeLabel,\r\n  // filters\r\n  filters,\r\n  setFilter,\r\n  filterMetadata,\r\n  currentFilter = '',\r\n  defaultFilterLabel = '',\r\n  children,\r\n  // load more\r\n  hasMore,\r\n  loadMore,\r\n  getURL,\r\n}) => {\r\n  const breakpoint = useBreakpoint();\r\n  const isTablet = breakpoint === Breakpoint.sm || breakpoint === Breakpoint.md;\r\n  // only show the filters when there are two or more filters\r\n  const hasFilters = filters && filters.length > 1;\r\n  const showFilters = hasFilters && setFilter;\r\n\r\n  const renderFilters = (forceDropdown: boolean) => (\r\n    <div className={classNames(styles.filters, { [styles.filtersInline]: inlineLayout })}>\r\n      {!!filterMetadata && inlineLayout && <span className={styles.filterMetadata}>{filterMetadata}</span>}\r\n      {showFilters && (\r\n        <Filter name=\"season\" value={currentFilter} defaultLabel={defaultFilterLabel} options={filters} setValue={setFilter} forceDropdown={forceDropdown} />\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  const renderRelatedVideos = (grid = true) => {\r\n    if (!playlist) return null;\r\n\r\n    return grid ? (\r\n      <>\r\n        <div className={classNames(styles.relatedVideosGrid, { [styles.inlineLayout]: inlineLayout })}>\r\n          <h2 className={styles.relatedVideosGridTitle}>{relatedTitle || '\\u00A0'}</h2>\r\n          {hasFilters && renderFilters(inlineLayout)}\r\n        </div>\r\n        <CardGrid\r\n          playlist={playlist}\r\n          isLoading={isLoading}\r\n          watchHistory={watchHistory}\r\n          accessModel={accessModel}\r\n          isLoggedIn={isLoggedIn}\r\n          currentCardItem={item}\r\n          currentCardLabel={activeLabel}\r\n          hasSubscription={hasSubscription}\r\n          hasMore={hasMore}\r\n          loadMore={loadMore}\r\n          getUrl={getURL}\r\n        />\r\n      </>\r\n    ) : (\r\n      <div className={styles.relatedVideosList}>\r\n        <VideoList\r\n          header={\r\n            <div className={styles.relatedVideosListHeader}>\r\n              {title && <h2 className={styles.relatedVideosListTitle}>{relatedTitle}</h2>}\r\n              {hasFilters && renderFilters(true)}\r\n            </div>\r\n          }\r\n          activeMediaId={item?.mediaid}\r\n          activeLabel={activeLabel}\r\n          playlist={playlist}\r\n          watchHistory={watchHistory}\r\n          isLoading={isLoading}\r\n          accessModel={accessModel}\r\n          isLoggedIn={isLoggedIn}\r\n          hasSubscription={hasSubscription}\r\n          hasMore={hasMore}\r\n          loadMore={loadMore}\r\n          getUrl={getURL}\r\n        />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  if (inlineLayout) {\r\n    return (\r\n      <div className={styles.videoInlineLayout} data-testid={testId('inline-layout')}>\r\n        <div className={styles.player}>{player}</div>\r\n        <div className={styles.videoDetailsInline}>\r\n          <VideoDetailsInline\r\n            title={secondaryMetadata || title}\r\n            live={item?.duration === 0}\r\n            description={description}\r\n            primaryMetadata={primaryMetadata}\r\n            shareButton={shareButton}\r\n            favoriteButton={favoriteButton}\r\n            trailerButton={trailerButton}\r\n          />\r\n        </div>\r\n        {renderRelatedVideos(isTablet)}\r\n        {children}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <VideoDetails\r\n      title={title}\r\n      description={description}\r\n      image={image}\r\n      startWatchingButton={startWatchingButton}\r\n      favoriteButton={favoriteButton}\r\n      trailerButton={trailerButton}\r\n      shareButton={shareButton}\r\n      primaryMetadata={primaryMetadata}\r\n      secondaryMetadata={secondaryMetadata}\r\n    >\r\n      {playlist && <section className={styles.relatedVideos}>{renderRelatedVideos(true)}</section>}\r\n      {children}\r\n      {player}\r\n    </VideoDetails>\r\n  );\r\n};\r\n\r\nexport default VideoLayout;\r\n","import { useCallback, useEffect, useLayoutEffect, useRef } from 'react';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport WatchHistoryController from '@jwp/ott-common/src/controllers/WatchHistoryController';\r\n\r\nimport useEventCallback from './useEventCallback';\r\n\r\ntype QueuedProgress = {\r\n  item: PlaylistItem;\r\n  seriesItem?: PlaylistItem;\r\n  progress: number;\r\n  timestamp: number;\r\n};\r\n\r\nconst PROGRESSIVE_SAVE_INTERVAL = 300_000; // 5 minutes\r\n\r\n/**\r\n * The `useWatchHistoryListener` hook has the responsibility to save the players watch progress on key moments.\r\n *\r\n * __The problem:__\r\n *\r\n * There are multiple events that trigger a save. This results in duplicate (unnecessary) saves and API calls. Another\r\n * problem is that some events are triggered when the `item` to update has changed. For example, when clicking a media\r\n * item in the \"Related shelf\". This causes the wrong item to be saved in the watch history.\r\n *\r\n * __The solution:__\r\n *\r\n * This hook listens to the player time update event and queues a watch history entry with the current progress and\r\n * item. When this needs to be saved, the queue is used to look up the last progress and item and save it when\r\n * necessary. The queue is then cleared to prevent duplicate saves and API calls.\r\n */\r\nexport const useWatchHistoryListener = (player: jwplayer.JWPlayer | undefined, item: PlaylistItem, seriesItem?: PlaylistItem) => {\r\n  const queuedWatchProgress = useRef<QueuedProgress | null>(null);\r\n  const watchHistoryController = getModule(WatchHistoryController);\r\n\r\n  // config\r\n  const { features } = useConfigStore((s) => s.config);\r\n  const continueWatchingList = features?.continueWatchingList;\r\n  const watchHistoryEnabled = !!continueWatchingList;\r\n\r\n  // maybe store the watch progress when we have a queued watch progress\r\n  const maybeSaveWatchProgress = useCallback(() => {\r\n    if (!watchHistoryEnabled || !queuedWatchProgress.current) return;\r\n\r\n    const { item, seriesItem, progress } = queuedWatchProgress.current;\r\n\r\n    // save the queued watch progress\r\n    watchHistoryController.saveItem(item, seriesItem, progress);\r\n\r\n    // clear the queue\r\n    queuedWatchProgress.current = null;\r\n  }, [watchHistoryEnabled, watchHistoryController]);\r\n\r\n  // update the queued watch progress on each time update event\r\n  const handleTimeUpdate = useEventCallback((event: jwplayer.TimeParam) => {\r\n    // live streams have a negative duration, we ignore these for now\r\n    if (event.duration < 0) return;\r\n\r\n    const progress = Number((event.position / event.duration).toFixed(5));\r\n\r\n    if (!isNaN(progress) && isFinite(progress)) {\r\n      queuedWatchProgress.current = {\r\n        item,\r\n        seriesItem,\r\n        progress,\r\n        timestamp: queuedWatchProgress.current?.timestamp || Date.now(),\r\n      };\r\n\r\n      // save the progress when we haven't done so in the last X minutes\r\n      if (Date.now() - queuedWatchProgress.current.timestamp > PROGRESSIVE_SAVE_INTERVAL) {\r\n        maybeSaveWatchProgress();\r\n      }\r\n    }\r\n  });\r\n\r\n  // listen for certain player events\r\n  useEffect(() => {\r\n    if (!player || !watchHistoryEnabled) return;\r\n\r\n    player.on('time', handleTimeUpdate);\r\n    player.on('pause', maybeSaveWatchProgress);\r\n    player.on('complete', maybeSaveWatchProgress);\r\n    player.on('remove', maybeSaveWatchProgress);\r\n\r\n    return () => {\r\n      player.off('time', handleTimeUpdate);\r\n      player.off('pause', maybeSaveWatchProgress);\r\n      player.off('complete', maybeSaveWatchProgress);\r\n      player.off('remove', maybeSaveWatchProgress);\r\n    };\r\n  }, [player, watchHistoryEnabled, maybeSaveWatchProgress, handleTimeUpdate]);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      // store watch progress on unmount and when the media item changes\r\n      maybeSaveWatchProgress();\r\n    };\r\n  }, [item?.mediaid, maybeSaveWatchProgress]);\r\n\r\n  // add event listeners for unload and visibility change to ensure the latest watch progress is saved\r\n  useLayoutEffect(() => {\r\n    const visibilityListener = () => document.visibilityState === 'hidden' && maybeSaveWatchProgress();\r\n\r\n    window.addEventListener('pagehide', maybeSaveWatchProgress);\r\n    window.addEventListener('visibilitychange', visibilityListener);\r\n\r\n    return () => {\r\n      window.removeEventListener('pagehide', maybeSaveWatchProgress);\r\n      window.removeEventListener('visibilitychange', visibilityListener);\r\n    };\r\n  }, [maybeSaveWatchProgress]);\r\n};\r\n","import { useMemo } from 'react';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { useWatchHistoryStore } from '@jwp/ott-common/src/stores/WatchHistoryStore';\r\nimport { VideoProgressMinMax } from '@jwp/ott-common/src/constants';\r\n\r\nimport { useWatchHistoryListener } from './useWatchHistoryListener';\r\n\r\nexport const useWatchHistory = (player: jwplayer.JWPlayer | undefined, item: PlaylistItem, seriesItem?: PlaylistItem) => {\r\n  // config\r\n  const { features } = useConfigStore((s) => s.config);\r\n  const continueWatchingList = features?.continueWatchingList;\r\n  const watchHistoryEnabled = !!continueWatchingList;\r\n\r\n  // watch history listener\r\n  useWatchHistoryListener(player, item, seriesItem);\r\n\r\n  // watch History\r\n  const watchHistoryItem = useWatchHistoryStore((state) => (!!item && watchHistoryEnabled ? state.getItem(item) : undefined));\r\n\r\n  // calculate the `startTime` of the current item based on the watch progress\r\n  return useMemo(() => {\r\n    const videoProgress = watchHistoryItem?.progress;\r\n\r\n    if (videoProgress && videoProgress > VideoProgressMinMax.Min && videoProgress < VideoProgressMinMax.Max) {\r\n      return videoProgress * item.duration;\r\n    }\r\n\r\n    // start at the beginning of the video (only for VOD content)\r\n    return 0;\r\n  }, [item.duration, watchHistoryItem?.progress]);\r\n};\r\n","import type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { createURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\n\r\nimport useEventCallback from './useEventCallback';\r\n\r\nexport const usePlaylistItemCallback = (startDateTime?: string | null, endDateTime?: string | null) => {\r\n  const applyLiveStreamOffset = (item: PlaylistItem) => {\r\n    if (!startDateTime) return item;\r\n\r\n    // The timeParam can either be just a start date like `2022-08-08T20:00:00` (to extend DVR) or a range like\r\n    // `2022-08-08T20:00:00-2022-08-08T22:00:00` to select a VOD from the live stream.\r\n    const timeParam = [startDateTime, endDateTime].filter(Boolean).join('-');\r\n\r\n    return {\r\n      ...item,\r\n      allSources: undefined, // `allSources` need to be cleared otherwise JW Player will use those instead\r\n      sources: item.sources.map((source) => ({\r\n        ...source,\r\n        file: createURL(source.file, {\r\n          t: timeParam,\r\n        }),\r\n      })),\r\n    };\r\n  };\r\n\r\n  return useEventCallback(async (item: PlaylistItem) => {\r\n    return applyLiveStreamOffset(item);\r\n  });\r\n};\r\n","import { useQuery } from 'react-query';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport ApiService from '@jwp/ott-common/src/services/ApiService';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { createURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport type { AdConfig } from '@jwp/ott-common/types/ad-schedule';\r\n\r\nconst CACHE_TIME = 60 * 1000 * 20;\r\n\r\n/**\r\n * @deprecated Use ad-config instead.\r\n */\r\nconst useLegacyStandaloneAds = ({ adScheduleId, enabled }: { adScheduleId: string | null | undefined; enabled: boolean }) => {\r\n  const apiService = getModule(ApiService);\r\n\r\n  const { isLoading, data } = useQuery(['ad-schedule', adScheduleId], async () => apiService.getAdSchedule(adScheduleId), {\r\n    enabled: enabled && !!adScheduleId,\r\n    cacheTime: CACHE_TIME,\r\n    staleTime: CACHE_TIME,\r\n  });\r\n\r\n  return {\r\n    isLoading,\r\n    data,\r\n  };\r\n};\r\n\r\nexport const useAds = ({ mediaId }: { mediaId: string }) => {\r\n  const { adSchedule: adScheduleId, adConfig: adConfigId, adScheduleUrls, adDeliveryMethod } = useConfigStore((s) => s.config);\r\n\r\n  // We use client side ads only when delivery method is not pointing at server ads\r\n  // adConfig and adScheduled can't be enabled at the same time\r\n  const useAdConfigFlow = !!adConfigId && adDeliveryMethod !== 'ssai';\r\n\r\n  const { data: adSchedule, isLoading: isAdScheduleLoading } = useLegacyStandaloneAds({ adScheduleId, enabled: !!adScheduleId });\r\n  const adConfig = useAdConfigFlow\r\n    ? ({\r\n        client: 'vast',\r\n        schedule: createURL(adScheduleUrls?.xml || '', {\r\n          media_id: mediaId,\r\n        }),\r\n      } as AdConfig)\r\n    : undefined;\r\n\r\n  return {\r\n    isLoading: useAdConfigFlow ? false : isAdScheduleLoading,\r\n    data: useAdConfigFlow ? adConfig : adSchedule,\r\n  };\r\n};\r\n","import { useQuery } from 'react-query';\r\nimport type { GetPlaylistParams } from '@jwp/ott-common/types/playlist';\r\nimport type { GetMediaParams } from '@jwp/ott-common/types/media';\r\nimport type { EntitlementType } from '@jwp/ott-common/types/entitlement';\r\nimport GenericEntitlementService from '@jwp/ott-common/src/services/GenericEntitlementService';\r\nimport JWPEntitlementService from '@jwp/ott-common/src/services/JWPEntitlementService';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { isTruthyCustomParamValue } from '@jwp/ott-common/src/utils/common';\r\n\r\nconst useContentProtection = <T>(\r\n  type: EntitlementType,\r\n  id: string | undefined,\r\n  callback: (token?: string, drmPolicyId?: string) => Promise<T | undefined>,\r\n  params: GetPlaylistParams | GetMediaParams = {},\r\n  enabled: boolean = true,\r\n  placeholderData?: T,\r\n) => {\r\n  const genericEntitlementService = getModule(GenericEntitlementService);\r\n  const jwpEntitlementService = getModule(JWPEntitlementService);\r\n\r\n  const { configId, signingConfig, contentProtection, jwp, urlSigning, isAccessBridgeEnabled } = useConfigStore(({ config, settings }) => ({\r\n    configId: config.id,\r\n    signingConfig: config.contentSigningService,\r\n    contentProtection: config.contentProtection,\r\n    jwp: config.integrations.jwp,\r\n    urlSigning: isTruthyCustomParamValue(config?.custom?.urlSigning),\r\n    isAccessBridgeEnabled: !!settings?.apiAccessBridgeUrl,\r\n  }));\r\n\r\n  const host = signingConfig?.host;\r\n  const drmPolicyId = contentProtection?.drm?.defaultPolicyId ?? signingConfig?.drmPolicyId;\r\n  const signingEnabled = !!urlSigning || !!host || (!!drmPolicyId && !host);\r\n\r\n  const { data: token, isLoading } = useQuery(\r\n    ['token', type, id, params],\r\n    async () => {\r\n      // if provider is not JWP\r\n      if (!!id && !!host) {\r\n        const accountController = getModule(AccountController);\r\n        const authData = await accountController.getAuthData();\r\n        const { host, drmPolicyId } = signingConfig;\r\n\r\n        return genericEntitlementService.getMediaToken(host, id, authData?.jwt, params, drmPolicyId);\r\n      }\r\n\r\n      // if provider is JWP\r\n      if (jwp && configId && !!id && signingEnabled) {\r\n        return jwpEntitlementService.getJWPMediaToken(configId, id);\r\n      }\r\n    },\r\n    { enabled: signingEnabled && enabled && !!id && !isAccessBridgeEnabled, keepPreviousData: false, staleTime: 15 * 60 * 1000 },\r\n  );\r\n\r\n  const queryResult = useQuery<T | undefined>([type, id, params, token], async () => callback(token, drmPolicyId), {\r\n    enabled: !!id && enabled && (!signingEnabled || !!token),\r\n    placeholderData: id ? placeholderData : undefined,\r\n    retry: 2,\r\n    retryDelay: 1000,\r\n    keepPreviousData: false,\r\n  });\r\n\r\n  return {\r\n    ...queryResult,\r\n    isLoading: isLoading || queryResult.isLoading,\r\n  };\r\n};\r\n\r\nexport default useContentProtection;\r\n","import { useQuery } from 'react-query';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport ApiService from '@jwp/ott-common/src/services/ApiService';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport AccessController from '@jwp/ott-common/src/controllers/AccessController';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\n\r\nimport useContentProtection from './useContentProtection';\r\n\r\nexport default function useProtectedMedia(item: PlaylistItem) {\r\n  const apiService = getModule(ApiService);\r\n  const accessController = getModule(AccessController);\r\n\r\n  const { isAccessBridgeEnabled } = useConfigStore(({ settings }) => ({\r\n    isAccessBridgeEnabled: !!settings?.apiAccessBridgeUrl,\r\n  }));\r\n\r\n  const contentProtectionQuery = useContentProtection('media', item.mediaid, async (token, drmPolicyId) => {\r\n    // If the Access Bridge is enabled, use it to retrieve media via access passport.\r\n    // This bypasses the need for a DRM token or policy and directly uses the access-controlled method.\r\n    if (isAccessBridgeEnabled) {\r\n      return accessController.getMediaById(item.mediaid);\r\n    }\r\n\r\n    // If Access Bridge is not enabled, retrieve the media using the provided DRM token and policy ID.\r\n    return apiService.getMediaById({ id: item.mediaid, token, drmPolicyId });\r\n  });\r\n\r\n  const { isLoading, data: isGeoBlocked } = useQuery(\r\n    ['media', 'geo', item.mediaid],\r\n    () => {\r\n      const m3u8 = contentProtectionQuery.data?.sources.find((source) => source.file.indexOf('.m3u8') !== -1);\r\n      if (m3u8) {\r\n        return fetch(m3u8.file, { method: 'HEAD' }).then((response) => response.status === 403);\r\n      }\r\n      return false;\r\n    },\r\n    {\r\n      enabled: contentProtectionQuery.isFetched,\r\n    },\r\n  );\r\n\r\n  return {\r\n    ...contentProtectionQuery,\r\n    isGeoBlocked,\r\n    isLoading: contentProtectionQuery.isLoading || isLoading,\r\n  };\r\n}\r\n","import type { PlaylistItem, Source } from '@jwp/ott-common/types/playlist';\r\nimport type { Config } from '@jwp/ott-common/types/config';\r\nimport type { Customer } from '@jwp/ott-common/types/account';\r\n\r\nconst isVODManifestType = (sourceUrl: string, baseUrl: string, mediaId: string, extensions: ('m3u8' | 'mpd')[]) => {\r\n  return extensions.some((ext) => sourceUrl === `${baseUrl}/manifests/${mediaId}.${ext}`);\r\n};\r\n\r\nconst isBCLManifestType = (sourceUrl: string, baseUrl: string, mediaId: string, extensions: ('m3u8' | 'mpd')[]) => {\r\n  return extensions.some((ext) => sourceUrl === `${baseUrl}/live/broadcast/${mediaId}.${ext}`);\r\n};\r\n\r\nexport const getSources = ({\r\n  item,\r\n  baseUrl,\r\n  config,\r\n  user,\r\n  passport,\r\n}: {\r\n  item: PlaylistItem;\r\n  baseUrl: string;\r\n  config: Config;\r\n  user: Customer | null;\r\n  passport: string | null;\r\n}) => {\r\n  const { sources, mediaid } = item;\r\n  const { adConfig, siteId, adDeliveryMethod } = config;\r\n\r\n  const userId = user?.id;\r\n  const hasServerAds = !!adConfig && adDeliveryMethod === 'ssai';\r\n\r\n  return sources.map((source: Source) => {\r\n    const url = new URL(source.file);\r\n\r\n    const sourceUrl = url.href;\r\n\r\n    const isBCLManifest = isBCLManifestType(sourceUrl, baseUrl, mediaid, ['m3u8', 'mpd']);\r\n    const isVODManifest = isVODManifestType(sourceUrl, baseUrl, mediaid, ['m3u8', 'mpd']);\r\n    const isDRM = url.searchParams.has('exp') && url.searchParams.has('sig');\r\n\r\n    // Use SSAI URL for configs with server side ads, DRM is not supported\r\n    if (isVODManifest && hasServerAds && !isDRM) {\r\n      // Only HLS is supported now\r\n      url.href = `${baseUrl}/v2/sites/${siteId}/media/${mediaid}/ssai.m3u8`;\r\n      url.searchParams.set('ad_config_id', adConfig);\r\n      // Attach user_id only for VOD and BCL SaaS Live Streams (doesn't work with SSAI items)\r\n    } else if ((isVODManifest || isBCLManifest) && userId) {\r\n      url.searchParams.set('user_id', userId);\r\n    }\r\n\r\n    // Attach the passport in all the drm sources as it's needed for the licence request.\r\n    // Passport is only available if Access Bridge is in use.\r\n    if (passport) {\r\n      attachPassportToSourceWithDRM(source, passport);\r\n    }\r\n\r\n    source.file = url.toString();\r\n    return source;\r\n  });\r\n};\r\n\r\nfunction attachPassportToSourceWithDRM(source: Source, passport: string): Source {\r\n  function updateUrl(urlString: string, passport: string): string {\r\n    const url = new URL(urlString);\r\n    if (!url.searchParams.has('token')) {\r\n      url.searchParams.set('passport', passport);\r\n    }\r\n    return url.toString();\r\n  }\r\n\r\n  if (source?.drm) {\r\n    if (source.drm?.playready?.url) {\r\n      source.drm.playready.url = updateUrl(source.drm.playready.url, passport);\r\n    }\r\n    if (source.drm?.widevine?.url) {\r\n      source.drm.widevine.url = updateUrl(source.drm.widevine.url, passport);\r\n    }\r\n    if (source.drm?.fairplay?.processSpcUrl) {\r\n      source.drm.fairplay.processSpcUrl = updateUrl(source.drm.fairplay.processSpcUrl, passport);\r\n    }\r\n  }\r\n\r\n  return source;\r\n}\r\n","import { useMemo } from 'react';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport type { PlaylistItem, Source } from '@jwp/ott-common/types/playlist';\r\nimport { getSources } from '@jwp/ott-common/src/utils/sources';\r\nimport { useAccessStore } from '@jwp/ott-common/src/stores/AccessStore';\r\n\r\n/** Modify manifest URLs to handle server ads and analytics params */\r\nexport const useMediaSources = ({ item, baseUrl }: { item: PlaylistItem; baseUrl: string }): Source[] => {\r\n  const config = useConfigStore((s) => s.config);\r\n  const user = useAccountStore((s) => s.user);\r\n  const passport = useAccessStore((s) => s.passport);\r\n\r\n  return useMemo(() => getSources({ item, baseUrl, config, user, passport }), [item, baseUrl, config, user, passport]);\r\n};\r\n","import React, { useCallback, useEffect, useRef, useState } from 'react';\r\nimport type { AdConfig, AdSchedule } from '@jwp/ott-common/types/ad-schedule';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { deepCopy } from '@jwp/ott-common/src/utils/collection';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\nimport { logInfo } from '@jwp/ott-common/src/logger';\r\nimport useEventCallback from '@jwp/ott-hooks-react/src/useEventCallback';\r\nimport { useMediaSources } from '@jwp/ott-hooks-react/src/useMediaSources';\r\nimport env from '@jwp/ott-common/src/env';\r\n\r\nimport type { JWPlayer } from '../../../types/jwplayer';\r\nimport { addScript } from '../../utils/dom';\r\n\r\nimport styles from './Player.module.scss';\r\n\r\ntype Props = {\r\n  feedId?: string;\r\n  item: PlaylistItem;\r\n  startTime?: number;\r\n  autostart?: boolean;\r\n  adsData?: AdConfig | AdSchedule;\r\n  onReady?: (player?: JWPlayer) => void;\r\n  onPlay?: () => void;\r\n  onPause?: () => void;\r\n  onComplete?: () => void;\r\n  onUserActive?: () => void;\r\n  onUserInActive?: () => void;\r\n  onBeforePlay?: () => void;\r\n  onFirstFrame?: () => void;\r\n  onRemove?: () => void;\r\n  onNext?: () => void;\r\n  onBackClick?: () => void;\r\n  onPlaylistItem?: () => void;\r\n  onPlaylistItemCallback?: (item: PlaylistItem) => Promise<undefined | PlaylistItem>;\r\n};\r\n\r\nconst Player: React.FC<Props> = ({\r\n  item,\r\n  adsData,\r\n  onReady,\r\n  onPlay,\r\n  onPause,\r\n  onComplete,\r\n  onUserActive,\r\n  onUserInActive,\r\n  onBeforePlay,\r\n  onFirstFrame,\r\n  onRemove,\r\n  onPlaylistItem,\r\n  onPlaylistItemCallback,\r\n  onNext,\r\n  onBackClick,\r\n  feedId,\r\n  startTime = 0,\r\n  autostart,\r\n}: Props) => {\r\n  const playerElementRef = useRef<HTMLDivElement>(null);\r\n  const playerRef = useRef<JWPlayer>();\r\n  const loadingRef = useRef(false);\r\n  const backClickRef = useRef(false);\r\n  const [libLoaded, setLibLoaded] = useState(!!window.jwplayer);\r\n  const startTimeRef = useRef(startTime);\r\n  const sources = useMediaSources({ item, baseUrl: env.APP_API_BASE_URL });\r\n\r\n  const { settings } = useConfigStore((s) => s);\r\n\r\n  const playerId = settings.playerId;\r\n  const playerLicenseKey = settings.playerLicenseKey;\r\n\r\n  const handleBeforePlay = useEventCallback(onBeforePlay);\r\n  const handlePlay = useEventCallback(onPlay);\r\n  const handlePause = useEventCallback(onPause);\r\n  const handleComplete = useEventCallback(onComplete);\r\n  const handleUserActive = useEventCallback(onUserActive);\r\n  const handleUserInactive = useEventCallback(onUserInActive);\r\n  const handleFirstFrame = useEventCallback(() => {\r\n    // a11y: auto focus to play/pause button\r\n    const playerContainer = playerRef.current?.getContainer();\r\n    const playPauseButton = playerContainer?.querySelector(\r\n      '.jw-controlbar [aria-label=\"Play\"], .jw-button-container [aria-label=\"Pause\"]',\r\n    ) as HTMLDivElement | null;\r\n    playPauseButton?.focus();\r\n\r\n    onFirstFrame?.();\r\n  });\r\n  const handleRemove = useEventCallback(onRemove);\r\n  const handlePlaylistItem = useEventCallback(onPlaylistItem);\r\n  const handlePlaylistItemCallback = useEventCallback(onPlaylistItemCallback);\r\n  const handleNextClick = useEventCallback(onNext);\r\n  const handleBackClick = useEventCallback(() => {\r\n    backClickRef.current = true;\r\n    onBackClick?.();\r\n  });\r\n  const handleReady = useEventCallback(() => onReady && onReady(playerRef.current));\r\n\r\n  const attachEvents = useCallback(() => {\r\n    playerRef.current?.on('ready', handleReady);\r\n    playerRef.current?.on('beforePlay', handleBeforePlay);\r\n    playerRef.current?.on('complete', handleComplete);\r\n    playerRef.current?.on('play', handlePlay);\r\n    playerRef.current?.on('pause', handlePause);\r\n    playerRef.current?.on('userActive', handleUserActive);\r\n    playerRef.current?.on('userInactive', handleUserInactive);\r\n    playerRef.current?.on('firstFrame', handleFirstFrame);\r\n    playerRef.current?.on('remove', handleRemove);\r\n    playerRef.current?.on('playlistItem', handlePlaylistItem);\r\n    playerRef.current?.on('nextClick', handleNextClick);\r\n    playerRef.current?.on('backClick', handleBackClick);\r\n    playerRef.current?.setPlaylistItemCallback(handlePlaylistItemCallback);\r\n  }, [\r\n    handleReady,\r\n    handleBeforePlay,\r\n    handleComplete,\r\n    handlePlay,\r\n    handlePause,\r\n    handleUserActive,\r\n    handleUserInactive,\r\n    handleFirstFrame,\r\n    handleRemove,\r\n    handlePlaylistItem,\r\n    handleNextClick,\r\n    handlePlaylistItemCallback,\r\n    handleBackClick,\r\n  ]);\r\n\r\n  const detachEvents = useCallback(() => {\r\n    playerRef.current?.off('ready');\r\n    playerRef.current?.off('beforePlay');\r\n    playerRef.current?.off('complete');\r\n    playerRef.current?.off('play');\r\n    playerRef.current?.off('pause');\r\n    playerRef.current?.off('userActive');\r\n    playerRef.current?.off('userInactive');\r\n    playerRef.current?.off('firstFrame');\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!window.jwplayer && !loadingRef.current) {\r\n      loadingRef.current = true;\r\n\r\n      const scriptUrl = `${env.APP_API_BASE_URL}/libraries/${playerId}.js`;\r\n\r\n      addScript(scriptUrl).then(() => {\r\n        setLibLoaded(true);\r\n        loadingRef.current = false;\r\n      });\r\n    }\r\n  }, [playerId]);\r\n\r\n  useEffect(() => {\r\n    // Update the startTimeRef each time the startTime changes\r\n    startTimeRef.current = startTime;\r\n  }, [startTime]);\r\n\r\n  useEffect(() => {\r\n    const loadPlaylist = () => {\r\n      if (!item || !playerRef.current) {\r\n        return;\r\n      }\r\n\r\n      const currentItem = playerRef.current?.getPlaylistItem() as unknown as PlaylistItem | null;\r\n\r\n      // We already loaded this item\r\n      if (currentItem && currentItem.mediaid === item.mediaid) {\r\n        logInfo('Player', 'Calling loadPlaylist with the same item, check the dependencies');\r\n        return;\r\n      }\r\n\r\n      // Update autostart parameter\r\n      if (typeof autostart !== 'undefined') {\r\n        playerRef.current?.setConfig({ autostart });\r\n      }\r\n\r\n      // Load new item\r\n      playerRef.current.load([deepCopy({ ...item, starttime: startTimeRef.current, feedid: feedId })]);\r\n    };\r\n\r\n    const initializePlayer = () => {\r\n      if (!window.jwplayer || !playerElementRef.current) return;\r\n\r\n      playerRef.current = window.jwplayer(playerElementRef.current) as JWPlayer;\r\n\r\n      // Player options are untyped\r\n      const playerOptions: { [key: string]: unknown } = {\r\n        advertising: {\r\n          ...adsData,\r\n          // Beta feature\r\n          showCountdown: true,\r\n        },\r\n        timeSlider: {\r\n          showAdMarkers: false,\r\n        },\r\n        aspectratio: false,\r\n        controls: true,\r\n        displaytitle: false,\r\n        displayHeading: false,\r\n        displaydescription: false,\r\n        floating: {\r\n          mode: 'never',\r\n        },\r\n        height: '100%',\r\n        mute: false,\r\n        playbackRateControls: true,\r\n        pipIcon: 'disabled',\r\n        playlist: [deepCopy({ ...item, starttime: startTimeRef.current, feedid: feedId, sources })],\r\n        repeat: false,\r\n        cast: {},\r\n        stretching: 'uniform',\r\n        width: '100%',\r\n      };\r\n\r\n      // Only set the autostart parameter when it is defined or it will override the player.defaults autostart setting\r\n      if (typeof autostart !== 'undefined') {\r\n        playerOptions.autostart = autostart;\r\n      }\r\n\r\n      // Set the license key if provided\r\n      if (playerLicenseKey) {\r\n        playerOptions.key = playerLicenseKey;\r\n      }\r\n      playerRef.current.setup(playerOptions);\r\n\r\n      attachEvents();\r\n    };\r\n\r\n    if (playerRef.current) {\r\n      return loadPlaylist();\r\n    }\r\n\r\n    if (libLoaded) {\r\n      initializePlayer();\r\n    }\r\n  }, [libLoaded, item, detachEvents, attachEvents, playerId, autostart, adsData, playerLicenseKey, sources, feedId]);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      if (playerRef.current) {\r\n        // Detaching events before component unmount\r\n        detachEvents();\r\n        if (backClickRef.current) {\r\n          backClickRef.current = false;\r\n          return;\r\n        }\r\n        playerRef.current.remove();\r\n      }\r\n    };\r\n  }, [detachEvents, backClickRef]);\r\n\r\n  return (\r\n    <div className={styles.container} data-testid={testId('player-container')}>\r\n      <div ref={playerElementRef} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Player;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport styles from './PlayerError.module.scss';\r\n\r\nexport enum PlayerErrorState {\r\n  GEO_BLOCKED = 'GEO_BLOCKED',\r\n}\r\n\r\ntype Props = {\r\n  error: keyof typeof PlayerErrorState;\r\n};\r\n\r\nconst PlayerError: React.FC<Props> = () => {\r\n  const { t } = useTranslation('video');\r\n  return (\r\n    <div className={styles.error}>\r\n      <h2 className={styles.title}>{t('player_error.geo_blocked_title')}</h2>\r\n      <p>{t('player_error.geo_blocked_description')}</p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PlayerError;\r\n","import React, { useCallback, useState } from 'react';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { useWatchHistory } from '@jwp/ott-hooks-react/src/useWatchHistory';\r\nimport { usePlaylistItemCallback } from '@jwp/ott-hooks-react/src/usePlaylistItemCallback';\r\nimport { useAds } from '@jwp/ott-hooks-react/src/useAds';\r\nimport useProtectedMedia from '@jwp/ott-hooks-react/src/useProtectedMedia';\r\n\r\nimport type { JWPlayer } from '../../../types/jwplayer';\r\nimport Player from '../../components/Player/Player';\r\nimport LoadingOverlay from '../../components/LoadingOverlay/LoadingOverlay';\r\nimport PlayerError, { PlayerErrorState } from '../../components/PlayerError/PlayerError';\r\n\r\ntype Props = {\r\n  item: PlaylistItem;\r\n  seriesItem?: PlaylistItem;\r\n  onPlay?: () => void;\r\n  onPause?: () => void;\r\n  onComplete?: () => void;\r\n  onClose?: () => void;\r\n  onUserActive?: () => void;\r\n  onUserInActive?: () => void;\r\n  onNext?: () => void;\r\n  onBackClick?: () => void;\r\n  feedId?: string;\r\n  liveStartDateTime?: string | null;\r\n  liveEndDateTime?: string | null;\r\n  liveFromBeginning?: boolean;\r\n  autostart?: boolean;\r\n};\r\n\r\nconst PlayerContainer: React.FC<Props> = ({\r\n  item,\r\n  seriesItem,\r\n  feedId,\r\n  onPlay,\r\n  onPause,\r\n  onComplete,\r\n  onUserActive,\r\n  onUserInActive,\r\n  onNext,\r\n  onBackClick,\r\n  liveEndDateTime,\r\n  liveFromBeginning,\r\n  liveStartDateTime,\r\n  autostart,\r\n}: Props) => {\r\n  // data\r\n  const { data: adsData, isLoading: isAdsLoading } = useAds({ mediaId: item?.mediaid });\r\n  const { data: playableItem, isLoading, isGeoBlocked } = useProtectedMedia(item);\r\n  // state\r\n  const [playerInstance, setPlayerInstance] = useState<JWPlayer>();\r\n\r\n  // watch history\r\n  const startTime = useWatchHistory(playerInstance, item, seriesItem);\r\n\r\n  // player events\r\n  const handleReady = useCallback((player?: JWPlayer) => {\r\n    setPlayerInstance(player);\r\n  }, []);\r\n\r\n  const handleFirstFrame = useCallback(() => {\r\n    // when playing a livestream, the first moment we can seek to the beginning of the DVR range is after the\r\n    // firstFrame event.\r\n    // @todo this doesn't seem to work 100% out of the times. Confirm with player team if this is the best approach.\r\n    if (liveFromBeginning) {\r\n      playerInstance?.seek(0);\r\n    }\r\n  }, [liveFromBeginning, playerInstance]);\r\n\r\n  const handlePlaylistItemCallback = usePlaylistItemCallback(liveStartDateTime, liveEndDateTime);\r\n\r\n  if (!playableItem || isLoading || isAdsLoading) {\r\n    return <LoadingOverlay inline />;\r\n  }\r\n\r\n  if (isGeoBlocked) {\r\n    return <PlayerError error={PlayerErrorState.GEO_BLOCKED} />;\r\n  }\r\n\r\n  return (\r\n    <Player\r\n      feedId={feedId}\r\n      item={playableItem}\r\n      adsData={adsData}\r\n      onReady={handleReady}\r\n      onFirstFrame={handleFirstFrame}\r\n      onPlay={onPlay}\r\n      onPause={onPause}\r\n      onComplete={onComplete}\r\n      onUserActive={onUserActive}\r\n      onUserInActive={onUserInActive}\r\n      onNext={onNext}\r\n      onBackClick={onBackClick}\r\n      onPlaylistItemCallback={handlePlaylistItemCallback}\r\n      startTime={startTime}\r\n      autostart={autostart}\r\n    />\r\n  );\r\n};\r\n\r\nexport default PlayerContainer;\r\n","import React from 'react';\r\nimport { useLocation, useNavigate } from 'react-router';\r\nimport { useTranslation } from 'react-i18next';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport Lock from '@jwp/ott-theme/assets/icons/lock.svg?react';\r\nimport { modalURLFromLocation } from '@jwp/ott-ui-react/src/utils/location';\r\n\r\nimport Image from '../../components/Image/Image';\r\nimport Fade from '../../components/Animation/Fade/Fade';\r\nimport Button from '../../components/Button/Button';\r\nimport PlayerContainer from '../PlayerContainer/PlayerContainer';\r\nimport Icon from '../../components/Icon/Icon';\r\n\r\nimport styles from './InlinePlayer.module.scss';\r\n\r\ntype Props = {\r\n  item: PlaylistItem;\r\n  seriesItem?: PlaylistItem;\r\n  onPlay?: () => void;\r\n  onPause?: () => void;\r\n  onComplete?: () => void;\r\n  feedId?: string;\r\n  liveStartDateTime?: string | null;\r\n  liveEndDateTime?: string | null;\r\n  liveFromBeginning?: boolean;\r\n  startWatchingButton: React.ReactNode;\r\n  isLoggedIn: boolean;\r\n  isEntitled: boolean;\r\n  playable?: boolean;\r\n  autostart?: boolean;\r\n  hasMediaOffers?: boolean;\r\n};\r\n\r\nconst InlinePlayer: React.FC<Props> = ({\r\n  item,\r\n  seriesItem,\r\n  onPlay,\r\n  onPause,\r\n  onComplete,\r\n  feedId,\r\n  liveStartDateTime,\r\n  liveEndDateTime,\r\n  liveFromBeginning,\r\n  startWatchingButton,\r\n  isLoggedIn,\r\n  isEntitled,\r\n  autostart,\r\n  playable = true,\r\n  hasMediaOffers,\r\n}: Props) => {\r\n  const siteName = useConfigStore((s) => s.config.siteName);\r\n  const { t } = useTranslation();\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n\r\n  const loginButtonClickHandler = () => {\r\n    navigate(modalURLFromLocation(location, 'login'));\r\n  };\r\n\r\n  const buyLabel = hasMediaOffers ? t('video:buy_to_start_watching') : t('video:sign_up_to_start_watching');\r\n\r\n  return (\r\n    <div className={styles.inlinePlayer}>\r\n      <Fade open={!playable || !isEntitled}>\r\n        <div className={styles.paywall}>\r\n          <Image className={styles.poster} image={item.backgroundImage} alt={item.title} width={1280} />\r\n          {!isEntitled && (\r\n            <>\r\n              <Icon icon={Lock} className={styles.lock} />\r\n              <h2 className={styles.title}>{buyLabel}</h2>\r\n              <span className={styles.text}>{t('account:choose_offer.watch_this_on_platform', { siteName })}</span>\r\n              {startWatchingButton}\r\n              {!isLoggedIn && <Button onClick={loginButtonClickHandler} label={t('common:sign_in')} />}\r\n            </>\r\n          )}\r\n        </div>\r\n      </Fade>\r\n      {isEntitled && playable && (\r\n        <PlayerContainer\r\n          item={item}\r\n          seriesItem={seriesItem}\r\n          feedId={feedId}\r\n          autostart={autostart}\r\n          onPlay={onPlay}\r\n          onPause={onPause}\r\n          onComplete={onComplete}\r\n          liveEndDateTime={liveEndDateTime}\r\n          liveFromBeginning={liveFromBeginning}\r\n          liveStartDateTime={liveStartDateTime}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InlinePlayer;\r\n","import React, { useCallback, useEffect, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport ArrowLeft from '@jwp/ott-theme/assets/icons/arrow_left.svg?react';\r\n\r\nimport IconButton from '../../components/IconButton/IconButton';\r\nimport PlayerContainer from '../PlayerContainer/PlayerContainer';\r\nimport Fade from '../../components/Animation/Fade/Fade';\r\nimport Icon from '../../components/Icon/Icon';\r\nimport Modal from '../../components/Modal/Modal';\r\n\r\nimport styles from './Cinema.module.scss';\r\n\r\ntype Props = {\r\n  open: boolean;\r\n  item: PlaylistItem;\r\n  seriesItem?: PlaylistItem;\r\n  onPlay?: () => void;\r\n  onPause?: () => void;\r\n  onComplete?: () => void;\r\n  onClose?: () => void;\r\n  onNext?: () => void;\r\n  feedId?: string;\r\n  title: string;\r\n  primaryMetadata: React.ReactNode;\r\n  secondaryMetadata?: React.ReactNode;\r\n  liveStartDateTime?: string | null;\r\n  liveEndDateTime?: string | null;\r\n  liveFromBeginning?: boolean;\r\n};\r\n\r\nconst Cinema: React.FC<Props> = ({\r\n  open,\r\n  item,\r\n  seriesItem,\r\n  title,\r\n  primaryMetadata,\r\n  secondaryMetadata,\r\n  onPlay,\r\n  onPause,\r\n  onComplete,\r\n  onClose,\r\n  onNext,\r\n  feedId,\r\n  liveStartDateTime,\r\n  liveEndDateTime,\r\n  liveFromBeginning,\r\n}: Props) => {\r\n  const { t } = useTranslation();\r\n\r\n  // state\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [overlayHasFocus, setOverlayHasFocus] = useState(false);\r\n  const [userActive, setUserActive] = useState(true);\r\n\r\n  const handlePlay = useCallback(() => {\r\n    setIsPlaying(true);\r\n    onPlay && onPlay();\r\n  }, [onPlay]);\r\n\r\n  const handlePause = useCallback(() => {\r\n    setIsPlaying(false);\r\n    onPause && onPause();\r\n  }, [onPause]);\r\n\r\n  const handleComplete = useCallback(() => {\r\n    onComplete && onComplete();\r\n  }, [onComplete]);\r\n\r\n  const handleNext = useCallback(() => {\r\n    onNext && onNext();\r\n  }, [onNext]);\r\n\r\n  const handleUserActive = useCallback(() => setUserActive(true), []);\r\n  const handleUserInactive = useCallback(() => setUserActive(false), []);\r\n\r\n  // effects\r\n  useEffect(() => {\r\n    if (open) setUserActive(true);\r\n  }, [open]);\r\n\r\n  return (\r\n    <Modal open={open} animationContainerClassName={styles.cinemaContainer} onClose={onClose} aria-label={t('videoplayer')}>\r\n      <div className={styles.cinema}>\r\n        <Fade className={styles.overlayFade} open={!isPlaying || userActive || overlayHasFocus} keepMounted>\r\n          <div className={styles.playerOverlay} onFocus={() => setOverlayHasFocus(true)} onBlur={() => setOverlayHasFocus(false)}>\r\n            <div className={styles.playerContent}>\r\n              <IconButton aria-label={t('common:back')} onClick={onClose} className={styles.backButton}>\r\n                <Icon icon={ArrowLeft} />\r\n              </IconButton>\r\n              <div>\r\n                <h1 className={styles.title}>{title}</h1>\r\n                <div className={styles.metaContainer}>\r\n                  {secondaryMetadata && <div className={styles.secondaryMetadata}>{secondaryMetadata}</div>}\r\n                  <div className={styles.primaryMetadata}>{primaryMetadata}</div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </Fade>\r\n        <PlayerContainer\r\n          item={item}\r\n          seriesItem={seriesItem}\r\n          feedId={feedId}\r\n          autostart={true}\r\n          onPlay={handlePlay}\r\n          onPause={handlePause}\r\n          onComplete={handleComplete}\r\n          onUserActive={handleUserActive}\r\n          onUserInActive={handleUserInactive}\r\n          onNext={handleNext}\r\n          onBackClick={onClose}\r\n          liveEndDateTime={liveEndDateTime}\r\n          liveFromBeginning={liveFromBeginning}\r\n          liveStartDateTime={liveStartDateTime}\r\n        />\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default Cinema;\r\n","import React, { useCallback, useState } from 'react';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\n\r\nimport Modal from '../../components/Modal/Modal';\r\nimport Player from '../../components/Player/Player';\r\nimport ModalCloseButton from '../../components/ModalCloseButton/ModalCloseButton';\r\nimport Fade from '../../components/Animation/Fade/Fade';\r\n\r\nimport styles from './TrailerModal.module.scss';\r\n\r\ntype Props = {\r\n  item?: PlaylistItem | null;\r\n  title: string;\r\n  open: boolean;\r\n  onClose: () => void;\r\n};\r\n\r\nconst TrailerModal: React.FC<Props> = ({ item, open, title, onClose }) => {\r\n  const [isPlaying, setIsPlaying] = useState<boolean>(false);\r\n  const [userActive, setUserActive] = useState(true);\r\n\r\n  const handlePlay = useCallback(() => setIsPlaying(true), []);\r\n  const handlePause = useCallback(() => setIsPlaying(false), []);\r\n  const handleUserActive = useCallback(() => setUserActive(true), []);\r\n  const handleUserInactive = useCallback(() => setUserActive(false), []);\r\n\r\n  if (!item) return null;\r\n\r\n  return (\r\n    <Modal open={open} onClose={onClose} aria-labelledby=\"trailer-modal-title\" centered>\r\n      <div className={styles.container}>\r\n        <Player\r\n          item={item}\r\n          onPlay={handlePlay}\r\n          onPause={handlePause}\r\n          onComplete={onClose}\r\n          onUserActive={handleUserActive}\r\n          onUserInActive={handleUserInactive}\r\n          autostart\r\n        />\r\n        <Fade open={!isPlaying || userActive} keepMounted>\r\n          <div className={styles.playerOverlay}>\r\n            <h1 id=\"trailer-modal-title\" className={styles.title}>\r\n              {title}\r\n            </h1>\r\n          </div>\r\n          <ModalCloseButton onClick={onClose} />\r\n        </Fade>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default TrailerModal;\r\n","import * as React from \"react\";\nconst SvgCheck = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\" }));\nexport default SvgCheck;\n","import * as React from \"react\";\nconst SvgShare = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z\" }));\nexport default SvgShare;\n","export const copyToClipboard = (value: string): void => {\r\n  const focusedElement = document.activeElement as HTMLElement;\r\n  const inputElement = document.createElement('input');\r\n  inputElement.style.zIndex = '-10';\r\n  inputElement.style.position = 'absolute';\r\n  inputElement.style.left = '-1000';\r\n  inputElement.value = value;\r\n  document.body.appendChild(inputElement);\r\n  inputElement.select();\r\n  document.execCommand('copy');\r\n  inputElement.blur();\r\n  document.body.removeChild(inputElement);\r\n  focusedElement?.focus();\r\n};\r\n","import React, { useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport Check from '@jwp/ott-theme/assets/icons/check.svg?react';\r\nimport Share from '@jwp/ott-theme/assets/icons/share.svg?react';\r\nimport useBreakpoint, { Breakpoint } from '@jwp/ott-ui-react/src/hooks/useBreakpoint';\r\n\r\nimport { copyToClipboard } from '../../utils/clipboard';\r\nimport Button from '../Button/Button';\r\nimport Icon from '../Icon/Icon';\r\n\r\ntype Props = {\r\n  title: string;\r\n  description: string;\r\n  url: string;\r\n};\r\n\r\nconst ShareButton = ({ title, description, url }: Props) => {\r\n  const { t } = useTranslation();\r\n  const breakpoint = useBreakpoint();\r\n  const [hasShared, setHasShared] = useState<boolean>(false);\r\n\r\n  const onShareClick = async () => {\r\n    if (typeof navigator.share === 'function') {\r\n      await navigator.share({ title, text: description, url });\r\n      return;\r\n    }\r\n\r\n    copyToClipboard(window.location.href);\r\n    setHasShared(true);\r\n    setTimeout(() => setHasShared(false), 2000);\r\n  };\r\n\r\n  return (\r\n    <Button\r\n      label={hasShared ? t('video:copied_url') : t('video:share')}\r\n      startIcon={hasShared ? <Icon icon={Check} /> : <Icon icon={Share} />}\r\n      onClick={onShareClick}\r\n      active={hasShared}\r\n      fullWidth={breakpoint < Breakpoint.md}\r\n    />\r\n  );\r\n};\r\n\r\nexport default ShareButton;\r\n","import * as React from \"react\";\nconst SvgFavoriteBorder = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M12.1,18.55L12,18.65L11.89,18.55C7.14,14.24 4,11.39 4,8.5C4,6.5 5.5,5 7.5,5C9.04,5 10.54,6 11.07,7.36H12.93C13.46,6 14.96,5 16.5,5C18.5,5 20,6.5 20,8.5C20,11.39 16.86,14.24 12.1,18.55M16.5,3C14.76,3 13.09,3.81 12,5.08C10.91,3.81 9.24,3 7.5,3C4.42,3 2,5.41 2,8.5C2,12.27 5.4,15.36 10.55,20.03L12,21.35L13.45,20.03C18.6,15.36 22,12.27 22,8.5C22,5.41 19.58,3 16.5,3Z\" }));\nexport default SvgFavoriteBorder;\n","import React, { useCallback, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { useFavoritesStore } from '@jwp/ott-common/src/stores/FavoritesStore';\r\nimport FavoritesController from '@jwp/ott-common/src/controllers/FavoritesController';\r\nimport Favorite from '@jwp/ott-theme/assets/icons/favorite.svg?react';\r\nimport FavoriteBorder from '@jwp/ott-theme/assets/icons/favorite_border.svg?react';\r\nimport useBreakpoint, { Breakpoint } from '@jwp/ott-ui-react/src/hooks/useBreakpoint';\r\n\r\nimport Button from '../../components/Button/Button';\r\nimport Alert from '../../components/Alert/Alert';\r\nimport Icon from '../../components/Icon/Icon';\r\n\r\ntype Props = {\r\n  item: PlaylistItem;\r\n};\r\n\r\nconst FavoriteButton: React.VFC<Props> = ({ item }) => {\r\n  const { t } = useTranslation();\r\n  const breakpoint = useBreakpoint();\r\n  const favoritesController = getModule(FavoritesController);\r\n\r\n  const { isFavorite, clearWarning, warning } = useFavoritesStore((state) => ({\r\n    isFavorite: !!item && state.hasItem(item),\r\n    clearWarning: state.clearWarning,\r\n    warning: state.warning,\r\n  }));\r\n\r\n  const onFavoriteButtonClick = useCallback(async () => {\r\n    await favoritesController.toggleFavorite(item);\r\n  }, [item, favoritesController]);\r\n\r\n  useEffect(() => {\r\n    // clear warning on unmount (probably by navigating away from the page using the back button)\r\n    return () => clearWarning();\r\n  }, [clearWarning]);\r\n\r\n  return (\r\n    <>\r\n      <Button\r\n        label={t('video:favorite')}\r\n        aria-label={t('video:favorite')}\r\n        startIcon={isFavorite ? <Icon icon={Favorite} /> : <Icon icon={FavoriteBorder} />}\r\n        onClick={onFavoriteButtonClick}\r\n        aria-pressed={isFavorite}\r\n        color={isFavorite ? 'primary' : 'default'}\r\n        fullWidth={breakpoint < Breakpoint.md}\r\n      />\r\n      <Alert open={warning !== null} message={warning} onClose={clearWarning} />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default FavoriteButton;\r\n","import Spinner from '../../components/Spinner/Spinner';\r\n\r\nimport styles from './Loading.module.scss';\r\n\r\nconst Loading = () => {\r\n  return (\r\n    <div className={styles.loading}>\r\n      <Spinner />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Loading;\r\n","import React from 'react';\r\n\r\nimport styles from './VideoMetaData.module.scss';\r\n\r\ntype Props = {\r\n  attributes: string[];\r\n  separator?: string;\r\n};\r\n\r\nconst VideoMetaData: React.FC<Props> = ({ attributes, separator = '•' }: Props) => {\r\n  return (\r\n    <div>\r\n      {attributes.map((value, index) => (\r\n        <React.Fragment key={value}>\r\n          <span>{value}</span>\r\n          {index < attributes.length - 1 && (\r\n            <span className={styles.separator} aria-hidden=\"true\">\r\n              {separator}\r\n            </span>\r\n          )}\r\n        </React.Fragment>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VideoMetaData;\r\n","/**\r\n * Seconds to ISO8601 duration or date string\r\n * TODO: use date-fns to replace this util\r\n */\r\nexport function secondsToISO8601(input: number, timeOnly: boolean = false): string {\r\n  if (!input) {\r\n    return '';\r\n  }\r\n\r\n  const date = new Date(input ? input * 1000 : 0);\r\n  const hours = date.getUTCHours();\r\n  const minutes = date.getUTCMinutes();\r\n  const seconds = date.getUTCSeconds();\r\n\r\n  if (!timeOnly) {\r\n    return date.toISOString();\r\n  }\r\n\r\n  let isoString = 'PT';\r\n  if (hours > 0) isoString += hours + 'H';\r\n  if (minutes > 0) isoString += minutes + 'M';\r\n  if (seconds > 0) isoString += seconds + 'S';\r\n\r\n  return isoString;\r\n}\r\n\r\nexport const is12HourClock = () => {\r\n  const date = new Date(Date.UTC(2022, 6, 20, 18, 0, 0));\r\n  return /am|pm/.test(date.toLocaleTimeString());\r\n};\r\n","import i18next from 'i18next';\r\nimport type { Playlist, PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport type { EpisodeMetadata } from '@jwp/ott-common/types/series';\r\nimport { legacySeriesURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport { secondsToISO8601 } from '@jwp/ott-common/src/utils/datetime';\r\nimport env from '@jwp/ott-common/src/env';\r\n\r\n/**\r\n * Get an array of options for a season filter\r\n */\r\nexport const getFiltersFromSeries = (playlist: Playlist | undefined): { value: string; label: string }[] => {\r\n  // Old series doesn't have sorting supported and just aggregates all episodes in one playlist\r\n  // So we need to sort the playlist manually based on the selected filter (season).\r\n  return (playlist?.playlist || [])\r\n    .reduce((filters, item) => {\r\n      if (filters.some((el) => el?.value === item?.seasonNumber)) {\r\n        return filters;\r\n      }\r\n\r\n      return filters.concat(\r\n        item.seasonNumber ? [{ label: i18next.t('video:season_number_filter_template', { seasonNumber: item.seasonNumber }), value: item.seasonNumber }] : [],\r\n      );\r\n    }, [] as { value: string; label: string }[])\r\n    .slice()\r\n    .sort();\r\n};\r\n\r\n/**\r\n * Get a playlist with episodes based on the selected filter\r\n */\r\nexport const filterSeries = (playlist: Playlist | undefined, filter: string | undefined): Playlist | undefined => {\r\n  if (!playlist) return;\r\n\r\n  if (filter === '') return playlist;\r\n\r\n  return {\r\n    ...playlist,\r\n    // Filter episodes manually for the old flow where our playlists includes all episodes with all seasons\r\n    playlist: playlist.playlist.filter(({ seasonNumber }) => seasonNumber === filter),\r\n  };\r\n};\r\n\r\nexport const getNextItem = (episode: PlaylistItem | undefined, seriesPlaylist: Playlist | undefined): PlaylistItem | undefined => {\r\n  if (!episode || !seriesPlaylist) return;\r\n\r\n  // For the old flow we already have all the episodes and seasons so we just need to find them in the array\r\n  const index = seriesPlaylist?.playlist?.findIndex(({ mediaid }) => mediaid === episode.mediaid);\r\n\r\n  return seriesPlaylist?.playlist?.[index + 1];\r\n};\r\n\r\n/** Get a total amount of episodes in a season */\r\nexport const getEpisodesInSeason = (episode: PlaylistItem | undefined, seriesPlaylist: Playlist | undefined) => {\r\n  if (!seriesPlaylist) return;\r\n\r\n  return seriesPlaylist.playlist.filter((i) => i.seasonNumber === episode?.seasonNumber)?.length;\r\n};\r\n\r\nexport const generateLegacySeriesMetadata = (seriesPlaylist: Playlist, seriesId: string | undefined) => {\r\n  // Use playlist for old flow and media id for a new flow\r\n  const seriesCanonical = `${env.APP_PUBLIC_URL}/s/${seriesId}`;\r\n\r\n  return {\r\n    '@type': 'TVSeries',\r\n    '@id': seriesCanonical,\r\n    name: seriesPlaylist.title,\r\n    numberOfEpisodes: String(seriesPlaylist.playlist.length),\r\n    numberOfSeasons: String(\r\n      seriesPlaylist.playlist.reduce(function (list, playlistItem) {\r\n        return !playlistItem.seasonNumber || list.includes(playlistItem.seasonNumber) ? list : list.concat(playlistItem.seasonNumber);\r\n      }, [] as string[]).length,\r\n    ),\r\n  };\r\n};\r\n\r\nexport const generateLegacyEpisodeJSONLD = (\r\n  seriesPlaylist: Playlist,\r\n  episode: PlaylistItem | undefined,\r\n  episodeMetadata: EpisodeMetadata | undefined,\r\n  seriesId: string,\r\n) => {\r\n  const episodeCanonical = `${env.APP_PUBLIC_URL}${legacySeriesURL({ episodeId: episode?.mediaid, seriesId })}`;\r\n  const seriesMetadata = generateLegacySeriesMetadata(seriesPlaylist, seriesId);\r\n\r\n  if (!episode) {\r\n    return JSON.stringify(seriesMetadata);\r\n  }\r\n\r\n  return JSON.stringify({\r\n    '@context': 'http://schema.org/',\r\n    '@type': 'TVEpisode',\r\n    '@id': episodeCanonical,\r\n    episodeNumber: episodeMetadata?.episodeNumber,\r\n    seasonNumber: episodeMetadata?.seasonNumber,\r\n    name: episode.title,\r\n    uploadDate: secondsToISO8601(episode.pubdate),\r\n    partOfSeries: seriesMetadata,\r\n  });\r\n};\r\n","import React, { useCallback, useEffect, useMemo, useState } from 'react';\r\nimport { useNavigate, useParams } from 'react-router';\r\nimport { Helmet } from 'react-helmet';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { useWatchHistoryStore } from '@jwp/ott-common/src/stores/WatchHistoryStore';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport { createPlaylistMetadata, createVideoMetadata } from '@jwp/ott-common/src/utils/metadata';\r\nimport { formatSeriesMetaString } from '@jwp/ott-common/src/utils/formatting';\r\nimport { legacySeriesURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport useEntitlement from '@jwp/ott-hooks-react/src/useEntitlement';\r\nimport useMedia from '@jwp/ott-hooks-react/src/useMedia';\r\nimport useBreakpoint, { Breakpoint } from '@jwp/ott-ui-react/src/hooks/useBreakpoint';\r\nimport useQueryParam from '@jwp/ott-ui-react/src/hooks/useQueryParam';\r\nimport usePlaylist from '@jwp/ott-hooks-react/src/usePlaylist';\r\nimport PlayTrailer from '@jwp/ott-theme/assets/icons/play_trailer.svg?react';\r\nimport env from '@jwp/ott-common/src/env';\r\n\r\nimport VideoLayout from '../../components/VideoLayout/VideoLayout';\r\nimport InlinePlayer from '../../containers/InlinePlayer/InlinePlayer';\r\nimport ErrorPage from '../../components/ErrorPage/ErrorPage';\r\nimport StartWatchingButton from '../../containers/StartWatchingButton/StartWatchingButton';\r\nimport Cinema from '../../containers/Cinema/Cinema';\r\nimport TrailerModal from '../../containers/TrailerModal/TrailerModal';\r\nimport ShareButton from '../../components/ShareButton/ShareButton';\r\nimport FavoriteButton from '../../containers/FavoriteButton/FavoriteButton';\r\nimport Button from '../../components/Button/Button';\r\nimport Loading from '../Loading/Loading';\r\nimport Icon from '../../components/Icon/Icon';\r\nimport VideoMetaData from '../../components/VideoMetaData/VideoMetaData';\r\n\r\nimport { filterSeries, generateLegacyEpisodeJSONLD, getEpisodesInSeason, getFiltersFromSeries, getNextItem } from './utils';\r\n\r\nconst LegacySeries = () => {\r\n  const breakpoint = useBreakpoint();\r\n  const { t } = useTranslation('video');\r\n  const [playTrailer, setPlayTrailer] = useState<boolean>(false);\r\n\r\n  // Navigation\r\n  const navigate = useNavigate();\r\n  const params = useParams();\r\n  const seriesId = params.id || '';\r\n  const play = useQueryParam('play') === '1';\r\n  const feedId = useQueryParam('r');\r\n  const episodeId = useQueryParam('e');\r\n\r\n  // Main data\r\n  const { isLoading: isSeriesPlaylistLoading, data: seriesPlaylist, isError: isPlaylistError } = usePlaylist(seriesId, {}, true, false);\r\n  const { isLoading: isEpisodeLoading, data: episode } = useMedia(episodeId || '');\r\n  const { isLoading: isTrailerLoading, data: trailerItem } = useMedia(episode?.trailerId || '');\r\n\r\n  const episodeMetadata = useMemo(() => ({ episodeNumber: episode?.episodeNumber || '0', seasonNumber: episode?.seasonNumber || '0' }), [episode]);\r\n\r\n  // Whether we show series or episode information. For old series flow we only have access to the playlist\r\n  const selectedItem = episode || seriesPlaylist;\r\n  const selectedItemImage = (selectedItem?.image as string) || '';\r\n\r\n  // Config\r\n  const { config, accessModel } = useConfigStore(({ config, accessModel }) => ({ config, accessModel }), shallow);\r\n  const { features, siteName, custom } = config;\r\n  const isFavoritesEnabled: boolean = Boolean(features?.favoritesList);\r\n  const inlineLayout = Boolean(custom?.inlinePlayer);\r\n\r\n  // Filters\r\n  const filters = useMemo(() => getFiltersFromSeries(seriesPlaylist), [seriesPlaylist]);\r\n  const [seasonFilter, setSeasonFilter] = useState<string | undefined>(undefined);\r\n\r\n  const firstEpisode = useMemo(() => seriesPlaylist?.playlist?.[0], [seriesPlaylist]);\r\n  const filteredPlaylist = useMemo(() => filterSeries(seriesPlaylist, seasonFilter), [seriesPlaylist, seasonFilter]);\r\n  const episodesInSeason = getEpisodesInSeason(episode, seriesPlaylist);\r\n  const nextItem = useMemo(() => getNextItem(episode, seriesPlaylist), [episode, seriesPlaylist]);\r\n\r\n  // Watch history\r\n  const watchHistoryDictionary = useWatchHistoryStore((state) => state.getDictionaryWithEpisodes());\r\n\r\n  // User, entitlement\r\n  const { user, subscription } = useAccountStore(({ user, subscription }) => ({ user, subscription }), shallow);\r\n  const { isEntitled, mediaOffers } = useEntitlement(episode || firstEpisode);\r\n  const hasMediaOffers = !!mediaOffers.length;\r\n  const isLoggedIn = !!user;\r\n  const hasSubscription = !!subscription;\r\n\r\n  // Handlers\r\n  const goBack = () => episode && navigate(legacySeriesURL({ episodeId: episode.mediaid, seriesId, play: false, playlistId: feedId }));\r\n  const getUrl = (toEpisode: PlaylistItem) => {\r\n    return seriesPlaylist ? legacySeriesURL({ episodeId: toEpisode.mediaid, seriesId, play: false, playlistId: feedId }) : '';\r\n  };\r\n\r\n  const handleComplete = useCallback(async () => {\r\n    navigate(legacySeriesURL({ episodeId: nextItem?.mediaid, seriesId, play: !!nextItem, playlistId: feedId }));\r\n  }, [navigate, nextItem, seriesId, feedId]);\r\n\r\n  // Effects\r\n  useEffect(() => {\r\n    (document.scrollingElement || document.body).scroll({ top: 0 });\r\n    (document.querySelector('#video-details button') as HTMLElement)?.focus();\r\n  }, [episode]);\r\n\r\n  useEffect(() => {\r\n    if (isSeriesPlaylistLoading || isEpisodeLoading) {\r\n      return;\r\n    }\r\n\r\n    if (seasonFilter === undefined) {\r\n      setSeasonFilter(parseInt(episodeMetadata?.seasonNumber, 10) ? episodeMetadata?.seasonNumber : filters?.[0]?.value || '');\r\n    }\r\n  }, [episodeMetadata, seasonFilter, isSeriesPlaylistLoading, isEpisodeLoading, filters]);\r\n\r\n  // UI\r\n  const isLoading = isSeriesPlaylistLoading || isEpisodeLoading;\r\n  if (isLoading) return <Loading />;\r\n  if (isPlaylistError || !seriesPlaylist || !selectedItem || !firstEpisode) return <ErrorPage title={t('series_error')} />;\r\n\r\n  const pageTitle = `${selectedItem.title} - ${siteName}`;\r\n  const pageDescription = selectedItem?.description || '';\r\n  const canonicalUrl = `${env.APP_PUBLIC_URL}${legacySeriesURL({ episodeId: episode?.mediaid, seriesId })}`;\r\n  const backgroundImage = (selectedItem.backgroundImage as string) || undefined;\r\n\r\n  const primaryMetadata = episode ? (\r\n    <VideoMetaData\r\n      attributes={createVideoMetadata(episode, {\r\n        episodesLabel: t('video:total_episodes', { count: seriesPlaylist?.playlist?.length }),\r\n        hoursAbbreviation: t('common:abbreviation.hours'),\r\n        minutesAbbreviation: t('common:abbreviation.minutes'),\r\n      })}\r\n    />\r\n  ) : (\r\n    <VideoMetaData attributes={createPlaylistMetadata(seriesPlaylist, t('video:total_episodes', { count: seriesPlaylist?.playlist?.length }))} />\r\n  );\r\n  const secondaryMetadata = episodeMetadata && episode && (\r\n    <>\r\n      <strong>{formatSeriesMetaString(episodeMetadata.seasonNumber, episodeMetadata.episodeNumber)}</strong> - {episode.title}\r\n    </>\r\n  );\r\n  const filterMetadata =\r\n    episodeMetadata &&\r\n    ` ${t('video:season')} ${episodeMetadata.seasonNumber}/${filters?.length} - ${t('video:episode')} ${episodeMetadata.episodeNumber}/${episodesInSeason}`;\r\n  const shareButton = <ShareButton title={selectedItem?.title} description={pageDescription} url={canonicalUrl} />;\r\n  const startWatchingButton = (\r\n    <StartWatchingButton\r\n      key={episodeId} // necessary to fix autofocus on TalkBack\r\n      item={episode || firstEpisode}\r\n      playUrl={legacySeriesURL({ episodeId: episode?.mediaid || firstEpisode?.mediaid, seriesId, play: true, playlistId: feedId })}\r\n    />\r\n  );\r\n\r\n  // For the old series approach we mark episodes as favorite items. New approach is applied to the series\r\n  const favoriteButton = isFavoritesEnabled && <FavoriteButton item={episode || firstEpisode} />;\r\n  const trailerButton = (!!trailerItem || isTrailerLoading) && (\r\n    <Button\r\n      label={t('video:trailer')}\r\n      aria-label={t('video:watch_trailer')}\r\n      startIcon={<Icon icon={PlayTrailer} />}\r\n      onClick={() => setPlayTrailer(true)}\r\n      active={playTrailer}\r\n      fullWidth={breakpoint < Breakpoint.md}\r\n      disabled={!trailerItem}\r\n    />\r\n  );\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Helmet>\r\n        <title>{pageTitle}</title>\r\n        <link rel=\"canonical\" href={canonicalUrl} />\r\n        <meta name=\"description\" content={pageDescription} />\r\n        <meta property=\"og:description\" content={pageDescription} />\r\n        <meta property=\"og:title\" content={pageTitle} />\r\n        <meta property=\"og:type\" content={episode ? 'video.episode' : 'video.series'} />\r\n        {selectedItemImage && <meta property=\"og:image\" content={selectedItemImage?.replace(/^https:/, 'http:')} />}\r\n        {selectedItemImage && <meta property=\"og:image:secure_url\" content={selectedItemImage?.replace(/^http:/, 'https:')} />}\r\n        {selectedItemImage && <meta property=\"og:image:width\" content={selectedItemImage ? '720' : ''} />}\r\n        {selectedItemImage && <meta property=\"og:image:height\" content={selectedItemImage ? '406' : ''} />}\r\n        <meta name=\"twitter:title\" content={pageTitle} />\r\n        <meta name=\"twitter:description\" content={pageDescription} />\r\n        {selectedItemImage && <meta name=\"twitter:image\" content={selectedItemImage} />}\r\n        <meta property=\"og:video\" content={canonicalUrl.replace(/^https:/, 'http:')} />\r\n        <meta property=\"og:video:secure_url\" content={canonicalUrl.replace(/^http:/, 'https:')} />\r\n        <meta property=\"og:video:type\" content=\"text/html\" />\r\n        <meta property=\"og:video:width\" content=\"1280\" />\r\n        <meta property=\"og:video:height\" content=\"720\" />\r\n        {selectedItem.tags\r\n          ? String(selectedItem.tags)\r\n              .split(',')\r\n              .map((tag: string) => <meta property=\"og:video:tag\" content={tag} key={tag} />)\r\n          : null}\r\n        {seriesPlaylist && selectedItem ? (\r\n          <script type=\"application/ld+json\">{generateLegacyEpisodeJSONLD(seriesPlaylist, episode, episodeMetadata, seriesId)}</script>\r\n        ) : null}\r\n      </Helmet>\r\n      <VideoLayout\r\n        item={episode}\r\n        title={selectedItem.title}\r\n        description={pageDescription}\r\n        inlineLayout={inlineLayout}\r\n        primaryMetadata={primaryMetadata}\r\n        secondaryMetadata={secondaryMetadata}\r\n        image={backgroundImage}\r\n        shareButton={shareButton}\r\n        favoriteButton={favoriteButton}\r\n        trailerButton={trailerButton}\r\n        startWatchingButton={startWatchingButton}\r\n        isLoading={isLoading}\r\n        accessModel={accessModel}\r\n        isLoggedIn={isLoggedIn}\r\n        hasSubscription={hasSubscription}\r\n        playlist={filteredPlaylist}\r\n        relatedTitle={inlineLayout ? selectedItem.title : t('episodes')}\r\n        setFilter={setSeasonFilter}\r\n        currentFilter={seasonFilter}\r\n        defaultFilterLabel={t('all_seasons')}\r\n        activeLabel={t('current_episode')}\r\n        watchHistory={watchHistoryDictionary}\r\n        filterMetadata={filterMetadata}\r\n        filters={filters}\r\n        getURL={getUrl}\r\n        player={\r\n          inlineLayout && (episode || firstEpisode) ? (\r\n            <InlinePlayer\r\n              isLoggedIn={isLoggedIn}\r\n              item={episode || firstEpisode}\r\n              onComplete={handleComplete}\r\n              feedId={feedId ?? undefined}\r\n              startWatchingButton={startWatchingButton}\r\n              isEntitled={isEntitled}\r\n              hasMediaOffers={hasMediaOffers}\r\n              autostart={play || undefined}\r\n            />\r\n          ) : (\r\n            <Cinema\r\n              open={play && isEntitled}\r\n              onClose={goBack}\r\n              item={episode || firstEpisode}\r\n              title={episode?.title || firstEpisode.title}\r\n              primaryMetadata={primaryMetadata}\r\n              secondaryMetadata={secondaryMetadata}\r\n              onComplete={handleComplete}\r\n              feedId={feedId ?? undefined}\r\n            />\r\n          )\r\n        }\r\n      />\r\n      {episode && <TrailerModal item={trailerItem} title={`${episode.title} - Trailer`} open={playTrailer} onClose={() => setPlayTrailer(false)} />}\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nexport default LegacySeries;\r\n","import type { Playlist, PlaylistItem } from '../../types/playlist';\r\n\r\nimport { isContentType } from './common';\r\n\r\ntype ScreenPredicate<T> = (data?: T) => boolean;\r\n\r\ntype ScreenDefinition<T, C> = {\r\n  predicate: ScreenPredicate<T>;\r\n  component: C;\r\n};\r\n\r\nexport class ScreenMap<T extends Playlist | PlaylistItem, C> {\r\n  private defaultScreen?: C = undefined;\r\n  private definitions: ScreenDefinition<T, C>[] = [];\r\n\r\n  register(component: C, predicate: ScreenPredicate<T>) {\r\n    this.definitions.push({ component, predicate });\r\n  }\r\n\r\n  registerByContentType(component: C, contentType: string) {\r\n    this.register(component, (data) => !!data && isContentType(data, contentType));\r\n  }\r\n\r\n  registerDefault(component: C) {\r\n    this.defaultScreen = component;\r\n  }\r\n\r\n  getScreen(data?: T): C {\r\n    const screen = this.definitions.find(({ predicate }) => predicate(data))?.component;\r\n\r\n    if (screen) {\r\n      return screen;\r\n    }\r\n\r\n    if (!this.defaultScreen) {\r\n      throw new Error('Default screen not defined');\r\n    }\r\n\r\n    return this.defaultScreen;\r\n  }\r\n}\r\n","import React, { useEffect } from 'react';\r\nimport { Helmet } from 'react-helmet';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { mediaURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport env from '@jwp/ott-common/src/env';\r\n\r\nimport type { ScreenComponent } from '../../../../../types/screens';\r\nimport MarkdownComponent from '../../../../components/MarkdownComponent/MarkdownComponent';\r\n\r\nimport styles from './MediaStaticPage.module.scss';\r\n\r\nconst MediaStaticPage: ScreenComponent<PlaylistItem> = ({ data }) => {\r\n  const { config } = useConfigStore(({ config }) => ({ config }), shallow);\r\n  const { siteName } = config;\r\n  const pageTitle = `${data.title} - ${siteName}`;\r\n  const canonicalUrl = data ? `${env.APP_PUBLIC_URL}${mediaURL({ id: data.mediaid, title: data.title })}` : window.location.href;\r\n\r\n  useEffect(() => {\r\n    (document.scrollingElement || document.body).scroll({ top: 0 });\r\n  }, [data.mediaid]);\r\n\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>{pageTitle}</title>\r\n        <link rel=\"canonical\" href={canonicalUrl} />\r\n        <meta property=\"og:title\" content={pageTitle} />\r\n        <meta name=\"twitter:title\" content={pageTitle} />\r\n      </Helmet>\r\n      <div className={styles.mediaStaticPage}>\r\n        <MarkdownComponent markdownString={data.markdown || data.description} />\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default MediaStaticPage;\r\n","import type { PlaylistItem } from '../../types/playlist';\r\nimport type { EpisodeMetadata, Series } from '../../types/series';\r\n\r\nimport { mediaURL } from './urlFormatting';\r\nimport { secondsToISO8601 } from './datetime';\r\n\r\nexport const generateMovieJSONLD = (item: PlaylistItem, origin: string) => {\r\n  const { mediaid: id, title } = item;\r\n  const movieCanonical = `${origin}${mediaURL({ id, title })}`;\r\n\r\n  return JSON.stringify({\r\n    '@context': 'http://schema.org/',\r\n    '@type': 'VideoObject',\r\n    '@id': movieCanonical,\r\n    name: item.title,\r\n    description: item.description,\r\n    duration: secondsToISO8601(item.duration, true),\r\n    thumbnailUrl: item.image,\r\n    uploadDate: secondsToISO8601(item.pubdate),\r\n  });\r\n};\r\n\r\nexport const generateSeriesMetadata = (series: Series, media: PlaylistItem, seriesId: string, origin: string) => {\r\n  // Use playlist for old flow and media id for a new flow\r\n  const seriesCanonical = `${origin}/m/${seriesId}`;\r\n\r\n  return {\r\n    '@type': 'TVSeries',\r\n    '@id': seriesCanonical,\r\n    name: media.title,\r\n    numberOfEpisodes: String(series?.episode_count || 0),\r\n    numberOfSeasons: String(series?.season_count || 0),\r\n  };\r\n};\r\n\r\nexport const generateEpisodeJSONLD = (\r\n  series: Series,\r\n  media: PlaylistItem,\r\n  origin: string,\r\n  episode: PlaylistItem | undefined,\r\n  episodeMetadata: EpisodeMetadata | undefined,\r\n) => {\r\n  const episodeCanonical = `${origin}/m/${series.series_id}?e=${episode?.mediaid}`;\r\n  const seriesMetadata = generateSeriesMetadata(series, media, series.series_id, origin);\r\n\r\n  if (!episode) {\r\n    return JSON.stringify(seriesMetadata);\r\n  }\r\n\r\n  return JSON.stringify({\r\n    '@context': 'http://schema.org/',\r\n    '@type': 'TVEpisode',\r\n    '@id': episodeCanonical,\r\n    episodeNumber: episodeMetadata?.episodeNumber || '0',\r\n    seasonNumber: episodeMetadata?.seasonNumber || '0',\r\n    name: episode.title,\r\n    uploadDate: secondsToISO8601(episode.pubdate),\r\n    partOfSeries: seriesMetadata,\r\n  });\r\n};\r\n","import React, { useCallback, useEffect, useState } from 'react';\r\nimport { useNavigate, useParams } from 'react-router';\r\nimport { Helmet } from 'react-helmet';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport { createVideoMetadata } from '@jwp/ott-common/src/utils/metadata';\r\nimport { mediaURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport { generateMovieJSONLD } from '@jwp/ott-common/src/utils/structuredData';\r\nimport useMedia from '@jwp/ott-hooks-react/src/useMedia';\r\nimport usePlaylist from '@jwp/ott-hooks-react/src/usePlaylist';\r\nimport useEntitlement from '@jwp/ott-hooks-react/src/useEntitlement';\r\nimport useBreakpoint, { Breakpoint } from '@jwp/ott-ui-react/src/hooks/useBreakpoint';\r\nimport PlayTrailer from '@jwp/ott-theme/assets/icons/play_trailer.svg?react';\r\nimport useQueryParam from '@jwp/ott-ui-react/src/hooks/useQueryParam';\r\nimport env from '@jwp/ott-common/src/env';\r\n\r\nimport type { ScreenComponent } from '../../../../../types/screens';\r\nimport VideoLayout from '../../../../components/VideoLayout/VideoLayout';\r\nimport StartWatchingButton from '../../../../containers/StartWatchingButton/StartWatchingButton';\r\nimport Cinema from '../../../../containers/Cinema/Cinema';\r\nimport TrailerModal from '../../../../containers/TrailerModal/TrailerModal';\r\nimport ShareButton from '../../../../components/ShareButton/ShareButton';\r\nimport FavoriteButton from '../../../../containers/FavoriteButton/FavoriteButton';\r\nimport Button from '../../../../components/Button/Button';\r\nimport InlinePlayer from '../../../../containers/InlinePlayer/InlinePlayer';\r\nimport Icon from '../../../../components/Icon/Icon';\r\nimport VideoMetaData from '../../../../components/VideoMetaData/VideoMetaData';\r\n\r\nconst MediaMovie: ScreenComponent<PlaylistItem> = ({ data, isLoading }) => {\r\n  const { t } = useTranslation('video');\r\n\r\n  const [playTrailer, setPlayTrailer] = useState<boolean>(false);\r\n  const breakpoint = useBreakpoint();\r\n\r\n  // Routing\r\n  const navigate = useNavigate();\r\n\r\n  const params = useParams();\r\n  const id = params.id || '';\r\n  const play = useQueryParam('play') === '1';\r\n  const feedId = useQueryParam('r');\r\n\r\n  // Config\r\n  const { config, accessModel } = useConfigStore(({ config, accessModel }) => ({ config, accessModel }), shallow);\r\n  const { siteName, features, custom } = config;\r\n\r\n  const isFavoritesEnabled: boolean = Boolean(features?.favoritesList);\r\n  const inlineLayout = Boolean(custom?.inlinePlayer);\r\n\r\n  // Media\r\n  const { isLoading: isTrailerLoading, data: trailerItem } = useMedia(data?.trailerId || '');\r\n  const { isLoading: isPlaylistLoading, data: playlist } = usePlaylist(features?.recommendationsPlaylist || '', { related_media_id: id });\r\n\r\n  // User, entitlement\r\n  const { user, subscription } = useAccountStore(({ user, subscription }) => ({ user, subscription }), shallow);\r\n  const { isEntitled, mediaOffers } = useEntitlement(data);\r\n  const hasMediaOffers = !!mediaOffers.length;\r\n\r\n  // Handlers\r\n  const goBack = () => data && navigate(mediaURL({ id: data.mediaid, title: data.title, playlistId: feedId, play: false }));\r\n  const getUrl = (item: PlaylistItem) => mediaURL({ id: item.mediaid, title: item.title, playlistId: features?.recommendationsPlaylist });\r\n\r\n  const handleComplete = useCallback(() => {\r\n    if (!id || !playlist) return;\r\n\r\n    const index = playlist.playlist.findIndex(({ mediaid }) => mediaid === id);\r\n    const nextItem = playlist.playlist[index + 1];\r\n\r\n    return nextItem && navigate(mediaURL({ id: nextItem.mediaid, title: nextItem.title, playlistId: features?.recommendationsPlaylist, play: true }));\r\n  }, [id, playlist, navigate, features?.recommendationsPlaylist]);\r\n\r\n  useEffect(() => {\r\n    (document.scrollingElement || document.body).scroll({ top: 0 });\r\n    (document.querySelector('#video-details button') as HTMLElement)?.focus();\r\n  }, [id]);\r\n\r\n  // UI\r\n  const pageTitle = `${data.title} - ${siteName}`;\r\n  const canonicalUrl = data ? `${env.APP_PUBLIC_URL}${mediaURL({ id: data.mediaid, title: data.title })}` : window.location.href;\r\n\r\n  const primaryMetadata = (\r\n    <VideoMetaData\r\n      attributes={createVideoMetadata(data, { hoursAbbreviation: t('common:abbreviation.hours'), minutesAbbreviation: t('common:abbreviation.minutes') })}\r\n    />\r\n  );\r\n  const shareButton = <ShareButton title={data.title} description={data.description} url={canonicalUrl} />;\r\n  const startWatchingButton = (\r\n    <StartWatchingButton\r\n      key={id} // necessary to fix autofocus on TalkBack\r\n      item={data}\r\n      playUrl={mediaURL({ id: data.mediaid, title: data.title, playlistId: feedId, play: true })}\r\n    />\r\n  );\r\n\r\n  const favoriteButton = isFavoritesEnabled && <FavoriteButton item={data} />;\r\n  const trailerButton = (!!trailerItem || isTrailerLoading) && (\r\n    <Button\r\n      label={t('video:trailer')}\r\n      aria-label={t('video:watch_trailer')}\r\n      startIcon={<Icon icon={PlayTrailer} />}\r\n      onClick={() => setPlayTrailer(true)}\r\n      active={playTrailer}\r\n      fullWidth={breakpoint < Breakpoint.md}\r\n      disabled={!trailerItem}\r\n    />\r\n  );\r\n\r\n  const isLoggedIn = !!user;\r\n  const hasSubscription = !!subscription;\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Helmet>\r\n        <title>{pageTitle}</title>\r\n        <link rel=\"canonical\" href={canonicalUrl} />\r\n        <meta name=\"description\" content={data.description} />\r\n        <meta property=\"og:description\" content={data.description} />\r\n        <meta property=\"og:title\" content={pageTitle} />\r\n        <meta property=\"og:type\" content=\"video.other\" />\r\n        {data.image && <meta property=\"og:image\" content={data.image?.replace(/^https:/, 'http:')} />}\r\n        {data.image && <meta property=\"og:image:secure_url\" content={data.image?.replace(/^http:/, 'https:')} />}\r\n        <meta property=\"og:image:width\" content={data.image ? '720' : ''} />\r\n        <meta property=\"og:image:height\" content={data.image ? '406' : ''} />\r\n        <meta name=\"twitter:title\" content={pageTitle} />\r\n        <meta name=\"twitter:description\" content={data.description} />\r\n        <meta name=\"twitter:image\" content={data.image} />\r\n        <meta property=\"og:video\" content={canonicalUrl.replace(/^https:/, 'http:')} />\r\n        <meta property=\"og:video:secure_url\" content={canonicalUrl.replace(/^http:/, 'https:')} />\r\n        <meta property=\"og:video:type\" content=\"text/html\" />\r\n        <meta property=\"og:video:width\" content=\"1280\" />\r\n        <meta property=\"og:video:height\" content=\"720\" />\r\n        {data.tags?.split(',').map((tag) => (\r\n          <meta property=\"og:video:tag\" content={tag} key={tag} />\r\n        ))}\r\n        {data ? <script type=\"application/ld+json\">{generateMovieJSONLD(data, env.APP_PUBLIC_URL)}</script> : null}\r\n      </Helmet>\r\n      <VideoLayout\r\n        item={data}\r\n        inlineLayout={inlineLayout}\r\n        isLoading={isLoading || isPlaylistLoading}\r\n        accessModel={accessModel}\r\n        isLoggedIn={isLoggedIn}\r\n        hasSubscription={hasSubscription}\r\n        title={data.title}\r\n        description={data.description}\r\n        image={data.backgroundImage}\r\n        primaryMetadata={primaryMetadata}\r\n        shareButton={shareButton}\r\n        favoriteButton={favoriteButton}\r\n        trailerButton={trailerButton}\r\n        startWatchingButton={startWatchingButton}\r\n        playlist={playlist}\r\n        relatedTitle={playlist?.title}\r\n        getURL={getUrl}\r\n        activeLabel={t('current_video')}\r\n        player={\r\n          inlineLayout ? (\r\n            <InlinePlayer\r\n              isLoggedIn={isLoggedIn}\r\n              item={data}\r\n              onComplete={handleComplete}\r\n              feedId={feedId ?? undefined}\r\n              startWatchingButton={startWatchingButton}\r\n              isEntitled={isEntitled}\r\n              hasMediaOffers={hasMediaOffers}\r\n              autostart={play || undefined}\r\n            />\r\n          ) : (\r\n            <Cinema\r\n              open={play && isEntitled}\r\n              onClose={goBack}\r\n              item={data}\r\n              title={data.title}\r\n              primaryMetadata={primaryMetadata}\r\n              onComplete={handleComplete}\r\n              feedId={feedId ?? undefined}\r\n              onNext={handleComplete}\r\n            />\r\n          )\r\n        }\r\n      />\r\n      <TrailerModal item={trailerItem} title={`${data.title} - Trailer`} open={playTrailer} onClose={() => setPlayTrailer(false)} />\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nexport default MediaMovie;\r\n","import type { EpisodeMetadata, Series } from '../../types/series';\r\n\r\n/**\r\n * Get an array of options for a season filter\r\n */\r\nexport const getFiltersFromSeries = (series: Series | undefined): { label: string; value: string }[] => {\r\n  return series && 'seasons' in series\r\n    ? series.seasons.map((season) => ({ label: season.season_title || String(season.season_number), value: String(season.season_number) }))\r\n    : [];\r\n};\r\n\r\n/** Get a total amount of episodes in a season */\r\nexport const getEpisodesInSeason = (episodeMetadata: EpisodeMetadata | undefined, series: Series | undefined) => {\r\n  return (series?.seasons || []).find((el) => el.season_number === Number(episodeMetadata?.seasonNumber))?.episode_count;\r\n};\r\n","import { useQuery, type UseQueryResult } from 'react-query';\r\nimport type { Series } from '@jwp/ott-common/types/series';\r\nimport ApiService from '@jwp/ott-common/src/services/ApiService';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport type { ApiError } from '@jwp/ott-common/src/utils/api';\r\nimport { CACHE_TIME, STALE_TIME } from '@jwp/ott-common/src/constants';\r\n\r\nexport const useSeries = (\r\n  seriesId: string | undefined,\r\n): {\r\n  data: Series | undefined;\r\n  error: ApiError | null;\r\n  isLoading: boolean;\r\n} => {\r\n  const apiService = getModule(ApiService);\r\n\r\n  // Try to get new series flow data\r\n  const { data, isLoading, error }: UseQueryResult<Series, ApiError> = useQuery(\r\n    ['series', seriesId],\r\n    async () => {\r\n      const series = await apiService.getSeries(seriesId || '');\r\n\r\n      return series;\r\n    },\r\n    {\r\n      enabled: !!seriesId,\r\n      staleTime: STALE_TIME,\r\n      cacheTime: CACHE_TIME,\r\n      // Don't retry when we got a not found error from either series or media item request (prevent unneeded requests)\r\n      // Both errors mean that old series flow should be used\r\n      retry: (failureCount, error: ApiError) => error.code !== 404 && failureCount < 2,\r\n    },\r\n  );\r\n\r\n  return { data, isLoading, error };\r\n};\r\n","import { useInfiniteQuery } from 'react-query';\r\nimport type { EpisodesWithPagination } from '@jwp/ott-common/types/series';\r\nimport type { Pagination } from '@jwp/ott-common/types/pagination';\r\nimport ApiService from '@jwp/ott-common/src/services/ApiService';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { CACHE_TIME, STALE_TIME } from '@jwp/ott-common/src/constants';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nconst getNextPageParam = (pagination: Pagination) => {\r\n  const { page, page_limit, total } = pagination;\r\n\r\n  // In case there are no more episodes in a season to fetch\r\n  if (page_limit * page >= total) {\r\n    return undefined;\r\n  }\r\n\r\n  return page;\r\n};\r\n\r\nexport const useEpisodes = (\r\n  seriesId: string | undefined,\r\n  seasonNumber: string | undefined,\r\n  options: { enabled: boolean },\r\n): {\r\n  data: EpisodesWithPagination[];\r\n  hasNextPage: boolean;\r\n  fetchNextPage: (params?: { pageParam?: number }) => void;\r\n  isLoading: boolean;\r\n} => {\r\n  const apiService = getModule(ApiService);\r\n\r\n  // Determine currently selected language\r\n  const { i18n } = useTranslation();\r\n  const language = i18n.language;\r\n\r\n  const {\r\n    data,\r\n    fetchNextPage,\r\n    isLoading,\r\n    hasNextPage = false,\r\n  } = useInfiniteQuery(\r\n    [seriesId, seasonNumber, language],\r\n    async ({ pageParam = 0 }) => {\r\n      if (Number(seasonNumber)) {\r\n        // Get episodes from a selected season using pagination\r\n        const season = await apiService.getSeasonWithEpisodes({ seriesId, seasonNumber: Number(seasonNumber), pageOffset: pageParam, language });\r\n\r\n        return { pagination: season.pagination, episodes: season.episodes };\r\n      } else {\r\n        // Get episodes from a selected series using pagination\r\n        const data = await apiService.getEpisodes({ seriesId, pageOffset: pageParam, language });\r\n        return data;\r\n      }\r\n    },\r\n    {\r\n      getNextPageParam: (lastPage) => getNextPageParam(lastPage?.pagination),\r\n      enabled: options.enabled,\r\n      staleTime: STALE_TIME,\r\n      cacheTime: CACHE_TIME,\r\n    },\r\n  );\r\n\r\n  return {\r\n    data: data?.pages || [],\r\n    isLoading,\r\n    fetchNextPage,\r\n    hasNextPage,\r\n  };\r\n};\r\n","import { useQuery } from 'react-query';\r\nimport ApiService from '@jwp/ott-common/src/services/ApiService';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { CACHE_TIME, STALE_TIME } from '@jwp/ott-common/src/constants';\r\n\r\nexport const useSeriesLookup = (mediaId: string | undefined) => {\r\n  const apiService = getModule(ApiService);\r\n\r\n  const { isLoading, data } = useQuery(\r\n    ['seriesLookup', mediaId],\r\n    async () => {\r\n      if (!mediaId) {\r\n        return;\r\n      }\r\n\r\n      // get all series for the given media id\r\n      const data = await apiService.getSeriesByMediaIds([mediaId]);\r\n      // get first series for the requested episode\r\n      const firstSeries = data?.[mediaId]?.[0];\r\n\r\n      return firstSeries;\r\n    },\r\n    { staleTime: STALE_TIME, cacheTime: CACHE_TIME, enabled: !!mediaId },\r\n  );\r\n\r\n  return {\r\n    isLoading,\r\n    data,\r\n  };\r\n};\r\n","import { useQuery } from 'react-query';\r\nimport type { Series } from '@jwp/ott-common/types/series';\r\nimport ApiService from '@jwp/ott-common/src/services/ApiService';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { CACHE_TIME, STALE_TIME } from '@jwp/ott-common/src/constants';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nexport const useNextEpisode = ({ series, episodeId }: { series: Series | undefined; episodeId: string | undefined }) => {\r\n  const apiService = getModule(ApiService);\r\n\r\n  // Determine currently selected language\r\n  const { i18n } = useTranslation();\r\n  const language = i18n.language;\r\n\r\n  const { isLoading, data } = useQuery(\r\n    ['next-episode', series?.series_id, episodeId, language],\r\n    async () => {\r\n      const item = await apiService.getEpisodes({ seriesId: series?.series_id, pageLimit: 1, afterId: episodeId, language });\r\n\r\n      return item?.episodes?.[0];\r\n    },\r\n    { staleTime: STALE_TIME, cacheTime: CACHE_TIME, enabled: !!(series?.series_id && episodeId) },\r\n  );\r\n\r\n  return {\r\n    isLoading,\r\n    data,\r\n  };\r\n};\r\n","import { useQuery } from 'react-query';\r\nimport type { Series } from '@jwp/ott-common/types/series';\r\nimport ApiService from '@jwp/ott-common/src/services/ApiService';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { CACHE_TIME, STALE_TIME } from '@jwp/ott-common/src/constants';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nexport const useFirstEpisode = ({ series }: { series: Series | undefined }) => {\r\n  const apiService = getModule(ApiService);\r\n  const { i18n } = useTranslation();\r\n\r\n  const { isLoading, data } = useQuery(\r\n    ['first-episode', series?.series_id],\r\n    async () => {\r\n      const item = await apiService.getEpisodes({ seriesId: series?.series_id, pageLimit: 1, language: i18n.language });\r\n\r\n      return item?.episodes?.[0];\r\n    },\r\n    { staleTime: STALE_TIME, cacheTime: CACHE_TIME, enabled: !!series?.series_id },\r\n  );\r\n\r\n  return {\r\n    isLoading,\r\n    data,\r\n  };\r\n};\r\n","import React, { useCallback, useEffect, useMemo, useState } from 'react';\r\nimport { Navigate, useLocation } from 'react-router';\r\nimport { Helmet } from 'react-helmet';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport { useSearchParams } from 'react-router-dom';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { useWatchHistoryStore } from '@jwp/ott-common/src/stores/WatchHistoryStore';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport { generateEpisodeJSONLD } from '@jwp/ott-common/src/utils/structuredData';\r\nimport { getEpisodesInSeason, getFiltersFromSeries } from '@jwp/ott-common/src/utils/series';\r\nimport { createVideoMetadata } from '@jwp/ott-common/src/utils/metadata';\r\nimport { formatSeriesMetaString } from '@jwp/ott-common/src/utils/formatting';\r\nimport { buildLegacySeriesUrlFromMediaItem, mediaURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport { VideoProgressMinMax } from '@jwp/ott-common/src/constants';\r\nimport useEntitlement from '@jwp/ott-hooks-react/src/useEntitlement';\r\nimport useMedia from '@jwp/ott-hooks-react/src/useMedia';\r\nimport { useSeries } from '@jwp/ott-hooks-react/src/series/useSeries';\r\nimport { useEpisodes } from '@jwp/ott-hooks-react/src/series/useEpisodes';\r\nimport { useSeriesLookup } from '@jwp/ott-hooks-react/src/series/useSeriesLookup';\r\nimport { useNextEpisode } from '@jwp/ott-hooks-react/src/series/useNextEpisode';\r\nimport PlayTrailer from '@jwp/ott-theme/assets/icons/play_trailer.svg?react';\r\nimport useBreakpoint, { Breakpoint } from '@jwp/ott-ui-react/src/hooks/useBreakpoint';\r\nimport { useFirstEpisode } from '@jwp/ott-hooks-react/src/series/useFirstEpisode';\r\nimport env from '@jwp/ott-common/src/env';\r\n\r\nimport type { ScreenComponent } from '../../../../../types/screens';\r\nimport ErrorPage from '../../../../components/ErrorPage/ErrorPage';\r\nimport StartWatchingButton from '../../../../containers/StartWatchingButton/StartWatchingButton';\r\nimport InlinePlayer from '../../../../containers/InlinePlayer/InlinePlayer';\r\nimport VideoLayout from '../../../../components/VideoLayout/VideoLayout';\r\nimport Cinema from '../../../../containers/Cinema/Cinema';\r\nimport TrailerModal from '../../../../containers/TrailerModal/TrailerModal';\r\nimport ShareButton from '../../../../components/ShareButton/ShareButton';\r\nimport FavoriteButton from '../../../../containers/FavoriteButton/FavoriteButton';\r\nimport Button from '../../../../components/Button/Button';\r\nimport Loading from '../../../Loading/Loading';\r\nimport Icon from '../../../../components/Icon/Icon';\r\nimport VideoMetaData from '../../../../components/VideoMetaData/VideoMetaData';\r\nimport { createURLFromLocation } from '../../../../utils/location';\r\n\r\nconst MediaSeries: ScreenComponent<PlaylistItem> = ({ data: seriesMedia }) => {\r\n  const breakpoint = useBreakpoint();\r\n  const { t } = useTranslation('video');\r\n  const [playTrailer, setPlayTrailer] = useState<boolean>(false);\r\n\r\n  // Navigation\r\n  const [searchParams, setSearchParams] = useSearchParams();\r\n  const seriesId = seriesMedia.mediaid;\r\n  const play = searchParams.get('play') === '1';\r\n  const feedId = searchParams.get('r');\r\n  const episodeId = searchParams.get('e');\r\n\r\n  // Main data\r\n  const { isLoading: isSeriesDataLoading, data: series, error: seriesError } = useSeries(seriesId);\r\n  const { isLoading: isEpisodeLoading, data: episode } = useMedia(episodeId || '');\r\n  const { isLoading: isTrailerLoading, data: trailerItem } = useMedia(episode?.trailerId || '');\r\n  const { isLoading: isSeriesDictionaryLoading, data: episodeInSeries } = useSeriesLookup(episodeId || undefined);\r\n  const { isLoading: isFirstEpisodeLoading, data: firstEpisode } = useFirstEpisode({ series });\r\n\r\n  // Whether we show series or episode information\r\n  const selectedItem = (episode || seriesMedia) as PlaylistItem;\r\n\r\n  // Config\r\n  const { config, accessModel } = useConfigStore(({ config, accessModel }) => ({ config, accessModel }), shallow);\r\n  const { features, siteName, custom } = config;\r\n  const isFavoritesEnabled: boolean = Boolean(features?.favoritesList);\r\n  const inlineLayout = Boolean(custom?.inlinePlayer);\r\n\r\n  // Filters\r\n  const filters = useMemo(() => getFiltersFromSeries(series), [series]);\r\n  const [seasonFilter, setSeasonFilter] = useState<string | undefined>(undefined);\r\n\r\n  // Season / episodes data\r\n  const {\r\n    data: episodes,\r\n    fetchNextPage: fetchNextEpisodes,\r\n    hasNextPage: hasNextEpisodesPage,\r\n  } = useEpisodes(seriesId, seasonFilter, { enabled: seasonFilter !== undefined && !!series });\r\n\r\n  const episodeMetadata = useMemo(\r\n    () =>\r\n      episodeInSeries && {\r\n        episodeNumber: episodeInSeries?.episode_number ? String(episodeInSeries.episode_number) : '',\r\n        seasonNumber: episodeInSeries?.season_number ? String(episodeInSeries.season_number) : '',\r\n      },\r\n    [episodeInSeries],\r\n  );\r\n  const playlist = useMemo(\r\n    () => ({\r\n      title: seriesMedia.title,\r\n      description: seriesMedia.description,\r\n      feedid: series?.series_id,\r\n      playlist: episodes?.flatMap((e) => e.episodes) || [],\r\n    }),\r\n    [seriesMedia, series, episodes],\r\n  );\r\n\r\n  const episodesInSeason = getEpisodesInSeason(episodeMetadata, series);\r\n  const { data: nextItem } = useNextEpisode({ series, episodeId: episode?.mediaid || firstEpisode?.mediaid });\r\n\r\n  // Watch history\r\n  const watchHistoryArray = useWatchHistoryStore((state) => state.watchHistory);\r\n  const watchHistoryDictionary = useWatchHistoryStore((state) => state.getDictionaryWithEpisodes());\r\n  const episodeInProgress = watchHistoryArray.find(\r\n    (episode) => episode?.seriesId === seriesId && episode.progress > VideoProgressMinMax.Min && episode.progress < VideoProgressMinMax.Max,\r\n  );\r\n\r\n  // User, entitlement\r\n  const { user, subscription } = useAccountStore(({ user, subscription }) => ({ user, subscription }), shallow);\r\n  const { isEntitled, mediaOffers } = useEntitlement(episode || firstEpisode);\r\n  const hasMediaOffers = !!mediaOffers.length;\r\n\r\n  const isLoggedIn = !!user;\r\n  const hasSubscription = !!subscription;\r\n\r\n  const location = useLocation();\r\n  const getURL = (toEpisode: PlaylistItem) => {\r\n    return createURLFromLocation(location, { e: toEpisode.mediaid });\r\n  };\r\n\r\n  // Handlers\r\n  const goBack = useCallback(() => {\r\n    setSearchParams({ ...searchParams, e: episode?.mediaid, r: feedId || '' });\r\n  }, [setSearchParams, searchParams, episode, feedId]);\r\n\r\n  const handleComplete = useCallback(async () => {\r\n    setSearchParams({ ...searchParams, e: (nextItem || episode)?.mediaid, r: feedId || '', play: nextItem ? '1' : '0' });\r\n  }, [setSearchParams, nextItem, episode, feedId, searchParams]);\r\n\r\n  const handleInlinePlay = useCallback(async () => {\r\n    if (!episode) {\r\n      setSearchParams({ ...searchParams, e: firstEpisode?.mediaid, r: feedId || '', play: '1' });\r\n    }\r\n  }, [setSearchParams, firstEpisode, feedId, episode, searchParams]);\r\n\r\n  // Effects\r\n  useEffect(() => {\r\n    (document.scrollingElement || document.body).scroll({ top: 0 });\r\n    (document.querySelector('#video-details button') as HTMLElement)?.focus();\r\n  }, [episode]);\r\n\r\n  useEffect(() => {\r\n    if (episodeInProgress && !searchParams.get('e')) {\r\n      setSearchParams({ ...searchParams, e: episodeInProgress.mediaid, r: feedId || '' }, { replace: true });\r\n    }\r\n  }, [episodeInProgress, setSearchParams, searchParams, feedId]);\r\n\r\n  useEffect(() => {\r\n    if (isSeriesDataLoading || isEpisodeLoading || isSeriesDictionaryLoading) {\r\n      return;\r\n    }\r\n\r\n    // No episode is selected, filter is not set\r\n    if (!episodeId && seasonFilter === undefined) {\r\n      setSeasonFilter(filters[0]?.value || '');\r\n      return;\r\n    }\r\n\r\n    // Select a corresponding season for an episode\r\n    if (seasonFilter === undefined && episodeMetadata) {\r\n      setSeasonFilter(episodeMetadata.seasonNumber);\r\n    }\r\n  }, [episodeMetadata, seasonFilter, isSeriesDataLoading, isEpisodeLoading, isSeriesDictionaryLoading, filters, episodeId]);\r\n\r\n  // UI\r\n  const playEpisode = episode || firstEpisode;\r\n  const isLoading = isSeriesDataLoading || isSeriesDictionaryLoading || isEpisodeLoading || isFirstEpisodeLoading;\r\n\r\n  const startWatchingButton = useMemo(\r\n    () =>\r\n      playEpisode && (\r\n        <StartWatchingButton\r\n          key={episodeId} // necessary to fix autofocus on TalkBack\r\n          item={playEpisode}\r\n          onClick={() => {\r\n            setSearchParams({ ...searchParams, e: playEpisode.mediaid, r: feedId || '', play: '1' }, { replace: true });\r\n          }}\r\n        />\r\n      ),\r\n    [episodeId, playEpisode, setSearchParams, searchParams, feedId],\r\n  );\r\n\r\n  if (isLoading) return <Loading />;\r\n\r\n  // Legacy series is used\r\n  if (seriesError?.code === 404) {\r\n    const url = buildLegacySeriesUrlFromMediaItem(seriesMedia, play, feedId);\r\n\r\n    return <Navigate to={url} replace />;\r\n  }\r\n\r\n  if (!seriesMedia || !series || !playEpisode) return <ErrorPage title={t('series_error')} />;\r\n\r\n  const pageTitle = `${selectedItem.title} - ${siteName}`;\r\n  const canonicalUrl = `${env.APP_PUBLIC_URL}${mediaURL({ id: seriesMedia.mediaid, title: seriesMedia.title, episodeId: episode?.mediaid })}`;\r\n\r\n  const primaryMetadata = (\r\n    <VideoMetaData\r\n      attributes={createVideoMetadata(selectedItem, {\r\n        episodesLabel: t('video:total_episodes', { count: series.episode_count }),\r\n        hoursAbbreviation: t('common:abbreviation.hours'),\r\n        minutesAbbreviation: t('common:abbreviation.minutes'),\r\n      })}\r\n    />\r\n  );\r\n  const secondaryMetadata = episodeMetadata && episode && (\r\n    <>\r\n      <strong>{formatSeriesMetaString(episodeMetadata.seasonNumber, episodeMetadata.episodeNumber)}</strong> - {episode.title}\r\n    </>\r\n  );\r\n  const filterMetadata =\r\n    episodeMetadata &&\r\n    ` ${t('video:season')} ${episodeMetadata.seasonNumber}/${filters?.length} - ${t('video:episode')} ${episodeMetadata.episodeNumber}/${episodesInSeason}`;\r\n  const shareButton = <ShareButton title={selectedItem?.title} description={selectedItem.description} url={canonicalUrl} />;\r\n\r\n  // For the old series approach we mark episodes as favorite items. New approach is applied to the series\r\n  const favoriteButton = isFavoritesEnabled && <FavoriteButton item={seriesMedia || firstEpisode} />;\r\n  const trailerButton = (!!trailerItem || isTrailerLoading) && (\r\n    <Button\r\n      label={t('video:trailer')}\r\n      aria-label={t('video:watch_trailer')}\r\n      startIcon={<Icon icon={PlayTrailer} />}\r\n      onClick={() => setPlayTrailer(true)}\r\n      active={playTrailer}\r\n      fullWidth={breakpoint < Breakpoint.md}\r\n      disabled={!trailerItem}\r\n    />\r\n  );\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Helmet>\r\n        <title>{pageTitle}</title>\r\n        <link rel=\"canonical\" href={canonicalUrl} />\r\n        <meta name=\"description\" content={selectedItem.description} />\r\n        <meta property=\"og:description\" content={selectedItem.description} />\r\n        <meta property=\"og:title\" content={pageTitle} />\r\n        <meta property=\"og:type\" content={episode ? 'video.episode' : 'video.series'} />\r\n        {selectedItem.image && <meta property=\"og:image\" content={selectedItem.image?.replace(/^https:/, 'http:')} />}\r\n        {selectedItem.image && <meta property=\"og:image:secure_url\" content={selectedItem.image?.replace(/^http:/, 'https:')} />}\r\n        {selectedItem.image && <meta property=\"og:image:width\" content={selectedItem.image ? '720' : ''} />}\r\n        {selectedItem.image && <meta property=\"og:image:height\" content={selectedItem.image ? '406' : ''} />}\r\n        <meta name=\"twitter:title\" content={pageTitle} />\r\n        <meta name=\"twitter:description\" content={selectedItem.description} />\r\n        <meta name=\"twitter:image\" content={selectedItem.image} />\r\n        <meta property=\"og:video\" content={canonicalUrl.replace(/^https:/, 'http:')} />\r\n        <meta property=\"og:video:secure_url\" content={canonicalUrl.replace(/^http:/, 'https:')} />\r\n        <meta property=\"og:video:type\" content=\"text/html\" />\r\n        <meta property=\"og:video:width\" content=\"1280\" />\r\n        <meta property=\"og:video:height\" content=\"720\" />\r\n        {selectedItem.tags?.split(',').map((tag: string) => (\r\n          <meta property=\"og:video:tag\" content={tag} key={tag} />\r\n        ))}\r\n        {selectedItem ? (\r\n          <script type=\"application/ld+json\">{generateEpisodeJSONLD(series, seriesMedia, env.APP_PUBLIC_URL, episode, episodeMetadata)}</script>\r\n        ) : null}\r\n      </Helmet>\r\n      <VideoLayout\r\n        item={selectedItem}\r\n        title={inlineLayout ? selectedItem.title : seriesMedia.title}\r\n        description={selectedItem.description || seriesMedia.description}\r\n        inlineLayout={inlineLayout}\r\n        primaryMetadata={primaryMetadata}\r\n        secondaryMetadata={secondaryMetadata}\r\n        image={selectedItem.backgroundImage}\r\n        shareButton={shareButton}\r\n        favoriteButton={favoriteButton}\r\n        trailerButton={trailerButton}\r\n        startWatchingButton={startWatchingButton}\r\n        isLoading={isLoading}\r\n        accessModel={accessModel}\r\n        isLoggedIn={isLoggedIn}\r\n        hasSubscription={hasSubscription}\r\n        playlist={playlist}\r\n        relatedTitle={inlineLayout ? seriesMedia.title : t('episodes')}\r\n        getURL={getURL}\r\n        setFilter={setSeasonFilter}\r\n        currentFilter={seasonFilter}\r\n        defaultFilterLabel={t('all_seasons')}\r\n        activeLabel={t('current_episode')}\r\n        watchHistory={watchHistoryDictionary}\r\n        filterMetadata={filterMetadata}\r\n        filters={filters}\r\n        hasMore={hasNextEpisodesPage}\r\n        loadMore={fetchNextEpisodes}\r\n        player={\r\n          inlineLayout ? (\r\n            <InlinePlayer\r\n              isLoggedIn={isLoggedIn}\r\n              item={playEpisode}\r\n              seriesItem={seriesMedia}\r\n              onComplete={handleComplete}\r\n              feedId={feedId ?? undefined}\r\n              onPlay={handleInlinePlay}\r\n              startWatchingButton={startWatchingButton}\r\n              isEntitled={isEntitled}\r\n              hasMediaOffers={hasMediaOffers}\r\n              autostart={play || undefined}\r\n            />\r\n          ) : (\r\n            <Cinema\r\n              open={play && isEntitled}\r\n              onClose={goBack}\r\n              item={playEpisode}\r\n              seriesItem={seriesMedia}\r\n              title={seriesMedia.title}\r\n              primaryMetadata={primaryMetadata}\r\n              secondaryMetadata={secondaryMetadata}\r\n              onComplete={handleComplete}\r\n              feedId={feedId ?? undefined}\r\n            />\r\n          )\r\n        }\r\n      />\r\n      {episode && <TrailerModal item={trailerItem} title={`${episode.title} - Trailer`} open={playTrailer} onClose={() => setPlayTrailer(false)} />}\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nexport default MediaSeries;\r\n","import { Navigate } from 'react-router-dom';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { liveChannelsURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\n\r\nimport type { ScreenComponent } from '../../../../../types/screens';\r\nimport Loading from '../../../Loading/Loading';\r\nimport MediaMovie from '../MediaMovie/MediaMovie';\r\n\r\nconst MediaLiveChannel: ScreenComponent<PlaylistItem> = ({ data, isLoading }) => {\r\n  const liveChannelsId = data.liveChannelsId;\r\n\r\n  if (isLoading) {\r\n    return <Loading />;\r\n  }\r\n\r\n  // this live channel is part of a live channels (TV Guide) page\r\n  if (liveChannelsId) {\r\n    return <Navigate to={liveChannelsURL(liveChannelsId, data.mediaid)} replace={true}></Navigate>;\r\n  }\r\n\r\n  // this live channel is \"just\" a media item\r\n  return <MediaMovie data={data} isLoading={isLoading} />;\r\n};\r\n\r\nexport default MediaLiveChannel;\r\n","import { Navigate } from 'react-router';\r\nimport { useSearchParams } from 'react-router-dom';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { buildLegacySeriesUrlFromMediaItem, mediaURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport { useSeriesLookup } from '@jwp/ott-hooks-react/src/series/useSeriesLookup';\r\nimport useMedia from '@jwp/ott-hooks-react/src/useMedia';\r\n\r\nimport type { ScreenComponent } from '../../../../../types/screens';\r\nimport Loading from '../../../Loading/Loading';\r\n\r\n/**\r\n * This media series episode screen is used to redirect an episode item to the series page.\r\n */\r\nconst MediaEpisode: ScreenComponent<PlaylistItem> = ({ data: media, isLoading: isMediaLoading }) => {\r\n  const mediaId = media.mediaid;\r\n  const [searchParams] = useSearchParams();\r\n\r\n  const play = searchParams.get('play') === '1';\r\n  const feedId = searchParams.get('r');\r\n\r\n  const { data: episodeInSeries, isLoading: isSeriesIdLoading } = useSeriesLookup(media.mediaid);\r\n  const { isLoading: isSeriesMediaLoading, data: seriesMedia } = useMedia(episodeInSeries?.series_id || '');\r\n\r\n  // Prevent rendering multiple times when we are loading data\r\n  if (isMediaLoading || isSeriesIdLoading || isSeriesMediaLoading) {\r\n    return <Loading />;\r\n  }\r\n\r\n  if (!episodeInSeries) {\r\n    return <Navigate to={buildLegacySeriesUrlFromMediaItem(media, play, feedId)} replace />;\r\n  }\r\n\r\n  const { mediaid: id, title } = seriesMedia as PlaylistItem;\r\n\r\n  // Use media episode item for legacy series flow\r\n  return (\r\n    <Navigate\r\n      to={mediaURL({\r\n        episodeId: mediaId,\r\n        id,\r\n        title,\r\n        play,\r\n        playlistId: feedId,\r\n      })}\r\n      replace\r\n    />\r\n  );\r\n};\r\n\r\nexport default MediaEpisode;\r\n","import type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { isLiveEvent, isPlayable } from '@jwp/ott-common/src/utils/liveEvent';\r\n\r\nexport function useLiveEvent(media: PlaylistItem) {\r\n  return {\r\n    isLiveEvent: isLiveEvent(media),\r\n    isPlayable: isPlayable(media),\r\n  };\r\n}\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\n\r\nimport styles from './Tag.module.scss';\r\n\r\ntype TagProps = {\r\n  className?: string;\r\n  isLive?: boolean;\r\n  children?: React.ReactNode;\r\n  size?: 'normal' | 'large';\r\n};\r\n\r\nconst Tag: React.FC<TagProps> = ({ children, className, isLive = false, size = 'normal' }: TagProps) => {\r\n  return (\r\n    <div\r\n      className={classNames(className, styles.tag, styles[size], {\r\n        [styles.live]: isLive,\r\n      })}\r\n    >\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Tag;\r\n","import { useTranslation } from 'react-i18next';\r\nimport { MediaStatus } from '@jwp/ott-common/src/utils/liveEvent';\r\nimport Today from '@jwp/ott-theme/assets/icons/today.svg?react';\r\n\r\nimport Tag from '../Tag/Tag';\r\nimport Icon from '../Icon/Icon';\r\n\r\nimport styles from './StatusIcon.module.scss';\r\n\r\ntype Props = {\r\n  mediaStatus?: MediaStatus;\r\n};\r\n\r\nexport default function StatusIcon({ mediaStatus }: Props) {\r\n  const { t } = useTranslation('video');\r\n\r\n  if (mediaStatus === MediaStatus.SCHEDULED || mediaStatus === MediaStatus.VOD) {\r\n    return <Icon icon={Today} className={styles.icon} />;\r\n  } else if (mediaStatus === MediaStatus.LIVE) {\r\n    return (\r\n      <Tag isLive className={styles.icon}>\r\n        {t('live')}\r\n      </Tag>\r\n    );\r\n  }\r\n\r\n  return null;\r\n}\r\n","import React, { useCallback, useEffect, useState } from 'react';\r\nimport { useNavigate, useParams } from 'react-router';\r\nimport { Helmet } from 'react-helmet';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport { MediaStatus } from '@jwp/ott-common/src/utils/liveEvent';\r\nimport { createLiveEventMetadata } from '@jwp/ott-common/src/utils/metadata';\r\nimport { mediaURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport { generateMovieJSONLD } from '@jwp/ott-common/src/utils/structuredData';\r\nimport useMedia from '@jwp/ott-hooks-react/src/useMedia';\r\nimport { useLiveEvent } from '@jwp/ott-hooks-react/src/useLiveEvent';\r\nimport usePlaylist from '@jwp/ott-hooks-react/src/usePlaylist';\r\nimport useEntitlement from '@jwp/ott-hooks-react/src/useEntitlement';\r\nimport useBreakpoint, { Breakpoint } from '@jwp/ott-ui-react/src/hooks/useBreakpoint';\r\nimport PlayTrailer from '@jwp/ott-theme/assets/icons/play_trailer.svg?react';\r\nimport useQueryParam from '@jwp/ott-ui-react/src/hooks/useQueryParam';\r\nimport env from '@jwp/ott-common/src/env';\r\n\r\nimport type { ScreenComponent } from '../../../../../types/screens';\r\nimport VideoLayout from '../../../../components/VideoLayout/VideoLayout';\r\nimport StartWatchingButton from '../../../../containers/StartWatchingButton/StartWatchingButton';\r\nimport Cinema from '../../../../containers/Cinema/Cinema';\r\nimport TrailerModal from '../../../../containers/TrailerModal/TrailerModal';\r\nimport ShareButton from '../../../../components/ShareButton/ShareButton';\r\nimport FavoriteButton from '../../../../containers/FavoriteButton/FavoriteButton';\r\nimport Button from '../../../../components/Button/Button';\r\nimport InlinePlayer from '../../../../containers/InlinePlayer/InlinePlayer';\r\nimport StatusIcon from '../../../../components/StatusIcon/StatusIcon';\r\nimport VideoMetaData from '../../../../components/VideoMetaData/VideoMetaData';\r\nimport Icon from '../../../../components/Icon/Icon';\r\n\r\nconst MediaEvent: ScreenComponent<PlaylistItem> = ({ data: media, isLoading }) => {\r\n  const { t, i18n } = useTranslation(['video', 'common']);\r\n\r\n  const [playTrailer, setPlayTrailer] = useState<boolean>(false);\r\n  const breakpoint = useBreakpoint();\r\n\r\n  // Routing\r\n  const navigate = useNavigate();\r\n\r\n  const params = useParams();\r\n  const id = params.id || '';\r\n  const play = useQueryParam('play') === '1';\r\n  const playlistId = useQueryParam('r');\r\n\r\n  // Config\r\n  const { config, accessModel } = useConfigStore(({ config, accessModel }) => ({ config, accessModel }), shallow);\r\n  const { siteName, features, custom } = config;\r\n\r\n  const isFavoritesEnabled: boolean = Boolean(features?.favoritesList);\r\n  const inlineLayout = Boolean(custom?.inlinePlayer);\r\n\r\n  // Media\r\n  const { isLoading: isTrailerLoading, data: trailerItem } = useMedia(media?.trailerId || '');\r\n  const { isLoading: isPlaylistLoading, data: playlist } = usePlaylist(playlistId || '');\r\n\r\n  // Event\r\n  const liveEvent = useLiveEvent(media);\r\n\r\n  // User, entitlement\r\n  const { user, subscription } = useAccountStore(({ user, subscription }) => ({ user, subscription }), shallow);\r\n  const { isEntitled, mediaOffers } = useEntitlement(media);\r\n  const hasMediaOffers = !!mediaOffers.length;\r\n\r\n  // Handlers\r\n  const goBack = () => media && navigate(mediaURL({ id: media.mediaid, title: media.title, playlistId, play: false }));\r\n  const getUrl = (item: PlaylistItem) => mediaURL({ id: item.mediaid, title: item.title, playlistId });\r\n\r\n  const handleComplete = useCallback(() => {\r\n    if (!id || !playlist) return;\r\n\r\n    const index = playlist.playlist.findIndex(({ mediaid }) => mediaid === id);\r\n    const nextItem = playlist.playlist[index + 1];\r\n\r\n    if (nextItem.mediaStatus === MediaStatus.SCHEDULED) {\r\n      return;\r\n    }\r\n\r\n    return nextItem && navigate(mediaURL({ id: nextItem.mediaid, title: nextItem.title, playlistId, play: true }));\r\n  }, [id, playlist, navigate, playlistId]);\r\n\r\n  // Effects\r\n  useEffect(() => {\r\n    (document.scrollingElement || document.body).scroll({ top: 0 });\r\n    (document.querySelector('#video-details button') as HTMLElement)?.focus();\r\n  }, [id]);\r\n\r\n  // UI\r\n  const { title, mediaid } = media;\r\n  const pageTitle = `${title} - ${siteName}`;\r\n  const canonicalUrl = media ? `${env.APP_PUBLIC_URL}${mediaURL({ id: mediaid, title })}` : window.location.href;\r\n\r\n  const primaryMetadata = (\r\n    <>\r\n      <StatusIcon mediaStatus={media.mediaStatus} />\r\n      <VideoMetaData\r\n        attributes={createLiveEventMetadata(media, i18n.language, {\r\n          minutesAbbreviation: t('common:abbreviation.minutes'),\r\n          hoursAbbreviation: t('common:abbreviation.hours'),\r\n        })}\r\n      />\r\n    </>\r\n  );\r\n\r\n  const shareButton = <ShareButton title={media.title} description={media.description} url={canonicalUrl} />;\r\n  const startWatchingButton = (\r\n    <StartWatchingButton\r\n      key={id} // necessary to fix autofocus on TalkBack\r\n      item={media}\r\n      playUrl={mediaURL({ id: mediaid, title, playlistId, play: true })}\r\n      disabled={!liveEvent.isPlayable}\r\n    />\r\n  );\r\n\r\n  const favoriteButton = isFavoritesEnabled && <FavoriteButton item={media} />;\r\n  const trailerButton = (!!trailerItem || isTrailerLoading) && (\r\n    <Button\r\n      label={t('video:trailer')}\r\n      aria-label={t('video:watch_trailer')}\r\n      startIcon={<Icon icon={PlayTrailer} />}\r\n      onClick={() => setPlayTrailer(true)}\r\n      active={playTrailer}\r\n      fullWidth={breakpoint < Breakpoint.md}\r\n      disabled={!trailerItem}\r\n    />\r\n  );\r\n\r\n  const isLoggedIn = !!user;\r\n  const hasSubscription = !!subscription;\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Helmet>\r\n        <title>{pageTitle}</title>\r\n        <link rel=\"canonical\" href={canonicalUrl} />\r\n        <meta name=\"description\" content={media.description} />\r\n        <meta property=\"og:description\" content={media.description} />\r\n        <meta property=\"og:title\" content={pageTitle} />\r\n        <meta property=\"og:type\" content=\"video.other\" />\r\n        {media.image && <meta property=\"og:image\" content={media.image?.replace(/^https:/, 'http:')} />}\r\n        {media.image && <meta property=\"og:image:secure_url\" content={media.image?.replace(/^http:/, 'https:')} />}\r\n        <meta property=\"og:image:width\" content={media.image ? '720' : ''} />\r\n        <meta property=\"og:image:height\" content={media.image ? '406' : ''} />\r\n        <meta name=\"twitter:title\" content={pageTitle} />\r\n        <meta name=\"twitter:description\" content={media.description} />\r\n        <meta name=\"twitter:image\" content={media.image} />\r\n        <meta property=\"og:video\" content={canonicalUrl.replace(/^https:/, 'http:')} />\r\n        <meta property=\"og:video:secure_url\" content={canonicalUrl.replace(/^http:/, 'https:')} />\r\n        <meta property=\"og:video:type\" content=\"text/html\" />\r\n        <meta property=\"og:video:width\" content=\"1280\" />\r\n        <meta property=\"og:video:height\" content=\"720\" />\r\n        {media.tags?.split(',').map((tag) => (\r\n          <meta property=\"og:video:tag\" content={tag} key={tag} />\r\n        ))}\r\n        {media ? <script type=\"application/ld+json\">{generateMovieJSONLD(media, env.APP_PUBLIC_URL)}</script> : null}\r\n      </Helmet>\r\n      <VideoLayout\r\n        item={media}\r\n        inlineLayout={inlineLayout}\r\n        isLoading={isLoading || isPlaylistLoading}\r\n        accessModel={accessModel}\r\n        isLoggedIn={isLoggedIn}\r\n        hasSubscription={hasSubscription}\r\n        title={media.title}\r\n        description={media.description}\r\n        image={media.backgroundImage}\r\n        primaryMetadata={primaryMetadata}\r\n        shareButton={shareButton}\r\n        favoriteButton={favoriteButton}\r\n        trailerButton={trailerButton}\r\n        startWatchingButton={startWatchingButton}\r\n        playlist={playlist}\r\n        relatedTitle={playlist?.title}\r\n        getURL={getUrl}\r\n        activeLabel={t('current_video')}\r\n        player={\r\n          inlineLayout ? (\r\n            <InlinePlayer\r\n              isLoggedIn={isLoggedIn}\r\n              item={media}\r\n              onComplete={handleComplete}\r\n              feedId={playlistId ?? undefined}\r\n              startWatchingButton={startWatchingButton}\r\n              isEntitled={isEntitled}\r\n              hasMediaOffers={hasMediaOffers}\r\n              autostart={liveEvent.isPlayable && (play || undefined)}\r\n              playable={liveEvent.isPlayable}\r\n            />\r\n          ) : (\r\n            <Cinema\r\n              open={play && isEntitled}\r\n              onClose={goBack}\r\n              item={media}\r\n              title={media.title}\r\n              primaryMetadata={primaryMetadata}\r\n              onComplete={handleComplete}\r\n              feedId={playlistId ?? undefined}\r\n              onNext={handleComplete}\r\n            />\r\n          )\r\n        }\r\n      />\r\n      <TrailerModal item={trailerItem} title={`${media.title} - Trailer`} open={playTrailer} onClose={() => setPlayTrailer(false)} />\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nexport default MediaEvent;\r\n","import { useParams } from 'react-router';\r\nimport { useTranslation } from 'react-i18next';\r\nimport React from 'react';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { isEpisode, isLegacySeriesFlow } from '@jwp/ott-common/src/utils/media';\r\nimport { MEDIA_CONTENT_TYPE } from '@jwp/ott-common/src/constants';\r\nimport { ScreenMap } from '@jwp/ott-common/src/utils/ScreenMap';\r\nimport useMedia from '@jwp/ott-hooks-react/src/useMedia';\r\n\r\nimport type { ScreenComponent } from '../../../types/screens';\r\nimport Loading from '../Loading/Loading';\r\nimport ErrorPage from '../../components/ErrorPage/ErrorPage';\r\nimport Fade from '../../components/Animation/Fade/Fade';\r\n\r\nimport MediaStaticPage from './mediaScreens/MediaStaticPage/MediaStaticPage';\r\nimport MediaMovie from './mediaScreens/MediaMovie/MediaMovie';\r\nimport MediaSeries from './mediaScreens/MediaSeries/MediaSeries';\r\nimport MediaLiveChannel from './mediaScreens/MediaLiveChannel/MediaLiveChannel';\r\nimport MediaEpisode from './mediaScreens/MediaEpisode/MediaEpisode';\r\nimport MediaEvent from './mediaScreens/MediaEvent/MediaEvent';\r\n\r\nexport const mediaScreenMap = new ScreenMap<PlaylistItem, ScreenComponent<PlaylistItem>>();\r\n\r\n// Register media screens\r\nmediaScreenMap.registerByContentType(MediaSeries, MEDIA_CONTENT_TYPE.series);\r\nmediaScreenMap.registerByContentType(MediaEpisode, MEDIA_CONTENT_TYPE.episode);\r\nmediaScreenMap.registerByContentType(MediaLiveChannel, MEDIA_CONTENT_TYPE.liveChannel);\r\nmediaScreenMap.registerByContentType(MediaEvent, MEDIA_CONTENT_TYPE.liveEvent);\r\nmediaScreenMap.registerByContentType(MediaStaticPage, MEDIA_CONTENT_TYPE.page);\r\nmediaScreenMap.registerDefault(MediaMovie);\r\n\r\n// Register legacy series and episode screens when `contentType` is missing\r\nmediaScreenMap.register(MediaEpisode, (item) => !!item && isEpisode(item));\r\nmediaScreenMap.register(MediaSeries, (item) => !!item && isLegacySeriesFlow(item));\r\n\r\nconst MediaScreenRouter = () => {\r\n  const params = useParams();\r\n  const id = params.id || '';\r\n  const { isLoading, isFetching, error, data } = useMedia(id);\r\n  const { t } = useTranslation('error');\r\n\r\n  if (isLoading) {\r\n    return <Loading />;\r\n  }\r\n\r\n  if (error || !data) {\r\n    return <ErrorPage title={t('video_not_found')} />;\r\n  }\r\n\r\n  const MediaScreen = mediaScreenMap.getScreen(data);\r\n\r\n  return (\r\n    <Fade open>\r\n      <MediaScreen data={data} isLoading={isFetching} />\r\n    </Fade>\r\n  );\r\n};\r\n\r\nexport default MediaScreenRouter;\r\n","import React, { useEffect, useMemo, useState } from 'react';\r\nimport { Helmet } from 'react-helmet';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport type { Playlist, PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { filterPlaylist, getFiltersFromConfig } from '@jwp/ott-common/src/utils/collection';\r\nimport { mediaURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport { useTranslationKey } from '@jwp/ott-hooks-react/src/useTranslationKey';\r\n\r\nimport type { ScreenComponent } from '../../../../../types/screens';\r\nimport CardGrid from '../../../../components/CardGrid/CardGrid';\r\nimport Filter from '../../../../components/Filter/Filter';\r\n\r\nimport styles from './PlaylistGrid.module.scss';\r\n\r\nconst PlaylistGrid: ScreenComponent<Playlist> = ({ data, isLoading }) => {\r\n  const translationKey = useTranslationKey('title');\r\n  const { config, accessModel } = useConfigStore(({ config, accessModel }) => ({ config, accessModel }), shallow);\r\n\r\n  const [filter, setFilter] = useState<string>('');\r\n\r\n  const categories = getFiltersFromConfig(config, data.feedid);\r\n  const filteredPlaylist = useMemo(() => filterPlaylist(data, filter), [data, filter]);\r\n  const shouldShowFilter = Boolean(categories.length);\r\n\r\n  // User\r\n  const { user, subscription } = useAccountStore(({ user, subscription }) => ({ user, subscription }), shallow);\r\n\r\n  useEffect(() => {\r\n    // reset filter when the playlist id changes\r\n    setFilter('');\r\n  }, [data.feedid]);\r\n\r\n  const title = (data?.[translationKey] as string) || data.title;\r\n  const pageTitle = `${title} - ${config.siteName}`;\r\n\r\n  const getUrl = (playlistItem: PlaylistItem) =>\r\n    mediaURL({\r\n      id: playlistItem.mediaid,\r\n      title: playlistItem.title,\r\n      playlistId: playlistItem.feedid,\r\n    });\r\n\r\n  return (\r\n    <div className={styles.playlist}>\r\n      <Helmet>\r\n        <title>{pageTitle}</title>\r\n        <meta property=\"og:title\" content={pageTitle} />\r\n        <meta name=\"twitter:title\" content={pageTitle} />\r\n      </Helmet>\r\n      <header className={styles.header}>\r\n        <h1>{title}</h1>\r\n        {shouldShowFilter && <Filter name=\"genre\" value={filter} defaultLabel=\"All\" options={categories} setValue={setFilter} />}\r\n      </header>\r\n      <CardGrid\r\n        getUrl={getUrl}\r\n        playlist={filteredPlaylist}\r\n        accessModel={accessModel}\r\n        isLoggedIn={!!user}\r\n        hasSubscription={!!subscription}\r\n        isLoading={isLoading}\r\n        headingLevel={2}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PlaylistGrid;\r\n","import { isAfter, isFuture, isPast, subHours } from 'date-fns';\r\n\r\nimport type { EpgChannel, EpgProgram } from '../../types/epg';\r\n\r\n/**\r\n * Returns true when the program is currently live e.g. the startTime is before now and the endTime is after now\r\n */\r\nexport const programIsLive = (program: EpgProgram) => {\r\n  const startTime = new Date(program.startTime);\r\n  const endTime = new Date(program.endTime);\r\n\r\n  return isPast(startTime) && isFuture(endTime);\r\n};\r\n\r\n/**\r\n * Returns true when the program is finished.\r\n */\r\nexport const programIsVod = (program: EpgProgram) => {\r\n  const endTime = new Date(program.endTime);\r\n\r\n  return isPast(endTime);\r\n};\r\n\r\n/**\r\n * Returns true when the program is watchable from the beginning. This is when the startTime is within the live stream\r\n * archive length.\r\n */\r\nexport const programIsFullyWatchable = (program: EpgProgram, liveStreamCatchupHours = 8) => {\r\n  const startTime = new Date(program.startTime);\r\n  const maxStartTime = subHours(new Date(), liveStreamCatchupHours);\r\n\r\n  return isAfter(startTime, maxStartTime);\r\n};\r\n\r\n/**\r\n * Get the live program of the given channel\r\n */\r\nexport const getLiveProgram = (channel: EpgChannel) => {\r\n  return channel.programs.find(programIsLive);\r\n};\r\n","import { useQuery } from 'react-query';\r\nimport { useCallback, useEffect, useState } from 'react';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\nimport type { EpgChannel, EpgProgram } from '@jwp/ott-common/types/epg';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport { getLiveProgram, programIsLive } from '@jwp/ott-common/src/utils/epg';\r\nimport { LIVE_CHANNELS_REFETCH_INTERVAL } from '@jwp/ott-common/src/constants';\r\nimport EpgController from '@jwp/ott-common/src/controllers/EpgController';\r\n\r\n/**\r\n * This hook fetches the schedules for the given list of playlist items and manages the current channel and program.\r\n *\r\n * It automatically selects the initial channel (or first channel) and currently live program. It also updates the\r\n * program information when the current program is not live anymore.\r\n *\r\n * The `enableAutoUpdate` argument can be used to ignore the auto update mechanism. For example, when playing a live\r\n * program from the beginning, we don't want to update the program information in the middle of the program.\r\n *\r\n * @todo The `enableAutoUpdate` mechanism has a drawback, when used the program information will not be updated anymore.\r\n *       Meaning that when watching a program from the beginning, it will hold the current program until the user clicks\r\n *       on a different program. This can be solved when we implement syncing the stream PDT with the schedule. Then the\r\n *       program information will be reactive based on the current time in the stream.\r\n */\r\nconst useLiveChannels = ({\r\n  playlist,\r\n  initialChannelId,\r\n  enableAutoUpdate = true,\r\n}: {\r\n  playlist: PlaylistItem[];\r\n  initialChannelId: string | undefined;\r\n  enableAutoUpdate?: boolean;\r\n}) => {\r\n  const epgController = getModule(EpgController);\r\n\r\n  const { data: channels = [] } = useQuery(['schedules', ...playlist.map(({ mediaid }) => mediaid)], () => epgController.getSchedules(playlist), {\r\n    refetchInterval: LIVE_CHANNELS_REFETCH_INTERVAL,\r\n  });\r\n\r\n  const [autoUpdate, setAutoUpdate] = useState(enableAutoUpdate);\r\n  const [channel, setChannel] = useState<EpgChannel | undefined>();\r\n  const [program, setProgram] = useState<EpgProgram | undefined>();\r\n\r\n  // this effect updates the program when watching the live stream and the next program starts\r\n  useEffect(() => {\r\n    if (!autoUpdate || !enableAutoUpdate) return;\r\n\r\n    const intervalId = window.setInterval(() => channel && setProgram(getLiveProgram(channel)), 5_000);\r\n\r\n    return () => clearInterval(intervalId);\r\n  }, [channel, autoUpdate, enableAutoUpdate]);\r\n\r\n  // auto select initial channel (fallback to first channel) and program when the data is loaded\r\n  // update channel and program state with the latest data\r\n  useEffect(() => {\r\n    const selectedChannel = channels.find(({ id }) => id === initialChannelId) || channels[0];\r\n\r\n    // auto select first channel when no channel is selected\r\n    if (!channel && selectedChannel) {\r\n      setChannel(selectedChannel);\r\n\r\n      // auto select live program\r\n      setProgram(getLiveProgram(selectedChannel));\r\n    }\r\n\r\n    // update the current channel with the updated data\r\n    if (channel) {\r\n      const updatedChannel = channels.find(({ id }) => id === channel.id);\r\n\r\n      // find the current program in the updated data\r\n      let updatedProgram = program && updatedChannel?.programs.find(({ id }) => id === program?.id);\r\n\r\n      // if the program doesn't exist, use the live program\r\n      if (!updatedProgram && updatedChannel) {\r\n        updatedProgram = getLiveProgram(updatedChannel);\r\n      }\r\n\r\n      // update channel with potential updated programs\r\n      setChannel(updatedChannel);\r\n      setProgram(updatedProgram);\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [channels]);\r\n\r\n  // update the selected channel and optionally the program\r\n  const setActiveChannel = useCallback(\r\n    (id: string, programId?: string) => {\r\n      const channel = channels?.find((channel) => channel.id === id);\r\n\r\n      // early return when no channel was found\r\n      if (!channel) {\r\n        return;\r\n      }\r\n\r\n      // select the found program or live program when no programId is given\r\n      const program = programId ? channel.programs.find((program) => program.id === programId) : getLiveProgram(channel);\r\n\r\n      setChannel(channel);\r\n      setProgram(program);\r\n\r\n      // enable auto update when there is no program information or when the program is live\r\n      // when the user clicks on a VOD item, we don't want to update the information automatically\r\n      setAutoUpdate(!program || programIsLive(program));\r\n    },\r\n    [channels],\r\n  );\r\n\r\n  return {\r\n    channel,\r\n    channels,\r\n    program,\r\n    setActiveChannel,\r\n  };\r\n};\r\n\r\nexport default useLiveChannels;\r\n","import { useEffect, useState } from 'react';\r\nimport type { EpgProgram } from '@jwp/ott-common/types/epg';\r\nimport { programIsFullyWatchable, programIsLive, programIsVod } from '@jwp/ott-common/src/utils/epg';\r\n\r\n/**\r\n * This hook returns memoized program state variables that change based on the given program and the current time.\r\n * For example, the live and VOD states, toggle when the program is not live anymore.\r\n */\r\nconst useLiveProgram = ({ program, catchupHours }: { program: EpgProgram | undefined; catchupHours: number | undefined }) => {\r\n  const [isLive, setIsLive] = useState(false);\r\n  const [isVod, setIsVod] = useState(false);\r\n  const [isWatchableFromBeginning, setIsWatchableFromBeginning] = useState(false);\r\n\r\n  // update when the program changes\r\n  useEffect(() => {\r\n    const calculateStatus = () => {\r\n      setIsLive(!!program && programIsLive(program));\r\n      setIsVod(!!program && programIsVod(program));\r\n      setIsWatchableFromBeginning(!!program && programIsFullyWatchable(program, catchupHours));\r\n    };\r\n\r\n    // recalculate the program status every 5 seconds\r\n    const intervalId = setInterval(calculateStatus, 5_000);\r\n\r\n    // immediately update the program status when the program changes\r\n    calculateStatus();\r\n\r\n    return () => clearInterval(intervalId);\r\n  }, [catchupHours, program]);\r\n\r\n  return {\r\n    isLive,\r\n    isVod,\r\n    isWatchableFromBeginning,\r\n  };\r\n};\r\n\r\nexport default useLiveProgram;\r\n","import { useMemo } from 'react';\r\nimport { useEpg } from 'planby';\r\nimport { startOfDay, startOfToday, startOfTomorrow } from 'date-fns';\r\nimport type { EpgChannel, EpgProgram } from '@jwp/ott-common/types/epg';\r\nimport { is12HourClock } from '@jwp/ott-common/src/utils/datetime';\r\n\r\nconst isBaseTimeFormat = is12HourClock();\r\n\r\nexport const formatChannel = ({ id, channelLogoImage, backgroundImage }: EpgChannel) => ({\r\n  uuid: id,\r\n  logo: channelLogoImage,\r\n  channelLogoImage: channelLogoImage,\r\n  backgroundImage: backgroundImage,\r\n});\r\n\r\nexport const formatProgram = (channelId: string, { id, title, cardImage, backgroundImage, description, endTime, startTime }: EpgProgram) => ({\r\n  channelUuid: channelId,\r\n  id: id,\r\n  title: title,\r\n  image: cardImage || '',\r\n  // programs have the same cardImage/backgroundImage (different API)\r\n  cardImage: cardImage || '',\r\n  backgroundImage: backgroundImage || '',\r\n  description: description || '',\r\n  till: endTime,\r\n  since: startTime,\r\n});\r\n\r\n/**\r\n * Return the Planby EPG props for the given channels\r\n */\r\nconst usePlanByEpg = ({\r\n  channels,\r\n  sidebarWidth,\r\n  itemHeight,\r\n}: {\r\n  channels: EpgChannel[];\r\n  sidebarWidth: number;\r\n  itemHeight: number;\r\n  highlightColor?: string | null;\r\n  backgroundColor?: string | null;\r\n}) => {\r\n  const [epgChannels, epgPrograms] = useMemo(() => {\r\n    return [channels.map(formatChannel), channels.flatMap((channel) => channel.programs.map((program) => formatProgram(channel.id, program)))];\r\n  }, [channels]);\r\n\r\n  const theme = useMemo(() => makeTheme(), []);\r\n\r\n  // this mechanism updates the EPG component range when leaving the page open for a longer period\r\n  // the useEpg hook doesn't accept a formatted date and re-renders when not memoize the start and end dates\r\n  // @todo ideally we want to render the schedule X hours before and after the current time, but this doesn't work (yet)\r\n  //       in the Planby component. E.g. `[subHours(new Date(), 12), addHours(new Date(), 12)]`. The `date` dependency\r\n  //       must also be changed to update every hour instead of daily.\r\n  const date = startOfToday().toJSON();\r\n  const [startDate, endDate] = useMemo(() => [startOfDay(new Date(date)), startOfTomorrow()], [date]);\r\n\r\n  return useEpg({\r\n    channels: epgChannels,\r\n    epg: epgPrograms,\r\n    dayWidth: 7200,\r\n    sidebarWidth,\r\n    itemHeight,\r\n    isSidebar: true,\r\n    isTimeline: true,\r\n    isLine: true,\r\n    isBaseTimeFormat,\r\n    startDate,\r\n    endDate,\r\n    theme,\r\n  });\r\n};\r\n\r\nexport const makeTheme = () => ({\r\n  primary: {\r\n    600: 'var(--epg-background-color, var(--body-background-color))',\r\n    900: 'var(--epg-background-color, var(--body-background-color))',\r\n  },\r\n  grey: {\r\n    300: '#fff',\r\n  },\r\n  white: '#fff',\r\n  green: {\r\n    300: '#fff',\r\n  },\r\n  loader: {\r\n    teal: '',\r\n    purple: '',\r\n    pink: '',\r\n    bg: '',\r\n  },\r\n  scrollbar: {\r\n    border: '',\r\n    thumb: {\r\n      bg: '',\r\n    },\r\n  },\r\n  gradient: {\r\n    blue: {\r\n      300: '',\r\n      600: '',\r\n      900: '',\r\n    },\r\n  },\r\n  text: {\r\n    grey: {\r\n      300: '',\r\n      500: '',\r\n    },\r\n  },\r\n  timeline: {\r\n    divider: {\r\n      bg: '',\r\n    },\r\n  },\r\n});\r\n\r\nexport default usePlanByEpg;\r\n","import React from 'react';\r\nimport type { Channel } from 'planby';\r\nimport classNames from 'classnames';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\n\r\nimport Image from '../Image/Image';\r\n\r\nimport styles from './EpgChannelItem.module.scss';\r\n\r\ntype Props = {\r\n  channel: Channel;\r\n  channelItemWidth: number;\r\n  sidebarWidth: number;\r\n  onClick?: (channel: Channel) => void;\r\n  isActive: boolean;\r\n  title: string;\r\n};\r\n\r\nconst EpgChannelItem: React.VFC<Props> = ({ channel, channelItemWidth, sidebarWidth, onClick, isActive, title }) => {\r\n  const { position, uuid, channelLogoImage } = channel;\r\n  const style = { top: position.top, height: position.height, width: sidebarWidth };\r\n\r\n  return (\r\n    <div className={styles.epgChannelBox} style={style}>\r\n      <div\r\n        className={classNames(styles.epgChannel, { [styles.active]: isActive })}\r\n        style={{ width: channelItemWidth }}\r\n        onClick={() => onClick && onClick(channel)}\r\n        data-testid={testId(uuid)}\r\n        role=\"button\"\r\n      >\r\n        <Image className={styles.epgChannelLogo} image={channelLogoImage} alt={title} width={320} />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EpgChannelItem;\r\n","import React from 'react';\r\nimport { useProgram, type Program } from 'planby';\r\nimport classNames from 'classnames';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\n\r\nimport styles from './EpgProgramItem.module.scss';\r\n\r\ntype Props = {\r\n  program: Program;\r\n  onClick?: (program: Program) => void;\r\n  isActive: boolean;\r\n  compact: boolean;\r\n  disabled: boolean;\r\n  isBaseTimeFormat: boolean;\r\n};\r\n\r\nconst ProgramItem: React.VFC<Props> = ({ program, onClick, isActive, compact, disabled, isBaseTimeFormat }) => {\r\n  const {\r\n    styles: { position },\r\n    formatTime,\r\n    set12HoursTimeFormat,\r\n    isLive,\r\n    isMinWidth,\r\n  } = useProgram({\r\n    program,\r\n    isBaseTimeFormat,\r\n  });\r\n\r\n  const { t } = useTranslation('common');\r\n  const { data } = program;\r\n  const { image, title, since, till } = data;\r\n\r\n  const sinceTime = formatTime(since, set12HoursTimeFormat()).toLowerCase();\r\n  const tillTime = formatTime(till, set12HoursTimeFormat()).toLowerCase();\r\n\r\n  const showImage = !compact && isMinWidth;\r\n  const showLiveTagInImage = !compact && isMinWidth && isLive;\r\n  const alt = ''; // intentionally empty for a11y, because adjacent text alternative\r\n\r\n  return (\r\n    <div className={styles.epgProgramBox} style={position} onClick={() => onClick && onClick(program)}>\r\n      <div\r\n        className={classNames(styles.epgProgram, {\r\n          [styles.selected]: isActive,\r\n          [styles.live]: isLive,\r\n          [styles.disabled]: disabled,\r\n        })}\r\n        style={{ width: styles.width }}\r\n        data-testid={testId(program.data.id)}\r\n      >\r\n        {showImage && <img className={styles.epgProgramImage} src={image} alt={alt} />}\r\n        {showLiveTagInImage && <div className={styles.epgLiveTag}>{t('live')}</div>}\r\n        <div className={styles.epgProgramContent}>\r\n          {compact && isLive && <div className={styles.epgLiveTag}>{t('live')}</div>}\r\n          <h2 className={styles.epgProgramTitle}>{title}</h2>\r\n          <span className={styles.epgProgramText}>\r\n            {sinceTime} - {tillTime}\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProgramItem;\r\n","import React from 'react';\r\nimport { useTimeline } from 'planby';\r\n\r\nimport styles from './EpgTimeline.module.scss';\r\n\r\ntype Props = {\r\n  isBaseTimeFormat: boolean;\r\n  isSidebar: boolean;\r\n  dayWidth: number;\r\n  hourWidth: number;\r\n  numberOfHoursInDay: number;\r\n  offsetStartHoursRange: number;\r\n  sidebarWidth: number;\r\n};\r\n\r\nconst EpgTimeline: React.VFC<Props> = ({ isBaseTimeFormat, dayWidth, hourWidth, numberOfHoursInDay, offsetStartHoursRange, isSidebar, sidebarWidth }) => {\r\n  const { time, dividers, formatTime } = useTimeline(numberOfHoursInDay, isBaseTimeFormat);\r\n\r\n  const renderDividers = () => dividers.map((_, index) => <div className={styles.timelineDivider} key={index} style={{ marginRight: hourWidth / 4 }} />);\r\n\r\n  const renderTime = (index: number) => (\r\n    <div className={styles.timelineBox} key={index} style={{ width: hourWidth }}>\r\n      <time className={styles.timelineTime}>{formatTime(index + offsetStartHoursRange).toLowerCase()}</time>\r\n      <div className={styles.timelineDividers}>{renderDividers()}</div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className={styles.timelineContainer} style={{ width: dayWidth, left: isSidebar ? sidebarWidth : 0 }}>\r\n      {time.map((_, index) => renderTime(index))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EpgTimeline;\r\n","import React, { useMemo } from 'react';\r\nimport classNames from 'classnames';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Epg as EpgContainer, Layout } from 'planby';\r\nimport { isBefore, subHours } from 'date-fns';\r\nimport type { EpgChannel, EpgProgram } from '@jwp/ott-common/types/epg';\r\nimport usePlanByEpg from '@jwp/ott-hooks-react/src/usePlanByEpg';\r\nimport ChevronRight from '@jwp/ott-theme/assets/icons/chevron_right.svg?react';\r\nimport ChevronLeft from '@jwp/ott-theme/assets/icons/chevron_left.svg?react';\r\nimport useBreakpoint, { Breakpoint } from '@jwp/ott-ui-react/src/hooks/useBreakpoint';\r\nimport useFirstRender from '@jwp/ott-hooks-react/src/useFirstRender';\r\n\r\nimport IconButton from '../IconButton/IconButton';\r\nimport Button from '../Button/Button';\r\nimport EpgChannelItem from '../EpgChannel/EpgChannelItem';\r\nimport EpgProgramItem from '../EpgProgramItem/EpgProgramItem';\r\nimport EpgTimeline from '../EpgTimeline/EpgTimeline';\r\nimport Spinner from '../Spinner/Spinner';\r\nimport Icon from '../Icon/Icon';\r\n\r\nimport styles from './Epg.module.scss';\r\n\r\ntype Props = {\r\n  channels: EpgChannel[];\r\n  onChannelClick: (channelId: string) => void;\r\n  onProgramClick: (programId: string, channelId: string) => void;\r\n  selectedChannel: EpgChannel | undefined;\r\n  program: EpgProgram | undefined;\r\n};\r\n\r\nexport default function Epg({ channels, selectedChannel, onChannelClick, onProgramClick, program }: Props) {\r\n  const firstRender = useFirstRender();\r\n  const breakpoint = useBreakpoint();\r\n  const { t } = useTranslation('common');\r\n\r\n  const isMobile = breakpoint < Breakpoint.sm;\r\n  const sidebarWidth = isMobile ? 70 : 184;\r\n  // the subtracted value is used for spacing in the sidebar\r\n  const channelItemWidth = isMobile ? sidebarWidth - 10 : sidebarWidth - 24;\r\n  const itemHeight = isMobile ? 80 : 106;\r\n\r\n  // Epg\r\n  const { getEpgProps, getLayoutProps, onScrollToNow, onScrollLeft, onScrollRight } = usePlanByEpg({\r\n    channels,\r\n    sidebarWidth,\r\n    itemHeight,\r\n  });\r\n  const catchupHoursDict = useMemo(() => Object.fromEntries(channels.map((channel) => [channel.id, channel.catchupHours])), [channels]);\r\n  const titlesDict = useMemo(() => Object.fromEntries(channels.map((channel) => [channel.id, channel.title])), [channels]);\r\n\r\n  return (\r\n    <div className={classNames(styles.epg, firstRender && styles.firstFrame)}>\r\n      <div className={styles.timelineControl}>\r\n        <Button className={styles.timelineNowButton} variant=\"contained\" label={t('now')} color=\"primary\" onClick={onScrollToNow} size=\"small\" />\r\n        <IconButton className={styles.leftControl} aria-label={t('slide_left')} onClick={() => onScrollLeft()}>\r\n          <Icon icon={ChevronLeft} />\r\n        </IconButton>\r\n        <IconButton className={styles.rightControl} aria-label={t('slide_right')} onClick={() => onScrollRight()}>\r\n          <Icon icon={ChevronRight} />\r\n        </IconButton>\r\n      </div>\r\n      <EpgContainer {...getEpgProps()} loader={<Spinner className={styles.epgSpinner} />}>\r\n        <Layout\r\n          {...getLayoutProps()}\r\n          renderTimeline={(props) => <EpgTimeline {...props} />}\r\n          renderChannel={({ channel: epgChannel }) => (\r\n            <EpgChannelItem\r\n              key={epgChannel.uuid}\r\n              channel={epgChannel}\r\n              channelItemWidth={channelItemWidth}\r\n              sidebarWidth={sidebarWidth}\r\n              onClick={(toChannel) => {\r\n                onChannelClick(toChannel.uuid);\r\n                onScrollToNow();\r\n              }}\r\n              title={titlesDict[epgChannel.uuid] || ''}\r\n              isActive={selectedChannel?.id === epgChannel.uuid}\r\n            />\r\n          )}\r\n          renderProgram={({ program: programItem, isBaseTimeFormat }) => {\r\n            const catchupHours = catchupHoursDict[programItem.data.channelUuid];\r\n            const disabled = isBefore(new Date(programItem.data.since), subHours(new Date(), catchupHours));\r\n\r\n            return (\r\n              <EpgProgramItem\r\n                key={programItem.data.id}\r\n                program={programItem}\r\n                disabled={disabled}\r\n                onClick={(program) => !disabled && onProgramClick(program.data.id, program.data.channelUuid)}\r\n                isActive={program?.id === programItem.data.id}\r\n                compact={isMobile}\r\n                isBaseTimeFormat={isBaseTimeFormat}\r\n              />\r\n            );\r\n          }}\r\n        />\r\n      </EpgContainer>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useMemo, useState } from 'react';\r\nimport { Helmet } from 'react-helmet';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport { useLocation, useNavigate } from 'react-router';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { differenceInSeconds, format } from 'date-fns';\r\nimport type { Playlist } from '@jwp/ott-common/types/playlist';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { formatDurationTag } from '@jwp/ott-common/src/utils/formatting';\r\nimport { createURL, liveChannelsURL } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport { generateMovieJSONLD } from '@jwp/ott-common/src/utils/structuredData';\r\nimport useLiveChannels from '@jwp/ott-hooks-react/src/useLiveChannels';\r\nimport useEntitlement from '@jwp/ott-hooks-react/src/useEntitlement';\r\nimport useLiveProgram from '@jwp/ott-hooks-react/src/useLiveProgram';\r\nimport Play from '@jwp/ott-theme/assets/icons/play.svg?react';\r\nimport env from '@jwp/ott-common/src/env';\r\n\r\nimport type { ScreenComponent } from '../../../../../types/screens';\r\nimport Epg from '../../../../components/Epg/Epg';\r\nimport ShareButton from '../../../../components/ShareButton/ShareButton';\r\nimport StartWatchingButton from '../../../../containers/StartWatchingButton/StartWatchingButton';\r\nimport Cinema from '../../../../containers/Cinema/Cinema';\r\nimport Button from '../../../../components/Button/Button';\r\nimport Tag from '../../../../components/Tag/Tag';\r\nimport Loading from '../../../Loading/Loading';\r\nimport VideoDetails from '../../../../components/VideoDetails/VideoDetails';\r\nimport Icon from '../../../../components/Icon/Icon';\r\nimport VideoMetaData from '../../../../components/VideoMetaData/VideoMetaData';\r\n\r\nimport styles from './PlaylistLiveChannels.module.scss';\r\n\r\nconst PlaylistLiveChannels: ScreenComponent<Playlist> = ({ data: { feedid, playlist } }) => {\r\n  const { t } = useTranslation('epg');\r\n\r\n  // Config\r\n  const { config } = useConfigStore(({ config }) => ({ config }), shallow);\r\n  const { siteName } = config;\r\n\r\n  // Routing\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const searchParams = useMemo(() => new URLSearchParams(location.search), [location.search]);\r\n  const play = searchParams.get('play') === '1';\r\n  const channelId = searchParams.get('channel') ?? undefined;\r\n  const liveStartDateTime = searchParams.get('start');\r\n  const liveEndDateTime = searchParams.get('end');\r\n  const liveFromBeginning = searchParams.get('beginning') === '1';\r\n  const goBack = () => feedid && navigate(liveChannelsURL(feedid, channelId));\r\n\r\n  // EPG data\r\n  const [initialChannelId] = useState(channelId);\r\n  const { channels, channel, program, setActiveChannel } = useLiveChannels({ playlist, initialChannelId, enableAutoUpdate: !liveFromBeginning });\r\n  const { isLive, isVod, isWatchableFromBeginning } = useLiveProgram({ program, catchupHours: channel?.catchupHours });\r\n\r\n  // Media item\r\n  const channelMediaItem = useMemo(() => playlist.find(({ mediaid }) => channel?.id === mediaid), [channel?.id, playlist]);\r\n  const { isEntitled } = useEntitlement(channelMediaItem);\r\n\r\n  const videoDetails = useMemo(() => {\r\n    if (program) {\r\n      return {\r\n        title: program.title,\r\n        description: program.description || '',\r\n        image: program.backgroundImage,\r\n        canWatch: isLive || (isVod && isWatchableFromBeginning),\r\n        canWatchFromBeginning: isEntitled && isLive && isWatchableFromBeginning,\r\n      };\r\n    }\r\n\r\n    return {\r\n      title: channel?.title || '',\r\n      description: channel?.description || '',\r\n      image: channel?.backgroundImage,\r\n      canWatch: true,\r\n      canWatchFromBeginning: false,\r\n    };\r\n  }, [channel?.backgroundImage, channel?.description, channel?.title, isEntitled, isLive, isVod, isWatchableFromBeginning, program]);\r\n\r\n  const primaryMetadata = useMemo(() => {\r\n    if (!channel) {\r\n      return '';\r\n    }\r\n\r\n    if (!program) {\r\n      return <Tag isLive>{t('common:live')}</Tag>;\r\n    }\r\n\r\n    const startTime = new Date(program.startTime);\r\n    const endTime = new Date(program.endTime);\r\n    const durationInSeconds = differenceInSeconds(endTime, startTime);\r\n    const duration = formatDurationTag(durationInSeconds, { minutesAbbreviation: t('common:abbreviation.minutes') });\r\n    const attributes = [t('on_channel', { name: channel.title }), duration].filter(Boolean);\r\n\r\n    return (\r\n      <>\r\n        <Tag className={styles.tag} isLive={isLive}>\r\n          {isLive ? t('common:live') : `${format(startTime, 'p')} - ${format(endTime, 'p')}`}\r\n        </Tag>\r\n        <VideoMetaData attributes={attributes} />\r\n      </>\r\n    );\r\n  }, [channel, isLive, program, t]);\r\n\r\n  // Handlers\r\n  const handleProgramClick = (programId: string, channelId: string) => {\r\n    setActiveChannel(channelId, programId);\r\n\r\n    // scroll to top when clicking a program\r\n    (document.scrollingElement || document.body).scroll({ top: 0, behavior: 'smooth' });\r\n  };\r\n\r\n  const handleChannelClick = (channelId: string) => {\r\n    setActiveChannel(channelId);\r\n  };\r\n\r\n  // Effects\r\n  useEffect(() => {\r\n    // update the channel id in URL\r\n    if (channel && feedid && channelId !== channel.id) {\r\n      navigate(liveChannelsURL(feedid, channel.id), { replace: true });\r\n    }\r\n  }, [navigate, feedid, channel, channelId]);\r\n\r\n  // Loading (channel and feedid must be defined)\r\n  if (!channel || !feedid) {\r\n    return <Loading />;\r\n  }\r\n\r\n  // SEO (for channels)\r\n  // const getUrl = (id: string) => liveChannelsURL(feedid, id);\r\n  const canonicalUrl = `${env.APP_PUBLIC_URL}${liveChannelsURL(feedid, channel.id)}`;\r\n  const pageTitle = `${channel.title} - ${siteName}`;\r\n\r\n  const shareButton = channelMediaItem ? (\r\n    <ShareButton title={channelMediaItem.title} description={channelMediaItem.description} url={window.location.href} />\r\n  ) : null;\r\n\r\n  // @todo: bring all props to liveChannelsURL, so that createURL isn't needed\r\n  const startWatchingButton = channelMediaItem ? (\r\n    <>\r\n      <StartWatchingButton\r\n        item={channelMediaItem}\r\n        playUrl={createURL(liveChannelsURL(feedid, channelId, true), {\r\n          start: isVod ? program?.startTime : undefined,\r\n          end: isVod ? program?.endTime : undefined,\r\n        })}\r\n        disabled={!videoDetails.canWatch}\r\n      />\r\n      {videoDetails.canWatchFromBeginning && (\r\n        <Button\r\n          className={styles.catchupButton}\r\n          onClick={() =>\r\n            navigate(\r\n              createURL(liveChannelsURL(feedid || '', channelId, true), {\r\n                start: program?.startTime,\r\n                beginning: 1,\r\n              }),\r\n            )\r\n          }\r\n          label={t('start_from_beginning')}\r\n          startIcon={<Icon icon={Play} />}\r\n        />\r\n      )}\r\n    </>\r\n  ) : null;\r\n\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>{pageTitle}</title>\r\n        <link rel=\"canonical\" href={canonicalUrl} />\r\n        <meta name=\"description\" content={channelMediaItem?.description} />\r\n        <meta property=\"og:description\" content={channelMediaItem?.description} />\r\n        <meta property=\"og:title\" content={pageTitle} />\r\n        <meta property=\"og:type\" content=\"video.other\" />\r\n        {channelMediaItem?.image && <meta property=\"og:image\" content={channelMediaItem.image?.replace(/^https:/, 'http:')} />}\r\n        {channelMediaItem?.image && <meta property=\"og:image:secure_url\" content={channelMediaItem.image?.replace(/^http:/, 'https:')} />}\r\n        <meta property=\"og:image:width\" content={channelMediaItem?.image ? '720' : ''} />\r\n        <meta property=\"og:image:height\" content={channelMediaItem?.image ? '406' : ''} />\r\n        <meta name=\"twitter:title\" content={pageTitle} />\r\n        <meta name=\"twitter:description\" content={channelMediaItem?.description} />\r\n        <meta name=\"twitter:image\" content={channelMediaItem?.image} />\r\n        <meta property=\"og:video\" content={canonicalUrl.replace(/^https:/, 'http:')} />\r\n        <meta property=\"og:video:secure_url\" content={canonicalUrl.replace(/^http:/, 'https:')} />\r\n        <meta property=\"og:video:type\" content=\"text/html\" />\r\n        <meta property=\"og:video:width\" content=\"1280\" />\r\n        <meta property=\"og:video:height\" content=\"720\" />\r\n        {channelMediaItem?.tags?.split(',').map((tag) => (\r\n          <meta property=\"og:video:tag\" content={tag} key={tag} />\r\n        ))}\r\n        {channelMediaItem ? <script type=\"application/ld+json\">{generateMovieJSONLD(channelMediaItem, env.APP_PUBLIC_URL)}</script> : null}\r\n      </Helmet>\r\n      <VideoDetails\r\n        title={videoDetails.title}\r\n        description={videoDetails.description}\r\n        image={videoDetails.image}\r\n        startWatchingButton={startWatchingButton}\r\n        shareButton={shareButton}\r\n        primaryMetadata={primaryMetadata}\r\n      >\r\n        {channelMediaItem && (\r\n          <Cinema\r\n            open={play && isEntitled}\r\n            onClose={goBack}\r\n            item={channelMediaItem}\r\n            title={videoDetails.title}\r\n            primaryMetadata={primaryMetadata}\r\n            feedId={feedid}\r\n            liveStartDateTime={liveStartDateTime}\r\n            liveEndDateTime={liveEndDateTime}\r\n            liveFromBeginning={liveFromBeginning}\r\n          />\r\n        )}\r\n        <div className={styles.epgContainer}>\r\n          <Epg channels={channels} onChannelClick={handleChannelClick} onProgramClick={handleProgramClick} selectedChannel={channel} program={program} />\r\n        </div>\r\n      </VideoDetails>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PlaylistLiveChannels;\r\n","import React from 'react';\r\nimport { useParams } from 'react-router';\r\nimport { useTranslation } from 'react-i18next';\r\nimport type { Playlist } from '@jwp/ott-common/types/playlist';\r\nimport { APP_CONFIG_ITEM_TYPE, PLAYLIST_CONTENT_TYPE } from '@jwp/ott-common/src/constants';\r\nimport { ScreenMap } from '@jwp/ott-common/src/utils/ScreenMap';\r\nimport usePlaylist from '@jwp/ott-hooks-react/src/usePlaylist';\r\nimport type { AppMenuType } from '@jwp/ott-common/types/config';\r\n\r\nimport Loading from '../Loading/Loading';\r\nimport ErrorPage from '../../components/ErrorPage/ErrorPage';\r\nimport type { ScreenComponent } from '../../../types/screens';\r\nimport Fade from '../../components/Animation/Fade/Fade';\r\n\r\nimport PlaylistGrid from './playlistScreens/PlaylistGrid/PlaylistGrid';\r\nimport PlaylistLiveChannels from './playlistScreens/PlaylistLiveChannels/PlaylistLiveChannels';\r\n\r\nexport const playlistScreenMap = new ScreenMap<Playlist, ScreenComponent<Playlist>>();\r\nexport const contentScreenMap = new ScreenMap<Playlist, ScreenComponent<Playlist>>();\r\n\r\n// register playlist screens\r\nplaylistScreenMap.registerDefault(PlaylistGrid);\r\nplaylistScreenMap.registerByContentType(PlaylistLiveChannels, PLAYLIST_CONTENT_TYPE.live);\r\n\r\n// register content list screens\r\ncontentScreenMap.registerDefault(PlaylistGrid);\r\n\r\nconst PlaylistScreenRouter = ({ type }: { type: AppMenuType }) => {\r\n  const params = useParams();\r\n  const id = params.id || '';\r\n\r\n  const { isFetching, error, data } = usePlaylist(id, {}, true, true, type);\r\n  const { t } = useTranslation('error');\r\n\r\n  if (isFetching) {\r\n    return <Loading />;\r\n  }\r\n\r\n  if (error || !data) {\r\n    return <ErrorPage title={t('playlist_not_found')} />;\r\n  }\r\n\r\n  if (data.playlist.length === 0) {\r\n    return <ErrorPage title={t('empty_shelves_heading')} message={t('empty_shelves_description')} />;\r\n  }\r\n\r\n  const Screen = type === APP_CONFIG_ITEM_TYPE.content_list ? contentScreenMap.getScreen(data) : playlistScreenMap.getScreen(data);\r\n\r\n  return (\r\n    <Fade key={id} open>\r\n      <Screen data={data} isLoading={isFetching} />\r\n    </Fade>\r\n  );\r\n};\r\n\r\nexport default PlaylistScreenRouter;\r\n","import { type PropsWithChildren } from 'react';\r\nimport classNames from 'classnames';\r\n\r\nimport createInjectableComponent from '../../modules/createInjectableComponent';\r\n\r\nimport styles from './Header.module.scss';\r\n\r\nexport const HeaderIdentifier = Symbol(`HEADER`);\r\n\r\ntype TypeHeader = 'static' | 'fixed';\r\n\r\nexport type HeaderProps = {\r\n  headerType?: TypeHeader;\r\n  className?: string;\r\n  searchActive: boolean;\r\n};\r\n\r\nconst Header = ({ children, className, headerType = 'static', searchActive }: PropsWithChildren<HeaderProps>) => {\r\n  const headerClassName = classNames(styles.header, styles[headerType], className, {\r\n    [styles.searchActive]: searchActive,\r\n  });\r\n\r\n  return (\r\n    <header className={headerClassName}>\r\n      <div className={styles.container}>{children}</div>\r\n    </header>\r\n  );\r\n};\r\n\r\nexport default createInjectableComponent(HeaderIdentifier, Header);\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\nimport { IS_DEVELOPMENT_BUILD } from '@jwp/ott-common/src/utils/common';\r\n\r\nimport MarkdownComponent from '../MarkdownComponent/MarkdownComponent';\r\n\r\nimport styles from './Footer.module.scss';\r\n\r\ntype Props = {\r\n  text: string;\r\n};\r\n\r\nconst Footer: React.FC<Props> = ({ text }) => {\r\n  const chunks = text.split('|').map((chuck) => chuck.trim());\r\n  const footerContent = chunks.map((value, index) => <MarkdownComponent key={index} markdownString={value} inline tag={chunks.length > 1 ? 'li' : 'div'} />);\r\n  const wrapper = chunks.length > 1 ? <ul className={styles.list}>{footerContent}</ul> : footerContent;\r\n\r\n  return (\r\n    // The extra style below is just to fix the footer on mobile when the dev selector is shown\r\n    <footer className={classNames(styles.footer, { [styles.testFixMargin]: IS_DEVELOPMENT_BUILD })}>{wrapper}</footer>\r\n  );\r\n};\r\n\r\nexport default Footer;\r\n","import * as React from \"react\";\nconst SvgMenu = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M0 0h24v24H0V0z\", fill: \"none\" }), /* @__PURE__ */ React.createElement(\"path\", { d: \"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z\" }));\nexport default SvgMenu;\n","import React from 'react';\r\nimport classNames from 'classnames';\r\nimport { useTranslation } from 'react-i18next';\r\nimport Menu from '@jwp/ott-theme/assets/icons/menu.svg?react';\r\n\r\nimport Icon from '../Icon/Icon';\r\nimport IconButton from '../IconButton/IconButton';\r\n\r\nimport styles from './Header.module.scss';\r\n\r\ntype Props = {\r\n  className?: string;\r\n  sideBarOpen: boolean;\r\n  onClick: () => void;\r\n};\r\n\r\nconst HeaderMenu = ({ className, sideBarOpen, onClick }: Props) => {\r\n  const { t } = useTranslation('menu');\r\n\r\n  return (\r\n    <div className={classNames(styles.menu, className)}>\r\n      <IconButton className={styles.iconButton} aria-label={t('open_menu')} aria-expanded={sideBarOpen} onClick={onClick}>\r\n        <Icon icon={Menu} />\r\n      </IconButton>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HeaderMenu;\r\n","import React, { useRef } from 'react';\r\nimport classNames from 'classnames';\r\n\r\nimport Button from '../Button/Button';\r\n\r\nimport styles from './Header.module.scss';\r\n\r\ntype NavItem = {\r\n  label: string;\r\n  to: string;\r\n};\r\n\r\nconst scrollOffset = 100;\r\n\r\nconst HeaderNavigation = ({ className, navItems }: { className?: string; navItems: NavItem[] }) => {\r\n  const navRef = useRef<HTMLElement>(null);\r\n\r\n  const focusHandler = (event: React.FocusEvent) => {\r\n    if (!navRef.current) return;\r\n\r\n    const navRect = navRef.current.getBoundingClientRect();\r\n    const targetRect = (event.target as HTMLElement).getBoundingClientRect();\r\n\r\n    // get the element offset position within the navigation scroll container\r\n    const targetScrollTo = targetRect.left + navRef.current.scrollLeft - navRect.left;\r\n    // the first half items will reset the scroll offset to 0\r\n    // all elements after will be scrolled into view with an offset, so that the previous item is still visible\r\n    const scrollTo = targetScrollTo < navRect.width / 2 ? 0 : targetScrollTo - scrollOffset;\r\n\r\n    navRef.current.scrollTo({ left: scrollTo, behavior: 'smooth' });\r\n  };\r\n\r\n  return (\r\n    <nav className={classNames(styles.nav, className)} ref={navRef}>\r\n      <ul onFocus={focusHandler}>\r\n        {navItems.map((item, index) => (\r\n          <li key={index}>\r\n            <Button activeClassname={styles.navButton} label={item.label} to={item.to} variant=\"text\" />\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </nav>\r\n  );\r\n};\r\n\r\nexport default HeaderNavigation;\r\n","import React, { useState } from 'react';\r\nimport { Link } from 'react-router-dom';\r\n\r\nimport styles from './Logo.module.scss';\r\n\r\ntype Props = {\r\n  src: string;\r\n  alt?: string;\r\n  onLoad: () => void;\r\n};\r\n\r\ntype ImgRef = {\r\n  height?: number;\r\n  width?: number;\r\n};\r\n\r\nconst Logo: React.FC<Props> = ({ src, alt = 'logo', onLoad }: Props) => {\r\n  const [imgDimensions, updateImgDimensions] = useState<ImgRef>({ height: undefined, width: undefined });\r\n\r\n  const onLoadHandler = (event: React.SyntheticEvent<HTMLImageElement, Event>) => {\r\n    const { height, width } = event.currentTarget;\r\n    updateImgDimensions({ height, width });\r\n    onLoad();\r\n  };\r\n\r\n  return (\r\n    <Link to=\"/\">\r\n      <img className={styles.logo} alt={alt} src={src} height={imgDimensions.height} width={imgDimensions.width} onLoad={onLoadHandler} onError={onLoad} />\r\n    </Link>\r\n  );\r\n};\r\n\r\nexport default Logo;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport classNames from 'classnames';\r\n\r\nimport Logo from '../Logo/Logo';\r\n\r\nimport styles from './Header.module.scss';\r\n\r\ntype Props = {\r\n  className?: string;\r\n  siteName?: string;\r\n  logoSrc?: string | null;\r\n  setLogoLoaded: (loaded: boolean) => void;\r\n};\r\n\r\nconst HeaderBrand = ({ className, siteName, logoSrc, setLogoLoaded }: Props) => {\r\n  const { t } = useTranslation('menu');\r\n\r\n  if (!logoSrc) return null;\r\n\r\n  return (\r\n    <div className={classNames(styles.brand, className)}>\r\n      <Logo alt={t('logo_alt', { siteName })} src={logoSrc} onLoad={() => setLogoLoaded(true)} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HeaderBrand;\r\n","import React, { type PropsWithChildren } from 'react';\r\nimport classNames from 'classnames';\r\n\r\nimport styles from './Header.module.scss';\r\n\r\nconst HeaderActions = ({ children, className }: PropsWithChildren<{ className?: string }>) => {\r\n  return <div className={classNames(styles.actions, className)}>{children}</div>;\r\n};\r\n\r\nexport default HeaderActions;\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport styles from './Header.module.scss';\r\n\r\nconst HeaderSkipLink = ({ className }: { className?: string }) => {\r\n  const { t } = useTranslation('menu');\r\n  return (\r\n    <a href=\"#content\" className={classNames(styles.skipToContent, className)}>\r\n      {t('skip_to_content')}\r\n    </a>\r\n  );\r\n};\r\n\r\nexport default HeaderSkipLink;\r\n","import React, { type ReactNode } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport Close from '@jwp/ott-theme/assets/icons/close.svg?react';\r\n\r\nimport IconButton from '../IconButton/IconButton';\r\nimport Icon from '../Icon/Icon';\r\nimport Modal, { type AnimationProps } from '../Modal/Modal';\r\nimport Slide from '../Animation/Slide/Slide';\r\nimport createInjectableComponent from '../../modules/createInjectableComponent';\r\n\r\nimport styles from './Sidebar.module.scss';\r\n\r\nexport const SidebarIdentifier = Symbol(`SIDEBAR`);\r\n\r\nexport type SidebarProps = {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  children?: ReactNode;\r\n};\r\n\r\nconst SlideLeft = ({ children, ...props }: AnimationProps) => (\r\n  <Slide direction=\"left\" {...props}>\r\n    {children}\r\n  </Slide>\r\n);\r\n\r\nconst Sidebar: React.FC<SidebarProps> = ({ isOpen, onClose, children }) => {\r\n  const { t } = useTranslation('menu');\r\n\r\n  return (\r\n    <Modal open={isOpen} onClose={onClose} AnimationComponent={SlideLeft}>\r\n      <div className={styles.sidebar} id=\"sidebar\">\r\n        <div className={styles.heading}>\r\n          <IconButton onClick={onClose} aria-label={t('close_menu')}>\r\n            <Icon icon={Close} />\r\n          </IconButton>\r\n        </div>\r\n        <nav className={styles.group} onClick={onClose}>\r\n          {children}\r\n        </nav>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default createInjectableComponent(SidebarIdentifier, Sidebar);\r\n","import React from 'react';\r\nimport { NavLink } from 'react-router-dom';\r\nimport classNames from 'classnames';\r\n\r\nimport createInjectableComponent from '../../modules/createInjectableComponent';\r\n\r\nimport styles from './MenuButton.module.scss';\r\n\r\nexport const MenuButtonIdentifier = Symbol(`MENU_BUTTON`);\r\n\r\nexport type MenuButtonProps = {\r\n  label?: string;\r\n  to?: string;\r\n  onClick?: () => void;\r\n  onBlur?: () => void;\r\n  onFocus?: () => void;\r\n  tabIndex?: number;\r\n  active?: boolean;\r\n  startIcon?: React.ReactElement;\r\n  small?: boolean;\r\n} & React.AriaAttributes;\r\n\r\nconst MenuButton: React.FC<MenuButtonProps> = ({\r\n  label,\r\n  to,\r\n  onClick,\r\n  onBlur,\r\n  onFocus,\r\n  tabIndex = 0,\r\n  active = false,\r\n  startIcon,\r\n  small = false,\r\n  ...rest\r\n}: MenuButtonProps) => {\r\n  const icon = startIcon ? <div className={styles.startIcon}>{startIcon}</div> : null;\r\n  const getClassName = (isActive: boolean) => classNames(styles.menuButton, { [styles.small]: small }, { [styles.active]: isActive });\r\n\r\n  if (to) {\r\n    return (\r\n      <NavLink\r\n        onBlur={onBlur}\r\n        onFocus={onFocus}\r\n        onClick={onClick}\r\n        className={({ isActive }) => getClassName(isActive || active)}\r\n        to={to}\r\n        tabIndex={tabIndex}\r\n        end\r\n      >\r\n        {icon}\r\n        <span className={styles.label}>{label}</span>\r\n      </NavLink>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div role=\"button\" onBlur={onBlur} onFocus={onFocus} className={getClassName(active)} onClick={onClick} tabIndex={tabIndex} {...rest}>\r\n      {icon}\r\n      <span className={styles.label}>{label}</span>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default createInjectableComponent(MenuButtonIdentifier, MenuButton);\r\n","import React, { useCallback } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useTranslation } from 'react-i18next';\r\nimport classNames from 'classnames';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport AccountCircle from '@jwp/ott-theme/assets/icons/account_circle.svg?react';\r\nimport Favorite from '@jwp/ott-theme/assets/icons/favorite.svg?react';\r\nimport BalanceWallet from '@jwp/ott-theme/assets/icons/balance_wallet.svg?react';\r\nimport Exit from '@jwp/ott-theme/assets/icons/exit.svg?react';\r\nimport { PATH_USER_ACCOUNT, PATH_USER_FAVORITES, PATH_USER_PAYMENTS } from '@jwp/ott-common/src/paths';\r\n\r\nimport styles from '../UserMenu/UserMenu.module.scss'; // TODO inherit styling\r\nimport MenuButton from '../MenuButton/MenuButton';\r\nimport Icon from '../Icon/Icon';\r\n\r\ntype Props = {\r\n  small?: boolean;\r\n  focusable: boolean;\r\n  showPaymentItems: boolean;\r\n  onButtonClick?: () => void;\r\n  titleId?: string;\r\n  favoritesEnabled?: boolean;\r\n};\r\n\r\nconst UserMenuNav = ({ showPaymentItems, small = false, onButtonClick, favoritesEnabled, focusable, titleId }: Props) => {\r\n  const { t } = useTranslation('user');\r\n  const navigate = useNavigate();\r\n  const accountController = getModule(AccountController);\r\n  const tabIndex = focusable ? 0 : -1;\r\n\r\n  const onLogout = useCallback(async () => {\r\n    if (onButtonClick) {\r\n      onButtonClick();\r\n    }\r\n\r\n    await accountController.logout();\r\n    navigate('/', { replace: true });\r\n  }, [onButtonClick, navigate, accountController]);\r\n\r\n  return (\r\n    <>\r\n      <h2 className={styles.sectionHeader} id={titleId}>\r\n        {t('nav.settings')}\r\n      </h2>\r\n      <ul className={styles.menuItems}>\r\n        <li>\r\n          <MenuButton\r\n            small={small}\r\n            onClick={onButtonClick}\r\n            to={PATH_USER_ACCOUNT}\r\n            label={t('nav.account')}\r\n            startIcon={<Icon icon={AccountCircle} />}\r\n            tabIndex={tabIndex}\r\n          />\r\n        </li>\r\n        {favoritesEnabled && (\r\n          <li>\r\n            <MenuButton\r\n              small={small}\r\n              onClick={onButtonClick}\r\n              to={PATH_USER_FAVORITES}\r\n              label={t('nav.favorites')}\r\n              startIcon={<Icon icon={Favorite} />}\r\n              tabIndex={tabIndex}\r\n            />\r\n          </li>\r\n        )}\r\n        {showPaymentItems && (\r\n          <li>\r\n            <MenuButton\r\n              small={small}\r\n              onClick={onButtonClick}\r\n              to={PATH_USER_PAYMENTS}\r\n              label={t('nav.payments')}\r\n              startIcon={<Icon icon={BalanceWallet} />}\r\n              tabIndex={tabIndex}\r\n            />\r\n          </li>\r\n        )}\r\n        <li className={classNames(styles.divider, { [styles.small]: small })}>\r\n          <MenuButton small={small} onClick={onLogout} label={t('nav.logout')} startIcon={<Icon icon={Exit} />} tabIndex={tabIndex} />\r\n        </li>\r\n      </ul>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default UserMenuNav;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useUIStore } from '@jwp/ott-common/src/stores/UIStore';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport useOpaqueId from '@jwp/ott-hooks-react/src/useOpaqueId';\r\nimport { useLocation, useNavigate } from 'react-router';\r\nimport { ACCESS_MODEL } from '@jwp/ott-common/src/constants';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport { determinePath } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport { useTranslationKey } from '@jwp/ott-hooks-react/src/useTranslationKey';\r\n\r\nimport Button from '../../components/Button/Button';\r\nimport Sidebar from '../../components/Sidebar/Sidebar';\r\nimport MenuButton from '../../components/MenuButton/MenuButton';\r\nimport { modalURLFromLocation } from '../../utils/location';\r\nimport UserMenuNav from '../../components/UserMenuNav/UserMenuNav';\r\n\r\nimport styles from './SidebarContainer.module.scss';\r\n\r\nconst SidebarUserActions = ({\r\n  sideBarOpen,\r\n  canLogin,\r\n  isLoggedIn,\r\n  favoritesEnabled,\r\n  onLoginClick,\r\n  onSignUpClick,\r\n}: {\r\n  sideBarOpen: boolean;\r\n  canLogin: boolean;\r\n  isLoggedIn: boolean;\r\n  favoritesEnabled: boolean;\r\n  onLoginClick: () => void;\r\n  onSignUpClick: () => void;\r\n}) => {\r\n  const { t } = useTranslation('menu');\r\n  const userMenuTitleId = useOpaqueId('usermenu-title');\r\n\r\n  if (!canLogin) return null;\r\n\r\n  return isLoggedIn ? (\r\n    <section aria-labelledby={userMenuTitleId}>\r\n      <UserMenuNav focusable={sideBarOpen} favoritesEnabled={favoritesEnabled} titleId={userMenuTitleId} showPaymentItems />\r\n    </section>\r\n  ) : (\r\n    <div className={styles.buttonContainer}>\r\n      <Button tabIndex={sideBarOpen ? 0 : -1} onClick={onLoginClick} label={t('sign_in')} fullWidth />\r\n      <Button tabIndex={sideBarOpen ? 0 : -1} variant=\"contained\" color=\"primary\" onClick={onSignUpClick} label={t('sign_up')} fullWidth />\r\n    </div>\r\n  );\r\n};\r\n\r\nconst SidebarContainer = () => {\r\n  const { t } = useTranslation('common');\r\n  const translationKey = useTranslationKey('title');\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n\r\n  const sideBarOpen = useUIStore((state) => state.sideBarOpen);\r\n  const {\r\n    config: { menu, features },\r\n    accessModel,\r\n  } = useConfigStore((state) => ({\r\n    config: state.config,\r\n    accessModel: state.accessModel,\r\n  }));\r\n  const isLoggedIn = useAccountStore(({ user }) => !!user);\r\n\r\n  const favoritesEnabled = !!features?.favoritesList;\r\n  const canLogin = accessModel !== ACCESS_MODEL.AVOD;\r\n\r\n  const closeSideBar = () => useUIStore.setState({ sideBarOpen: false });\r\n\r\n  const loginButtonClickHandler = () => {\r\n    navigate(modalURLFromLocation(location, 'login'));\r\n  };\r\n\r\n  const signUpButtonClickHandler = () => {\r\n    navigate(modalURLFromLocation(location, 'create-account'));\r\n  };\r\n\r\n  return (\r\n    <Sidebar isOpen={sideBarOpen} onClose={closeSideBar}>\r\n      <ul>\r\n        <li>\r\n          <MenuButton label={t('home')} to=\"/\" />\r\n        </li>\r\n        {menu.map(({ contentId, type, label, custom }) => (\r\n          <li key={contentId}>\r\n            <MenuButton label={custom?.[translationKey] || label} to={determinePath({ type, contentId })} />\r\n          </li>\r\n        ))}\r\n      </ul>\r\n      <hr className={styles.separator} />\r\n      <SidebarUserActions\r\n        sideBarOpen={sideBarOpen}\r\n        favoritesEnabled={favoritesEnabled}\r\n        canLogin={canLogin}\r\n        isLoggedIn={isLoggedIn}\r\n        onLoginClick={loginButtonClickHandler}\r\n        onSignUpClick={signUpButtonClickHandler}\r\n      />\r\n    </Sidebar>\r\n  );\r\n};\r\n\r\nexport default SidebarContainer;\r\n","import { Helmet } from 'react-helmet';\r\nimport React from 'react';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nconst SiteMetadata = () => {\r\n  const { t } = useTranslation('common');\r\n  const { siteName, description } = useConfigStore(({ config }) => config, shallow);\r\n  const metaDescription = description || t('default_description');\r\n\r\n  return (\r\n    <Helmet>\r\n      <title>{siteName}</title>\r\n      <meta name=\"description\" content={metaDescription} />\r\n      <meta property=\"og:description\" content={metaDescription} />\r\n      <meta property=\"og:title\" content={siteName} />\r\n      <meta name=\"twitter:title\" content={siteName} />\r\n      <meta name=\"twitter:description\" content={metaDescription} />\r\n    </Helmet>\r\n  );\r\n};\r\n\r\nexport default SiteMetadata;\r\n","import * as React from \"react\";\nconst SvgSearch = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\" }));\nexport default SvgSearch;\n","import * as React from \"react\";\nconst SvgCancel = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { d: \"M9 1C4.58 1 1 4.58 1 9s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm4 10.87L11.87 13 9 10.13 6.13 13 5 11.87 7.87 9 5 6.13 6.13 5 9 7.87 11.87 5 13 6.13 10.13 9 13 11.87z\" }));\nexport default SvgCancel;\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport Search from '@jwp/ott-theme/assets/icons/search.svg?react';\r\nimport Cancel from '@jwp/ott-theme/assets/icons/cancel.svg?react';\r\n\r\nimport IconButton from '../IconButton/IconButton';\r\nimport Icon from '../Icon/Icon';\r\n\r\nimport styles from './SearchBar.module.scss';\r\n\r\nexport type Props = {\r\n  query?: string;\r\n  onQueryChange?: (event: React.ChangeEvent<HTMLInputElement>) => void;\r\n  onClearButtonClick?: () => void;\r\n  onClose?: () => void;\r\n  inputRef?: React.MutableRefObject<HTMLInputElement>;\r\n};\r\n\r\nconst SearchBar: React.FC<Props> = ({ query, onQueryChange, onClearButtonClick, onClose, inputRef }: Props) => {\r\n  const { t } = useTranslation('search');\r\n  const handleSubmit = (event: React.ChangeEvent<HTMLFormElement>) => {\r\n    event.preventDefault();\r\n    inputRef?.current.focus(); // Force hide mobile keyboard\r\n    (document.querySelector('#content') as HTMLElement)?.focus();\r\n  };\r\n\r\n  return (\r\n    <div className={styles.searchBar}>\r\n      <Icon icon={Search} className={styles.icon} />\r\n      <form className={styles.searchForm} role=\"search\" onSubmit={handleSubmit}>\r\n        <label htmlFor=\"searchbar-input\" className=\"hidden\">\r\n          {t('search_bar.search_label')}\r\n        </label>\r\n        <input\r\n          className={styles.input}\r\n          id=\"searchbar-input\"\r\n          type=\"search\"\r\n          value={query}\r\n          onChange={onQueryChange}\r\n          onKeyDown={(event) => event.key === 'Escape' && onClose?.()}\r\n          placeholder={t('search_bar.search_placeholder')}\r\n          ref={inputRef}\r\n        />\r\n        {query ? (\r\n          <IconButton className={styles.clearButton} aria-label={t('search_bar.clear_search_label')} onClick={onClearButtonClick}>\r\n            <Icon icon={Cancel} />\r\n          </IconButton>\r\n        ) : null}\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\nexport default SearchBar;\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\n\r\nimport IconButton, { type Props as IconButtonProps } from '../IconButton/IconButton';\r\n\r\nimport styles from './Header.module.scss';\r\n\r\nconst HeaderActionButton = ({ children, className, ...rest }: IconButtonProps) => {\r\n  return (\r\n    <IconButton className={classNames(styles.iconButton, className)} {...rest}>\r\n      {children}\r\n    </IconButton>\r\n  );\r\n};\r\n\r\nexport default HeaderActionButton;\r\n","import React, { useEffect, useRef } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useLocation } from 'react-router';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport { isTruthyCustomParamValue } from '@jwp/ott-common/src/utils/common';\r\nimport { useUIStore } from '@jwp/ott-common/src/stores/UIStore';\r\nimport SearchIcon from '@jwp/ott-theme/assets/icons/search.svg?react';\r\nimport CloseIcon from '@jwp/ott-theme/assets/icons/close.svg?react';\r\n\r\nimport Icon from '../../components/Icon/Icon';\r\nimport SearchBar from '../../components/SearchBar/SearchBar';\r\nimport useSearchQueryUpdater from '../../hooks/useSearchQueryUpdater';\r\nimport HeaderActionButton from '../../components/Header/HeaderActionButton';\r\n\r\nimport styles from './HeaderSearch.module.scss';\r\n\r\nconst HeaderSearch = () => {\r\n  const { t } = useTranslation('menu');\r\n  const location = useLocation();\r\n  const searchInputRef = useRef<HTMLInputElement>(null) as React.MutableRefObject<HTMLInputElement>;\r\n\r\n  const config = useConfigStore(({ config }) => config);\r\n  const { features, custom } = config;\r\n\r\n  const { searchPlaylist } = features || {};\r\n  const hasAppContentSearch = isTruthyCustomParamValue(custom?.appContentSearch);\r\n  const searchEnabled = !!searchPlaylist || hasAppContentSearch;\r\n\r\n  const { searchQuery, searchActive } = useUIStore(\r\n    ({ searchQuery, searchActive, userMenuOpen, languageMenuOpen }) => ({\r\n      languageMenuOpen,\r\n      searchQuery,\r\n      searchActive,\r\n      userMenuOpen,\r\n    }),\r\n    shallow,\r\n  );\r\n  const { updateSearchQuery, resetSearchQuery } = useSearchQueryUpdater();\r\n\r\n  const closeSearchButtonClickHandler = () => {\r\n    resetSearchQuery();\r\n\r\n    useUIStore.setState({\r\n      searchActive: false,\r\n    });\r\n  };\r\n\r\n  const searchButtonClickHandler = () => {\r\n    useUIStore.setState({\r\n      searchActive: true,\r\n      preSearchPage: `${location.pathname}${location.search || ''}`,\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (searchActive && searchInputRef.current) {\r\n      searchInputRef.current.focus();\r\n    }\r\n  }, [searchActive]);\r\n\r\n  if (!searchEnabled) return null;\r\n\r\n  return searchActive ? (\r\n    <div className={styles.searchContainer}>\r\n      <SearchBar\r\n        query={searchQuery}\r\n        onQueryChange={(event) => updateSearchQuery(event.target.value)}\r\n        onClearButtonClick={() => updateSearchQuery('')}\r\n        inputRef={searchInputRef}\r\n        onClose={closeSearchButtonClickHandler}\r\n      />\r\n      <HeaderActionButton aria-label={t('search_close')} onClick={closeSearchButtonClickHandler}>\r\n        <Icon icon={CloseIcon} />\r\n      </HeaderActionButton>\r\n    </div>\r\n  ) : (\r\n    <HeaderActionButton aria-label={t('search_open')} onClick={searchButtonClickHandler}>\r\n      <Icon icon={SearchIcon} />\r\n    </HeaderActionButton>\r\n  );\r\n};\r\n\r\nexport default HeaderSearch;\r\n","import * as React from \"react\";\nconst SvgLanguage = (props) => /* @__PURE__ */ React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 24 24\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { fill: \"currentColor\", d: \"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z\" }));\nexport default SvgLanguage;\n","import React from 'react';\r\n\r\nimport styles from './Panel.module.scss';\r\n\r\ntype Props = {\r\n  id?: string;\r\n  children?: React.ReactNode;\r\n};\r\n\r\nconst Panel: React.FC<Props> = ({ children, ...rest }) => {\r\n  return (\r\n    <div className={styles.panel} {...rest}>\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Panel;\r\n","import React, { useEffect, useRef } from 'react';\r\n\r\ntype Prop = {\r\n  callback: () => void;\r\n  children: React.ReactElement;\r\n};\r\n\r\nconst DetectOutsideClick = ({ callback, children }: Prop) => {\r\n  const elementRef = useRef<HTMLDivElement>();\r\n\r\n  useEffect(() => {\r\n    const handleClick = (event: MouseEvent) => {\r\n      if (!elementRef.current || !(event.target instanceof Node)) {\r\n        return;\r\n      }\r\n\r\n      if (elementRef.current !== event.target && !elementRef.current?.contains(event.target)) {\r\n        callback();\r\n      }\r\n    };\r\n\r\n    setTimeout(() => document.addEventListener('click', handleClick), 1);\r\n\r\n    return () => document.removeEventListener('click', handleClick);\r\n  }, [callback]);\r\n\r\n  return React.cloneElement(children, {\r\n    ref: (node: HTMLDivElement) => {\r\n      elementRef.current = node;\r\n    },\r\n  });\r\n};\r\n\r\nexport default DetectOutsideClick;\r\n","import React, { type ReactNode } from 'react';\r\nimport classNames from 'classnames';\r\n\r\nimport DetectOutsideClick from '../DetectOutsideClick/DetectOutsideClick';\r\nimport Slide from '../Animation/Slide/Slide';\r\n\r\nimport styles from './Popover.module.scss';\r\n\r\ntype Props = {\r\n  children: ReactNode;\r\n  className?: string;\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n};\r\n\r\nconst Popover: React.FC<Props> = ({ children, className, isOpen, onClose }: Props) => {\r\n  return (\r\n    <Slide open={isOpen} duration={250} direction=\"right\" style={{ position: 'relative' }}>\r\n      <DetectOutsideClick callback={onClose}>\r\n        <div className={classNames(styles.popover, className)}>{children}</div>\r\n      </DetectOutsideClick>\r\n    </Slide>\r\n  );\r\n};\r\n\r\nexport default Popover;\r\n","import type { LanguageDefinition } from '@jwp/ott-common/types/i18n';\r\nimport classNames from 'classnames';\r\nimport { type MouseEvent } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { testId } from '@jwp/ott-common/src/utils/common';\r\nimport Language from '@jwp/ott-theme/assets/icons/language.svg?react';\r\n\r\nimport Link from '../Link/Link';\r\nimport Panel from '../Panel/Panel';\r\nimport Popover from '../Popover/Popover';\r\nimport Icon from '../Icon/Icon';\r\nimport HeaderActionButton from '../Header/HeaderActionButton';\r\n\r\nimport styles from './LanguageMenu.module.scss';\r\n\r\ntype Props = {\r\n  onClick: (code: string) => void | null;\r\n  className?: string;\r\n  languages: LanguageDefinition[];\r\n  currentLanguage: LanguageDefinition | undefined;\r\n  languageMenuOpen: boolean;\r\n  openLanguageMenu: () => void;\r\n  closeLanguageMenu: () => void;\r\n};\r\n\r\nconst LanguageMenu = ({ onClick, className, languages, currentLanguage, languageMenuOpen, closeLanguageMenu, openLanguageMenu }: Props) => {\r\n  const { t } = useTranslation('menu');\r\n\r\n  const handleLanguageSelect = (event: MouseEvent<HTMLElement>, code: string) => {\r\n    event.preventDefault();\r\n    onClick && onClick(code);\r\n\r\n    closeLanguageMenu();\r\n  };\r\n\r\n  const handleMenuToggle = () => {\r\n    if (languageMenuOpen) {\r\n      closeLanguageMenu();\r\n    } else {\r\n      openLanguageMenu();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <HeaderActionButton\r\n        data-testid={testId('language-menu-button')}\r\n        aria-controls=\"language-panel\"\r\n        aria-expanded={languageMenuOpen}\r\n        aria-haspopup=\"menu\"\r\n        className={className}\r\n        aria-label={t('language_menu')}\r\n        onClick={handleMenuToggle}\r\n        onBlur={closeLanguageMenu}\r\n      >\r\n        <Icon icon={Language} />\r\n      </HeaderActionButton>\r\n      <Popover isOpen={languageMenuOpen} onClose={closeLanguageMenu}>\r\n        <Panel id=\"language-panel\">\r\n          <ul className={styles.menuItems}>\r\n            {languages.map(({ code, displayName }) => {\r\n              const isActive = currentLanguage?.code === code;\r\n              const menuItemClassname = classNames(styles.menuItem, { [styles.menuItemActive]: isActive });\r\n              return (\r\n                <li key={code} className={menuItemClassname} onClick={(event) => handleLanguageSelect(event, code)}>\r\n                  <Link onFocus={openLanguageMenu} onBlur={closeLanguageMenu} href=\"#\" aria-current={isActive}>\r\n                    {displayName}\r\n                  </Link>\r\n                </li>\r\n              );\r\n            })}\r\n          </ul>\r\n        </Panel>\r\n      </Popover>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LanguageMenu;\r\n","import React, { useCallback, useMemo } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { useUIStore } from '@jwp/ott-common/src/stores/UIStore';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport FavoritesController from '@jwp/ott-common/src/controllers/FavoritesController';\r\nimport WatchHistoryController from '@jwp/ott-common/src/controllers/WatchHistoryController';\r\n\r\nimport LanguageMenu from '../../components/LanguageMenu/LanguageMenu';\r\n\r\nconst HeaderLanguageSwitcher = () => {\r\n  const { i18n } = useTranslation('menu');\r\n  const supportedLanguages = useConfigStore((state) => state.supportedLanguages);\r\n  const languageMenuOpen = useUIStore((state) => state.languageMenuOpen);\r\n\r\n  const favoritesController = getModule(FavoritesController);\r\n  const watchlistController = getModule(WatchHistoryController);\r\n\r\n  const openLanguageMenu = useCallback(() => useUIStore.setState({ languageMenuOpen: true }), []);\r\n  const closeLanguageMenu = useCallback(() => useUIStore.setState({ languageMenuOpen: false }), []);\r\n\r\n  const languageClickHandler = (code: string) => {\r\n    i18n.changeLanguage(code);\r\n    favoritesController.restoreFavorites(code);\r\n    watchlistController.restoreWatchHistory(code);\r\n  };\r\n\r\n  const currentLanguage = useMemo(() => supportedLanguages.find(({ code }) => code === i18n.language), [i18n.language, supportedLanguages]);\r\n\r\n  if (supportedLanguages.length < 2) return null;\r\n\r\n  return (\r\n    <LanguageMenu\r\n      openLanguageMenu={openLanguageMenu}\r\n      closeLanguageMenu={closeLanguageMenu}\r\n      languageMenuOpen={languageMenuOpen}\r\n      onClick={languageClickHandler}\r\n      languages={supportedLanguages}\r\n      currentLanguage={currentLanguage}\r\n    />\r\n  );\r\n};\r\n\r\nexport default HeaderLanguageSwitcher;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport AccountCircle from '@jwp/ott-theme/assets/icons/account_circle.svg?react';\r\n\r\nimport Icon from '../Icon/Icon';\r\nimport Popover from '../Popover/Popover';\r\nimport Panel from '../Panel/Panel';\r\nimport Button from '../Button/Button';\r\nimport UserMenuNav from '../UserMenuNav/UserMenuNav';\r\nimport HeaderActionButton from '../Header/HeaderActionButton';\r\n\r\nimport styles from './UserMenu.module.scss';\r\n\r\ntype Props = {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  onOpen: () => void;\r\n  onLoginButtonClick: () => void;\r\n  onSignUpButtonClick: () => void;\r\n  isLoggedIn: boolean;\r\n  favoritesEnabled: boolean;\r\n};\r\n\r\nconst UserMenu = ({ isLoggedIn, favoritesEnabled, open, onClose, onOpen, onLoginButtonClick, onSignUpButtonClick }: Props) => {\r\n  const { t } = useTranslation('menu');\r\n\r\n  if (!isLoggedIn) {\r\n    return (\r\n      <>\r\n        <Button onClick={onLoginButtonClick} label={t('sign_in')} aria-haspopup=\"dialog\" />\r\n        <Button variant=\"contained\" color=\"primary\" onClick={onSignUpButtonClick} label={t('sign_up')} aria-haspopup=\"dialog\" />\r\n      </>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <HeaderActionButton\r\n        aria-label={t('open_user_menu')}\r\n        aria-controls=\"menu_panel\"\r\n        aria-expanded={open}\r\n        aria-haspopup=\"menu\"\r\n        onClick={onOpen}\r\n        onBlur={onClose}\r\n      >\r\n        <Icon icon={AccountCircle} />\r\n      </HeaderActionButton>\r\n      <Popover className={styles.popover} isOpen={open} onClose={onClose}>\r\n        <Panel id=\"menu_panel\">\r\n          <div onFocus={onOpen} onBlur={onClose}>\r\n            <UserMenuNav focusable={open} onButtonClick={onClose} showPaymentItems={true} favoritesEnabled={favoritesEnabled} small />\r\n          </div>\r\n        </Panel>\r\n      </Popover>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserMenu;\r\n","import React, { useCallback } from 'react';\r\nimport { useUIStore } from '@jwp/ott-common/src/stores/UIStore';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport { ACCESS_MODEL } from '@jwp/ott-common/src/constants';\r\nimport { useLocation, useNavigate } from 'react-router';\r\n\r\nimport UserMenu from '../../components/UserMenu/UserMenu';\r\nimport useBreakpoint, { Breakpoint } from '../../hooks/useBreakpoint';\r\nimport { modalURLFromLocation } from '../../utils/location';\r\n\r\nconst HeaderUserMenu = () => {\r\n  const breakpoint = useBreakpoint();\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n\r\n  const userMenuOpen = useUIStore((state) => state.userMenuOpen);\r\n  const {\r\n    config: { features },\r\n    accessModel,\r\n  } = useConfigStore((state) => ({\r\n    config: state.config,\r\n    accessModel: state.accessModel,\r\n  }));\r\n  const isLoggedIn = useAccountStore(({ user }) => !!user);\r\n\r\n  const favoritesEnabled = !!features?.favoritesList;\r\n  const canLogin = accessModel !== ACCESS_MODEL.AVOD;\r\n\r\n  const openUserPanel = useCallback(() => useUIStore.setState({ userMenuOpen: true }), []);\r\n  const closeUserPanel = useCallback(() => useUIStore.setState({ userMenuOpen: false }), []);\r\n\r\n  const loginButtonClickHandler = () => navigate(modalURLFromLocation(location, 'login'));\r\n  const signUpButtonClickHandler = () => navigate(modalURLFromLocation(location, 'create-account'));\r\n\r\n  if (!canLogin || breakpoint <= Breakpoint.sm) return null;\r\n\r\n  return (\r\n    <UserMenu\r\n      open={userMenuOpen}\r\n      onOpen={openUserPanel}\r\n      onClose={closeUserPanel}\r\n      isLoggedIn={isLoggedIn}\r\n      favoritesEnabled={favoritesEnabled}\r\n      onLoginButtonClick={loginButtonClickHandler}\r\n      onSignUpButtonClick={signUpButtonClickHandler}\r\n    />\r\n  );\r\n};\r\n\r\nexport default HeaderUserMenu;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Outlet } from 'react-router';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\nimport { useConfigStore } from '@jwp/ott-common/src/stores/ConfigStore';\r\nimport { unicodeToChar } from '@jwp/ott-common/src/utils/common';\r\nimport { determinePath } from '@jwp/ott-common/src/utils/urlFormatting';\r\nimport env from '@jwp/ott-common/src/env';\r\nimport { useUIStore } from '@jwp/ott-common/src/stores/UIStore';\r\nimport { useTranslationKey } from '@jwp/ott-hooks-react/src/useTranslationKey';\r\n\r\nimport Header from '../../components/Header/Header';\r\nimport Footer from '../../components/Footer/Footer';\r\nimport HeaderMenu from '../../components/Header/HeaderMenu';\r\nimport HeaderNavigation from '../../components/Header/HeaderNavigation';\r\nimport HeaderBrand from '../../components/Header/HeaderBrand';\r\nimport HeaderActions from '../../components/Header/HeaderActions';\r\nimport HeaderSkipLink from '../../components/Header/HeaderSkipLink';\r\nimport SidebarContainer from '../SidebarContainer/SidebarContainer';\r\nimport SiteMetadata from '../SiteMetadata/SiteMetadata';\r\nimport HeaderSearch from '../HeaderSearch/HeaderSearch';\r\nimport HeaderLanguageSwitcher from '../HeaderLanguageSwitcher/HeaderLanguageSwitcher';\r\nimport HeaderUserMenu from '../HeaderUserMenu/HeaderUserMenu';\r\n\r\nimport styles from './Layout.module.scss';\r\n\r\nconst Layout = () => {\r\n  const { t } = useTranslation('common');\r\n  const translationKey = useTranslationKey('label');\r\n\r\n  const { config } = useConfigStore(\r\n    ({ config, accessModel, supportedLanguages }) => ({\r\n      config,\r\n      accessModel,\r\n      supportedLanguages,\r\n    }),\r\n    shallow,\r\n  );\r\n  const { menu, assets, siteName, styling } = config;\r\n  const { footerText: configFooterText } = styling || {};\r\n  const footerText = configFooterText || unicodeToChar(env.APP_FOOTER_TEXT);\r\n\r\n  const { sideBarOpen, searchActive } = useUIStore((state) => ({\r\n    sideBarOpen: state.sideBarOpen,\r\n    searchActive: state.searchActive,\r\n  }));\r\n  const banner = assets.banner;\r\n\r\n  const openSideBar = () => useUIStore.setState({ sideBarOpen: true });\r\n\r\n  const navItems = [\r\n    { label: t('home'), to: '/' },\r\n    ...menu.map(({ label, contentId, type, custom }) => ({\r\n      label: custom?.[translationKey] || label,\r\n      to: determinePath({ type, contentId, label }),\r\n    })),\r\n  ];\r\n\r\n  const containerProps = { inert: sideBarOpen ? '' : undefined }; // inert is not yet officially supported in react\r\n\r\n  return (\r\n    <div className={styles.layout}>\r\n      <SiteMetadata />\r\n      <div {...containerProps}>\r\n        <Header searchActive={searchActive}>\r\n          <HeaderSkipLink />\r\n          <HeaderMenu sideBarOpen={sideBarOpen} onClick={openSideBar} />\r\n          <HeaderBrand siteName={siteName} logoSrc={banner} setLogoLoaded={() => undefined} />\r\n          <HeaderNavigation navItems={navItems} />\r\n          <HeaderActions>\r\n            <HeaderSearch />\r\n            <HeaderLanguageSwitcher />\r\n            <HeaderUserMenu />\r\n          </HeaderActions>\r\n        </Header>\r\n        <main id=\"content\" className={styles.main} tabIndex={-1}>\r\n          <Outlet />\r\n        </main>\r\n        {!!footerText && <Footer text={footerText} />}\r\n      </div>\r\n      <SidebarContainer />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Layout;\r\n","import { useEffect } from 'react';\r\nimport { useLocation, useNavigate } from 'react-router';\r\nimport { getModule } from '@jwp/ott-common/src/modules/container';\r\nimport AccountController from '@jwp/ott-common/src/controllers/AccountController';\r\nimport { queryClient } from '@jwp/ott-ui-react/src/containers/QueryProvider/QueryProvider';\r\nimport { modalURLFromLocation } from '@jwp/ott-ui-react/src/utils/location';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport useEventCallback from '@jwp/ott-hooks-react/src/useEventCallback';\r\nimport type { AccountModals } from '@jwp/ott-ui-react/src/containers/AccountModal/AccountModal';\r\n\r\nenum NotificationsTypes {\r\n  ACCESS_REVOKED = 'access.revoked',\r\n  CARD_REQUIRES_ACTION = 'payment.card.requires.action',\r\n  CARD_FAILED = 'payment.card.failed',\r\n  CARD_SUCCESS = 'payment.card.success',\r\n  SUBSCRIBE_REQUIRES_ACTION = 'subscribe.requires.action',\r\n  FAILED = '.failed',\r\n  SUBSCRIBE_FAILED = 'subscribe.failed',\r\n  SUBSCRIBE_SUCCESS = 'subscribe.success',\r\n  ACCOUNT_LOGOUT = 'account.logout',\r\n}\r\n\r\nexport default function useNotifications() {\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const uuid = useAccountStore((s) => (typeof s.user?.uuid === 'string' ? s.user.uuid : undefined));\r\n\r\n  const accountController = getModule(AccountController);\r\n  const { hasNotifications } = accountController?.getFeatures() || {};\r\n\r\n  // use an eventCallback to prevent the `location` property being stale when used directly in the useEffect below\r\n  const navigateToModal = useEventCallback((path: keyof AccountModals | null, queryParams?: Record<string, string>) => {\r\n    navigate(modalURLFromLocation(location, path, queryParams));\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (!uuid || !hasNotifications) return;\r\n\r\n    accountController?.subscribeToNotifications({\r\n      uuid,\r\n      onMessage: async (message) => {\r\n        if (message) {\r\n          const notification = JSON.parse(message);\r\n\r\n          switch (notification.type) {\r\n            case NotificationsTypes.FAILED:\r\n            case NotificationsTypes.CARD_FAILED:\r\n            case NotificationsTypes.SUBSCRIBE_FAILED:\r\n              navigateToModal('payment-error', notification.resource?.message);\r\n              break;\r\n            case NotificationsTypes.CARD_SUCCESS:\r\n              await queryClient.invalidateQueries(['entitlements']);\r\n              navigateToModal(null); // close modal\r\n              break;\r\n            case NotificationsTypes.SUBSCRIBE_SUCCESS:\r\n              await accountController.reloadSubscriptions();\r\n              break;\r\n            case NotificationsTypes.ACCESS_REVOKED:\r\n              await accountController.reloadSubscriptions();\r\n              break;\r\n            case NotificationsTypes.CARD_REQUIRES_ACTION:\r\n            case NotificationsTypes.SUBSCRIBE_REQUIRES_ACTION:\r\n              window.location.href = notification.resource?.redirect_to_url;\r\n              break;\r\n            default:\r\n              break;\r\n          }\r\n        }\r\n      },\r\n    });\r\n  }, [accountController, hasNotifications, navigateToModal, uuid]);\r\n}\r\n","import React, { useEffect } from 'react';\r\nimport { Navigate, useLocation } from 'react-router-dom';\r\nimport { Outlet } from 'react-router';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useAccountStore } from '@jwp/ott-common/src/stores/AccountStore';\r\nimport { shallow } from '@jwp/ott-common/src/utils/compare';\r\n\r\nimport useNotifications from '#src/hooks/useNotifications';\r\n\r\nconst RoutesContainer = () => {\r\n  const { i18n } = useTranslation();\r\n  const location = useLocation();\r\n\r\n  const userData = useAccountStore((s) => ({ loading: s.loading, user: s.user }), shallow);\r\n\r\n  // listen to websocket notifications\r\n  useNotifications();\r\n\r\n  // set/update lang html lang attribute\r\n  useEffect(() => {\r\n    document.documentElement.setAttribute('lang', i18n.language);\r\n  }, [i18n.language]);\r\n\r\n  // used for social logins\r\n  // @todo should users be redirected away from a page after login?\r\n  if (userData.user && !userData.loading && window.location.href.includes('#token')) {\r\n    return <Navigate to={{ ...location, hash: '' }} replace />; // component instead of hook to prevent extra re-renders\r\n  }\r\n\r\n  return <Outlet />;\r\n};\r\n\r\nexport default RoutesContainer;\r\n","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Route, Routes } from 'react-router-dom';\r\nimport ErrorPage from '@jwp/ott-ui-react/src/components/ErrorPage/ErrorPage';\r\nimport RootErrorPage from '@jwp/ott-ui-react/src/components/RootErrorPage/RootErrorPage';\r\nimport About from '@jwp/ott-ui-react/src/pages/About/About';\r\nimport Home from '@jwp/ott-ui-react/src/pages/Home/Home';\r\nimport Search from '@jwp/ott-ui-react/src/pages/Search/Search';\r\nimport User from '@jwp/ott-ui-react/src/pages/User/User';\r\nimport LegacySeries from '@jwp/ott-ui-react/src/pages/LegacySeries/LegacySeries';\r\nimport MediaScreenRouter from '@jwp/ott-ui-react/src/pages/ScreenRouting/MediaScreenRouter';\r\nimport PlaylistScreenRouter from '@jwp/ott-ui-react/src/pages/ScreenRouting/PlaylistScreenRouter';\r\nimport Layout from '@jwp/ott-ui-react/src/containers/Layout/Layout';\r\nimport { PATH_ABOUT, PATH_CONTENT_LIST, PATH_LEGACY_SERIES, PATH_MEDIA, PATH_PLAYLIST, PATH_SEARCH, PATH_USER } from '@jwp/ott-common/src/paths';\r\nimport { APP_CONFIG_ITEM_TYPE } from '@jwp/ott-common/src/constants';\r\n\r\nimport RoutesContainer from '#src/containers/RoutesContainer/RoutesContainer';\r\n\r\nexport default function AppRoutes() {\r\n  const { t } = useTranslation('error');\r\n\r\n  return (\r\n    <Routes>\r\n      <Route element={<RoutesContainer />}>\r\n        <Route element={<Layout />} errorElement={<RootErrorPage />}>\r\n          <Route index element={<Home />} />\r\n          <Route path={PATH_PLAYLIST} element={<PlaylistScreenRouter type={APP_CONFIG_ITEM_TYPE.playlist} />} />\r\n          <Route path={PATH_CONTENT_LIST} element={<PlaylistScreenRouter type={APP_CONFIG_ITEM_TYPE.content_list} />} />\r\n          <Route path={PATH_MEDIA} element={<MediaScreenRouter />} />\r\n          <Route path={PATH_LEGACY_SERIES} element={<LegacySeries />} />\r\n          <Route path={PATH_SEARCH} element={<Search />} />\r\n          <Route path={PATH_USER} element={<User />} />\r\n          <Route path={PATH_ABOUT} element={<About />} />\r\n          <Route\r\n            path=\"/*\"\r\n            element={<ErrorPage title={t('notfound_error_heading', 'Not found')} message={t('notfound_error_description', \"This page doesn't exist.\")} />}\r\n          />\r\n        </Route>\r\n      </Route>\r\n    </Routes>\r\n  );\r\n}\r\n","import React, { useEffect, useMemo } from 'react';\r\nimport type { Content } from '@jwp/ott-common/types/config';\r\nimport type { PlaylistItem } from '@jwp/ott-common/types/playlist';\r\n\r\nimport type { ScreenComponent } from '../../../../../types/screens';\r\nimport ShelfList from '../../../../containers/ShelfList/ShelfList';\r\nimport Hero from '../../../../components/Hero/Hero';\r\nimport HeroTitle from '../../../../components/Hero/HeroTitle';\r\nimport HeroDescription from '../../../../components/Hero/HeroDescription';\r\n\r\nconst parsePlaylistIds = (input: unknown): Content[] => {\r\n  const playlistIds = typeof input === 'string' ? input.replace(/\\s+/g, '').split(',') : [];\r\n\r\n  return playlistIds.map((id) => ({ type: 'playlist', contentId: id }));\r\n};\r\n\r\nconst MediaHub: ScreenComponent<PlaylistItem> = ({ data }) => {\r\n  // Hub may specify multiple playlists as a CSV list of IDs or a single playlist\r\n  const rows = useMemo(() => parsePlaylistIds(data.playlists || data.playlist), [data.playlist, data.playlists]);\r\n\r\n  // Effects\r\n  useEffect(() => {\r\n    (document.scrollingElement || document.body).scroll({ top: 0 });\r\n    (document.querySelector('#video-details button') as HTMLElement)?.focus();\r\n  }, [data]);\r\n\r\n  return (\r\n    <header>\r\n      <Hero image={data.backgroundImage}>\r\n        <HeroTitle title={data.title} />\r\n        <HeroDescription description={data.description} />\r\n      </Hero>\r\n      <ShelfList rows={rows}></ShelfList>\r\n    </header>\r\n  );\r\n};\r\n\r\nexport default MediaHub;\r\n","import { MEDIA_CONTENT_TYPE } from '@jwp/ott-common/src/constants';\r\nimport { mediaScreenMap } from '@jwp/ott-ui-react/src/pages/ScreenRouting/MediaScreenRouter';\r\nimport MediaHub from '@jwp/ott-ui-react/src/pages/ScreenRouting/mediaScreens/MediaHub/MediaHub';\r\n\r\n/**\r\n * This file is used to add media and/or playlist screens.\r\n *\r\n * The most basic example is given below where a media screen is registered for the `hub` contentType. This means that\r\n * when navigating to the `/m/:id` page and the requested media item has `contentType: hub`, it will render the\r\n * `MediaHub` screen.\r\n *\r\n * In the application, screens are registered for the following contentTypes: Episode, Series and LiveChannel. When no\r\n * match is found, the default screen is used.\r\n *\r\n * To override the default media screen you can use:\r\n *\r\n * @example\r\n * mediaScreenMap.registerDefault(CustomMediaScreen);\r\n *\r\n * If you want to override the series contentType you can use:\r\n *\r\n * @example\r\n * mediaScreenMap.registerByContentType(CustomSeriesScreen, 'series');\r\n *\r\n * Or you want to use different parameters to select a screen, you can use the `register` method with a predicate\r\n * function. This predicate function must return `true` when it should be used.\r\n *\r\n * @example\r\n * mediaScreenMap.register(CustomMediaScreen, (item?: PlaylistItem) => item?.customParam === 'yes');\r\n *\r\n * If you want to override all screens and only use a single screen for all media items, you can register a screen\r\n * with a predicate that always returns `true`\r\n *\r\n * @example\r\n * mediaScreenMap.register(CustomMediaScreen, () => true);\r\n *\r\n * The same methods can be used for the `playlistScreenMap` that is exported from\r\n * {@link /src/pages/ScreenRouting/PlaylistScreenRouter.tsx}\r\n */\r\n\r\nexport default function registerCustomScreens() {\r\n  // Hub is an example screen for the media router\r\n  mediaScreenMap.registerByContentType(MediaHub, MEDIA_CONTENT_TYPE.hub);\r\n}\r\n","import { useLayoutEffect } from 'react';\r\nimport { useSearchParams } from 'react-router-dom';\r\nimport type { Settings } from '@jwp/ott-common/types/settings';\r\nimport { CONFIG_QUERY_KEY } from '@jwp/ott-common/src/constants';\r\n\r\nexport function useTrackConfigKeyChange(settings: Settings | undefined, configSource: string | undefined) {\r\n  const [searchParams, setSearchParams] = useSearchParams();\r\n\r\n  // Update the query string to maintain the right params\r\n  useLayoutEffect(() => {\r\n    if (!settings) {\r\n      return;\r\n    }\r\n\r\n    // If there is no valid config source or the config source equals the default, remove the ?app-config= param\r\n    if (searchParams.has(CONFIG_QUERY_KEY) && (!configSource || configSource === settings?.defaultConfigSource)) {\r\n      setSearchParams(\r\n        (s) => {\r\n          s.delete(CONFIG_QUERY_KEY);\r\n\r\n          return s;\r\n        },\r\n        { replace: true },\r\n      );\r\n    }\r\n\r\n    // If the config source is not the default and the query string isn't set right, set the ?app-config= param\r\n    if (configSource && configSource !== settings?.defaultConfigSource && searchParams.get(CONFIG_QUERY_KEY) !== configSource) {\r\n      setSearchParams(\r\n        (s) => {\r\n          s.set(CONFIG_QUERY_KEY, configSource);\r\n          return s;\r\n        },\r\n        { replace: true },\r\n      );\r\n    }\r\n  }, [configSource, searchParams, setSearchParams, settings]);\r\n\r\n  return configSource;\r\n}\r\n","import React, { useEffect, useState, type FC, useCallback } from 'react';\r\nimport { IS_DEMO_MODE, IS_DEVELOPMENT_BUILD, IS_PREVIEW_MODE, IS_PROD_MODE } from '@jwp/ott-common/src/utils/common';\r\nimport ErrorPage from '@jwp/ott-ui-react/src/components/ErrorPage/ErrorPage';\r\nimport AccountModal from '@jwp/ott-ui-react/src/containers/AccountModal/AccountModal';\r\nimport DevConfigSelector from '@jwp/ott-ui-react/src/components/DevConfigSelector/DevConfigSelector';\r\nimport LoadingOverlay from '@jwp/ott-ui-react/src/components/LoadingOverlay/LoadingOverlay';\r\nimport { type BootstrapData, type OnReadyCallback, useBootstrapApp } from '@jwp/ott-hooks-react/src/useBootstrapApp';\r\nimport { setThemingVariables } from '@jwp/ott-ui-react/src/utils/theming';\r\nimport type { Config } from '@jwp/ott-common/types/config';\r\nimport { AppError } from '@jwp/ott-common/src/utils/error';\r\n\r\nimport DemoConfigDialog from '../../components/DemoConfigDialog/DemoConfigDialog';\r\nimport AppRoutes from '../AppRoutes/AppRoutes';\r\n\r\nimport registerCustomScreens from '#src/screenMapping';\r\nimport { useTrackConfigKeyChange } from '#src/hooks/useTrackConfigKeyChange';\r\n\r\nconst IS_DEMO_OR_PREVIEW = IS_DEMO_MODE || IS_PREVIEW_MODE;\r\n\r\nconst BootstrapError = ({ error }: { error: Error | AppError }) => {\r\n  if (error instanceof AppError) {\r\n    return <ErrorPage title={error.payload.title} message={error.payload.description} helpLink={error.payload.helpLink} error={error} />;\r\n  }\r\n  return <ErrorPage error={error} />;\r\n};\r\n\r\nconst ProdContentLoader = ({ query }: { query: BootstrapData }) => {\r\n  const { isLoading, error } = query;\r\n\r\n  if (isLoading) {\r\n    return <LoadingOverlay />;\r\n  }\r\n\r\n  if (error) {\r\n    return <BootstrapError error={error} />;\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\nconst DemoContentLoader = ({ query }: { query: BootstrapData }) => {\r\n  const { isLoading, error, data } = query;\r\n\r\n  // Show the spinner while loading except in demo mode (the demo config shows its own loading status)\r\n  if (!IS_DEMO_OR_PREVIEW && isLoading) {\r\n    return <LoadingOverlay />;\r\n  }\r\n\r\n  const { configSource } = data || {};\r\n\r\n  return (\r\n    <>\r\n      {/* Show the error page when error except in demo mode (the demo mode shows its own error) */}\r\n      {!IS_DEMO_OR_PREVIEW && error && <BootstrapError error={error} />}\r\n      {IS_DEMO_OR_PREVIEW && <DemoConfigDialog query={query} />}\r\n      {/* Config select control to improve testing experience */}\r\n      {(IS_DEVELOPMENT_BUILD || IS_PREVIEW_MODE) && <DevConfigSelector selectedConfig={configSource} />}\r\n    </>\r\n  );\r\n};\r\n\r\n// This is moved to a separate, parallel component to reduce rerenders\r\nconst RootLoader = ({ onReady }: { onReady: OnReadyCallback }) => {\r\n  const query = useBootstrapApp(window.location.href, onReady);\r\n\r\n  // Modify query string to add / remove app-config id\r\n  useTrackConfigKeyChange(query.data?.settings, query.data?.configSource);\r\n\r\n  return IS_PROD_MODE ? <ProdContentLoader query={query} /> : <DemoContentLoader query={query} />;\r\n};\r\n\r\nconst Root: FC = () => {\r\n  const [isReady, setIsReady] = useState(false);\r\n\r\n  // Register custom screen mappings\r\n  useEffect(() => {\r\n    registerCustomScreens();\r\n  }, []);\r\n\r\n  const onReadyCallback = useCallback(async (config: Config | undefined) => {\r\n    // when the config is missing, the initialization failed\r\n    if (!config) {\r\n      return;\r\n    }\r\n\r\n    // because theming and analytics are specific to web, we configure it from here\r\n    // alternatively, we can use an events or specific callbacks or extend the AppController for each platform\r\n    setThemingVariables(config);\r\n\r\n    setIsReady(true);\r\n  }, []);\r\n\r\n  return (\r\n    <>\r\n      {isReady && <AppRoutes />}\r\n      {isReady && <AccountModal />}\r\n      {/*This is moved to a separate, parallel component to reduce rerenders */}\r\n      <RootLoader onReady={onReadyCallback} />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Root;\r\n","import React, { useEffect, useState } from 'react';\r\nimport { BrowserRouter } from 'react-router-dom';\r\nimport QueryProvider from '@jwp/ott-ui-react/src/containers/QueryProvider/QueryProvider';\r\nimport { ErrorPageWithoutTranslation } from '@jwp/ott-ui-react/src/components/ErrorPage/ErrorPage';\r\nimport LoadingOverlay from '@jwp/ott-ui-react/src/components/LoadingOverlay/LoadingOverlay';\r\nimport { AriaAnnouncerProvider } from '@jwp/ott-ui-react/src/containers/AnnouncementProvider/AnnoucementProvider';\r\nimport { logError } from '@jwp/ott-common/src/logger';\r\n\r\nimport initI18n from './i18n/config';\r\nimport Root from './containers/Root/Root';\r\n\r\nimport './screenMapping';\r\nimport './styles/main.scss';\r\n\r\ninterface State {\r\n  isLoading: boolean;\r\n  error?: Error;\r\n}\r\n\r\nexport default function App() {\r\n  const [i18nState, seti18nState] = useState<State>({ isLoading: true });\r\n\r\n  useEffect(() => {\r\n    initI18n()\r\n      .then(() => seti18nState({ isLoading: false }))\r\n      .catch((e) => seti18nState({ isLoading: false, error: e as Error }));\r\n  }, []);\r\n\r\n  if (i18nState.isLoading) {\r\n    return <LoadingOverlay />;\r\n  }\r\n\r\n  if (i18nState.error) {\r\n    logError('App', 'Failed to load translations', { error: i18nState.error });\r\n\r\n    // Don't be tempted to translate these strings. If i18n fails to load, translations won't work anyhow\r\n    return (\r\n      <ErrorPageWithoutTranslation\r\n        title={'Unable to load translations'}\r\n        message={'Check your language settings and try again later. If the problem persists contact technical support.'}\r\n        error={i18nState.error}\r\n      />\r\n    );\r\n  }\r\n\r\n  return (\r\n    <QueryProvider>\r\n      <BrowserRouter>\r\n        <AriaAnnouncerProvider>\r\n          <Root />\r\n        </AriaAnnouncerProvider>\r\n      </BrowserRouter>\r\n    </QueryProvider>\r\n  );\r\n}\r\n","export const attachAccessibilityListener = () => {\r\n  let isTabbing = false;\r\n\r\n  // when the user presses the Tab key, we add a `is-tabbing` className to the body element, so we can enable outline\r\n  // focus for keyboard users\r\n  document.addEventListener('keydown', (event) => {\r\n    if (event.key === 'Tab' && !isTabbing) {\r\n      isTabbing = true;\r\n      document.body.classList.add('is-tabbing');\r\n    }\r\n  });\r\n\r\n  // remove the `is-tabbing` className when the user uses a mouse again to interact with elements\r\n  document.addEventListener('mousedown', () => {\r\n    if (isTabbing) {\r\n      isTabbing = false;\r\n      document.body.classList.remove('is-tabbing');\r\n    }\r\n  });\r\n};\r\n","import 'virtual:polyfills';\r\nimport React from 'react';\r\nimport { createRoot } from 'react-dom/client';\r\nimport 'wicg-inert';\r\nimport { registerSW } from 'virtual:pwa-register';\r\nimport { configureEnv } from '@jwp/ott-common/src/env';\r\n\r\nimport './modules/register';\r\n\r\nimport App from './App';\r\n\r\nimport { attachAccessibilityListener } from '#src/utils/accessibility';\r\n\r\n// Collect env vars\r\nconfigureEnv({\r\n  APP_VERSION: import.meta.env.APP_VERSION,\r\n\r\n  APP_API_BASE_URL: import.meta.env.APP_API_BASE_URL,\r\n  APP_PLAYER_ID: import.meta.env.APP_PLAYER_ID,\r\n\r\n  APP_DEFAULT_CONFIG_SOURCE: import.meta.env.APP_DEFAULT_CONFIG_SOURCE,\r\n  APP_PLAYER_LICENSE_KEY: import.meta.env.APP_PLAYER_LICENSE_KEY,\r\n\r\n  APP_FOOTER_TEXT: import.meta.env.APP_FOOTER_TEXT,\r\n  APP_BODY_FONT: import.meta.env.APP_BODY_FONT,\r\n  APP_BODY_ALT_FONT: import.meta.env.APP_BODY_ALT_FONT,\r\n  APP_PUBLIC_URL: import.meta.env.APP_PUBLIC_URL || window.location.origin,\r\n});\r\n\r\nattachAccessibilityListener();\r\n\r\nconst rootElement = document.getElementById('root');\r\n\r\nif (rootElement) {\r\n  const root = createRoot(rootElement);\r\n  root.render(<App />);\r\n} else {\r\n  console.info('Application - rootElement not found');\r\n}\r\n\r\nconst refresh = registerSW({\r\n  immediate: true,\r\n  onNeedRefresh: () => refresh(true),\r\n});\r\n"],"file":"assets/index-B5wzJenI.js"}